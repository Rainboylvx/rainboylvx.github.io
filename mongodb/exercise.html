<!doctype html><html lang=zh-cn><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=cache-control content="max-age=0"><meta http-equiv=cache-control content="no-cache"><meta http-equiv=expires content="0"><meta http-equiv=expires content="Tue, 01 Jan 1980 1:00:00 GMT"><meta http-equiv=pragma content="no-cache"><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png }><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/site.webmanifest><meta name=theme-color media="(prefers-color-scheme: light)" content="#ffffff"><meta name=theme-color media="(prefers-color-scheme: dark)" content="#1b1b1b"><meta name=description content="MongoDB 练习 1"><script>(function(){const e=localStorage.getItem("theme")||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light");document.documentElement.setAttribute("data-theme",e)})()</script><title>MongoDB 练习 1 | Rainboy's Blog</title><style>:root{--background:#ffffff}@media(prefers-color-scheme:dark){:root{--background:#1b1b1b}}html{background-color:var(--background)}body{background-color:var(--background)}</style><link rel=stylesheet type=text/css href=/style.min.9e52618e081d7542403ff6356f894d993b93e26eb37d3f072c70cd92f0c439ab.css media=all><link rel=stylesheet href=/grid.css><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css integrity="sha512-fHwaWebuwA7NSF5Qg/af4UeDx9XqUpYpOGgubo3yWu+b2IQR4UeQwbb42Ti7gVAjNtVoI/I9TEoYeu9omwcC6g==" crossorigin=anonymous referrerpolicy=no-referrer><link href="https://fonts.font.im/css?family=Roboto+Mono" rel=stylesheet><style>body,.heti,.heti--sans{font-family:roboto mono,monospace,times new roman,times,heti song,serif,apple color emoji,segoe ui emoji,segoe ui symbol}</style></head><body><nav><ul class=menu><li><a tabindex=-1 class=menu-link href=/><u>H</u>ome</a></li><li><a tabindex=-1 class=menu-link href=/tags><u>T</u>ags</a></li><li><span style=cursor:pointer id=theme-switcher class=menu-link type=button><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-moon h-4 w-4"><path d="M12 3a6 6 0 009 9 9 9 0 11-9-9z"/></svg></span></li></ul></nav><div id=single-header><h1>MongoDB 练习 1</h1><div id=single-meta><span class=datesub>2025-09-09</span>
<span id=tags>&nbsp;&nbsp;
<span><a href=https://hugo-dead-simple.netlify.com/tags/mongodb.html>#mongodb</a>
</span>&nbsp; <span><a href=https://hugo-dead-simple.netlify.com/tags/exercises.html>#exercises</a>
</span>&nbsp;</span></div></div><aside class="hidden lg:block toc" id=tableOfContentContainer><nav id=TableOfContents><ul><li><a href=#5>5</a></li><li><a href=#8>8</a></li><li><a href=#9>9</a></li><li><a href=#10>10</a></li><li><a href=#11>11</a></li><li><a href=#12>12</a></li><li><a href=#13>13</a></li><li><a href=#14>14</a><ul><li><a href=#mongodb-nodejs-driver-的-find-方法>MongoDB Node.js Driver 的 <code>find</code> 方法</a></li><li><a href=#投影projection在选项对象中>投影（Projection）在选项对象中</a></li><li><a href=#为什么必须使用-projection-字段>为什么必须使用 <code>projection</code> 字段？</a></li><li><a href=#总结>总结</a></li></ul></li><li><a href=#15>15</a></li><li><a href=#16-包含reg投影>16 包含<code>Reg</code>+投影</a></li><li><a href=#17>17</a></li><li><a href=#18>18</a></li><li><a href=#19>19</a></li><li><a href=#20>20</a></li></ul></nav></aside><main class="heti heti--classic"><h2 id=5>5</h2><ol start=5><li>Write a MongoDB query to display all the restaurant which is in the borough Bronx.</li></ol><p>这个简单,本质是查询固定的值</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=ln>1</span><span class=cl><span class=nx>db</span><span class=p>[</span><span class=s2>&#34;restaurants&#34;</span><span class=p>].</span><span class=nx>find</span><span class=p>({</span><span class=s1>&#39;borough&#39;</span><span class=o>:</span><span class=s1>&#39;Bronx&#39;</span><span class=p>})</span>
</span></span></code></pre></div><h2 id=8>8</h2><ol start=8><li>Write a MongoDB query to find the restaurants who achieved a score more than 90.</li></ol><p>让我们查询一个数组,数组里面有一个Object的值<code>>=0</code></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=ln>1</span><span class=cl><span class=nx>db</span><span class=p>[</span><span class=s2>&#34;restaurants&#34;</span><span class=p>].</span><span class=nx>find</span><span class=p>({</span><span class=s1>&#39;grades.score&#39;</span><span class=o>:</span> <span class=p>{</span><span class=nx>$gt</span> <span class=o>:</span> <span class=mi>90</span><span class=p>}}).</span><span class=nx>count</span><span class=p>()</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=ln>1</span><span class=cl><span class=nx>db</span><span class=p>[</span><span class=s2>&#34;restaurants&#34;</span><span class=p>].</span><span class=nx>find</span><span class=p>({</span> <span class=s1>&#39;grades&#39;</span> <span class=o>:</span> <span class=p>{</span><span class=nx>$elemMatch</span> <span class=o>:</span> <span class=p>{</span> <span class=s2>&#34;score&#34;</span> <span class=o>:</span><span class=p>{</span><span class=nx>$gt</span> <span class=o>:</span> <span class=mi>90</span><span class=p>}</span> <span class=p>}</span>  <span class=p>}</span> <span class=p>})</span>
</span></span></code></pre></div><p>这两个的结果是等价的,只不过第二个用到了数组匹配操作符<code>$elemMatch</code></p><h2 id=9>9</h2><ol start=9><li>Write a MongoDB query to find the restaurants that achieved a score, more than 80 but less than 100.</li></ol><p>这个题目的意思是: <code>grades</code>里存在一个分数,这个分数在80与90之间</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=ln>1</span><span class=cl><span class=nx>db</span><span class=p>[</span><span class=s2>&#34;restaurants&#34;</span><span class=p>].</span><span class=nx>find</span><span class=p>({</span> <span class=s1>&#39;grades&#39;</span> <span class=o>:</span> <span class=p>{</span><span class=nx>$elemMatch</span> <span class=o>:</span> <span class=p>{</span> <span class=s2>&#34;score&#34;</span> <span class=o>:</span><span class=p>{</span><span class=nx>$gt</span> <span class=o>:</span> <span class=mi>80</span><span class=p>,</span><span class=nx>$lt</span><span class=o>:</span><span class=mi>100</span><span class=p>}</span> <span class=p>}</span>  <span class=p>}</span> <span class=p>})</span>
</span></span></code></pre></div><h2 id=10>10</h2><ol start=10><li>Write a MongoDB query to find the restaurants which locate in latitude value less than -95.754168.</li></ol><p>这里考察我们如何查询数组里某个下标的值</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=ln>1</span><span class=cl>db.restaurants.find<span class=o>({</span><span class=s2>&#34;address.coord.0&#34;</span>:<span class=o>{</span><span class=nv>$lte</span> :  -95.754168<span class=o>}</span> <span class=o>})</span>
</span></span></code></pre></div><h2 id=11>11</h2><ol start=11><li>Write a MongoDB query to find the restaurants that do not prepare any cuisine of &lsquo;American&rsquo; and their grade score more than 70 and latitude less than -65.754168.</li></ol><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=ln>1</span><span class=cl>db<span class=o>[</span><span class=s2>&#34;restaurants&#34;</span><span class=o>]</span>.count<span class=o>({</span>cuisine:<span class=o>{</span><span class=nv>$not</span>: <span class=o>{</span><span class=nv>$regex</span>: /.*American.*/ <span class=o>}</span> <span class=o>}</span>,grades:<span class=o>{</span><span class=nv>$elemMatch</span> : <span class=o>{</span> <span class=s2>&#34;score&#34;</span>:<span class=o>{</span><span class=nv>$gte</span>:70<span class=o>}</span> <span class=o>}}</span> <span class=o>})</span>
</span></span></code></pre></div><p>这里考查我们有多个条件,同时成立的查询</p><p>发现一个问题:</p><p>我查询了文档</p><ul><li>mongodb在数组上的查询 <a href=https://www.mongodb.com/zh-cn/docs/manual/tutorial/query-arrays/#specify-multiple-conditions-for-array-elements target=_blank rel=noopener>https://www.mongodb.com/zh-cn/docs/manual/tutorial/query-arrays/#specify-multiple-conditions-for-array-elements</a></li><li><a href=https://stackoverflow.com/questions/10907843/mongo-ne-query-with-an-array-not-working-as-expected target=_blank rel=noopener>mongodb - mongo $ne query with an array not working as expected - Stack Overflow</a></li></ul><p><code>$ne</code>操作在数组的查询与我想的不一样</p><p>如果你希望能够匹配数组中有部分元素与 &ldquo;red&rdquo; 不匹配的文档，可以使用 $elemMatch 来精确匹配数组中的单个元素：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=ln>1</span><span class=cl><span class=nx>db</span><span class=p>.</span><span class=nx>newdb</span><span class=p>.</span><span class=nx>find</span><span class=p>({</span>
</span></span><span class=line><span class=ln>2</span><span class=cl>  <span class=nx>tags</span><span class=o>:</span> <span class=p>{</span> <span class=nx>$elemMatch</span><span class=o>:</span> <span class=p>{</span> <span class=nx>$ne</span><span class=o>:</span> <span class=s2>&#34;red&#34;</span> <span class=p>}</span> <span class=p>}</span>
</span></span><span class=line><span class=ln>3</span><span class=cl><span class=p>})</span>
</span></span></code></pre></div><p>这里官方给出的答案</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=ln>1</span><span class=cl><span class=err>db.restaurants.find(</span>
</span></span><span class=line><span class=ln>2</span><span class=cl>               <span class=p>{</span><span class=err>$and:</span>
</span></span><span class=line><span class=ln>3</span><span class=cl>                    <span class=err>[</span>
</span></span><span class=line><span class=ln>4</span><span class=cl>                       <span class=err>{</span><span class=nt>&#34;cuisine&#34;</span> <span class=p>:</span> <span class=p>{</span><span class=err>$ne</span> <span class=err>:</span><span class=nt>&#34;American &#34;</span><span class=p>}}</span><span class=err>,</span>
</span></span><span class=line><span class=ln>5</span><span class=cl>                       <span class=p>{</span><span class=nt>&#34;grades.score&#34;</span> <span class=p>:</span> <span class=p>{</span><span class=err>$gt</span> <span class=err>:</span> <span class=err>70</span><span class=p>}}</span><span class=err>,</span>
</span></span><span class=line><span class=ln>6</span><span class=cl>                       <span class=p>{</span><span class=nt>&#34;address.coord&#34;</span> <span class=p>:</span> <span class=p>{</span><span class=err>$lt</span> <span class=err>:</span> <span class=err>-65.754168</span><span class=p>}}</span>
</span></span><span class=line><span class=ln>7</span><span class=cl>                    <span class=err>]</span>
</span></span><span class=line><span class=ln>8</span><span class=cl>                <span class=err>});</span>
</span></span></code></pre></div><h2 id=12>12</h2><ol start=12><li>Write a MongoDB query to find the restaurants which do not prepare any cuisine of &lsquo;American&rsquo; and achieved a score more than 70 and located in the longitude less than -65.754168.
Note : Do this query without using $and operator.</li></ol><p>和上一个问题的问题一样,只是不让我们使用<code>$and$</code>符号</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=ln>1</span><span class=cl><span class=nx>db</span><span class=p>.</span><span class=nx>restaurants</span><span class=p>.</span><span class=nx>find</span><span class=p>(</span>
</span></span><span class=line><span class=ln>2</span><span class=cl>                           <span class=p>{</span>
</span></span><span class=line><span class=ln>3</span><span class=cl>                             <span class=s2>&#34;cuisine&#34;</span> <span class=o>:</span> <span class=p>{</span><span class=nx>$ne</span> <span class=o>:</span> <span class=s2>&#34;American &#34;</span><span class=p>},</span>
</span></span><span class=line><span class=ln>4</span><span class=cl>                             <span class=s2>&#34;grades.score&#34;</span> <span class=o>:</span><span class=p>{</span><span class=nx>$gt</span><span class=o>:</span> <span class=mi>70</span><span class=p>},</span>
</span></span><span class=line><span class=ln>5</span><span class=cl>                             <span class=s2>&#34;address.coord&#34;</span> <span class=o>:</span> <span class=p>{</span><span class=nx>$lt</span> <span class=o>:</span> <span class=o>-</span><span class=mf>65.754168</span><span class=p>}</span>
</span></span><span class=line><span class=ln>6</span><span class=cl>                            <span class=p>}</span>
</span></span><span class=line><span class=ln>7</span><span class=cl>                     <span class=p>);</span>
</span></span></code></pre></div><h2 id=13>13</h2><ol start=13><li>Write a MongoDB query to find the restaurants which do not prepare any cuisine of &lsquo;American&rsquo; and achieved a grade point &lsquo;A&rsquo; not belongs to the borough Brooklyn. The document must be displayed according to the cuisine in descending order.</li></ol><p>前面的条件还好,这里只是多了一个排序的要求</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=ln>1</span><span class=cl><span class=nx>db</span><span class=p>.</span><span class=nx>restaurants</span><span class=p>.</span><span class=nx>find</span><span class=p>(</span> <span class=p>{</span>
</span></span><span class=line><span class=ln>2</span><span class=cl>                             <span class=s2>&#34;cuisine&#34;</span> <span class=o>:</span> <span class=p>{</span><span class=nx>$ne</span> <span class=o>:</span> <span class=s2>&#34;American&#34;</span><span class=p>},</span>
</span></span><span class=line><span class=ln>3</span><span class=cl>                             <span class=s2>&#34;grades.grade&#34;</span> <span class=o>:</span><span class=s2>&#34;A&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=ln>4</span><span class=cl>                             <span class=s2>&#34;borough&#34;</span><span class=o>:</span> <span class=p>{</span><span class=nx>$ne</span> <span class=o>:</span> <span class=s2>&#34;Brooklyn&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=ln>5</span><span class=cl>                       <span class=p>}</span> 
</span></span><span class=line><span class=ln>6</span><span class=cl>                    <span class=p>).</span><span class=nx>sort</span><span class=p>({</span><span class=s2>&#34;cuisine&#34;</span><span class=o>:-</span><span class=mi>1</span><span class=p>});</span>
</span></span></code></pre></div><h2 id=14>14</h2><ol start=14><li>Write a MongoDB query to find the restaurant Id, name, borough and cuisine for those restaurants which contain &lsquo;Wil&rsquo; as first three letters for its name.</li></ol><p>查询的条件是name的首个三个字母是3个Wil字符.</p><p>我这里的写法与官方不一样,因为我不理解官方的第二个参数,为什么这样写,因为我查询的nodejs api 不是这样的.</p><p><a href=https://mongodb.github.io/node-mongodb-native/6.11/interfaces/FindOptions.html#projection target=_blank rel=noopener>https://mongodb.github.io/node-mongodb-native/6.11/interfaces/FindOptions.html#projection</a></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=ln>1</span><span class=cl><span class=nx>db</span><span class=p>[</span><span class=s2>&#34;restaurants&#34;</span><span class=p>].</span><span class=nx>find</span> <span class=p>({</span><span class=nx>name</span><span class=o>:</span><span class=sr>/AWil/</span><span class=p>}).</span><span class=nx>projection</span><span class=p>({</span><span class=nx>name</span><span class=o>:</span><span class=mi>1</span><span class=p>,</span><span class=nx>restaurant_id</span><span class=o>:</span><span class=mi>1</span><span class=p>,</span><span class=nx>borough</span><span class=o>:</span><span class=mi>1</span><span class=p>,</span><span class=nx>cuisine</span><span class=o>:</span><span class=mi>1</span><span class=p>}})</span>
</span></span></code></pre></div><p>为什么会这样? ,AI 告诉我这是一个差异!!!</p><p>你提出的问题涉及到 <strong>MongoDB Node.js Driver</strong> 的 <code>find</code> 方法的第二个参数，它实际上是一个 <strong>选项对象（options）</strong>，而 <strong>投影（projection）</strong> 是该选项对象中的一个字段。这是 MongoDB <strong>Node.js Driver</strong> 和 <strong>MongoDB Shell</strong>（<code>mongosh</code>）之间的一个差异。</p><h3 id=mongodb-nodejs-driver-的-find-方法>MongoDB Node.js Driver 的 <code>find</code> 方法</h3><p>根据你提供的链接，在 MongoDB 的 <strong>Node.js Driver</strong> 版本 3.6 中，<code>find</code> 方法的第二个参数 <strong>必须是一个选项对象</strong>，该对象中可以包含多个选项，例如 <code>projection</code>, <code>sort</code>, <code>limit</code> 等。</p><h4 id=find-方法的签名nodejs-driver><code>find</code> 方法的签名（Node.js Driver）</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=ln>1</span><span class=cl><span class=nx>find</span><span class=p>(</span><span class=nx>filter</span><span class=p>,</span> <span class=nx>options</span><span class=p>)</span>
</span></span></code></pre></div><ul><li><code>filter</code>: 查询条件。</li><li><code>options</code>: 选项对象，其中包括多个可选的字段，例如 <code>projection</code>, <code>sort</code>, <code>limit</code> 等。</li></ul><h3 id=投影projection在选项对象中>投影（Projection）在选项对象中</h3><p>在 <strong>MongoDB Node.js Driver</strong> 中，<strong>投影（projection）</strong> 是通过选项对象中的 <code>projection</code> 字段来指定的。因此，第二个参数的形式通常是一个包含 <code>projection</code> 字段的对象，而 <strong>投影（projection）</strong> 本身是一个文档，定义了需要包含或排除的字段。</p><h4 id=示例代码>示例代码：</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=ln> 1</span><span class=cl><span class=kr>const</span> <span class=p>{</span> <span class=nx>MongoClient</span> <span class=p>}</span> <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s1>&#39;mongodb&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=ln> 2</span><span class=cl>
</span></span><span class=line><span class=ln> 3</span><span class=cl><span class=kr>async</span> <span class=kd>function</span> <span class=nx>queryRestaurants</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=ln> 4</span><span class=cl>  <span class=kr>const</span> <span class=nx>client</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>MongoClient</span><span class=p>(</span><span class=s1>&#39;mongodb://localhost:27017&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=ln> 5</span><span class=cl>  <span class=kr>await</span> <span class=nx>client</span><span class=p>.</span><span class=nx>connect</span><span class=p>();</span>
</span></span><span class=line><span class=ln> 6</span><span class=cl>  <span class=kr>const</span> <span class=nx>db</span> <span class=o>=</span> <span class=nx>client</span><span class=p>.</span><span class=nx>db</span><span class=p>(</span><span class=s1>&#39;test&#39;</span><span class=p>);</span> <span class=c1>// 假设你的数据库名是 &#39;test&#39;
</span></span></span><span class=line><span class=ln> 7</span><span class=cl><span class=c1></span>  <span class=kr>const</span> <span class=nx>collection</span> <span class=o>=</span> <span class=nx>db</span><span class=p>.</span><span class=nx>collection</span><span class=p>(</span><span class=s1>&#39;restaurants&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=ln> 8</span><span class=cl>
</span></span><span class=line><span class=ln> 9</span><span class=cl>  <span class=c1>// 使用 find 查询并投影
</span></span></span><span class=line><span class=ln>10</span><span class=cl><span class=c1></span>  <span class=kr>const</span> <span class=nx>cursor</span> <span class=o>=</span> <span class=nx>collection</span><span class=p>.</span><span class=nx>find</span><span class=p>(</span>
</span></span><span class=line><span class=ln>11</span><span class=cl>    <span class=p>{</span> <span class=nx>name</span><span class=o>:</span> <span class=sr>/^Wil/</span> <span class=p>},</span>
</span></span><span class=line><span class=ln>12</span><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=ln>13</span><span class=cl>      <span class=nx>projection</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=ln>14</span><span class=cl>        <span class=s2>&#34;restaurant_id&#34;</span><span class=o>:</span> <span class=mi>1</span><span class=p>,</span>
</span></span><span class=line><span class=ln>15</span><span class=cl>        <span class=s2>&#34;name&#34;</span><span class=o>:</span> <span class=mi>1</span><span class=p>,</span>
</span></span><span class=line><span class=ln>16</span><span class=cl>        <span class=s2>&#34;borough&#34;</span><span class=o>:</span> <span class=mi>1</span><span class=p>,</span>
</span></span><span class=line><span class=ln>17</span><span class=cl>        <span class=s2>&#34;cuisine&#34;</span><span class=o>:</span> <span class=mi>1</span>
</span></span><span class=line><span class=ln>18</span><span class=cl>      <span class=p>}</span>
</span></span><span class=line><span class=ln>19</span><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=ln>20</span><span class=cl>  <span class=p>);</span>
</span></span><span class=line><span class=ln>21</span><span class=cl>
</span></span><span class=line><span class=ln>22</span><span class=cl>  <span class=c1>// 获取查询结果并打印
</span></span></span><span class=line><span class=ln>23</span><span class=cl><span class=c1></span>  <span class=kr>const</span> <span class=nx>results</span> <span class=o>=</span> <span class=kr>await</span> <span class=nx>cursor</span><span class=p>.</span><span class=nx>toArray</span><span class=p>();</span>
</span></span><span class=line><span class=ln>24</span><span class=cl>  <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>results</span><span class=p>);</span>
</span></span><span class=line><span class=ln>25</span><span class=cl>
</span></span><span class=line><span class=ln>26</span><span class=cl>  <span class=kr>await</span> <span class=nx>client</span><span class=p>.</span><span class=nx>close</span><span class=p>();</span>
</span></span><span class=line><span class=ln>27</span><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=ln>28</span><span class=cl>
</span></span><span class=line><span class=ln>29</span><span class=cl><span class=nx>queryRestaurants</span><span class=p>().</span><span class=k>catch</span><span class=p>(</span><span class=nx>console</span><span class=p>.</span><span class=nx>error</span><span class=p>);</span>
</span></span></code></pre></div><h3 id=为什么必须使用-projection-字段>为什么必须使用 <code>projection</code> 字段？</h3><p>在 Node.js MongoDB Driver 的 <strong><code>find</code></strong> 方法中，第二个参数是一个 <strong>选项对象（options）</strong>，因此你需要明确指定 <code>projection</code> 字段来设置查询返回的字段。这是与 <strong>MongoDB Shell（mongosh）</strong> 的差异，后者可以直接将投影文档作为第二个参数。</p><h4 id=nodejs-driver-的选项对象结构>Node.js Driver 的选项对象结构</h4><p>在 Node.js 中，你可以传递一个包含多个选项字段的对象，例如：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=ln>1</span><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=ln>2</span><span class=cl>  <span class=nx>projection</span><span class=o>:</span> <span class=p>{</span> <span class=s2>&#34;restaurant_id&#34;</span><span class=o>:</span> <span class=mi>1</span><span class=p>,</span> <span class=s2>&#34;name&#34;</span><span class=o>:</span> <span class=mi>1</span><span class=p>,</span> <span class=s2>&#34;borough&#34;</span><span class=o>:</span> <span class=mi>1</span><span class=p>,</span> <span class=s2>&#34;cuisine&#34;</span><span class=o>:</span> <span class=mi>1</span> <span class=p>},</span>
</span></span><span class=line><span class=ln>3</span><span class=cl>  <span class=nx>sort</span><span class=o>:</span> <span class=p>{</span> <span class=nx>name</span><span class=o>:</span> <span class=mi>1</span> <span class=p>},</span>
</span></span><span class=line><span class=ln>4</span><span class=cl>  <span class=nx>limit</span><span class=o>:</span> <span class=mi>10</span>
</span></span><span class=line><span class=ln>5</span><span class=cl><span class=p>}</span>
</span></span></code></pre></div><ul><li><code>projection</code>: 指定返回的字段。</li><li><code>sort</code>: 指定排序规则。</li><li><code>limit</code>: 限制返回的文档数量。</li></ul><h3 id=总结>总结</h3><p>在 <strong>MongoDB Node.js Driver</strong> 中，第二个参数是一个 <strong>选项对象（options）</strong>，其中包含 <code>projection</code> 字段来指定投影。而在 <strong>MongoDB Shell（mongosh）</strong> 中，第二个参数直接是一个投影文档，可以省略 <code>projection</code> 字段名。</p><h4 id=nodejs-driver-使用-projection>Node.js Driver 使用 <code>projection</code>：</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=ln>1</span><span class=cl><span class=nx>db</span><span class=p>.</span><span class=nx>restaurants</span><span class=p>.</span><span class=nx>find</span><span class=p>(</span>
</span></span><span class=line><span class=ln>2</span><span class=cl>  <span class=p>{</span> <span class=nx>name</span><span class=o>:</span> <span class=sr>/^Wil/</span> <span class=p>},</span>
</span></span><span class=line><span class=ln>3</span><span class=cl>  <span class=p>{</span> <span class=nx>projection</span><span class=o>:</span> <span class=p>{</span> <span class=s2>&#34;restaurant_id&#34;</span><span class=o>:</span> <span class=mi>1</span><span class=p>,</span> <span class=s2>&#34;name&#34;</span><span class=o>:</span> <span class=mi>1</span><span class=p>,</span> <span class=s2>&#34;borough&#34;</span><span class=o>:</span> <span class=mi>1</span><span class=p>,</span> <span class=s2>&#34;cuisine&#34;</span><span class=o>:</span> <span class=mi>1</span> <span class=p>}</span> <span class=p>}</span>
</span></span><span class=line><span class=ln>4</span><span class=cl><span class=p>);</span>
</span></span></code></pre></div><h4 id=mongodb-shell-中直接传递投影文档>MongoDB Shell 中直接传递投影文档：</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=ln>1</span><span class=cl><span class=nx>db</span><span class=p>.</span><span class=nx>restaurants</span><span class=p>.</span><span class=nx>find</span><span class=p>(</span>
</span></span><span class=line><span class=ln>2</span><span class=cl>  <span class=p>{</span> <span class=nx>name</span><span class=o>:</span> <span class=sr>/^Wil/</span> <span class=p>},</span>
</span></span><span class=line><span class=ln>3</span><span class=cl>  <span class=p>{</span> <span class=s2>&#34;restaurant_id&#34;</span><span class=o>:</span> <span class=mi>1</span><span class=p>,</span> <span class=s2>&#34;name&#34;</span><span class=o>:</span> <span class=mi>1</span><span class=p>,</span> <span class=s2>&#34;borough&#34;</span><span class=o>:</span> <span class=mi>1</span><span class=p>,</span> <span class=s2>&#34;cuisine&#34;</span><span class=o>:</span> <span class=mi>1</span> <span class=p>}</span>
</span></span><span class=line><span class=ln>4</span><span class=cl><span class=p>);</span>
</span></span></code></pre></div><p>好吧,经过我的查询,这真的是一个差异:</p><ul><li><a href=https://stackoverflow.com/questions/67090307/mongodb-projection-syntax target=_blank rel=noopener>https://stackoverflow.com/questions/67090307/mongodb-projection-syntax</a></li><li><a href=https://www.mongodb.com/zh-cn/docs/manual/reference/method/db.collection.findOne/ target=_blank rel=noopener>https://www.mongodb.com/zh-cn/docs/manual/reference/method/db.collection.findOne/</a></li></ul><p>两者确实不一样.</p><h2 id=15>15</h2><ol start=15><li>Write a MongoDB query to find the restaurant Id, name, borough and cuisine for those restaurants which contain &lsquo;ces&rsquo; as last three letters for its name.</li></ol><p>和上一个问题一样,但是要查询的值是最后三个字符,还是使用regex</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=ln>1</span><span class=cl><span class=nx>db</span><span class=p>.</span><span class=nx>restaurants</span><span class=p>.</span><span class=nx>find</span><span class=p>(</span>
</span></span><span class=line><span class=ln>2</span><span class=cl><span class=p>{</span><span class=nx>name</span><span class=o>:</span> <span class=sr>/ces$/</span><span class=p>},</span>
</span></span><span class=line><span class=ln>3</span><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=ln>4</span><span class=cl><span class=s2>&#34;restaurant_id&#34;</span> <span class=o>:</span> <span class=mi>1</span><span class=p>,</span>
</span></span><span class=line><span class=ln>5</span><span class=cl><span class=s2>&#34;name&#34;</span><span class=o>:</span><span class=mi>1</span><span class=p>,</span><span class=s2>&#34;borough&#34;</span><span class=o>:</span><span class=mi>1</span><span class=p>,</span>
</span></span><span class=line><span class=ln>6</span><span class=cl><span class=s2>&#34;cuisine&#34;</span> <span class=o>:</span><span class=mi>1</span>
</span></span><span class=line><span class=ln>7</span><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=ln>8</span><span class=cl><span class=p>);</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=ln>1</span><span class=cl><span class=nx>db</span><span class=p>[</span><span class=s2>&#34;restaurants&#34;</span><span class=p>].</span><span class=nx>find</span> <span class=p>({</span><span class=nx>name</span><span class=o>:</span><span class=sr>/ces$/</span><span class=p>}).</span><span class=nx>projection</span><span class=p>({</span><span class=nx>name</span><span class=o>:</span><span class=mi>1</span><span class=p>,</span>
</span></span><span class=line><span class=ln>2</span><span class=cl><span class=nx>restaurant_id</span><span class=o>:</span><span class=mi>1</span><span class=p>,</span><span class=nx>borough</span><span class=o>:</span><span class=mi>1</span><span class=p>,</span><span class=nx>cuisine</span><span class=o>:</span><span class=mi>1</span><span class=p>})</span>
</span></span></code></pre></div><h2 id=16-包含reg投影>16 包含<code>Reg</code>+投影</h2><ol start=16><li>Write a MongoDB query to find the restaurant Id, name, borough and cuisine for those restaurants which contain &lsquo;Reg&rsquo; as three letters somewhere in its name.</li></ol><p>改变一下reg就可以了.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=ln> 1</span><span class=cl><span class=nx>db</span><span class=p>[</span><span class=s2>&#34;restaurants&#34;</span><span class=p>].</span><span class=nx>find</span><span class=p>({</span><span class=nx>name</span><span class=o>:</span><span class=sr>/Reg/</span><span class=p>},{</span><span class=nx>name</span><span class=o>:</span><span class=mi>1</span><span class=p>}).</span><span class=nx>count</span><span class=p>()</span>
</span></span><span class=line><span class=ln> 2</span><span class=cl><span class=nx>db</span><span class=p>[</span><span class=s2>&#34;restaurants&#34;</span><span class=p>].</span><span class=nx>find</span><span class=p>({</span><span class=nx>name</span><span class=o>:</span><span class=sr>/Reg/</span><span class=p>},{</span><span class=nx>name</span><span class=o>:</span><span class=mi>1</span><span class=p>}).</span><span class=nx>count</span><span class=p>()</span>
</span></span><span class=line><span class=ln> 3</span><span class=cl>
</span></span><span class=line><span class=ln> 4</span><span class=cl><span class=nx>db</span><span class=p>.</span><span class=nx>restaurants</span><span class=p>.</span><span class=nx>find</span><span class=p>(</span>
</span></span><span class=line><span class=ln> 5</span><span class=cl><span class=p>{</span><span class=s2>&#34;name&#34;</span><span class=o>:</span> <span class=sr>/.*Reg.*/</span><span class=p>},</span>
</span></span><span class=line><span class=ln> 6</span><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=ln> 7</span><span class=cl><span class=s2>&#34;restaurant_id&#34;</span> <span class=o>:</span> <span class=mi>1</span><span class=p>,</span>
</span></span><span class=line><span class=ln> 8</span><span class=cl><span class=s2>&#34;name&#34;</span><span class=o>:</span><span class=mi>1</span><span class=p>,</span><span class=s2>&#34;borough&#34;</span><span class=o>:</span><span class=mi>1</span><span class=p>,</span>
</span></span><span class=line><span class=ln> 9</span><span class=cl><span class=s2>&#34;cuisine&#34;</span> <span class=o>:</span><span class=mi>1</span>
</span></span><span class=line><span class=ln>10</span><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=ln>11</span><span class=cl><span class=p>);</span>
</span></span></code></pre></div><h2 id=17>17</h2><ol start=17><li>Write a MongoDB query to find the restaurants which belong to the borough Bronx and prepared either American or Chinese dish.</li></ol><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=ln>1</span><span class=cl><span class=nx>db</span><span class=p>[</span><span class=s2>&#34;restaurants&#34;</span><span class=p>].</span><span class=nx>find</span><span class=p>({</span><span class=s2>&#34;cuisine&#34;</span><span class=o>:</span> <span class=p>{</span><span class=nx>$in</span> <span class=o>:</span><span class=p>[</span><span class=s1>&#39;Chinese&#39;</span><span class=p>,</span> <span class=s1>&#39;American &#39;</span><span class=p>]}</span> <span class=p>,</span>
</span></span><span class=line><span class=ln>2</span><span class=cl>  <span class=s2>&#34;borough&#34;</span><span class=o>:</span> <span class=s2>&#34;Bronx&#34;</span>
</span></span><span class=line><span class=ln>3</span><span class=cl><span class=p>},{</span><span class=s2>&#34;cuisine&#34;</span><span class=o>:</span><span class=mi>1</span><span class=p>}).</span><span class=nx>count</span><span class=p>()</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=ln>1</span><span class=cl><span class=nx>db</span><span class=p>.</span><span class=nx>restaurants</span><span class=p>.</span><span class=nx>find</span><span class=p>(</span>
</span></span><span class=line><span class=ln>2</span><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=ln>3</span><span class=cl><span class=s2>&#34;borough&#34;</span><span class=o>:</span> <span class=s2>&#34;Bronx&#34;</span> <span class=p>,</span>
</span></span><span class=line><span class=ln>4</span><span class=cl><span class=nx>$or</span> <span class=o>:</span> <span class=p>[</span>
</span></span><span class=line><span class=ln>5</span><span class=cl><span class=p>{</span> <span class=s2>&#34;cuisine&#34;</span> <span class=o>:</span> <span class=s2>&#34;American &#34;</span> <span class=p>},</span>
</span></span><span class=line><span class=ln>6</span><span class=cl><span class=p>{</span> <span class=s2>&#34;cuisine&#34;</span> <span class=o>:</span> <span class=s2>&#34;Chinese&#34;</span> <span class=p>}</span>
</span></span><span class=line><span class=ln>7</span><span class=cl><span class=p>]</span>
</span></span><span class=line><span class=ln>8</span><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=ln>9</span><span class=cl><span class=p>);</span>
</span></span></code></pre></div><h2 id=18>18</h2><p>Write a MongoDB query to find the restaurant Id, name, borough and cuisine for those restaurants which belong to the borough Staten Island or Queens or Bronxor Brooklyn.</p><p>和我的上一个执行<code>$in</code>的语法一样</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=ln>1</span><span class=cl><span class=nx>db</span><span class=p>.</span><span class=nx>restaurants</span><span class=p>.</span><span class=nx>find</span><span class=p>(</span>
</span></span><span class=line><span class=ln>2</span><span class=cl>    <span class=p>{</span><span class=s2>&#34;borough&#34;</span> <span class=o>:</span><span class=p>{</span><span class=nx>$in</span> <span class=o>:</span><span class=p>[</span><span class=s2>&#34;Staten Island&#34;</span><span class=p>,</span><span class=s2>&#34;Queens&#34;</span><span class=p>,</span><span class=s2>&#34;Bronx&#34;</span><span class=p>,</span><span class=s2>&#34;Brooklyn&#34;</span><span class=p>]}},</span>
</span></span><span class=line><span class=ln>3</span><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=ln>4</span><span class=cl>    <span class=s2>&#34;restaurant_id&#34;</span> <span class=o>:</span> <span class=mi>1</span><span class=p>,</span>
</span></span><span class=line><span class=ln>5</span><span class=cl>    <span class=s2>&#34;name&#34;</span><span class=o>:</span><span class=mi>1</span><span class=p>,</span><span class=s2>&#34;borough&#34;</span><span class=o>:</span><span class=mi>1</span><span class=p>,</span>
</span></span><span class=line><span class=ln>6</span><span class=cl>    <span class=s2>&#34;cuisine&#34;</span> <span class=o>:</span><span class=mi>1</span>
</span></span><span class=line><span class=ln>7</span><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=ln>8</span><span class=cl>    <span class=p>);</span>
</span></span></code></pre></div><h2 id=19>19</h2><p>Write a MongoDB query to find the restaurant Id, name, borough and cuisine for those restaurants which are not belonging to the borough Staten Island or Queens or Bronxor Brooklyn.</p><p>从数理逻辑的角度来看,<span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mo mathvariant="normal">∉</mo><mo stretchy="false">{</mo><mtext>borough Staten Island , Queens , Bronxor Brooklyn</mtext><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">a \notin \{\text{borough Staten Island , Queens , Bronxor Brooklyn} \}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class="mord mathnormal">a</span><span class=mspace style=margin-right:.2778em></span><span class=mrel><span class=mord><span class=mrel>∈</span></span><span class="mord vbox"><span class=thinbox><span class=llap><span class=strut style=height:1em;vertical-align:-.25em></span><span class=inner><span class=mord><span class=mord>/</span><span class=mspace style=margin-right:.0556em></span></span></span><span class=fix></span></span></span></span></span><span class=mspace style=margin-right:.2778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mopen>{</span><span class="mord text"><span class=mord>borough Staten Island , Queens , Bronxor Brooklyn</span></span><span class=mclose>}</span></span></span></span> 当这个条件为true的时候,这里使用<code>$nin</code>操作</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=ln>1</span><span class=cl><span class=nx>db</span><span class=p>.</span><span class=nx>restaurants</span><span class=p>.</span><span class=nx>find</span><span class=p>(</span>
</span></span><span class=line><span class=ln>2</span><span class=cl><span class=p>{</span><span class=s2>&#34;borough&#34;</span> <span class=o>:</span><span class=p>{</span><span class=nx>$nin</span> <span class=o>:</span><span class=p>[</span><span class=s2>&#34;Staten Island&#34;</span><span class=p>,</span><span class=s2>&#34;Queens&#34;</span><span class=p>,</span><span class=s2>&#34;Bronx&#34;</span><span class=p>,</span><span class=s2>&#34;Brooklyn&#34;</span><span class=p>]}},</span>
</span></span><span class=line><span class=ln>3</span><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=ln>4</span><span class=cl><span class=s2>&#34;restaurant_id&#34;</span> <span class=o>:</span> <span class=mi>1</span><span class=p>,</span>
</span></span><span class=line><span class=ln>5</span><span class=cl><span class=s2>&#34;name&#34;</span><span class=o>:</span><span class=mi>1</span><span class=p>,</span><span class=s2>&#34;borough&#34;</span><span class=o>:</span><span class=mi>1</span><span class=p>,</span>
</span></span><span class=line><span class=ln>6</span><span class=cl><span class=s2>&#34;cuisine&#34;</span> <span class=o>:</span><span class=mi>1</span>
</span></span><span class=line><span class=ln>7</span><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=ln>8</span><span class=cl><span class=p>);</span>
</span></span></code></pre></div><h2 id=20>20</h2><p>Write a MongoDB query to find the restaurant Id, name, borough and cuisine for those restaurants which achieved a score which is not more than 10.</p><p>这里的核心就在于 not more than 10 ,数学写法</p><span class=katex-display><span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi mathvariant="normal">¬</mi><mo stretchy="false">(</mo><mi>g</mi><mi>r</mi><mi>a</mi><mi>d</mi><mi>e</mi><mi>s</mi><mi mathvariant="normal">.</mi><mi>s</mi><mi>c</mi><mi>o</mi><mi>r</mi><mi>e</mi><mo>&gt;</mo><mn>10</mn><mo stretchy="false">)</mo><mo>⇔</mo><mi>g</mi><mi>r</mi><mi>a</mi><mi>d</mi><mi>e</mi><mi>s</mi><mi mathvariant="normal">.</mi><mi>s</mi><mi>c</mi><mi>o</mi><mi>r</mi><mi>e</mi><mo>&lt;</mo><mo>=</mo><mn>10</mn></mrow><annotation encoding="application/x-tex">
\neg (grades.score &gt; 10) \Leftrightarrow grades.score &lt;= 10
</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord>¬</span><span class=mopen>(</span><span class="mord mathnormal" style=margin-right:.03588em>g</span><span class="mord mathnormal" style=margin-right:.02778em>r</span><span class="mord mathnormal">a</span><span class="mord mathnormal">d</span><span class="mord mathnormal">es</span><span class=mord>.</span><span class="mord mathnormal">score</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>></span><span class=mspace style=margin-right:.2778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord>10</span><span class=mclose>)</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>⇔</span><span class=mspace style=margin-right:.2778em></span></span><span class=base><span class=strut style=height:.8889em;vertical-align:-.1944em></span><span class="mord mathnormal" style=margin-right:.03588em>g</span><span class="mord mathnormal" style=margin-right:.02778em>r</span><span class="mord mathnormal">a</span><span class="mord mathnormal">d</span><span class="mord mathnormal">es</span><span class=mord>.</span><span class="mord mathnormal">score</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>&lt;=</span><span class=mspace style=margin-right:.2778em></span></span><span class=base><span class=strut style=height:.6444em></span><span class=mord>10</span></span></span></span></span><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=ln>1</span><span class=cl><span class=nx>db</span><span class=p>[</span><span class=s2>&#34;restaurants&#34;</span><span class=p>].</span><span class=nx>find</span><span class=p>({</span><span class=s2>&#34;grades.score&#34;</span><span class=o>:</span> <span class=p>{</span><span class=nx>$lte</span><span class=o>:</span> <span class=mi>10</span><span class=p>}}).</span><span class=nx>count</span><span class=p>()</span>
</span></span><span class=line><span class=ln>2</span><span class=cl>
</span></span><span class=line><span class=ln>3</span><span class=cl><span class=nx>db</span><span class=p>.</span><span class=nx>restaurants</span><span class=p>.</span><span class=nx>find</span><span class=p>(</span> <span class=p>{</span><span class=s2>&#34;grades.score&#34;</span> <span class=o>:</span> <span class=p>{</span> <span class=nx>$not</span><span class=o>:</span> <span class=p>{</span><span class=nx>$gt</span> <span class=o>:</span> <span class=mi>10</span><span class=p>}</span> <span class=p>}</span> <span class=p>}).</span><span class=nx>count</span><span class=p>()</span>
</span></span></code></pre></div><p>恩&mldr;&mldr;&mldr;.., 两者竟然是不一样的.</p><p>题目应该问的是: 所有的分都不超过10.</p><p><code>$lte:10</code> 应该是只要有一个(存在)<code>&lt;=10</code> 就成立</p><p>遇到这种事件,应该首先查文档: <a href=https://www.mongodb.com/zh-cn/docs/manual/reference/operator/query/not/ target=_blank rel=noopener>https://www.mongodb.com/zh-cn/docs/manual/reference/operator/query/not/</a>,但文档上没有说.</p><p><code>find({ "grades.score": {$gt : 10} })</code> 表示的意思其实是: <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">∃</mi><mo stretchy="false">(</mo><mi>x</mi><mo>&gt;</mo><mn>10</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\exists (x &gt; 10)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord>∃</span><span class=mopen>(</span><span class="mord mathnormal">x</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>></span><span class=mspace style=margin-right:.2778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord>10</span><span class=mclose>)</span></span></span></span></p><p><code>find({ "grades.score": {$not :{ $gt : 10} }})</code> 表示的意思其实是: <span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">¬</mi><mi mathvariant="normal">∃</mi><mo stretchy="false">(</mo><mi>x</mi><mo>&gt;</mo><mn>10</mn><mo stretchy="false">)</mo><mo>→</mo><mi mathvariant="normal">∀</mi><mo stretchy="false">(</mo><mi>x</mi><mo>&lt;</mo><mo>=</mo><mn>10</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\neg \exists (x &gt; 10) \to \forall (x&lt;=10)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord>¬∃</span><span class=mopen>(</span><span class="mord mathnormal">x</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>></span><span class=mspace style=margin-right:.2778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord>10</span><span class=mclose>)</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>→</span><span class=mspace style=margin-right:.2778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord>∀</span><span class=mopen>(</span><span class="mord mathnormal">x</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>&lt;=</span><span class=mspace style=margin-right:.2778em></span></span><span class=base><span class=strut style=height:1em;vertical-align:-.25em></span><span class=mord>10</span><span class=mclose>)</span></span></span></span>,这样就能理解了</p></main><br><footer><div class=footer-info><p>Copyright &copy; 2025 Rainboy. All rights reserved.
<span>| Last build: 2025-09-12 20:08:29</span></p></div><script defer>document.addEventListener("keydown",function(e){if(document.activeElement.isContentEditable)return!1;if(document.activeElement.tagName=="INPUT")return!1;if(e.altKey||e.ctrlKey||e.shiftKey)return!1;var t=e.key;if(t==="h")e.preventDefault(),e.stopPropagation(),window.location.href="/";else if(t==="t")e.preventDefault(),e.stopPropagation(),window.location.href=`https://${location.hostname}/tags`;else if(t==="i"){e.preventDefault(),e.stopPropagation();const t=document.querySelectorAll("input");for(let e=0;e<t.length;e++)if(t[e].offsetParent!==null){t[e].selectionStart=t[e].selectionEnd=t[e].value.length,t[e].focus();break}}return!1})</script><script defer>function throttle(e,t){var n=Date.now();return function(){var s=Date.now();n+t-s<0&&(e(),n=s)}}function scrollHandler(){const e=Array.from(document.querySelectorAll("body h2, body h3"));function t(){for(var n,s,o,i=window.pageYOffset||document.documentElement.scrollTop,t=0;t<e.length;t++)s=e[t].getAttribute("id"),n=document.querySelector('nav ul li a[href="#'+s+'"]'),n&&n.classList.remove("active-toc");for(t=e.length-1;t>=0;t--)if(o=e[t].offsetTop,i>o-75&&(s=e[t].getAttribute("id"),n=document.querySelector('nav ul li a[href="#'+s+'"]'),n)){n.classList.add("active-toc");break}}window.addEventListener("scroll",throttle(t,200))}setTimeout(scrollHandler,100)</script><script defer>function addCopyButtonToCodeBlocks(){const e=document.querySelectorAll('code[class^="language-"]:not(.output):not([class*="language-console"])');e.forEach(e=>{const t=document.createElement("button");t.classList.add("copy-code-button"),t.innerHTML="copy",t.addEventListener("click",()=>{const s=e.querySelectorAll(".cl");let n="";s.forEach(e=>{n+=e.innerText}),navigator.clipboard.writeText(n),t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},1500)}),e.parentNode.before(t)})}setTimeout(function(){addCopyButtonToCodeBlocks()},100)</script><script defer src=/js/theme-switcher.js></script></footer></body></html>