<!doctype html><html lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=cache-control content="max-age=0"><meta http-equiv=cache-control content="no-cache"><meta http-equiv=expires content="0"><meta http-equiv=expires content="Tue, 01 Jan 1980 1:00:00 GMT"><meta http-equiv=pragma content="no-cache"><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png }><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/site.webmanifest><meta name=theme-color media="(prefers-color-scheme: light)" content="#ffffff"><meta name=theme-color media="(prefers-color-scheme: dark)" content="#1b1b1b"><meta name=description content="MongoDB 练习 2"><script>(function(){const e=localStorage.getItem("theme")||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light");document.documentElement.setAttribute("data-theme",e)})()</script><title>MongoDB 练习 2 | Rainboy's Blog</title><style>:root{--background:#ffffff}@media(prefers-color-scheme:dark){:root{--background:#1b1b1b}}html{background-color:var(--background)}body{background-color:var(--background)}</style><link rel=stylesheet type=text/css href=/style.min.20930b28bccdfeef9630b3bf7e743593efc6984312602656fd25572182cb9c89.css media=all><link rel=stylesheet href=/grid.css><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css integrity="sha512-fHwaWebuwA7NSF5Qg/af4UeDx9XqUpYpOGgubo3yWu+b2IQR4UeQwbb42Ti7gVAjNtVoI/I9TEoYeu9omwcC6g==" crossorigin=anonymous referrerpolicy=no-referrer></head><body><nav><ul class=menu><li><a tabindex=-1 class=menu-link href=/><u>H</u>ome</a></li><li><a tabindex=-1 class=menu-link href=/tags><u>T</u>ags</a></li><li><span style=cursor:pointer id=theme-switcher class=menu-link type=button>🌙</span></li></ul></nav><div id=single-header><h1>MongoDB 练习 2</h1><div id=single-meta><span class=datesub>2025-09-09</span>
<span id=tags>&nbsp;&nbsp;
<span><a href=https://hugo-dead-simple.netlify.com/tags/mongodb/>#mongodb</a>
</span>&nbsp; <span><a href=https://hugo-dead-simple.netlify.com/tags/exercises/>#exercises</a>
</span>&nbsp;</span></div></div><aside class="hidden lg:block toc" id=tableOfContentContainer><nav id=TableOfContents><ul><li><a href=#21>21</a></li><li><a href=#22>22</a></li><li><a href=#23>23</a></li><li><a href=#24>24</a></li><li><a href=#2526>25,26</a></li><li><a href=#27>27</a></li><li><a href=#28>28</a></li><li><a href=#29>29</a></li><li><a href=#30>30</a></li><li><a href=#31>31</a></li><li><a href=#32>32</a></li><li><a href=#33>33</a></li><li><a href=#34>34</a></li><li><a href=#35>35</a></li><li><a href=#36>36</a></li><li><a href=#37>37</a></li><li><a href=#38>38</a></li><li><a href=#39>39</a></li><li><a href=#40>40</a></li></ul></nav></aside><main><h2 id=21>21</h2><p>Write a MongoDB query to find the restaurant Id, name, borough and cuisine for those restaurants which prepared dish except &lsquo;American&rsquo; and &lsquo;Chinees&rsquo; or restaurant&rsquo;s name begins with letter &lsquo;Wil&rsquo;.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=ln>1</span><span class=cl><span class=nx>db</span><span class=p>.</span><span class=nx>restaurants</span><span class=p>.</span><span class=nx>find</span><span class=p>({</span>
</span></span><span class=line><span class=ln>2</span><span class=cl>    <span class=nx>$or</span> <span class=o>:</span> <span class=p>[</span>
</span></span><span class=line><span class=ln>3</span><span class=cl>      <span class=p>{</span><span class=s2>&#34;name&#34;</span><span class=o>:</span> <span class=sr>/^Wil/</span><span class=p>},</span>
</span></span><span class=line><span class=ln>4</span><span class=cl>      <span class=p>{</span><span class=s2>&#34;cuisine&#34;</span> <span class=o>:</span> <span class=p>{</span> <span class=nx>$nin</span> <span class=o>:</span><span class=p>[</span><span class=s2>&#34;American &#34;</span><span class=p>,</span><span class=s2>&#34;Chinees&#34;</span><span class=p>]</span> <span class=p>}}</span>
</span></span><span class=line><span class=ln>5</span><span class=cl>    <span class=p>]</span>
</span></span><span class=line><span class=ln>6</span><span class=cl>  <span class=p>})</span>
</span></span></code></pre></div><p>这两个写法是一样的</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=ln> 1</span><span class=cl><span class=nx>db</span><span class=p>.</span><span class=nx>restaurants</span><span class=p>.</span><span class=nx>find</span><span class=p>(</span>
</span></span><span class=line><span class=ln> 2</span><span class=cl><span class=p>{</span><span class=nx>$or</span><span class=o>:</span> <span class=p>[</span>
</span></span><span class=line><span class=ln> 3</span><span class=cl>  <span class=p>{</span><span class=nx>name</span><span class=o>:</span> <span class=sr>/^Wil/</span><span class=p>},</span>
</span></span><span class=line><span class=ln> 4</span><span class=cl>  <span class=p>{</span><span class=s2>&#34;$and&#34;</span><span class=o>:</span> <span class=p>[</span>
</span></span><span class=line><span class=ln> 5</span><span class=cl>       <span class=p>{</span><span class=s2>&#34;cuisine&#34;</span> <span class=o>:</span> <span class=p>{</span><span class=nx>$ne</span> <span class=o>:</span><span class=s2>&#34;American &#34;</span><span class=p>}},</span>
</span></span><span class=line><span class=ln> 6</span><span class=cl>       <span class=p>{</span><span class=s2>&#34;cuisine&#34;</span> <span class=o>:</span> <span class=p>{</span><span class=nx>$ne</span> <span class=o>:</span><span class=s2>&#34;Chinees&#34;</span><span class=p>}}</span>
</span></span><span class=line><span class=ln> 7</span><span class=cl>   <span class=p>]}</span>
</span></span><span class=line><span class=ln> 8</span><span class=cl><span class=p>]}</span>
</span></span><span class=line><span class=ln> 9</span><span class=cl><span class=p>,{</span><span class=s2>&#34;restaurant_id&#34;</span> <span class=o>:</span> <span class=mi>1</span><span class=p>,</span><span class=s2>&#34;name&#34;</span><span class=o>:</span><span class=mi>1</span><span class=p>,</span><span class=s2>&#34;borough&#34;</span><span class=o>:</span><span class=mi>1</span><span class=p>,</span><span class=s2>&#34;cuisine&#34;</span> <span class=o>:</span><span class=mi>1</span><span class=p>}</span>
</span></span><span class=line><span class=ln>10</span><span class=cl><span class=p>);</span>
</span></span></code></pre></div><h2 id=22>22</h2><ol start=22><li>Write a MongoDB query to find the restaurant Id, name, and grades for those restaurants which achieved a grade of &ldquo;A&rdquo; and scored 11 on an ISODate &ldquo;2014-08-11T00:00:00Z&rdquo; among many of survey dates.</li></ol><p>达到了 grade A 且 scored 11. 首先,我们要理解这里的意思到底是什么意思?</p><p>有三个条件:</p><ul><li>时间: ISODate &ldquo;2014-08-11T00:00:00Z</li><li>分值: 11</li><li>grade: A</li></ul><p>这里的关键在于,数组<code>grades</code>其中的一条满足这3个条件.那么里这里要用到的<code>$elemMatch</code></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=ln>1</span><span class=cl><span class=nx>db</span><span class=p>.</span><span class=nx>restaurants</span><span class=p>.</span><span class=nx>find</span><span class=p>({</span>
</span></span><span class=line><span class=ln>2</span><span class=cl>    <span class=nx>grades</span><span class=o>:</span><span class=p>{</span> <span class=nx>$elemMatch</span> <span class=o>:</span> <span class=p>{</span> <span class=nx>grade</span><span class=o>:</span><span class=s1>&#39;A&#39;</span><span class=p>,</span><span class=nx>date</span><span class=o>:</span><span class=nx>ISODate</span><span class=p>(</span><span class=s2>&#34;2014-08-11T00:00:00Z&#34;</span><span class=p>),</span> <span class=nx>scored</span><span class=o>:</span> <span class=mi>11</span><span class=p>}}</span>
</span></span><span class=line><span class=ln>3</span><span class=cl>  <span class=p>})</span>
</span></span></code></pre></div><p>但是给出的答案是,理解我写在注释里</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=ln>1</span><span class=cl><span class=nx>db</span><span class=p>.</span><span class=nx>restaurants</span><span class=p>.</span><span class=nx>find</span><span class=p>(</span>
</span></span><span class=line><span class=ln>2</span><span class=cl>    <span class=p>{</span> <span class=c1>// 这里是and
</span></span></span><span class=line><span class=ln>3</span><span class=cl><span class=c1></span>      <span class=s2>&#34;grades.date&#34;</span><span class=o>:</span> <span class=nx>ISODate</span><span class=p>(</span><span class=s2>&#34;2014-08-11T00:00:00Z&#34;</span><span class=p>),</span> <span class=c1>// 这里只要有一个数组的元素成立
</span></span></span><span class=line><span class=ln>4</span><span class=cl><span class=c1></span>      <span class=s2>&#34;grades.grade&#34;</span><span class=o>:</span><span class=s2>&#34;A&#34;</span> <span class=p>,</span> <span class=c1>// 这里只要有一个数组的元素成立
</span></span></span><span class=line><span class=ln>5</span><span class=cl><span class=c1></span>      <span class=s2>&#34;grades.score&#34;</span> <span class=o>:</span> <span class=mi>11</span><span class=c1>// 这里只要有一个数组的元素成立
</span></span></span><span class=line><span class=ln>6</span><span class=cl><span class=c1></span>    <span class=p>},</span>
</span></span><span class=line><span class=ln>7</span><span class=cl>      <span class=p>{</span><span class=s2>&#34;restaurant_id&#34;</span> <span class=o>:</span> <span class=mi>1</span><span class=p>,</span><span class=s2>&#34;name&#34;</span><span class=o>:</span><span class=mi>1</span><span class=p>,</span><span class=s2>&#34;grades&#34;</span><span class=o>:</span><span class=mi>1</span><span class=p>}</span>
</span></span><span class=line><span class=ln>8</span><span class=cl>    <span class=p>);</span>
</span></span></code></pre></div><p>这里怎么用数学描述: 设集合A为<code>A = [{},{},{},{}]</code>, 满足条件<span class=katex><span class=katex-mathml><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mo>∈</mo><mi>A</mi><mo>∧</mo><mi>b</mi><mo>∈</mo><mi>A</mi><mo>∧</mo><mi>c</mi><mo>∈</mo><mi>A</mi></mrow><annotation encoding="application/x-tex">a \in A \land b \in A \land c \in A</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.5782em;vertical-align:-.0391em></span><span class="mord mathnormal">a</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>∈</span><span class=mspace style=margin-right:.2778em></span></span><span class=base><span class=strut style=height:.6833em></span><span class="mord mathnormal">A</span><span class=mspace style=margin-right:.2222em></span><span class=mbin>∧</span><span class=mspace style=margin-right:.2222em></span></span><span class=base><span class=strut style=height:.7335em;vertical-align:-.0391em></span><span class="mord mathnormal">b</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>∈</span><span class=mspace style=margin-right:.2778em></span></span><span class=base><span class=strut style=height:.6833em></span><span class="mord mathnormal">A</span><span class=mspace style=margin-right:.2222em></span><span class=mbin>∧</span><span class=mspace style=margin-right:.2222em></span></span><span class=base><span class=strut style=height:.5782em;vertical-align:-.0391em></span><span class="mord mathnormal">c</span><span class=mspace style=margin-right:.2778em></span><span class=mrel>∈</span><span class=mspace style=margin-right:.2778em></span></span><span class=base><span class=strut style=height:.6833em></span><span class="mord mathnormal">A</span></span></span></span></p><h2 id=23>23</h2><p>Write a MongoDB query to find the restaurant Id, name and grades for those restaurants where the 2nd element of grades array contains a grade of &ldquo;A&rdquo; and score 9 on an ISODate &ldquo;2014-08-11T00:00:00Z&rdquo;.</p><p>arrayElemAt（如果你需要明确选择数组中的特定元素）</p><p>如果你明确只想要查询数组的第二个元素，elemMatch 不能直接做这件事。不过，你可以结合 $arrayElemAt 来选择数组中的第二个元素进行条件匹配：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=ln>1</span><span class=cl><span class=nx>db</span><span class=p>.</span><span class=nx>collection</span><span class=p>.</span><span class=nx>find</span><span class=p>({</span>
</span></span><span class=line><span class=ln>2</span><span class=cl>  <span class=s2>&#34;$expr&#34;</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=ln>3</span><span class=cl>    <span class=s2>&#34;$eq&#34;</span><span class=o>:</span> <span class=p>[</span>
</span></span><span class=line><span class=ln>4</span><span class=cl>      <span class=p>{</span> <span class=s2>&#34;$arrayElemAt&#34;</span><span class=o>:</span> <span class=p>[</span><span class=s2>&#34;$grades&#34;</span><span class=p>,</span> <span class=mi>1</span><span class=p>]</span> <span class=p>},</span>  <span class=c1>// 获取第二个元素
</span></span></span><span class=line><span class=ln>5</span><span class=cl><span class=c1></span>      <span class=p>{</span> <span class=s2>&#34;grade&#34;</span><span class=o>:</span> <span class=s2>&#34;A&#34;</span><span class=p>,</span> <span class=s2>&#34;score&#34;</span><span class=o>:</span> <span class=mi>9</span><span class=p>,</span> <span class=s2>&#34;date&#34;</span><span class=o>:</span> <span class=nx>ISODate</span><span class=p>(</span><span class=s2>&#34;2014-08-11T00:00:00Z&#34;</span><span class=p>)</span> <span class=p>}</span>  <span class=c1>// 条件
</span></span></span><span class=line><span class=ln>6</span><span class=cl><span class=c1></span>    <span class=p>]</span>
</span></span><span class=line><span class=ln>7</span><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=ln>8</span><span class=cl><span class=p>})</span>
</span></span></code></pre></div><p>那么还是官方给的答案比较简单:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=ln>1</span><span class=cl><span class=nx>db</span><span class=p>.</span><span class=nx>restaurants</span><span class=p>.</span><span class=nx>find</span><span class=p>(</span>
</span></span><span class=line><span class=ln>2</span><span class=cl>                      <span class=p>{</span> <span class=s2>&#34;grades.1.date&#34;</span><span class=o>:</span> <span class=nx>ISODate</span><span class=p>(</span><span class=s2>&#34;2014-08-11T00:00:00Z&#34;</span><span class=p>),</span>
</span></span><span class=line><span class=ln>3</span><span class=cl>                        <span class=s2>&#34;grades.1.grade&#34;</span><span class=o>:</span><span class=s2>&#34;A&#34;</span> <span class=p>,</span>
</span></span><span class=line><span class=ln>4</span><span class=cl>                        <span class=s2>&#34;grades.1.score&#34;</span> <span class=o>:</span> <span class=mi>9</span>
</span></span><span class=line><span class=ln>5</span><span class=cl>                      <span class=p>},</span>
</span></span><span class=line><span class=ln>6</span><span class=cl>                       <span class=p>{</span><span class=s2>&#34;restaurant_id&#34;</span> <span class=o>:</span> <span class=mi>1</span><span class=p>,</span><span class=s2>&#34;name&#34;</span><span class=o>:</span><span class=mi>1</span><span class=p>,</span><span class=s2>&#34;grades&#34;</span><span class=o>:</span><span class=mi>1</span><span class=p>}</span>
</span></span><span class=line><span class=ln>7</span><span class=cl>                   <span class=p>);</span>
</span></span></code></pre></div><h2 id=24>24</h2><p>Write a MongoDB query to find the restaurant Id, name, address and geographical location for those restaurants where 2nd element of coord array contains a value which is more than 42 and upto 52.</p><p>没有争议</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=ln>1</span><span class=cl><span class=nx>db</span><span class=p>.</span><span class=nx>restaurants</span><span class=p>.</span><span class=nx>find</span><span class=p>(</span>
</span></span><span class=line><span class=ln>2</span><span class=cl>                      <span class=p>{</span>
</span></span><span class=line><span class=ln>3</span><span class=cl>                        <span class=s2>&#34;address.coord.1&#34;</span><span class=o>:</span> <span class=p>{</span><span class=nx>$gt</span> <span class=o>:</span> <span class=mi>42</span><span class=p>,</span> <span class=nx>$lte</span> <span class=o>:</span> <span class=mi>52</span><span class=p>}</span>
</span></span><span class=line><span class=ln>4</span><span class=cl>                      <span class=p>},</span>
</span></span><span class=line><span class=ln>5</span><span class=cl>                        <span class=p>{</span><span class=s2>&#34;restaurant_id&#34;</span> <span class=o>:</span> <span class=mi>1</span><span class=p>,</span><span class=s2>&#34;name&#34;</span><span class=o>:</span><span class=mi>1</span><span class=p>,</span><span class=s2>&#34;address&#34;</span><span class=o>:</span><span class=mi>1</span><span class=p>,</span><span class=s2>&#34;coord&#34;</span><span class=o>:</span><span class=mi>1</span><span class=p>}</span>
</span></span><span class=line><span class=ln>6</span><span class=cl>                   <span class=p>);</span>
</span></span></code></pre></div><h2 id=2526>25,26</h2><blockquote><ul><li>Write a MongoDB query to arrange the name of the restaurants in ascending order along with all the columns.</li><li>Write a MongoDB query to arrange the name of the restaurants in descending along with all the columns.</li></ul></blockquote><p>就是排序而已</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=ln>1</span><span class=cl><span class=nx>db</span><span class=p>.</span><span class=nx>restaurants</span><span class=p>.</span><span class=nx>find</span><span class=p>().</span><span class=nx>sort</span><span class=p>({</span><span class=s2>&#34;name&#34;</span><span class=o>:</span><span class=mi>1</span><span class=p>});</span>
</span></span><span class=line><span class=ln>2</span><span class=cl><span class=nx>db</span><span class=p>.</span><span class=nx>restaurants</span><span class=p>.</span><span class=nx>find</span><span class=p>().</span><span class=nx>sort</span><span class=p>(</span> <span class=p>{</span><span class=s2>&#34;name&#34;</span><span class=o>:-</span><span class=mi>1</span><span class=p>});</span>
</span></span></code></pre></div><h2 id=27>27</h2><blockquote><p>Write a MongoDB query to arranged the name of the cuisine in ascending order and for that same cuisine borough should be in descending order.</p></blockquote><p>还是排序,不过同时要排序两个元素</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=ln>1</span><span class=cl><span class=nx>db</span><span class=p>.</span><span class=nx>restaurants</span><span class=p>.</span><span class=nx>find</span><span class=p>().</span><span class=nx>sort</span><span class=p>(</span>
</span></span><span class=line><span class=ln>2</span><span class=cl>                           <span class=p>{</span><span class=s2>&#34;cuisine&#34;</span><span class=o>:</span><span class=mi>1</span><span class=p>,</span><span class=s2>&#34;borough&#34;</span> <span class=o>:</span> <span class=o>-</span><span class=mi>1</span><span class=p>,}</span>
</span></span><span class=line><span class=ln>3</span><span class=cl>                          <span class=p>);</span>
</span></span></code></pre></div><h2 id=28>28</h2><blockquote><p>Write a MongoDB query to know whether all the addresses contains the street or not.</p></blockquote><p>查询元素的存在性</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=ln>1</span><span class=cl><span class=nx>db</span><span class=p>.</span><span class=nx>restaurants</span><span class=p>.</span><span class=nx>find</span><span class=p>(</span> <span class=p>{</span><span class=s2>&#34;address.street&#34;</span> <span class=o>:</span> <span class=p>{</span> <span class=nx>$exists</span> <span class=o>:</span> <span class=kc>true</span> <span class=p>}</span> <span class=p>}</span> <span class=p>);</span>
</span></span></code></pre></div><h2 id=29>29</h2><blockquote><p>Write a MongoDB query which will select all documents in the restaurants collection where the coord field value is Double.</p></blockquote><p>查询元素的类型</p><p>对于 field 为数组的文档，<code>$type</code> 返回的文档中至少有一个数组元素与传递给 <code>$type</code> 的类型匹配。</p><p>对 $type: &ldquo;array&rdquo; 的查询会返回字段本身为数组的文档。</p><p><a href=https://www.mongodb.com/zh-cn/docs/manual/reference/operator/query/type/ target=_blank rel="noreferrer nofollow">$type — MongoDB 手册 v8.0</a></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=ln>1</span><span class=cl><span class=nx>db</span><span class=p>.</span><span class=nx>restaurants</span><span class=p>.</span><span class=nx>find</span><span class=p>(</span> <span class=p>{</span><span class=s2>&#34;address.coord&#34;</span> <span class=o>:</span> <span class=p>{</span><span class=nx>$type</span> <span class=o>:</span> <span class=mi>1</span><span class=p>}</span> <span class=p>});</span>
</span></span></code></pre></div><h2 id=30>30</h2><blockquote><p>Write a MongoDB query which will select the restaurant Id, name and grades for those restaurants which returns 0 as a remainder after dividing the score by 7.</p></blockquote><p>这里用到了 <a href=https://www.mongodb.com/zh-cn/docs/manual/reference/operator/query/mod/ target=_blank rel="noreferrer nofollow">$mod - MongoDB 手册 v8.0</a></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=ln>1</span><span class=cl><span class=nx>db</span><span class=p>.</span><span class=nx>restaurants</span><span class=p>.</span><span class=nx>find</span><span class=p>(</span>
</span></span><span class=line><span class=ln>2</span><span class=cl>                      <span class=p>{</span><span class=s2>&#34;grades.score&#34;</span> <span class=o>:</span>
</span></span><span class=line><span class=ln>3</span><span class=cl>                         <span class=p>{</span><span class=nx>$mod</span> <span class=o>:</span> <span class=p>[</span><span class=mi>7</span><span class=p>,</span><span class=mi>0</span><span class=p>]}</span>
</span></span><span class=line><span class=ln>4</span><span class=cl>                      <span class=p>},</span>
</span></span><span class=line><span class=ln>5</span><span class=cl>                         <span class=p>{</span><span class=s2>&#34;restaurant_id&#34;</span> <span class=o>:</span> <span class=mi>1</span><span class=p>,</span><span class=s2>&#34;name&#34;</span><span class=o>:</span><span class=mi>1</span><span class=p>,</span><span class=s2>&#34;grades&#34;</span><span class=o>:</span><span class=mi>1</span><span class=p>}</span>
</span></span><span class=line><span class=ln>6</span><span class=cl>                    <span class=p>);</span>
</span></span></code></pre></div><h2 id=31>31</h2><blockquote><p>Write a MongoDB query to find the restaurant name, borough, longitude and attitude and cuisine for those restaurants which contains &lsquo;mon&rsquo; as three letters somewhere in its name.</p></blockquote><p>正则查询</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=ln> 1</span><span class=cl><span class=nx>db</span><span class=p>.</span><span class=nx>restaurants</span><span class=p>.</span><span class=nx>find</span><span class=p>(</span>
</span></span><span class=line><span class=ln> 2</span><span class=cl>                   <span class=p>{</span> <span class=nx>name</span> <span class=o>:</span>
</span></span><span class=line><span class=ln> 3</span><span class=cl>                     <span class=p>{</span> <span class=nx>$regex</span> <span class=o>:</span> <span class=s2>&#34;mon.*&#34;</span><span class=p>,</span> <span class=nx>$options</span><span class=o>:</span> <span class=s2>&#34;i&#34;</span> <span class=p>}</span>
</span></span><span class=line><span class=ln> 4</span><span class=cl>                   <span class=p>},</span>
</span></span><span class=line><span class=ln> 5</span><span class=cl>                       <span class=p>{</span>
</span></span><span class=line><span class=ln> 6</span><span class=cl>                         <span class=s2>&#34;name&#34;</span><span class=o>:</span><span class=mi>1</span><span class=p>,</span>
</span></span><span class=line><span class=ln> 7</span><span class=cl>                         <span class=s2>&#34;borough&#34;</span><span class=o>:</span><span class=mi>1</span><span class=p>,</span>
</span></span><span class=line><span class=ln> 8</span><span class=cl>                         <span class=s2>&#34;address.coord&#34;</span><span class=o>:</span><span class=mi>1</span><span class=p>,</span>
</span></span><span class=line><span class=ln> 9</span><span class=cl>                         <span class=s2>&#34;cuisine&#34;</span> <span class=o>:</span><span class=mi>1</span>
</span></span><span class=line><span class=ln>10</span><span class=cl>                        <span class=p>}</span>
</span></span><span class=line><span class=ln>11</span><span class=cl>                   <span class=p>);</span>
</span></span></code></pre></div><h2 id=32>32</h2><blockquote><p>Write a MongoDB query to find the restaurant name, borough, longitude and latitude and cuisine for those restaurants which contain &lsquo;Mad&rsquo; as first three letters of its name.</p></blockquote><p>正则查询</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=ln> 1</span><span class=cl><span class=nx>db</span><span class=p>.</span><span class=nx>restaurants</span><span class=p>.</span><span class=nx>find</span><span class=p>(</span>
</span></span><span class=line><span class=ln> 2</span><span class=cl>                   <span class=p>{</span> <span class=nx>name</span> <span class=o>:</span>
</span></span><span class=line><span class=ln> 3</span><span class=cl>                     <span class=p>{</span> <span class=nx>$regex</span> <span class=o>:</span> <span class=sr>/^Mad/i</span><span class=p>,</span> <span class=p>}</span>
</span></span><span class=line><span class=ln> 4</span><span class=cl>                   <span class=p>},</span>
</span></span><span class=line><span class=ln> 5</span><span class=cl>                       <span class=p>{</span>
</span></span><span class=line><span class=ln> 6</span><span class=cl>                         <span class=s2>&#34;name&#34;</span><span class=o>:</span><span class=mi>1</span><span class=p>,</span>
</span></span><span class=line><span class=ln> 7</span><span class=cl>                         <span class=s2>&#34;borough&#34;</span><span class=o>:</span><span class=mi>1</span><span class=p>,</span>
</span></span><span class=line><span class=ln> 8</span><span class=cl>                         <span class=s2>&#34;address.coord&#34;</span><span class=o>:</span><span class=mi>1</span><span class=p>,</span>
</span></span><span class=line><span class=ln> 9</span><span class=cl>                         <span class=s2>&#34;cuisine&#34;</span> <span class=o>:</span><span class=mi>1</span>
</span></span><span class=line><span class=ln>10</span><span class=cl>                        <span class=p>}</span>
</span></span><span class=line><span class=ln>11</span><span class=cl>                   <span class=p>);</span>
</span></span></code></pre></div><h2 id=33>33</h2><blockquote><p>Write a MongoDB query to find the restaurants that have at least one grade with a score of less than 5.</p></blockquote><p>数组查询</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=ln>1</span><span class=cl><span class=nx>db</span><span class=p>.</span><span class=nx>restaurants</span><span class=p>.</span><span class=nx>find</span><span class=p>({</span> <span class=s2>&#34;grades.score&#34;</span><span class=o>:</span> <span class=p>{</span> <span class=nx>$lt</span><span class=o>:</span> <span class=mi>5</span> <span class=p>}</span> <span class=p>})</span>
</span></span></code></pre></div><h2 id=34>34</h2><blockquote><p>Write a MongoDB query to find the restaurants that have at least one grade with a score of less than 5 and that are located in the borough of Manhattan.</p></blockquote><p>怎么变简单了?</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=ln>1</span><span class=cl><span class=nx>db</span><span class=p>.</span><span class=nx>restaurants</span><span class=p>.</span><span class=nx>find</span><span class=p>({</span> <span class=s2>&#34;grades.score&#34;</span><span class=o>:</span> <span class=p>{</span> <span class=nx>$lt</span><span class=o>:</span> <span class=mi>5</span> <span class=p>},</span> <span class=s2>&#34;borough&#34;</span><span class=o>:</span> <span class=s2>&#34;Manhattan&#34;</span> <span class=p>})</span>
</span></span></code></pre></div><h2 id=35>35</h2><blockquote><p>Write a MongoDB query to find the restaurants that have at least one grade with a score of less than 5 and that are located in the borough of Manhattan or Brooklyn.</p></blockquote><p>还是简单</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=ln> 1</span><span class=cl><span class=nx>db</span><span class=p>.</span><span class=nx>restaurants</span><span class=p>.</span><span class=nx>find</span><span class=p>({</span>
</span></span><span class=line><span class=ln> 2</span><span class=cl>  <span class=nx>$and</span><span class=o>:</span> <span class=p>[</span>
</span></span><span class=line><span class=ln> 3</span><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=ln> 4</span><span class=cl>      <span class=nx>$or</span><span class=o>:</span> <span class=p>[</span> <span class=c1>// 可以用$in
</span></span></span><span class=line><span class=ln> 5</span><span class=cl><span class=c1></span>        <span class=p>{</span><span class=nx>borough</span><span class=o>:</span> <span class=s2>&#34;Manhattan&#34;</span><span class=p>},</span>
</span></span><span class=line><span class=ln> 6</span><span class=cl>        <span class=p>{</span><span class=nx>borough</span><span class=o>:</span> <span class=s2>&#34;Brooklyn&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=ln> 7</span><span class=cl>      <span class=p>]</span>
</span></span><span class=line><span class=ln> 8</span><span class=cl>    <span class=p>},</span>
</span></span><span class=line><span class=ln> 9</span><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=ln>10</span><span class=cl>      <span class=s2>&#34;grades.score&#34;</span><span class=o>:</span> <span class=p>{</span> <span class=nx>$lt</span><span class=o>:</span> <span class=mi>5</span> <span class=p>}</span>
</span></span><span class=line><span class=ln>11</span><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=ln>12</span><span class=cl>  <span class=p>]</span>
</span></span><span class=line><span class=ln>13</span><span class=cl><span class=p>})</span>
</span></span></code></pre></div><h2 id=36>36</h2><blockquote><p>Write a MongoDB query to find the restaurants that have at least one grade with a score of less than 5 and that are located in the borough of Manhattan or Brooklyn, and their cuisine is not American.</p></blockquote><p>官方给的这个答案,可以不用最外层的<code>$and</code></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=ln>1</span><span class=cl><span class=nx>db</span><span class=p>.</span><span class=nx>restaurants</span><span class=p>.</span><span class=nx>find</span><span class=p>({</span>
</span></span><span class=line><span class=ln>2</span><span class=cl>  <span class=nx>$and</span><span class=o>:</span> <span class=p>[</span>
</span></span><span class=line><span class=ln>3</span><span class=cl><span class=p>{</span> <span class=nx>$or</span><span class=o>:</span> <span class=p>[{</span> <span class=nx>borough</span><span class=o>:</span> <span class=s2>&#34;Manhattan&#34;</span> <span class=p>},</span> <span class=p>{</span> <span class=nx>borough</span><span class=o>:</span> <span class=s2>&#34;Brooklyn&#34;</span> <span class=p>}]</span> <span class=p>},</span>
</span></span><span class=line><span class=ln>4</span><span class=cl><span class=p>{</span> <span class=s2>&#34;grades.score&#34;</span><span class=o>:</span> <span class=p>{</span> <span class=nx>$lt</span><span class=o>:</span> <span class=mi>5</span> <span class=p>}</span> <span class=p>},</span>
</span></span><span class=line><span class=ln>5</span><span class=cl><span class=p>{</span> <span class=nx>cuisine</span><span class=o>:</span> <span class=p>{</span> <span class=nx>$ne</span><span class=o>:</span> <span class=s2>&#34;American&#34;</span> <span class=p>}</span> <span class=p>}</span>
</span></span><span class=line><span class=ln>6</span><span class=cl>  <span class=p>]</span>
</span></span><span class=line><span class=ln>7</span><span class=cl><span class=p>})</span>
</span></span></code></pre></div><h2 id=37>37</h2><blockquote><p>Write a MongoDB query to find the restaurants that have at least one grade with a score of less than 5 and that are located in the borough of Manhattan or Brooklyn, and their cuisine is not American or Chinese.</p></blockquote><p>这里用到了<code>不是...,也不是....</code>这个也语法</p><p><a href=https://www.mongodb.com/zh-cn/docs/manual/reference/operator/query/nor/ target=_blank rel="noreferrer nofollow">$nor - MongoDB 手册 v8.0</a></p><p>选择数组中所有查询谓词均未通过的文档</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=ln>1</span><span class=cl>$nor :[ expr1 ,expr2...]
</span></span></code></pre></div><p>那么查询的文档满足的条件是：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=ln>1</span><span class=cl>expr1(doc1) == false and expr2(doc2) == false
</span></span></code></pre></div><h2 id=38>38</h2><blockquote><p>Write a MongoDB query to find the restaurants that have a grade with a score of 2 and a grade with a score of 6.</p></blockquote><p>grades 含有2，和6</p><p>我写的</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=ln>1</span><span class=cl><span class=nx>db</span><span class=p>.</span><span class=nx>restaurants</span><span class=p>.</span><span class=nx>find</span><span class=p>({</span>
</span></span><span class=line><span class=ln>2</span><span class=cl>    <span class=s2>&#34;grades.score&#34;</span><span class=o>:</span> <span class=mi>2</span><span class=p>,</span>
</span></span><span class=line><span class=ln>3</span><span class=cl>    <span class=s2>&#34;grades.score&#34;</span><span class=o>:</span> <span class=mi>6</span><span class=p>,</span>
</span></span><span class=line><span class=ln>4</span><span class=cl>  <span class=p>})</span>
</span></span></code></pre></div><p>效果一样的官方答案。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=ln>1</span><span class=cl><span class=nx>db</span><span class=p>.</span><span class=nx>restaurants</span><span class=p>.</span><span class=nx>find</span><span class=p>({</span>
</span></span><span class=line><span class=ln>2</span><span class=cl>  <span class=nx>$and</span><span class=o>:</span> <span class=p>[</span>
</span></span><span class=line><span class=ln>3</span><span class=cl>    <span class=p>{</span><span class=s2>&#34;grades.score&#34;</span><span class=o>:</span> <span class=mi>2</span><span class=p>},</span>
</span></span><span class=line><span class=ln>4</span><span class=cl>    <span class=p>{</span><span class=s2>&#34;grades.score&#34;</span><span class=o>:</span> <span class=mi>6</span><span class=p>}</span>
</span></span><span class=line><span class=ln>5</span><span class=cl>  <span class=p>]</span>
</span></span><span class=line><span class=ln>6</span><span class=cl><span class=p>})</span>
</span></span></code></pre></div><h2 id=39>39</h2><blockquote><p>Write a MongoDB query to find the restaurants that have a grade with a score of 2 and a grade with a score of 6 and are located in the borough of Manhattan.</p></blockquote><p>没有什么难度</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=ln>1</span><span class=cl><span class=nx>db</span><span class=p>.</span><span class=nx>restaurants</span><span class=p>.</span><span class=nx>find</span><span class=p>({</span>
</span></span><span class=line><span class=ln>2</span><span class=cl>  <span class=nx>$and</span><span class=o>:</span> <span class=p>[</span>
</span></span><span class=line><span class=ln>3</span><span class=cl>    <span class=p>{</span><span class=s2>&#34;grades.score&#34;</span><span class=o>:</span> <span class=mi>2</span><span class=p>},</span>
</span></span><span class=line><span class=ln>4</span><span class=cl>    <span class=p>{</span><span class=s2>&#34;grades.score&#34;</span><span class=o>:</span> <span class=mi>6</span><span class=p>},</span>
</span></span><span class=line><span class=ln>5</span><span class=cl>    <span class=p>{</span><span class=s2>&#34;borough&#34;</span><span class=o>:</span> <span class=s2>&#34;Manhattan&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=ln>6</span><span class=cl>  <span class=p>]</span>
</span></span><span class=line><span class=ln>7</span><span class=cl><span class=p>})</span>
</span></span></code></pre></div><h2 id=40>40</h2><blockquote><p>Write a MongoDB query to find the restaurants that have a grade with a score of 2 and a grade with a score of 6 and are located in the borough of Manhattan or Brooklyn.</p></blockquote><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=ln>1</span><span class=cl><span class=nx>db</span><span class=p>.</span><span class=nx>restaurants</span><span class=p>.</span><span class=nx>find</span><span class=p>({</span>
</span></span><span class=line><span class=ln>2</span><span class=cl>  <span class=nx>$and</span><span class=o>:</span> <span class=p>[</span>
</span></span><span class=line><span class=ln>3</span><span class=cl>    <span class=p>{</span><span class=s2>&#34;grades.score&#34;</span><span class=o>:</span> <span class=mi>2</span><span class=p>},</span>
</span></span><span class=line><span class=ln>4</span><span class=cl>    <span class=p>{</span><span class=s2>&#34;grades.score&#34;</span><span class=o>:</span> <span class=mi>6</span><span class=p>},</span>
</span></span><span class=line><span class=ln>5</span><span class=cl>    <span class=p>{</span><span class=s2>&#34;borough&#34;</span><span class=o>:</span> <span class=p>{</span><span class=s2>&#34;$in&#34;</span><span class=o>:</span> <span class=p>[</span><span class=s2>&#34;Manhattan&#34;</span><span class=p>,</span> <span class=s2>&#34;Brooklyn&#34;</span><span class=p>]}}</span>
</span></span><span class=line><span class=ln>6</span><span class=cl>  <span class=p>]</span>
</span></span><span class=line><span class=ln>7</span><span class=cl><span class=p>})</span>
</span></span></code></pre></div></main><br><footer><script defer>document.addEventListener("keydown",function(e){if(document.activeElement.isContentEditable)return!1;if(document.activeElement.tagName=="INPUT")return!1;if(e.altKey||e.ctrlKey||e.shiftKey)return!1;var t=e.key;if(t==="h")e.preventDefault(),e.stopPropagation(),window.location.href="/";else if(t==="t")e.preventDefault(),e.stopPropagation(),window.location.href=`https://${location.hostname}/tags`;else if(t==="i"){e.preventDefault(),e.stopPropagation();const t=document.querySelectorAll("input");for(let e=0;e<t.length;e++)if(t[e].offsetParent!==null){t[e].selectionStart=t[e].selectionEnd=t[e].value.length,t[e].focus();break}}return!1})</script><script defer>function throttle(e,t){var n=Date.now();return function(){var s=Date.now();n+t-s<0&&(e(),n=s)}}function scrollHandler(){const e=Array.from(document.querySelectorAll("body h2, body h3"));function t(){for(var n,s,o,i=window.pageYOffset||document.documentElement.scrollTop,t=0;t<e.length;t++)s=e[t].getAttribute("id"),n=document.querySelector('nav ul li a[href="#'+s+'"]'),n&&n.classList.remove("active-toc");for(t=e.length-1;t>=0;t--)if(o=e[t].offsetTop,i>o-75&&(s=e[t].getAttribute("id"),n=document.querySelector('nav ul li a[href="#'+s+'"]'),n)){n.classList.add("active-toc");break}}window.addEventListener("scroll",throttle(t,200))}setTimeout(scrollHandler,100)</script><script defer>function addCopyButtonToCodeBlocks(){const e=document.querySelectorAll('code[class^="language-"]:not(.output):not([class*="language-console"])');e.forEach(e=>{const t=document.createElement("button");t.classList.add("copy-code-button"),t.innerHTML="copy",t.addEventListener("click",()=>{const s=e.querySelectorAll(".cl");let n="";s.forEach(e=>{n+=e.innerText}),navigator.clipboard.writeText(n),t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},1500)}),e.parentNode.before(t)})}setTimeout(function(){addCopyButtonToCodeBlocks()},100)</script><script defer src=/js/theme-switcher.js></script></footer></body></html>