<!doctype html><html lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=cache-control content="max-age=0"><meta http-equiv=cache-control content="no-cache"><meta http-equiv=expires content="0"><meta http-equiv=expires content="Tue, 01 Jan 1980 1:00:00 GMT"><meta http-equiv=pragma content="no-cache"><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png }><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/site.webmanifest><meta name=theme-color media="(prefers-color-scheme: light)" content="#ffffff"><meta name=theme-color media="(prefers-color-scheme: dark)" content="#1b1b1b"><meta name=description content="完美实现 Hugo 博客暗黑模式切换：从原理到实践"><script>(function(){const e=localStorage.getItem("theme")||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light");document.documentElement.setAttribute("data-theme",e)})()</script><title>完美实现 Hugo 博客暗黑模式切换：从原理到实践 | Rainboy's Blog</title><style>:root{--background:#ffffff}@media(prefers-color-scheme:dark){:root{--background:#1b1b1b}}html{background-color:var(--background)}body{background-color:var(--background)}</style><link rel=stylesheet type=text/css href=/style.min.20930b28bccdfeef9630b3bf7e743593efc6984312602656fd25572182cb9c89.css media=all><link rel=stylesheet href=/grid.css></head><body><nav><ul class=menu><li><a tabindex=-1 class=menu-link href=/><u>H</u>ome</a></li><li><a tabindex=-1 class=menu-link href=/tags><u>T</u>ags</a></li><li><span style=cursor:pointer id=theme-switcher class=menu-link type=button>🌙</span></li></ul></nav><div id=single-header><h1>完美实现 Hugo 博客暗黑模式切换：从原理到实践</h1><div id=single-meta><span class=datesub>2025-09-09</span>
<span id=tags>&nbsp;&nbsp;
<span><a href=https://hugo-dead-simple.netlify.com/tags/hugo/>#hugo</a>
</span>&nbsp; <span><a href=https://hugo-dead-simple.netlify.com/tags/web%E5%BC%80%E5%8F%91/>#web%E5%BC%80%E5%8F%91</a>
</span>&nbsp; <span><a href=https://hugo-dead-simple.netlify.com/tags/javascript/>#javascript</a>
</span>&nbsp; <span><a href=https://hugo-dead-simple.netlify.com/tags/css/>#css</a>
</span>&nbsp;</span></div></div><aside class="hidden lg:block toc" id=tableOfContentContainer><nav id=TableOfContents><ul><li><a href=#最终效果>最终效果</a></li><li><a href=#核心实现原理>核心实现原理</a></li><li><a href=#恼人的闪烁问题及解决方案>恼人的“闪烁”问题及解决方案</a></li><li><a href=#分步实现指南>分步实现指南</a><ul><li><a href=#第-1-步在-headerhtml-中添加核心脚本和切换按钮>第 1 步：在 <code>header.html</code> 中添加核心脚本和切换按钮</a></li><li><a href=#第-2-步创建处理按钮交互的-javascript>第 2 步：创建处理按钮交互的 JavaScript</a></li><li><a href=#第-3-步配置-css-颜色变量>第 3 步：配置 CSS 颜色变量</a></li></ul></li><li><a href=#总结>总结</a></li><li><a href=#data-theme-自定义属性原理>data-theme 自定义属性原理</a></li><li><a href=#代码解析>代码解析</a><ul><li><a href=#1-root--全局默认变量>1. <code>:root</code> — 全局默认变量</a></li><li><a href=#2-data-themelight--浅色主题>2. <code>[data-theme='light']</code> — 浅色主题</a></li><li><a href=#3-data-themedark--深色主题>3. <code>[data-theme='dark']</code> — 深色主题</a></li></ul></li><li><a href=#data-theme-的工作原理><code>data-theme</code> 的工作原理</a><ul><li><a href=#总结-1>总结</a></li></ul></li></ul></nav></aside><main><p>在当今的用户体验设计中，提供暗黑模式（Dark Mode）几乎已成为标配。它不仅能减少眼部疲劳，在低光环境下也更加舒适。本文将详细记录如何为一个 Hugo 网站（实际上适用于任何静态网站）添加一个功能完善、体验流畅的主题切换器。</p><p>我们将解决一个常见痛点：<strong>页面刷新时的“闪烁”问题</strong>，并最终实现一个堪称完美的解决方案。</p><h2 id=最终效果>最终效果</h2><ul><li>一个位于导航栏的按钮，用于在浅色（Light）和深色（Dark）主题间切换。</li><li>用户的选择会被浏览器记住，下次访问时自动应用。</li><li>如果用户首次访问，则会根据其操作系统的偏好自动选择主题。</li><li><strong>最重要的：页面在加载和刷新时绝不会出现恼人的颜色闪烁。</strong></li></ul><h2 id=核心实现原理>核心实现原理</h2><p>我们的主题切换功能主要依赖两大现代 Web 技术的结合：</p><ol><li><strong>CSS 自定义属性 (CSS Variables)</strong></li><li><strong>通过 JavaScript 操作 HTML 标签的 <code>data-*</code> 属性</strong></li></ol><p>基本思路是：我们在 CSS 中定义两套颜色变量，一套用于浅色主题，另一套用于深色主题。然后，通过 JavaScript 动态地在 <code>&lt;html></code> 根元素上切换一个 <code>data-theme</code> 属性（例如，<code>data-theme="light"</code> 或 <code>data-theme="dark"</code>）。CSS 会根据这个属性的值，自动应用对应的颜色变量集，从而实现整个网站的颜色切换。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-css data-lang=css><span class=line><span class=ln> 1</span><span class=cl><span class=c>/* 基础/浅色主题变量 */</span>
</span></span><span class=line><span class=ln> 2</span><span class=cl><span class=p>:</span><span class=nd>root</span> <span class=p>{</span>
</span></span><span class=line><span class=ln> 3</span><span class=cl>  <span class=nv>--background</span><span class=p>:</span> <span class=mh>#ffffff</span><span class=p>;</span>
</span></span><span class=line><span class=ln> 4</span><span class=cl>  <span class=nv>--text</span><span class=p>:</span> <span class=mh>#000000</span><span class=p>;</span>
</span></span><span class=line><span class=ln> 5</span><span class=cl>  <span class=nv>--link</span><span class=p>:</span> <span class=mh>#3366cc</span><span class=p>;</span>
</span></span><span class=line><span class=ln> 6</span><span class=cl>  <span class=c>/* ... 其他颜色变量 */</span>
</span></span><span class=line><span class=ln> 7</span><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=ln> 8</span><span class=cl>
</span></span><span class=line><span class=ln> 9</span><span class=cl><span class=c>/* 深色主题变量 */</span>
</span></span><span class=line><span class=ln>10</span><span class=cl><span class=o>[</span><span class=nt>data-theme</span><span class=o>=</span><span class=s1>&#39;dark&#39;</span><span class=o>]</span> <span class=p>{</span>
</span></span><span class=line><span class=ln>11</span><span class=cl>  <span class=nv>--background</span><span class=p>:</span> <span class=mh>#1b1b1b</span><span class=p>;</span>
</span></span><span class=line><span class=ln>12</span><span class=cl>  <span class=nv>--text</span><span class=p>:</span> <span class=mh>#d8d8d8</span><span class=p>;</span>
</span></span><span class=line><span class=ln>13</span><span class=cl>  <span class=nv>--link</span><span class=p>:</span> <span class=mh>#88a9e9</span><span class=p>;</span>
</span></span><span class=line><span class=ln>14</span><span class=cl>  <span class=c>/* ... 其他颜色变量 */</span>
</span></span><span class=line><span class=ln>15</span><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=ln>16</span><span class=cl>
</span></span><span class=line><span class=ln>17</span><span class=cl><span class=c>/* 在组件中使用变量 */</span>
</span></span><span class=line><span class=ln>18</span><span class=cl><span class=nt>body</span> <span class=p>{</span>
</span></span><span class=line><span class=ln>19</span><span class=cl>  <span class=k>background-color</span><span class=p>:</span> <span class=nf>var</span><span class=p>(</span><span class=o>--</span><span class=n>background</span><span class=p>);</span>
</span></span><span class=line><span class=ln>20</span><span class=cl>  <span class=k>color</span><span class=p>:</span> <span class=nf>var</span><span class=p>(</span><span class=o>--</span><span class=kc>text</span><span class=p>);</span>
</span></span><span class=line><span class=ln>21</span><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=ln>22</span><span class=cl>
</span></span><span class=line><span class=ln>23</span><span class=cl><span class=nt>a</span> <span class=p>{</span>
</span></span><span class=line><span class=ln>24</span><span class=cl>  <span class=k>color</span><span class=p>:</span> <span class=nf>var</span><span class=p>(</span><span class=o>--</span><span class=n>link</span><span class=p>);</span>
</span></span><span class=line><span class=ln>25</span><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>这种方法的优势在于，我们无需加载不同的 CSS 文件，只需改变一个属性，就能高效地重绘整个页面的颜色，非常灵活且性能优秀。</p><h2 id=恼人的闪烁问题及解决方案>恼人的“闪烁”问题及解决方案</h2><p>很多主题切换方案都存在一个通病：当用户选择深色模式并刷新页面时，页面会先以默认的浅色模式短暂显示，然后“闪烁”一下再变成深色。</p><p><strong>闪烁原因</strong>：这是因为负责切换主题的 JavaScript 脚本通常放在 <code>&lt;body></code> 底部加载。浏览器会先按照 CSS 的默认设置（通常是浅色主题）渲染页面，等 JS 加载并执行后，才把主题切换过来，这个过程就造成了闪烁。</p><p><strong>解决方案</strong>：答案是<strong>在浏览器渲染 <code>&lt;body></code> 之前就确定好主题</strong>。我们将一小段关键的 JavaScript 代码作为内联脚本直接放在 <code>&lt;head></code> 标签中。</p><p>这段脚本的任务非常纯粹：</p><ol><li>检查 <code>localStorage</code> 中是否有用户之前保存的主题偏好。</li><li>如果没有，则检查用户的操作系统是否偏好深色模式。</li><li>根据结果，立即在 <code>&lt;html></code> 标签上设置 <code>data-theme</code> 属性。</li></ol><p>因为这段脚本在 <code>&lt;head></code> 中，它会比页面的任何可见元素（<code>&lt;body></code> 内的内容）都先执行，从而确保了浏览器在“第一帧”渲染时就使用了正确的主题，彻底消除了闪烁。</p><h2 id=分步实现指南>分步实现指南</h2><h3 id=第-1-步在-headerhtml-中添加核心脚本和切换按钮>第 1 步：在 <code>header.html</code> 中添加核心脚本和切换按钮</h3><p>首先，我们需要将实现无闪烁切换的核心脚本和按钮添加到主题的 <code>header.html</code> 中。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=ln> 1</span><span class=cl>// filepath: layouts/partials/header.html
</span></span><span class=line><span class=ln> 2</span><span class=cl>
</span></span><span class=line><span class=ln> 3</span><span class=cl><span class=p>&lt;</span><span class=nt>head</span><span class=p>&gt;</span>
</span></span><span class=line><span class=ln> 4</span><span class=cl>    {{/* ... 其他 head 内容 ... */}}
</span></span><span class=line><span class=ln> 5</span><span class=cl>
</span></span><span class=line><span class=ln> 6</span><span class=cl>    {{/* 核心：防止闪烁的内联脚本 */}}
</span></span><span class=line><span class=ln> 7</span><span class=cl>    <span class=p>&lt;</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span><span class=line><span class=ln> 8</span><span class=cl>      <span class=c1>// 在页面加载或切换主题时，此脚本应内联在 &lt;head&gt; 中以避免 FOUC (Flash of Unstyled Content)
</span></span></span><span class=line><span class=ln> 9</span><span class=cl><span class=c1></span>      <span class=p>(</span><span class=kd>function</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=ln>10</span><span class=cl>        <span class=kr>const</span> <span class=nx>theme</span> <span class=o>=</span> <span class=nx>localStorage</span><span class=p>.</span><span class=nx>getItem</span><span class=p>(</span><span class=s1>&#39;theme&#39;</span><span class=p>)</span> <span class=o>||</span> <span class=p>(</span><span class=nb>window</span><span class=p>.</span><span class=nx>matchMedia</span><span class=p>(</span><span class=s1>&#39;(prefers-color-scheme: dark)&#39;</span><span class=p>).</span><span class=nx>matches</span> <span class=o>?</span> <span class=s1>&#39;dark&#39;</span> <span class=o>:</span> <span class=s1>&#39;light&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=ln>11</span><span class=cl>        <span class=nb>document</span><span class=p>.</span><span class=nx>documentElement</span><span class=p>.</span><span class=nx>setAttribute</span><span class=p>(</span><span class=s1>&#39;data-theme&#39;</span><span class=p>,</span> <span class=nx>theme</span><span class=p>);</span>
</span></span><span class=line><span class=ln>12</span><span class=cl>      <span class=p>})();</span>
</span></span><span class=line><span class=ln>13</span><span class=cl>    <span class=p>&lt;/</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span><span class=line><span class=ln>14</span><span class=cl>
</span></span><span class=line><span class=ln>15</span><span class=cl>    {{/* ... 其他 head 内容，如 CSS 链接等 ... */}}
</span></span><span class=line><span class=ln>16</span><span class=cl><span class=p>&lt;/</span><span class=nt>head</span><span class=p>&gt;</span>
</span></span><span class=line><span class=ln>17</span><span class=cl>
</span></span><span class=line><span class=ln>18</span><span class=cl><span class=p>&lt;</span><span class=nt>body</span><span class=p>&gt;</span>
</span></span><span class=line><span class=ln>19</span><span class=cl>    <span class=p>&lt;</span><span class=nt>nav</span><span class=p>&gt;</span>
</span></span><span class=line><span class=ln>20</span><span class=cl>      <span class=p>&lt;</span><span class=nt>ul</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;menu&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=ln>21</span><span class=cl>        {{/* ... 其他菜单项 ... */}}
</span></span><span class=line><span class=ln>22</span><span class=cl>        <span class=p>&lt;</span><span class=nt>li</span><span class=p>&gt;&lt;</span><span class=nt>a</span> <span class=na>href</span><span class=o>=</span><span class=s>&#34;/posts&#34;</span><span class=p>&gt;</span>文章<span class=p>&lt;/</span><span class=nt>a</span><span class=p>&gt;&lt;/</span><span class=nt>li</span><span class=p>&gt;</span>
</span></span><span class=line><span class=ln>23</span><span class=cl>        {{/* 主题切换按钮 */}}
</span></span><span class=line><span class=ln>24</span><span class=cl>        <span class=p>&lt;</span><span class=nt>li</span><span class=p>&gt;&lt;</span><span class=nt>button</span> <span class=na>id</span><span class=o>=</span><span class=s>&#34;theme-switcher&#34;</span> <span class=na>class</span><span class=o>=</span><span class=s>&#34;menu-link&#34;</span> <span class=na>type</span><span class=o>=</span><span class=s>&#34;button&#34;</span><span class=p>&gt;</span>🌗<span class=p>&lt;/</span><span class=nt>button</span><span class=p>&gt;&lt;/</span><span class=nt>li</span><span class=p>&gt;</span>
</span></span><span class=line><span class=ln>25</span><span class=cl>      <span class=p>&lt;/</span><span class=nt>ul</span><span class=p>&gt;</span>
</span></span><span class=line><span class=ln>26</span><span class=cl>    <span class=p>&lt;/</span><span class=nt>nav</span><span class=p>&gt;</span>
</span></span><span class=line><span class=ln>27</span><span class=cl>    {{/* ... */}}
</span></span></code></pre></div><h3 id=第-2-步创建处理按钮交互的-javascript>第 2 步：创建处理按钮交互的 JavaScript</h3><p>接下来，我们创建一个单独的 JS 文件来处理按钮的点击事件。这个脚本可以放在 <code>&lt;body></code> 底部加载，因为它不负责初始主题的设定，只负责响应用户操作。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=ln> 1</span><span class=cl><span class=c1>// filepath: static/js/theme-switcher.js
</span></span></span><span class=line><span class=ln> 2</span><span class=cl><span class=c1></span>
</span></span><span class=line><span class=ln> 3</span><span class=cl><span class=p>(</span><span class=kd>function</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=ln> 4</span><span class=cl>  <span class=kr>const</span> <span class=nx>themeSwitcher</span> <span class=o>=</span> <span class=nb>document</span><span class=p>.</span><span class=nx>getElementById</span><span class=p>(</span><span class=s1>&#39;theme-switcher&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=ln> 5</span><span class=cl>  <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=nx>themeSwitcher</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=ln> 6</span><span class=cl>    <span class=k>return</span><span class=p>;</span>
</span></span><span class=line><span class=ln> 7</span><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=ln> 8</span><span class=cl>
</span></span><span class=line><span class=ln> 9</span><span class=cl>  <span class=c1>// 页面加载时，根据当前主题设置按钮图标
</span></span></span><span class=line><span class=ln>10</span><span class=cl><span class=c1></span>  <span class=kd>let</span> <span class=nx>currentTheme</span> <span class=o>=</span> <span class=nb>document</span><span class=p>.</span><span class=nx>documentElement</span><span class=p>.</span><span class=nx>getAttribute</span><span class=p>(</span><span class=s1>&#39;data-theme&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=ln>11</span><span class=cl>  <span class=nx>themeSwitcher</span><span class=p>.</span><span class=nx>textContent</span> <span class=o>=</span> <span class=nx>currentTheme</span> <span class=o>===</span> <span class=s1>&#39;dark&#39;</span> <span class=o>?</span> <span class=s1>&#39;☀️&#39;</span> <span class=o>:</span> <span class=s1>&#39;🌗&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=ln>12</span><span class=cl>
</span></span><span class=line><span class=ln>13</span><span class=cl>  <span class=c1>// 监听按钮点击事件
</span></span></span><span class=line><span class=ln>14</span><span class=cl><span class=c1></span>  <span class=nx>themeSwitcher</span><span class=p>.</span><span class=nx>addEventListener</span><span class=p>(</span><span class=s1>&#39;click&#39;</span><span class=p>,</span> <span class=p>()</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=ln>15</span><span class=cl>    <span class=c1>// 切换主题
</span></span></span><span class=line><span class=ln>16</span><span class=cl><span class=c1></span>    <span class=nx>currentTheme</span> <span class=o>=</span> <span class=nb>document</span><span class=p>.</span><span class=nx>documentElement</span><span class=p>.</span><span class=nx>getAttribute</span><span class=p>(</span><span class=s1>&#39;data-theme&#39;</span><span class=p>)</span> <span class=o>===</span> <span class=s1>&#39;dark&#39;</span> <span class=o>?</span> <span class=s1>&#39;light&#39;</span> <span class=o>:</span> <span class=s1>&#39;dark&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=ln>17</span><span class=cl>    <span class=nb>document</span><span class=p>.</span><span class=nx>documentElement</span><span class=p>.</span><span class=nx>setAttribute</span><span class=p>(</span><span class=s1>&#39;data-theme&#39;</span><span class=p>,</span> <span class=nx>currentTheme</span><span class=p>);</span>
</span></span><span class=line><span class=ln>18</span><span class=cl>
</span></span><span class=line><span class=ln>19</span><span class=cl>    <span class=c1>// 将用户的选择存入 localStorage
</span></span></span><span class=line><span class=ln>20</span><span class=cl><span class=c1></span>    <span class=nx>localStorage</span><span class=p>.</span><span class=nx>setItem</span><span class=p>(</span><span class=s1>&#39;theme&#39;</span><span class=p>,</span> <span class=nx>currentTheme</span><span class=p>);</span>
</span></span><span class=line><span class=ln>21</span><span class=cl>
</span></span><span class=line><span class=ln>22</span><span class=cl>    <span class=c1>// 更新按钮图标
</span></span></span><span class=line><span class=ln>23</span><span class=cl><span class=c1></span>    <span class=nx>themeSwitcher</span><span class=p>.</span><span class=nx>textContent</span> <span class=o>=</span> <span class=nx>currentTheme</span> <span class=o>===</span> <span class=s1>&#39;dark&#39;</span> <span class=o>?</span> <span class=s1>&#39;☀️&#39;</span> <span class=o>:</span> <span class=s1>&#39;🌗&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=ln>24</span><span class=cl>  <span class=p>});</span>
</span></span><span class=line><span class=ln>25</span><span class=cl><span class=p>})();</span>
</span></span></code></pre></div><p>别忘了在 <code>footer_scripts.html</code> 或类似的地方引入这个脚本：
<code>&lt;script src="{{ "js/theme-switcher.js" | relURL }}">&lt;/script></code></p><h3 id=第-3-步配置-css-颜色变量>第 3 步：配置 CSS 颜色变量</h3><p>最后，也是最关键的一步，是配置好我们的 CSS 文件，让它能够响应 <code>data-theme</code> 属性的变化。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-css data-lang=css><span class=line><span class=ln> 1</span><span class=cl><span class=c>/* filepath: assets/css/main.css */</span>
</span></span><span class=line><span class=ln> 2</span><span class=cl>
</span></span><span class=line><span class=ln> 3</span><span class=cl><span class=c>/* 默认/浅色主题变量 */</span>
</span></span><span class=line><span class=ln> 4</span><span class=cl><span class=p>:</span><span class=nd>root</span> <span class=p>{</span>
</span></span><span class=line><span class=ln> 5</span><span class=cl>  <span class=nv>--background</span><span class=p>:</span> <span class=mh>#ffffff</span><span class=p>;</span>
</span></span><span class=line><span class=ln> 6</span><span class=cl>  <span class=nv>--text</span><span class=p>:</span> <span class=kc>black</span><span class=p>;</span>
</span></span><span class=line><span class=ln> 7</span><span class=cl>  <span class=nv>--link</span><span class=p>:</span> <span class=mh>#3366cc</span><span class=p>;</span>
</span></span><span class=line><span class=ln> 8</span><span class=cl>  <span class=nv>--card-background</span><span class=p>:</span> <span class=mh>#f9f9f9</span><span class=p>;</span>
</span></span><span class=line><span class=ln> 9</span><span class=cl>  <span class=c>/* ... 更多颜色 */</span>
</span></span><span class=line><span class=ln>10</span><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=ln>11</span><span class=cl>
</span></span><span class=line><span class=ln>12</span><span class=cl><span class=c>/* 当 data-theme=&#39;light&#39; 时应用的变量（可选，用于明确指定） */</span>
</span></span><span class=line><span class=ln>13</span><span class=cl><span class=o>[</span><span class=nt>data-theme</span><span class=o>=</span><span class=s1>&#39;light&#39;</span><span class=o>]</span> <span class=p>{</span>
</span></span><span class=line><span class=ln>14</span><span class=cl>  <span class=nv>--background</span><span class=p>:</span> <span class=mh>#ffffff</span><span class=p>;</span>
</span></span><span class=line><span class=ln>15</span><span class=cl>  <span class=nv>--text</span><span class=p>:</span> <span class=kc>black</span><span class=p>;</span>
</span></span><span class=line><span class=ln>16</span><span class=cl>  <span class=nv>--link</span><span class=p>:</span> <span class=mh>#3366cc</span><span class=p>;</span>
</span></span><span class=line><span class=ln>17</span><span class=cl>  <span class=nv>--card-background</span><span class=p>:</span> <span class=mh>#f9f9f9</span><span class=p>;</span>
</span></span><span class=line><span class=ln>18</span><span class=cl>  <span class=c>/* ... */</span>
</span></span><span class=line><span class=ln>19</span><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=ln>20</span><span class=cl>
</span></span><span class=line><span class=ln>21</span><span class=cl><span class=c>/* 当 data-theme=&#39;dark&#39; 时应用的变量 */</span>
</span></span><span class=line><span class=ln>22</span><span class=cl><span class=o>[</span><span class=nt>data-theme</span><span class=o>=</span><span class=s1>&#39;dark&#39;</span><span class=o>]</span> <span class=p>{</span>
</span></span><span class=line><span class=ln>23</span><span class=cl>  <span class=nv>--background</span><span class=p>:</span> <span class=mh>#1b1b1b</span><span class=p>;</span>
</span></span><span class=line><span class=ln>24</span><span class=cl>  <span class=nv>--text</span><span class=p>:</span> <span class=mh>#d8d8d8</span><span class=p>;</span>
</span></span><span class=line><span class=ln>25</span><span class=cl>  <span class=nv>--link</span><span class=p>:</span> <span class=mh>#88a9e9</span><span class=p>;</span>
</span></span><span class=line><span class=ln>26</span><span class=cl>  <span class=nv>--card-background</span><span class=p>:</span> <span class=mh>#272727</span><span class=p>;</span>
</span></span><span class=line><span class=ln>27</span><span class=cl>  <span class=c>/* ... 更多颜色 */</span>
</span></span><span class=line><span class=ln>28</span><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=ln>29</span><span class=cl>
</span></span><span class=line><span class=ln>30</span><span class=cl><span class=c>/* ... 之后的 CSS 规则全部使用 var() 来引用颜色 ... */</span>
</span></span><span class=line><span class=ln>31</span><span class=cl><span class=nt>body</span> <span class=p>{</span>
</span></span><span class=line><span class=ln>32</span><span class=cl>  <span class=k>background-color</span><span class=p>:</span> <span class=nf>var</span><span class=p>(</span><span class=o>--</span><span class=n>background</span><span class=p>);</span>
</span></span><span class=line><span class=ln>33</span><span class=cl>  <span class=k>color</span><span class=p>:</span> <span class=nf>var</span><span class=p>(</span><span class=o>--</span><span class=kc>text</span><span class=p>);</span>
</span></span><span class=line><span class=ln>34</span><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=ln>35</span><span class=cl>
</span></span><span class=line><span class=ln>36</span><span class=cl><span class=p>.</span><span class=nc>subcategory-card</span> <span class=p>{</span>
</span></span><span class=line><span class=ln>37</span><span class=cl>  <span class=k>background-color</span><span class=p>:</span> <span class=nf>var</span><span class=p>(</span><span class=o>--</span><span class=n>card</span><span class=o>-</span><span class=n>background</span><span class=p>);</span>
</span></span><span class=line><span class=ln>38</span><span class=cl><span class=p>}</span>
</span></span></code></pre></div><h2 id=总结>总结</h2><p>通过将<strong>主题决策逻辑前置到 <code>&lt;head></code></strong> 并结合 <strong>CSS 变量</strong>，我们构建了一个健壮、高效且用户体验极佳的主题切换系统。这个方案不仅解决了恼人的“闪烁”问题，其模块化的结构也使得未来的样式维护和扩展变得异常简单。希望这篇文章能对你有所帮助！</p><h2 id=data-theme-自定义属性原理>data-theme 自定义属性原理</h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-css data-lang=css><span class=line><span class=ln> 1</span><span class=cl><span class=p>:</span><span class=nd>root</span> <span class=p>{</span>
</span></span><span class=line><span class=ln> 2</span><span class=cl>  <span class=nv>--complimentary</span><span class=p>:</span> <span class=mh>#815205</span><span class=p>;</span>
</span></span><span class=line><span class=ln> 3</span><span class=cl>  <span class=nv>--text</span><span class=p>:</span> <span class=kc>black</span><span class=p>;</span>
</span></span><span class=line><span class=ln> 4</span><span class=cl>  <span class=nv>--code</span><span class=p>:</span> <span class=kc>black</span><span class=p>;</span>
</span></span><span class=line><span class=ln> 5</span><span class=cl>  <span class=nv>--accent-color</span><span class=p>:</span> <span class=mh>#00aaff</span><span class=p>;</span>
</span></span><span class=line><span class=ln> 6</span><span class=cl>  <span class=nv>--accent-color-light</span><span class=p>:</span> <span class=nb>rgba</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>170</span><span class=p>,</span> <span class=mi>255</span><span class=p>,</span> <span class=mf>0.1</span><span class=p>);</span>
</span></span><span class=line><span class=ln> 7</span><span class=cl>  <span class=nv>--card-background</span><span class=p>:</span> <span class=mh>#cccccc</span><span class=mi>5</span><span class=n>f</span><span class=p>;</span>
</span></span><span class=line><span class=ln> 8</span><span class=cl>  <span class=nv>--card-background-hover</span><span class=p>:</span> <span class=mh>#6e6b6b</span><span class=n>ff</span><span class=p>;</span>
</span></span><span class=line><span class=ln> 9</span><span class=cl>  <span class=nv>--card-text-color</span><span class=p>:</span> <span class=mh>#100101</span><span class=n>ff</span><span class=p>;</span>
</span></span><span class=line><span class=ln>10</span><span class=cl>  <span class=nv>--shadow-color</span><span class=p>:</span> <span class=nb>rgba</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mf>0.1</span><span class=p>);</span>
</span></span><span class=line><span class=ln>11</span><span class=cl>  <span class=nv>--text-dim</span><span class=p>:</span> <span class=mh>#444</span><span class=p>;</span>
</span></span><span class=line><span class=ln>12</span><span class=cl>  <span class=nv>--link</span><span class=p>:</span> <span class=mh>#3366cc</span><span class=p>;</span>
</span></span><span class=line><span class=ln>13</span><span class=cl>  <span class=nv>--link-visited</span><span class=p>:</span> <span class=mh>#795cb2</span><span class=p>;</span>
</span></span><span class=line><span class=ln>14</span><span class=cl>  <span class=nv>--code-background</span><span class=p>:</span> <span class=mh>#f3f5f7</span><span class=p>;</span>
</span></span><span class=line><span class=ln>15</span><span class=cl>  <span class=nv>--code-border</span><span class=p>:</span> <span class=mh>#eaecf0</span><span class=p>;</span>
</span></span><span class=line><span class=ln>16</span><span class=cl>  <span class=nv>--code-border</span><span class=p>:</span> <span class=kc>transparent</span><span class=p>;</span>
</span></span><span class=line><span class=ln>17</span><span class=cl>  <span class=nv>--code-hl</span><span class=p>:</span> <span class=mh>#e6e6e6</span><span class=p>;</span>
</span></span><span class=line><span class=ln>18</span><span class=cl>  <span class=nv>--border-general</span><span class=p>:</span> <span class=mh>#cccfd4</span><span class=p>;</span>
</span></span><span class=line><span class=ln>19</span><span class=cl>  <span class=nv>--table-th</span><span class=p>:</span> <span class=mh>#e1e5ea</span><span class=p>;</span>
</span></span><span class=line><span class=ln>20</span><span class=cl>  <span class=nv>--table-tr</span><span class=p>:</span> <span class=mh>#edeff2</span><span class=p>;</span>
</span></span><span class=line><span class=ln>21</span><span class=cl>  <span class=nv>--toc-background</span><span class=p>:</span> <span class=mh>#f9f9f9</span><span class=p>;</span>
</span></span><span class=line><span class=ln>22</span><span class=cl>  <span class=nv>--toc-border</span><span class=p>:</span> <span class=mh>#aaa</span><span class=p>;</span>
</span></span><span class=line><span class=ln>23</span><span class=cl>  <span class=nv>--output-background</span><span class=p>:</span> <span class=mh>#d5dbe3</span><span class=p>;</span>
</span></span><span class=line><span class=ln>24</span><span class=cl>  <span class=nv>--output-foreground</span><span class=p>:</span> <span class=mh>#805105</span><span class=p>;</span>
</span></span><span class=line><span class=ln>25</span><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=ln>26</span><span class=cl>
</span></span><span class=line><span class=ln>27</span><span class=cl><span class=o>[</span><span class=nt>data-theme</span><span class=o>=</span><span class=s1>&#39;light&#39;</span><span class=o>]</span> <span class=p>{</span>
</span></span><span class=line><span class=ln>28</span><span class=cl>  <span class=nv>--background</span><span class=p>:</span> <span class=mh>#ffffff</span><span class=p>;</span>
</span></span><span class=line><span class=ln>29</span><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=ln>30</span><span class=cl>
</span></span><span class=line><span class=ln>31</span><span class=cl><span class=o>[</span><span class=nt>data-theme</span><span class=o>=</span><span class=s1>&#39;dark&#39;</span><span class=o>]</span> <span class=p>{</span>
</span></span><span class=line><span class=ln>32</span><span class=cl>  <span class=nv>--background</span><span class=p>:</span> <span class=mh>#1b1b1b</span><span class=p>;</span>
</span></span><span class=line><span class=ln>33</span><span class=cl>  <span class=nv>--text</span><span class=p>:</span> <span class=mh>#d8d8d8</span><span class=p>;</span>
</span></span><span class=line><span class=ln>34</span><span class=cl>  <span class=nv>--code</span><span class=p>:</span> <span class=mh>#cbcbcb</span><span class=p>;</span>
</span></span><span class=line><span class=ln>35</span><span class=cl>  <span class=nv>--accent-color</span><span class=p>:</span> <span class=mh>#00aaff</span><span class=p>;</span>
</span></span><span class=line><span class=ln>36</span><span class=cl>  <span class=nv>--accent-color-light</span><span class=p>:</span> <span class=nb>rgba</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>170</span><span class=p>,</span> <span class=mi>255</span><span class=p>,</span> <span class=mf>0.2</span><span class=p>);</span>
</span></span><span class=line><span class=ln>37</span><span class=cl>  <span class=nv>--card-background</span><span class=p>:</span> <span class=mh>#272727</span><span class=p>;</span>
</span></span><span class=line><span class=ln>38</span><span class=cl>  <span class=nv>--card-background-hover</span><span class=p>:</span> <span class=mh>#444</span><span class=p>;</span>
</span></span><span class=line><span class=ln>39</span><span class=cl>  <span class=nv>--card-text-color</span><span class=p>:</span> <span class=mh>#d8d8d8</span><span class=p>;</span>
</span></span><span class=line><span class=ln>40</span><span class=cl>  <span class=nv>--shadow-color</span><span class=p>:</span> <span class=nb>rgba</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>,</span> <span class=mf>0.3</span><span class=p>);</span>
</span></span><span class=line><span class=ln>41</span><span class=cl>  <span class=nv>--text-dim</span><span class=p>:</span> <span class=mh>#a7a7a7</span><span class=p>;</span>
</span></span><span class=line><span class=ln>42</span><span class=cl>  <span class=nv>--link</span><span class=p>:</span> <span class=mh>#88a9e9</span><span class=p>;</span>
</span></span><span class=line><span class=ln>43</span><span class=cl>  <span class=nv>--link-visited</span><span class=p>:</span> <span class=mh>#a390ca</span><span class=p>;</span>
</span></span><span class=line><span class=ln>44</span><span class=cl>  <span class=nv>--code-background</span><span class=p>:</span> <span class=mh>#272727</span><span class=p>;</span>
</span></span><span class=line><span class=ln>45</span><span class=cl>  <span class=nv>--code-border</span><span class=p>:</span> <span class=kc>transparent</span><span class=p>;</span>
</span></span><span class=line><span class=ln>46</span><span class=cl>  <span class=nv>--code-hl</span><span class=p>:</span> <span class=mh>#5a5a5a</span><span class=p>;</span>
</span></span><span class=line><span class=ln>47</span><span class=cl>  <span class=nv>--border-general</span><span class=p>:</span> <span class=mh>#495057</span><span class=p>;</span>
</span></span><span class=line><span class=ln>48</span><span class=cl>  <span class=nv>--table-th</span><span class=p>:</span> <span class=mh>#414141</span><span class=p>;</span>
</span></span><span class=line><span class=ln>49</span><span class=cl>  <span class=nv>--table-tr</span><span class=p>:</span> <span class=mh>#343434</span><span class=p>;</span>
</span></span><span class=line><span class=ln>50</span><span class=cl>  <span class=nv>--toc-background</span><span class=p>:</span> <span class=mh>#343434</span><span class=p>;</span>
</span></span><span class=line><span class=ln>51</span><span class=cl>  <span class=nv>--toc-border</span><span class=p>:</span> <span class=mh>#495057</span><span class=p>;</span>
</span></span><span class=line><span class=ln>52</span><span class=cl>  <span class=nv>--output-background</span><span class=p>:</span> <span class=mh>#020202</span><span class=p>;</span>
</span></span><span class=line><span class=ln>53</span><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>向我解释上面的代码,并向我解释 <code>data-theme</code>的原理</p><p>当然，我很乐意为你解释这段代码以及 <code>data-theme</code> 的工作原理。</p><p>简单来说，这段 CSS 代码使用 <strong>CSS 变量</strong>（也叫自定义属性）和 <strong><code>data-</code> 属性</strong>来创建一套灵活的主题系统，可以轻松地在浅色模式 (light mode) 和深色模式 (dark mode) 之间切换。</p><hr><h2 id=代码解析>代码解析</h2><p>这段代码主要分为三个部分：</p><h3 id=1-root--全局默认变量>1. <code>:root</code> — 全局默认变量</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-css data-lang=css><span class=line><span class=ln>1</span><span class=cl><span class=p>:</span><span class=nd>root</span> <span class=p>{</span>
</span></span><span class=line><span class=ln>2</span><span class=cl>  <span class=nv>--complimentary</span><span class=p>:</span> <span class=mh>#815205</span><span class=p>;</span>
</span></span><span class=line><span class=ln>3</span><span class=cl>  <span class=nv>--text</span><span class=p>:</span> <span class=kc>black</span><span class=p>;</span>
</span></span><span class=line><span class=ln>4</span><span class=cl>  <span class=c>/* ... 其他变量 ... */</span>
</span></span><span class=line><span class=ln>5</span><span class=cl><span class=p>}</span>
</span></span></code></pre></div><ul><li><strong><code>:root</code> 选择器</strong>：这个选择器指向文档的根元素，在 HTML 中就是 <code>&lt;html></code> 标签。在这里定义的变量是<strong>全局的</strong>，可以在整个页面的任何地方使用。</li><li><strong>CSS 变量 (Custom Properties)</strong>：以 <code>--</code> 开头的都是 CSS 变量。你可以把它们看作是值的“占位符”。例如，<code>--text: black;</code> 定义了一个名为 <code>text</code> 的变量，它的值是黑色。</li><li><strong>作用</strong>：这个部分定义了网站的<strong>默认主题</strong>，或者说是“基础”颜色。当没有指定特定主题时，网站就会使用这些颜色。</li></ul><h3 id=2-data-themelight--浅色主题>2. <code>[data-theme='light']</code> — 浅色主题</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-css data-lang=css><span class=line><span class=ln>1</span><span class=cl><span class=o>[</span><span class=nt>data-theme</span><span class=o>=</span><span class=s1>&#39;light&#39;</span><span class=o>]</span> <span class=p>{</span>
</span></span><span class=line><span class=ln>2</span><span class=cl>  <span class=nv>--background</span><span class=p>:</span> <span class=mh>#ffffff</span><span class=p>;</span>
</span></span><span class=line><span class=ln>3</span><span class=cl><span class=p>}</span>
</span></span></code></pre></div><ul><li><strong><code>[data-theme='light']</code></strong>：这是一个<strong>属性选择器</strong>。它的意思是：“选择任何带有 <code>data-theme</code> 属性并且该属性的值为 <code>light</code> 的元素”。</li><li><strong>作用</strong>：当 <code>&lt;html></code> 或 <code>&lt;body></code> 标签被设置为 <code>&lt;html data-theme="light"></code> 时，这个规则就会生效。它定义了浅色主题下的特定变量。在这里，它只定义了 <code>--background</code> 为白色 (<code>#ffffff</code>)。其他没有被重新定义的变量（如 <code>--text</code>）会继续使用 <code>:root</code> 中的默认值。</li></ul><h3 id=3-data-themedark--深色主题>3. <code>[data-theme='dark']</code> — 深色主题</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-css data-lang=css><span class=line><span class=ln>1</span><span class=cl><span class=o>[</span><span class=nt>data-theme</span><span class=o>=</span><span class=s1>&#39;dark&#39;</span><span class=o>]</span> <span class=p>{</span>
</span></span><span class=line><span class=ln>2</span><span class=cl>  <span class=nv>--background</span><span class=p>:</span> <span class=mh>#1b1b1b</span><span class=p>;</span>
</span></span><span class=line><span class=ln>3</span><span class=cl>  <span class=nv>--text</span><span class=p>:</span> <span class=mh>#d8d8d8</span><span class=p>;</span>
</span></span><span class=line><span class=ln>4</span><span class=cl>  <span class=c>/* ... 其他变量 ... */</span>
</span></span><span class=line><span class=ln>5</span><span class=cl><span class=p>}</span>
</span></span></code></pre></div><ul><li><strong><code>[data-theme='dark']</code></strong>：与上面类似，这个属性选择器会匹配 <code>&lt;html data-theme="dark"></code> 这样的元素。</li><li><strong>作用</strong>：当网站切换到深色模式时，这个规则会生效。它会<strong>覆盖</strong> <code>:root</code> 中定义的许多变量，将它们替换为适合在深色背景下显示的颜色值（例如，背景变为深灰色，文字变为浅灰色）。</li></ul><hr><h2 id=data-theme-的工作原理><code>data-theme</code> 的工作原理</h2><p><code>data-theme</code> 是一个<strong>自定义数据属性 (Custom Data Attribute)</strong>。这是 HTML5 的一个很棒的功能，允许你将自定义的数据存储在 HTML 元素上，而不会影响其样式和行为。</p><p>它的工作原理就像一个<strong>状态开关</strong> 🚦，具体步骤如下：</p><ol><li><p><strong>定义样式</strong>：就像你上面提供的 CSS 代码一样，我们为不同的 <code>data-theme</code> 值（如 <code>light</code> 和 <code>dark</code>）定义不同的 CSS 变量。</p></li><li><p><strong>设置初始状态</strong>：在 HTML 的根元素（通常是 <code>&lt;html></code>）上设置一个初始主题。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=ln>1</span><span class=cl><span class=p>&lt;</span><span class=nt>html</span> <span class=na>data-theme</span><span class=o>=</span><span class=s>&#34;light&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=ln>2</span><span class=cl>  <span class=p>&lt;/</span><span class=nt>html</span><span class=p>&gt;</span>
</span></span></code></pre></div><p>当页面加载时，浏览器看到 <code>data-theme="light"</code>，于是 <code>[data-theme='light']</code> 的 CSS 规则被应用，页面显示为浅色主题。</p></li><li><p><strong>使用变量</strong>：在你的其他 CSS 文件中，你不会直接使用颜色代码，而是使用 <code>var()</code> 函数来调用这些变量。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-css data-lang=css><span class=line><span class=ln>1</span><span class=cl><span class=nt>body</span> <span class=p>{</span>
</span></span><span class=line><span class=ln>2</span><span class=cl>  <span class=k>background-color</span><span class=p>:</span> <span class=nf>var</span><span class=p>(</span><span class=o>--</span><span class=n>background</span><span class=p>);</span> <span class=c>/* 使用 --background 变量 */</span>
</span></span><span class=line><span class=ln>3</span><span class=cl>  <span class=k>color</span><span class=p>:</span> <span class=nf>var</span><span class=p>(</span><span class=o>--</span><span class=kc>text</span><span class=p>);</span> <span class=c>/* 使用 --text 变量 */</span>
</span></span><span class=line><span class=ln>4</span><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=ln>5</span><span class=cl>
</span></span><span class=line><span class=ln>6</span><span class=cl><span class=nt>a</span> <span class=p>{</span>
</span></span><span class=line><span class=ln>7</span><span class=cl>  <span class=k>color</span><span class=p>:</span> <span class=nf>var</span><span class=p>(</span><span class=o>--</span><span class=n>link</span><span class=p>);</span> <span class=c>/* 使用 --link 变量 */</span>
</span></span><span class=line><span class=ln>8</span><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>这样做的好处是，你只需要改变变量的值，所有使用该变量的元素的样式都会自动更新。</p></li><li><p><strong>用 JavaScript 切换主题</strong>：当用户点击一个“切换主题”按钮时，你会用 JavaScript 来改变 <code>&lt;html></code> 标签上 <code>data-theme</code> 属性的值。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=ln>1</span><span class=cl><span class=c1>// 获取 &lt;html&gt; 元素
</span></span></span><span class=line><span class=ln>2</span><span class=cl><span class=c1></span><span class=kr>const</span> <span class=nx>htmlElement</span> <span class=o>=</span> <span class=nb>document</span><span class=p>.</span><span class=nx>documentElement</span><span class=p>;</span>
</span></span><span class=line><span class=ln>3</span><span class=cl>
</span></span><span class=line><span class=ln>4</span><span class=cl><span class=c1>// 假设当前是 &#39;light&#39;，我们要切换到 &#39;dark&#39;
</span></span></span><span class=line><span class=ln>5</span><span class=cl><span class=c1></span><span class=nx>htmlElement</span><span class=p>.</span><span class=nx>setAttribute</span><span class=p>(</span><span class=s1>&#39;data-theme&#39;</span><span class=p>,</span> <span class=s1>&#39;dark&#39;</span><span class=p>);</span>
</span></span></code></pre></div></li></ol><p><strong>切换瞬间发生了什么？</strong></p><p>当 JavaScript 将 <code>data-theme</code> 的值从 <code>'light'</code> 改为 <code>'dark'</code> 时，浏览器会立即重新计算样式：</p><ul><li>之前匹配的 CSS 规则 <code>[data-theme='light']</code> <strong>不再生效</strong>。</li><li>新的 CSS 规则 <code>[data-theme='dark']</code> <strong>开始生效</strong>。</li><li>所有 CSS 变量（<code>--background</code>, <code>--text</code> 等）的值被立刻更新为深色主题的值。</li><li>所有使用了 <code>var()</code> 函数的元素（比如 <code>body</code>）的样式都会<strong>自动重新渲染</strong>，页面瞬间就从浅色模式变成了深色模式，无需刷新页面。</li></ul><h3 id=总结-1>总结</h3><p>总而言之，这种方法通过 <strong>CSS 变量</strong>将设计系统的颜色集中管理，然后利用 <strong><code>data-theme</code> 属性</strong>作为开关，最后通过 <strong>JavaScript</strong> 来“拨动”这个开关，从而实现了一种非常现代化、高效且易于维护的网站主题切换方案。</p></main><br><footer><script defer>document.addEventListener("keydown",function(e){if(document.activeElement.isContentEditable)return!1;if(document.activeElement.tagName=="INPUT")return!1;if(e.altKey||e.ctrlKey||e.shiftKey)return!1;var t=e.key;if(t==="h")e.preventDefault(),e.stopPropagation(),window.location.href="/";else if(t==="t")e.preventDefault(),e.stopPropagation(),window.location.href=`https://${location.hostname}/tags`;else if(t==="i"){e.preventDefault(),e.stopPropagation();const t=document.querySelectorAll("input");for(let e=0;e<t.length;e++)if(t[e].offsetParent!==null){t[e].selectionStart=t[e].selectionEnd=t[e].value.length,t[e].focus();break}}return!1})</script><script defer>function throttle(e,t){var n=Date.now();return function(){var s=Date.now();n+t-s<0&&(e(),n=s)}}function scrollHandler(){const e=Array.from(document.querySelectorAll("body h2, body h3"));function t(){for(var n,s,o,i=window.pageYOffset||document.documentElement.scrollTop,t=0;t<e.length;t++)s=e[t].getAttribute("id"),n=document.querySelector('nav ul li a[href="#'+s+'"]'),n&&n.classList.remove("active-toc");for(t=e.length-1;t>=0;t--)if(o=e[t].offsetTop,i>o-75&&(s=e[t].getAttribute("id"),n=document.querySelector('nav ul li a[href="#'+s+'"]'),n)){n.classList.add("active-toc");break}}window.addEventListener("scroll",throttle(t,200))}setTimeout(scrollHandler,100)</script><script defer>function addCopyButtonToCodeBlocks(){const e=document.querySelectorAll('code[class^="language-"]:not(.output):not([class*="language-console"])');e.forEach(e=>{const t=document.createElement("button");t.classList.add("copy-code-button"),t.innerHTML="copy",t.addEventListener("click",()=>{const s=e.querySelectorAll(".cl");let n="";s.forEach(e=>{n+=e.innerText}),navigator.clipboard.writeText(n),t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},1500)}),e.parentNode.before(t)})}setTimeout(function(){addCopyButtonToCodeBlocks()},100)</script><script defer src=/js/theme-switcher.js></script></footer></body></html>