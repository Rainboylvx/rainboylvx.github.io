<!doctype html><html lang=zh-cn><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=cache-control content="max-age=0"><meta http-equiv=cache-control content="no-cache"><meta http-equiv=expires content="0"><meta http-equiv=expires content="Tue, 01 Jan 1980 1:00:00 GMT"><meta http-equiv=pragma content="no-cache"><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png }><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/site.webmanifest><meta name=theme-color media="(prefers-color-scheme: light)" content="#ffffff"><meta name=theme-color media="(prefers-color-scheme: dark)" content="#1b1b1b"><meta name=description content="Search Results"><script>(function(){const e=localStorage.getItem("theme")||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light");document.documentElement.setAttribute("data-theme",e)})()</script><title>Search Results | Rainboy's Blog</title><style>:root{--background:#ffffff}@media(prefers-color-scheme:dark){:root{--background:#1b1b1b}}html{background-color:var(--background)}body{background-color:var(--background)}</style><link rel=stylesheet type=text/css href=/style.min.4de9e3236bcb55312d0b2ff0fc62c694f607b9c0d95d0621f6c6dbacb7d6dbb5.css media=all><link rel=stylesheet href=/grid.css><link href="https://fonts.font.im/css?family=Roboto+Mono" rel=stylesheet><style>body,.heti,.heti--sans{font-family:roboto mono,monospace,times new roman,times,heti song,serif,apple color emoji,segoe ui emoji,segoe ui symbol}</style></head><body><nav><ul class=menu><li><a tabindex=-1 class=menu-link href=/><u>H</u>ome</a></li><li><a tabindex=-1 class=menu-link href=/tags><u>T</u>ags</a></li><li><span style=cursor:pointer id=theme-switcher class=menu-link type=button><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-moon h-4 w-4"><path d="M12 3a6 6 0 009 9 9 9 0 11-9-9z"/></svg></span></li></ul></nav><main id=main class=post><header><h1 id=search-title>Search Results</h1></header><form id=search-form action=/search method=get><label hidden for=search-input>Search site</label>
<input tabindex=-1 type=text id=search-input name=query placeholder="search [i] ..."></form><ul id=search-results></ul></main><script>window.store={"https://hugo-dead-simple.netlify.com/nvim-for-oi/index.html":{title:"nvim-for-oi",tags:[],content:"å†…å®¹ æ¦‚è¿° buffline lsp clangd clangd Snacks æºç è§£è¯» æ¦‚è¿° ",url:"https://hugo-dead-simple.netlify.com/nvim-for-oi/index.html"},"https://hugo-dead-simple.netlify.com/nvim-for-oi/snacks%E6%BA%90%E7%A0%81%E8%A7%A3%E8%AF%BB.html":{title:"snacksæºç è§£è¯»",tags:[""],content:"èµ·å›  å‘ç°äº†ä¸€ä¸ªæ’ä»¶ https://github.com/folke/snacks.nvim å‘ç°éå¸¸é€‚åˆæˆ‘,ä½†æ˜¯åœ¨é…ç½®çš„è¿‡ç¨‹ä¸­,æˆ‘å‘ç°éœ€è¦ç†è§£å¹¶é˜…è¯»å®ƒçš„æºä»£ç ,åŒæ—¶æˆ‘ä¹Ÿæƒ³çŸ¥é“å¦‚ä½•ä½¿ç”¨luaè¯­è¨€å†™neovimçš„æ’ä»¶.\nå‡†å¤‡ æ ¹æ® nvim-doc NVIM_APPNAME,æˆ‘ä»¬å¯ä»¥é…ç½®å‡ºä¸€ä¸ªå•ç‹¬çš„ä¸“é—¨ä½¿ç”¨çš„é…ç½®,å’Œæˆ‘ä»¬çš„ä¸»nvim é…ç½®,è¿›è¡Œåˆ†ç¦»\n1# 1. åˆ›å»ºä¸€ä¸ªç”¨äºå­¦ä¹ çš„æ ¹ç›®å½• (å¯ä»¥æ”¾åœ¨ä»»ä½•ä½ å–œæ¬¢çš„åœ°æ–¹) 2configPath=&#34;~/.config/snacks-learn&#34; 3mkdir -p $configPath 4 5# 2. åˆ›å»º lazy.vim éœ€è¦çš„é…ç½®ã€æ•°æ®å’ŒçŠ¶æ€ç›®å½• 6mkdir -p $configPath/config/nvim 7mkdir -p $configPath/data 8mkdir -p $configPath/state 9mkdir -p $configPath/cache 10 11# 3. æŠŠä½ çš„ snacks.nvim æ’ä»¶å…‹éš†åˆ°è¿™ä¸ªç›®å½•ä¸­ (æ–¹ä¾¿ç®¡ç†) 12git clone https://github.com/folke/snacks.nvim.git $configPath/snacks.nvim 1# åœ¨.zshrc ä¸­æ·»åŠ  2# å‘Šè¯‰ Neovim ä½¿ç”¨ &#39;snacks-learn&#39; ä½œä¸ºé…ç½®å 3# å®ƒä¼šè‡ªåŠ¨æŸ¥æ‰¾ $HOME/.config/snacks-learn/init.lua 4NVIM_APPNAME=snacks-learn nvim 1-- ~/.config/snacks-learn/init.lua 2 3-- ============================================================================= 4-- 1. è®¾ç½® Neovim çš„æ•°æ®ã€é…ç½®ã€çŠ¶æ€ç­‰è·¯å¾„ 5-- ä½¿å…¶å®Œå…¨éš”ç¦»åœ¨æˆ‘ä»¬çš„ ~/snacks-learn ç›®å½•ä¸­ 6-- ============================================================================= 7-- æ³¨æ„ï¼šæˆ‘ä»¬å°†åœ¨å¯åŠ¨ nvim æ—¶ä½¿ç”¨ NVIM_APP_NAME=snacks-learn ç¯å¢ƒå˜é‡, 8-- Neovim ä¼šè‡ªåŠ¨å°† stdpath(&#39;config&#39;) æŒ‡å‘ ~/snacks-learn/config/nvim 9-- æˆ‘ä»¬éœ€è¦æ‰‹åŠ¨è®¾ç½®å…¶ä»–è·¯å¾„ï¼Œä»¥ç¡®ä¿å®Œå…¨éš”ç¦» 10 11local path = vim.fn.stdpath(&#34;config&#34;) 12vim.env.XDG_DATA_HOME = path .. &#34;/data&#34; 13vim.env.XDG_STATE_HOME = path .. &#34;/state&#34; 14vim.env.XDG_CACHE_HOME = path .. &#34;/cache&#34; 15 16-- ============================================================================= 17-- 2. åŸºæœ¬çš„ Neovim è®¾ç½® (QoL) 18-- ============================================================================= 19vim.opt.number = true -- æ˜¾ç¤ºè¡Œå· 20vim.opt.relativenumber = true -- æ˜¾ç¤ºç›¸å¯¹è¡Œå· 21vim.opt.termguicolors = true -- å¯ç”¨çœŸå½©è‰² 22vim.opt.mouse = &#34;a&#34; -- å¯ç”¨é¼ æ ‡ 23vim.opt.clipboard = &#34;unnamedplus&#34; -- ä½¿ç”¨ç³»ç»Ÿå‰ªè´´æ¿ 24vim.opt.swapfile = false -- å…³é—­äº¤æ¢æ–‡ä»¶ 25vim.opt.backup = false -- å…³é—­å¤‡ä»½ 26vim.opt.writebackup = false 27 28-- ============================================================================= 29-- 3. lazy.vim æ’ä»¶ç®¡ç†å™¨ - å¼•å¯¼ç¨‹åº 30-- ============================================================================= 31-- local lazypath = vim.fn.stdpath(&#34;data&#34;) .. &#34;/lazy/lazy.nvim&#34; 32 33-- è¿™é‡Œæ²¡ç”¨ä½¿ç”¨stdpath(&#34;data&#34;) è€Œæ˜¯ä½¿ç”¨äº†stdpath(&#34;config&#34;),æ–¹ä¾¿æˆ‘ä»¬æŸ¥çœ‹ 34local lazypath = vim.fn.stdpath(&#34;config&#34;) .. &#34;/lazy/lazy.nvim&#34; 35if not vim.loop.fs_stat(lazypath) then 36 print(&#34;æ­£åœ¨å…‹éš† lazy.nvim...&#34;) 37 vim.fn.system({ 38 &#34;git&#34;, 39 &#34;clone&#34;, 40 &#34;--filter=blob:none&#34;, 41 &#34;https://gh-proxy.com/https://github.com/folke/lazy.nvim.git&#34;, 42 &#34;--branch=stable&#34;, -- latest stable release 43 lazypath, 44 }) 45end 46vim.opt.rtp:prepend(lazypath) 47 48-- ============================================================================= 49-- 4. lazy.vim æ’ä»¶è®¾ç½® 50-- ============================================================================= 51require(&#34;lazy&#34;).setup({ 52 -- è¿™æ˜¯æˆ‘ä»¬è¦å­¦ä¹ çš„æ’ä»¶ï¼šsnacks.nvim 53 { 54 -- æ ¸å¿ƒï¼šä½¿ç”¨ `dir` å…³é”®å­—æŒ‡å‘ä½ æœ¬åœ°å…‹éš†çš„è·¯å¾„ 55 -- !! ä½ éœ€è¦ä¿®æ”¹è¿™ä¸ªè·¯å¾„ä¸ºä½ å…‹éš† `snacks.nvim` çš„å®é™…è·¯å¾„ !! 56 dir = os.getenv(&#34;HOME&#34;) .. &#34;/.config/snacks-learn/snacks.nvim&#34;, 57 58 -- `name` æ˜¯å¯é€‰çš„ï¼Œä½†å½“ä½¿ç”¨ `dir` æ—¶ï¼Œå®ƒæœ‰åŠ©äº lazy.nvim è¯†åˆ«æ’ä»¶ 59 name = &#34;snacks.nvim&#34;, 60 61 -- snacks.nvim çš„ä¾èµ–é¡¹ 62 -- lazy.nvim ä¼šè‡ªåŠ¨ä» GitHub ä¸‹è½½è¿™äº›ä¾èµ– 63 dependencies = { 64 &#34;nvim-tree/nvim-web-devicons&#34;, -- (å¯é€‰) ç”¨äºæ˜¾ç¤ºå›¾æ ‡ 65 &#34;rcarriga/nvim-notify&#34;, -- (å¯é€‰) ç”¨äºæ˜¾ç¤ºé€šçŸ¥ 66 }, 67 68 -- `opts` è¡¨æ ¼ç”¨äºé…ç½® snacks.nvim 69 -- ä½ å¯ä»¥åœ¨è¿™é‡Œæ‰“å¼€/å…³é—­/é…ç½® snacks çš„å„ä¸ªæ¨¡å— 70 opts = { 71 -- æ¨¡å—ç™½åå•ï¼ŒåªåŠ è½½ä½ æ„Ÿå…´è¶£çš„ 72 -- ç•™ç©º (opts = {}) æ¥åŠ è½½æ‰€æœ‰æ¨¡å— 73 modules = { 74 &#34;cursor&#34;, -- é«˜äº®å…‰æ ‡æ‰€åœ¨è¡Œ 75 &#34;indent&#34;, -- ç¼©è¿›çº¿ 76 &#34;navic&#34;, -- (éœ€è¦ nvim-navic æ’ä»¶) 77 &#34;notify&#34;, -- (éœ€è¦ nvim-notify æ’ä»¶) 78 &#34;regex&#34;, -- æ­£åˆ™è¡¨è¾¾å¼é¢„è§ˆ 79 &#34;scrollbar&#34;, -- æ»šåŠ¨æ¡ 80 &#34;search&#34;, -- æœç´¢é«˜äº® 81 }, 82 83 -- ================== 84 -- æ¨¡å—çš„å…·ä½“é…ç½®ç¤ºä¾‹ 85 -- ================== 86 87 -- å¯ç”¨æ»šåŠ¨æ¡ 88 scrollbar = { 89 enabled = true, 90 }, 91 92 -- å¯ç”¨ç¼©è¿›çº¿ 93 indent = { 94 enabled = true, 95 -- ä½ å¯ä»¥å°è¯• &#34;conveal&#34; æˆ– &#34;list&#34; ç­–ç•¥ 96 -- strategy = &#34;conceal&#34;, 97 }, 98 99 -- å¯ç”¨å…‰æ ‡è¡Œé«˜äº® 100 cursor = { 101 enabled = true, 102 }, 103 }, 104 105 -- `config` å‡½æ•°ä¼šåœ¨æ’ä»¶åŠ è½½åè¿è¡Œ 106 -- `snacks.nvim` ä¼šè‡ªåŠ¨è°ƒç”¨ `setup(opts)`ï¼Œæ‰€ä»¥è¿™é‡Œé€šå¸¸æ˜¯ç©ºçš„ 107 -- ä½†ä½ å¯ä»¥ç”¨å®ƒæ¥æ·»åŠ é¢å¤–çš„é”®ä½ç»‘å®šç­‰ 108 config = function(_, opts) 109 require(&#34;snacks&#34;).setup(opts) 110 111 -- ç¤ºä¾‹ï¼šæ·»åŠ ä¸€ä¸ªé”®ä½ç»‘å®šæ¥åˆ‡æ¢ç¼©è¿›çº¿ 112 vim.keymap.set(&#34;n&#34;, &#34;&lt;leader&gt;ti&#34;, function() 113 local indent = require(&#34;snacks.indent&#34;) 114 indent.toggle() 115 print(&#34;ç¼©è¿›çº¿: &#34; .. (indent.is_enabled() and &#34;ON&#34; or &#34;OFF&#34;)) 116 end, { desc = &#34;[T]oggle [I]ndent guides (Snacks)&#34; }) 117 end, 118 }, 119 120 -- snacks.nvim çš„ä¾èµ–é¡¹ (lazy.nvim ä¼šè‡ªåŠ¨å¤„ç†) 121 -- æˆ‘ä»¬ä¸éœ€è¦åœ¨è¿™é‡Œå†æ¬¡åˆ—å‡º &#34;nvim-tree/nvim-web-devicons&#34; å’Œ &#34;rcarriga/nvim-notify&#34; 122 -- å› ä¸ºå®ƒä»¬å·²ç»åœ¨ snacks.nvim çš„ `dependencies` ä¸­äº†ã€‚ 123 124 -- (å¯é€‰) æ·»åŠ ä¸€ä¸ªä¸»é¢˜ï¼Œè®©ç•Œé¢æ›´å¥½çœ‹ 125 { &#34;folke/tokyonight.nvim&#34; }, 126 127}) ",url:"https://hugo-dead-simple.netlify.com/nvim-for-oi/snacks%E6%BA%90%E7%A0%81%E8%A7%A3%E8%AF%BB.html"},"https://hugo-dead-simple.netlify.com/program_language/index.html":{title:"Program_languages",tags:[],content:"",url:"https://hugo-dead-simple.netlify.com/program_language/index.html"},"https://hugo-dead-simple.netlify.com/program_language/lua/lua%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E5%9F%BA%E7%A1%80.html":{title:"å…ƒè¡¨åŠå…ƒæ–¹æ³•",tags:[""],content:`å…ƒè¡¨æ¦‚å¿µ Lua ä¸­çš„æ¯ä¸ªå€¼éƒ½å¯ä»¥æœ‰ä¸€ä¸ªå…ƒè¡¨ã€‚æ­¤å…ƒè¡¨æ˜¯ä¸€ä¸ªæ™®é€šçš„ Lua è¡¨ï¼Œå®ƒå®šä¹‰äº†åŸå§‹å€¼åœ¨ç‰¹å®šäº‹ä»¶ä¸‹çš„è¡Œä¸ºã€‚æ‚¨å¯ä»¥é€šè¿‡è®¾ç½®å…¶å…ƒè¡¨ä¸­çš„ç‰¹å®šå­—æ®µæ¥æ›´æ”¹å€¼çš„å¤šä¸ªè¡Œä¸ºæ–¹é¢ã€‚ä¾‹å¦‚ï¼Œå½“éæ•°å­—å€¼æ˜¯åŠ æ³•çš„æ“ä½œæ•°æ—¶ï¼ŒLua ä¼šåœ¨è¯¥å€¼çš„å…ƒè¡¨çš„ __add å­—æ®µä¸­æŸ¥æ‰¾ä¸€ä¸ªå‡½æ•°ã€‚å¦‚æœæ‰¾åˆ°ä¸€ä¸ªï¼ŒLua ä¼šè°ƒç”¨æ­¤å‡½æ•°æ¥æ‰§è¡ŒåŠ æ³•
è¯¦ç»†å‚è§ 2.4 â€“ å…ƒè¡¨åŠå…ƒæ–¹æ³•
ä¸¾ä¸€ä¸ªä¾‹å­,ç±»ä¼¼äº c++çš„è¿ç®—ç¬¦é‡è½½,è¿™é‡Œæˆ‘ä»¬é‡è½½+
1foo = {a = 1} 2print(foo.a) 3 4smt = { 5 __add = function(a,b) 6 return a.a + b; 7 end 8} 9 10-- è®¾å®š foo çš„å…ƒè¡¨, 11-- å½“ä½ å¯¹éæ•°å­—å€¼åšåŠ æ“ä½œæ—¶ï¼Œ Lua ä¼šæ£€æŸ¥è¯¥å€¼çš„å…ƒè¡¨ä¸­çš„ &#34;__add&#34; åŸŸä¸‹çš„å‡½æ•° 12setmetatable(foo, smt) 13 14b = foo + 1 15print(string.format(&#34;foo + 1 = %d&#34;, b)) __index __index: ç´¢å¼• table[key]ã€‚ å½“ table ä¸æ˜¯è¡¨æˆ–æ˜¯è¡¨ table ä¸­ä¸å­˜åœ¨ key è¿™ä¸ªé”®æ—¶ï¼Œè¿™ä¸ªäº‹ä»¶è¢«è§¦å‘ã€‚ æ­¤æ—¶ï¼Œä¼šè¯»å‡º table ç›¸åº”çš„å…ƒæ–¹æ³•ã€‚ å°½ç®¡åå­—å–æˆè¿™æ ·ï¼Œ è¿™ä¸ªäº‹ä»¶çš„å…ƒæ–¹æ³•å…¶å®å¯ä»¥æ˜¯ä¸€ä¸ªå‡½æ•°ä¹Ÿå¯ä»¥æ˜¯ä¸€å¼ è¡¨ã€‚ å¦‚æœå®ƒæ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œåˆ™ä»¥ table å’Œ key ä½œä¸ºå‚æ•°è°ƒç”¨å®ƒã€‚ å¦‚æœå®ƒæ˜¯ä¸€å¼ è¡¨ï¼Œæœ€ç»ˆçš„ç»“æœå°±æ˜¯ä»¥ key å–ç´¢å¼•è¿™å¼ è¡¨çš„ç»“æœã€‚ ï¼ˆè¿™ä¸ªç´¢å¼•è¿‡ç¨‹æ˜¯èµ°å¸¸è§„çš„æµç¨‹ï¼Œè€Œä¸æ˜¯ç›´æ¥ç´¢å¼•ï¼Œ æ‰€ä»¥è¿™æ¬¡ç´¢å¼•æœ‰å¯èƒ½å¼•å‘å¦ä¸€æ¬¡å…ƒæ–¹æ³•ã€‚ï¼‰
1foo = {a = 1} 2print(foo.a) 3 4smt = { 5 __index = function(table,key) 6 return string.format(&#34;not found key : %s&#34;,key) 7 end 8} 9 10setmetatable(foo, smt) 11print(foo[&#34;mykey&#34;]) 12print(foo[123]) __newindex __newindex: ç´¢å¼•èµ‹å€¼ table[key] = value ã€‚ å’Œç´¢å¼•äº‹ä»¶ç±»ä¼¼ï¼Œå®ƒå‘ç”Ÿåœ¨ table ä¸æ˜¯è¡¨æˆ–æ˜¯è¡¨ table ä¸­ä¸å­˜åœ¨ key è¿™ä¸ªé”®çš„æ—¶å€™ã€‚ æ­¤æ—¶ï¼Œä¼šè¯»å‡º table ç›¸åº”çš„å…ƒæ–¹æ³•ã€‚
åŒç´¢å¼•è¿‡ç¨‹é‚£æ ·ï¼Œ è¿™ä¸ªäº‹ä»¶çš„å…ƒæ–¹æ³•å³å¯ä»¥æ˜¯å‡½æ•°ï¼Œä¹Ÿå¯ä»¥æ˜¯ä¸€å¼ è¡¨ã€‚ å¦‚æœæ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œ åˆ™ä»¥ tableã€ keyã€ä»¥åŠ value ä¸ºå‚æ•°ä¼ å…¥ã€‚ å¦‚æœæ˜¯ä¸€å¼ è¡¨ï¼Œ Lua å¯¹è¿™å¼ è¡¨åšç´¢å¼•èµ‹å€¼æ“ä½œã€‚ ï¼ˆè¿™ä¸ªç´¢å¼•è¿‡ç¨‹æ˜¯èµ°å¸¸è§„çš„æµç¨‹ï¼Œè€Œä¸æ˜¯ç›´æ¥ç´¢å¼•èµ‹å€¼ï¼Œ æ‰€ä»¥è¿™æ¬¡ç´¢å¼•èµ‹å€¼æœ‰å¯èƒ½å¼•å‘å¦ä¸€æ¬¡å…ƒæ–¹æ³•ã€‚ï¼‰
ä¸€æ—¦æœ‰äº† â€œnewindexâ€ å…ƒæ–¹æ³•ï¼Œ Lua å°±ä¸å†åšæœ€åˆçš„èµ‹å€¼æ“ä½œã€‚ ï¼ˆå¦‚æœæœ‰å¿…è¦ï¼Œåœ¨å…ƒæ–¹æ³•å†…éƒ¨å¯ä»¥è°ƒç”¨ rawset æ¥åšèµ‹å€¼ã€‚ï¼‰
1foo = {a = 1} 2print(foo.a) 3 4smt = { 5 __newindex = function(table,key,value) 6 --print(key,value) 7 rawset(table,key,value) 8 end 9} 10 11setmetatable(foo, smt) 12foo[&#34;abc&#34;] = 123 13print(foo[&#34;abc&#34;]) è¯­æ³•ç³– è¿™æ˜¯ Lua æ”¯æŒçš„ä¸€ç§è¯­æ³•ç³–ã€‚ åƒ v:name(args) è¿™ä¸ªæ ·å­ï¼Œ è¢«è§£é‡Šæˆ v.name(v,args)ï¼Œ è¿™é‡Œçš„ v åªä¼šè¢«æ±‚å€¼ä¸€æ¬¡
å†’å· è¯­æ³•å¯ä»¥ç”¨æ¥å®šä¹‰ æ–¹æ³•ï¼Œ å°±æ˜¯è¯´ï¼Œå‡½æ•°å¯ä»¥æœ‰ä¸€ä¸ªéšå¼çš„å½¢å‚ selfã€‚ å› æ­¤ï¼Œå¦‚ä¸‹è¯­å¥
1function foo:new(a,b) 2 -- .... 3end 4 5foo.new = function (self,a,b) 6 -- .... 7end 1foo = { 2 a = 1, 3 add = function(table,value) 4 table.a = table.a + value 5 end 6} 7 8foo:add(1) 9-- eq: foo.add(foo,1) 10print(foo[&#34;a&#34;]) è¿™ç§è¯­æ³•ç³–å®ç°äº†c++çš„thisæŒ‡é’ˆçš„ç±»ä¼¼åŠŸèƒ½,å¯ä»¥æ“ä½œå¯¹è±¡æœ¬èº«,è€Œä¸éœ€è¦ä¼ å…¥å¯¹è±¡æœ¬èº«.
é¢å‘å¯¹è±¡ matetable éå¸¸ç±»ä¼¼äºjavascript çš„prototypeï¼Œå¯ä»¥ç”¨æ¥å®ç°é¢å‘å¯¹è±¡
ä»£ç 1å®ç°:
ç±»çš„æ„é€ å‡½æ•° ç±»çš„æ–¹æ³• 1local fooClass = {} 2 3function fooClass:new(name) { 4 local t = { name = name} 5 local t_smt = { 6 __add = function(a,b) ... end 7 -- æ·»åŠ å„ç§èƒ½åŠ› 8 9 -- æ·»åŠ åŸºç¡€å± 10 &#34;default_name&#34; = &#34;bar&#34; 11 } 12 -- å½“ t[&#39;no-key&#39;] æ—¶å€™ å›å»æ‰¾ t_smt é‡Œé¢çš„å…ƒç´  13 t_smt[&#34;__index&#34;] = t_smt 14 setmetatable(t,t_smt) 15 return t 16} ä»£ç 2å®ç°: ç±»çš„ç»§æ‰¿ åŸç†: __index å¯ä»¥æŒ‡å‘ä¸€ä¸ªè¡¨,å½“è®¿é—®çš„keyä¸å­˜åœ¨æ—¶,ä¼šå»__indexæŒ‡å‘çš„è¡¨ä¸­æŸ¥æ‰¾
1function newObject(value) 2 return setmetatable({}, {__index = value}) 3end 4 5function createClass(...) 6 local c = {} -- a new class instance 7 setmetatable(c, {__index = ...}) 8 c.__index = c 9 function c:new (o) 10 o = o or {} 11 setmetatable(o, c) 12 return o 13 end 14 return c 15end 16 17local animal = createClass() 18function animal:new(name) 19 local o = {name = name} 20 self.__index = self 21 setmetatable(o, self) 22 return o 23end 24 25function animal:printName() 26 print(self.name) 27end 28 29local dog = animal:new(&#34;dog&#34;) 30dog:printName() ä¸€ä¸ªä¾‹å­ 1print(&#34;&lt;-- learning class --&gt;&#34;) 2local Animal = {} 3Animal.__index = Animal 4 5function Animal.new(name) 6 local self = setmetatable({}, {__index = Animal}) 7 self.name = name 8 return self 9end 10 11function Animal:count() 12 print(self.name .. &#34;Animal kingdom is large!&#34;) 13end 14 15function Animal:speak() 16 print(self.name .. &#34; says: I&#39;m an animal!&#34;) 17end 18 19function Animal:move() 20 print(self.name .. &#34; is moving.&#34;) 21end 22 23 24--- use Animal class 25local dog = Animal.new(&#34;Dog&#34;) 26dog:speak() -- Output: Dog says: I&#39;m an animal! 27dog:move() -- Output: Dog is moving. 28 29--- li sh 30 31 32-- class inherit 33local Dog = {} 34Dog.__index = Dog -- ä¸ºäº†åé¢å¯ä»¥ç»§æ‰¿ Dog 35-- setmetatable(Dog,{__index = Animal}) -- æŒ‡å‘çˆ¶ç±» 36setmetatable(Dog,{__index = Animal}) -- æŒ‡å‘çˆ¶ç±» 37 38 39function Dog.new(name) 40 local self = Animal.new(name) -- è°ƒç”¨çˆ¶ç±»çš„æ„é€ å‡½æ•° 41 setmetatable(self, Dog) -- è®¾ç½®å…ƒè¡¨ä¸º Dog 42 -- å¯ä»¥è®¤ä¸ºåˆ›å»ºäº†ä¸€ä¸ª Dog çš„å®ä¾‹ 43 return self 44end 45 46function Dog:speak() 47 print(self.name .. &#34; says: Woof!&#34;) 48end 49 50local myDog = Dog.new(&#34;Buddy&#34;) 51myDog:speak() -- Output: Buddy says: Woof! 52myDog:move() -- Output: Buddy is moving. 53 54myDog.count(myDog) -- Output: Buddy Animal kingdom is large! 55 __index åªè¯»å–ç‰¹æ€§ ç­”æ¡ˆå¾ˆç®€å•ï¼š__index åªä¼šå½±å“â€œè¯»å–â€æ“ä½œï¼Œä¸ä¼šå½±å“â€œå†™å…¥â€ï¼ˆèµ‹å€¼ï¼‰æ“ä½œã€‚
1local obj = { 2 num = 0; 3} 4 5function obj:add1() 6 self.num = self.num + 1 7end 8 9function obj.new(start) 10 local t = {} 11 setmetatable(t, {__index = obj}) 12 -- t.num = start 13 return t; 14end 15 16local o1 = obj.new(10) 17o1:add1() 18print(o1.num) 19 20local o2 = obj.new(100) 21o2:add1() 22print(o2.num) __index åªåœ¨è¯»å–ï¼ˆæŸ¥æ‰¾ï¼‰æ—¶ç”Ÿæ•ˆï¼Œå†™å…¥ï¼ˆèµ‹å€¼ï¼‰æ—¶æ— æ•ˆã€‚
o1:add1() å’Œ o2:add1() éƒ½æ˜¯ï¼š
è¯»å– obj.num (å€¼æ˜¯ 0)ã€‚ è®¡ç®— 0 + 1 = 1ã€‚ å†™å…¥åˆ°è‡ªå·±èº«ä¸Š (o1.num = 1, o2.num = 1)ã€‚ obj.num æ°¸è¿œæ˜¯ 0ï¼Œo1 å’Œ o2 äº’ä¸å½±å“ã€‚
æ”¹è¿›çš„é¢å‘å¯¹è±¡ ä¸åˆ›å»ºæ–°çš„è¡¨,è€Œæ˜¯ç›´æ¥ä½¿ç”¨åŸè¡¨,è¿™æ ·å¯ä»¥èŠ‚çœå†…å­˜ newæ–¹æ³•ä¹Ÿä½¿ç”¨å†’å·è¯­æ³•,è¿™æ ·å¯ä»¥ç›´æ¥è°ƒç”¨ æ¥è‡ªlua programming 4th ä¹¦ä¸­æ–¹å¼
1local Animal = {} 2 3function Animal:new(name) 4 local o = { name = name} 5 self.__index = self 6 setmetatable(o,self) 7 return o 8end 9 10function Animal:speak() 11 print(self.name .. &#34; is speaking!&#34;) 12end 13 14local myPet1 = Animal:new(&#39;pet1&#39;) 15myPet1:speak() 16 17 18local Dog = {} 19setmetatable(Dog,{__index = Animal}) 20 21function Dog:new(name,hair_color) 22 local dog = Animal:new(name) 23 dog.hair_color = hair_color 24 self.__index = self 25 setmetatable(dog,self) 26 return dog 27end 28 29 30local mypet_dog = Dog:new(&#34;dogee&#34;,&#34;black&#34;) 31mypet_dog:speak() `,url:"https://hugo-dead-simple.netlify.com/program_language/lua/lua%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E5%9F%BA%E7%A1%80.html"},"https://hugo-dead-simple.netlify.com/blog/index.html":{title:"Blogs",tags:[],content:"",url:"https://hugo-dead-simple.netlify.com/blog/index.html"},"https://hugo-dead-simple.netlify.com/tags/c++.html":{title:"C++",tags:[],content:"",url:"https://hugo-dead-simple.netlify.com/tags/c++.html"},"https://hugo-dead-simple.netlify.com/tags/cairo.html":{title:"Cairo",tags:[],content:"",url:"https://hugo-dead-simple.netlify.com/tags/cairo.html"},"https://hugo-dead-simple.netlify.com/blog/cairo%E5%9B%BE%E5%BD%A2%E5%BA%93%E5%85%A5%E9%97%A8.html":{title:"cairoå›¾å½¢åº“å…¥é—¨",tags:["C++","Cairo","å›¾å½¢å­¦","æ•™ç¨‹"],content:`Cairoå›¾å½¢åº“å…¥é—¨ï¼šç”¨C++ç»˜åˆ¶ä¼˜é›…çš„2DçŸ¢é‡å›¾å½¢ æ‘˜è¦ï¼š æœ¬æ–‡æ˜¯ä¸€ç¯‡é’ˆå¯¹åˆå­¦è€…çš„ Cairo å…¥é—¨æ•™ç¨‹ï¼Œå°†å¸¦ä½ ä»é›¶å¼€å§‹ï¼Œå­¦ä¹ å¦‚ä½•ä½¿ç”¨è¿™ä¸ªå¼ºå¤§è€Œä¼˜é›…çš„2Då›¾å½¢åº“ï¼Œé€šè¿‡C++è¯­è¨€åˆ›å»ºé«˜è´¨é‡çš„çŸ¢é‡å›¾å½¢ã€‚
ä»€ä¹ˆæ˜¯ Cairoï¼Ÿ Cairo æ˜¯ä¸€ä¸ªå¼€æºçš„2Då›¾å½¢åº“ï¼Œå®ƒæä¾›äº†ä¸€å¥—å¼ºå¤§è€Œçµæ´»çš„APIï¼Œç”¨äºåˆ›å»ºé«˜è´¨é‡çš„çŸ¢é‡å›¾å½¢ã€‚ä¸ä¾èµ–åƒç´ çš„ä½å›¾ä¸åŒï¼ŒçŸ¢é‡å›¾å½¢åŸºäºæ•°å­¦æ–¹ç¨‹ï¼Œè¿™æ„å‘³ç€ä½ å¯ä»¥åœ¨ä¸æŸå¤±ä»»ä½•æ¸…æ™°åº¦çš„æƒ…å†µä¸‹ï¼Œä»»æ„ç¼©æ”¾ã€æ—‹è½¬æˆ–å˜æ¢å›¾å½¢ã€‚
ä¸ºä»€ä¹ˆé€‰æ‹© Cairoï¼Ÿ
é«˜è´¨é‡è¾“å‡ºï¼šæ— è®ºæ˜¯ç”Ÿæˆç”¨äºæ‰“å°çš„ PDFï¼Œè¿˜æ˜¯ç”¨äºç½‘é¡µçš„ SVGï¼ŒCairo éƒ½èƒ½ç¡®ä¿å›¾å½¢è¾¹ç¼˜å¹³æ»‘ã€æ— é”¯é½¿ã€‚ å¤šæ ¼å¼æ”¯æŒï¼šä¸€æ¬¡ç¼–å†™ï¼Œå¤šå¤„æ¸²æŸ“ã€‚Cairo æ”¯æŒå¤šç§è¾“å‡ºç›®æ ‡ï¼ˆç§°ä¸º â€œSurfaceâ€ï¼‰ï¼ŒåŒ…æ‹¬ PNG å›¾ç‰‡ã€PDFã€SVGã€PostScriptï¼Œç”šè‡³ç›´æ¥æ¸²æŸ“åˆ°çª—å£ã€‚ è·¨å¹³å°ï¼šä½œä¸ºä¸šç•Œæ ‡å‡†ä¹‹ä¸€ï¼ŒCairo åœ¨ Linuxã€macOS å’Œ Windows ä¸Šéƒ½èƒ½å®Œç¾è¿è¡Œã€‚ ä¸°å¯Œçš„è¯­è¨€ç»‘å®šï¼šè™½ç„¶æ ¸å¿ƒåº“ç”¨ C è¯­è¨€ç¼–å†™ï¼Œä½†å®ƒæ‹¥æœ‰ C++ã€Pythonã€Rustã€Go ç­‰å¤šç§è¯­è¨€çš„ç»‘å®šï¼Œè®©ä½ å¯ä»¥åœ¨è‡ªå·±å–œæ¬¢çš„å¼€å‘ç¯å¢ƒä¸­ä½¿ç”¨ã€‚ å®‰è£…ä¸é…ç½® åœ¨å¼€å§‹ä¹‹å‰ï¼Œä½ éœ€è¦å®‰è£… Cairo çš„å¼€å‘åº“ã€‚
åœ¨ Linux (Ubuntu/Debian) ä¸Šï¼š
1sudo apt-get install libcairo2-dev åœ¨ macOS ä¸Š (ä½¿ç”¨ Homebrew)ï¼š
1brew install cairo åœ¨ Windows ä¸Š (ä½¿ç”¨ vcpkg)ï¼š
1vcpkg install cairo å®‰è£…å®Œæˆåï¼Œä½ éœ€è¦å‘Šè¯‰ç¼–è¯‘å™¨å¦‚ä½•æ‰¾åˆ° Cairo çš„å¤´æ–‡ä»¶å’Œåº“ã€‚pkg-config æ˜¯ä¸€ä¸ªèƒ½å¸®ä½ è‡ªåŠ¨å®Œæˆè¿™é¡¹å·¥ä½œçš„åˆ©å™¨ï¼š
1# è¿™æ¡å‘½ä»¤ä¼šè¾“å‡ºç¼–è¯‘å’Œé“¾æ¥æ‰€éœ€çš„å…¨éƒ¨å‚æ•° 2g++ your_program.cpp -o your_program \`pkg-config --cflags --libs cairo\` Cairo çš„æ ¸å¿ƒæ¦‚å¿µ ç†è§£ Cairo çš„ç»˜å›¾æ¨¡å‹æ˜¯æŒæ¡å®ƒçš„å…³é”®ã€‚æƒ³è±¡ä½ æ˜¯ä¸€ä½ç”»å®¶ï¼š
Surface (ç”»å¸ƒ)ï¼šè¿™æ˜¯ä½ çš„ç»˜ç”»ç›®æ ‡ã€‚å®ƒå¯ä»¥æ˜¯ä¸€å¼  PNG å›¾ç‰‡ (cairo_image_surface_create)ï¼Œä¸€ä¸ª PDF æ–‡ä»¶ (cairo_pdf_surface_create)ï¼Œæˆ–æ˜¯ä¸€ä¸ª SVG å›¾åƒ (cairo_svg_surface_create)ã€‚ Context (ç”»ç¬”å’Œè°ƒè‰²æ¿)ï¼šcairo_t æ˜¯ä½ çš„ç»˜å›¾ä¸Šä¸‹æ–‡ï¼Œå®ƒåŒ…å«äº†æ‰€æœ‰ç»˜å›¾çš„çŠ¶æ€ï¼Œå¦‚é¢œè‰²ã€çº¿å®½ã€å­—ä½“ç­‰ã€‚ä½ æ‰€æœ‰çš„ç»˜å›¾æ“ä½œéƒ½æ˜¯é€šè¿‡å®ƒæ¥å®Œæˆçš„ã€‚ Path (è·¯å¾„)ï¼šè¿™æ˜¯ä½ ä¸‹ç¬”å‰å‹¾å‹’çš„è½®å»“ã€‚è·¯å¾„ç”±ç›´çº¿ã€æ›²çº¿å’Œå¼§çº¿ç»„æˆã€‚å®ƒæœ¬èº«æ˜¯ä¸å¯è§çš„ï¼Œç›´åˆ°ä½ è¿›è¡Œä¸‹ä¸€æ­¥æ“ä½œã€‚ Source (é¢œæ–™)ï¼šè¿™æ˜¯ä½ ç”¨æ¥å¡«å……æˆ–æç”»è·¯å¾„çš„â€œé¢œæ–™â€ã€‚å®ƒå¯ä»¥æ˜¯çº¯è‰² (cairo_set_source_rgb)ã€æ¸å˜æˆ–å›¾æ¡ˆã€‚ æ“ä½œ (ç»˜åˆ¶åŠ¨ä½œ)ï¼š cairo_stroke()ï¼šæè¾¹ï¼Œæ²¿ç€è·¯å¾„ç”»å‡ºè½®å»“çº¿ã€‚ cairo_fill()ï¼šå¡«å……ï¼Œå°†è·¯å¾„åŒ…å›´çš„åŒºåŸŸå¡«æ»¡é¢œè‰²ã€‚ ç¬¬ä¸€ä¸ªç¨‹åºï¼šç»˜åˆ¶åŸºæœ¬å›¾å½¢ è®©æˆ‘ä»¬ä»ä¸€ä¸ªç®€å•çš„ä¾‹å­å¼€å§‹ï¼Œåˆ›å»ºä¸€ä¸ªPNGå›¾ç‰‡ï¼Œå¹¶åœ¨ä¸Šé¢ç»˜åˆ¶ä¸€äº›åŸºæœ¬å›¾å½¢ã€‚è¿™ä¸ªä¾‹å­å°†æ¶µç›–åˆ›å»ºç”»å¸ƒã€è®¾ç½®ç”»ç¬”ã€å®šä¹‰è·¯å¾„å’Œæ¸²æŸ“çš„å…¨è¿‡ç¨‹ã€‚
1#include &lt;cairo/cairo.h&gt; 2#include &lt;cmath&gt; // For M_PI 3 4int main() { 5 int width = 600; 6 int height = 400; 7 8 // 1. åˆ›å»ºä¸€ä¸ªå›¾åƒç”»å¸ƒ (Image Surface) 9 cairo_surface_t* surface = cairo_image_surface_create(CAIRO_FORMAT_ARGB32, width, height); 10 // 2. åˆ›å»ºä¸€ä¸ªç»˜å›¾ä¸Šä¸‹æ–‡ (Context) 11 cairo_t* cr = cairo_create(surface); 12 13 // --- ç»˜åˆ¶èƒŒæ™¯ --- 14 cairo_set_source_rgb(cr, 0.9, 0.9, 0.9); // è®¾ç½®æµ…ç°è‰² 15 cairo_paint(cr); 16 17 // --- ç»˜åˆ¶ä¸€ä¸ªçº¢è‰²æè¾¹çš„çŸ©å½¢ --- 18 cairo_set_source_rgb(cr, 1.0, 0.0, 0.0); // çº¢è‰² 19 cairo_set_line_width(cr, 6.0); 20 cairo_rectangle(cr, 50, 50, 200, 150); // å®šä¹‰çŸ©å½¢è·¯å¾„ (x, y, w, h) 21 cairo_stroke(cr); // æè¾¹ 22 23 // --- ç»˜åˆ¶ä¸€ä¸ªè“è‰²å¡«å……çš„åœ†å½¢ --- 24 cairo_set_source_rgb(cr, 0.0, 0.0, 1.0); // è“è‰² 25 // å®šä¹‰åœ†å½¢è·¯å¾„ (cx, cy, radius, start_angle, end_angle) 26 cairo_arc(cr, 400, 125, 75, 0, 2 * M_PI); 27 cairo_fill(cr); // å¡«å…… 28 29 // --- ç»˜åˆ¶ä¸€æ®µç»¿è‰²æ›²çº¿ --- 30 cairo_set_source_rgb(cr, 0.0, 1.0, 0.0); // ç»¿è‰² 31 cairo_set_line_width(cr, 8.0); 32 cairo_move_to(cr, 50, 300); // å°†ç”»ç¬”ç§»åŠ¨åˆ°èµ·ç‚¹ 33 // å®šä¹‰è´å¡å°”æ›²çº¿ (c1x, c1y, c2x, c2y, endx, endy) 34 cairo_curve_to(cr, 150, 200, 350, 400, 500, 300); 35 cairo_stroke(cr); 36 37 // 3. å°†ç»“æœä¿å­˜åˆ°PNGæ–‡ä»¶ 38 cairo_surface_write_to_png(surface, &#34;basic_shapes.png&#34;); 39 40 // 4. æ¸…ç†èµ„æº 41 cairo_destroy(cr); 42 cairo_surface_destroy(surface); 43 44 return 0; 45} ç¼–è¯‘å¹¶è¿è¡Œï¼š
1g++ main.cpp -o basic_shapes \`pkg-config --cflags --libs cairo\` 2./basic_shapes ä½ å°†å¾—åˆ°ä¸€ä¸ªåä¸º basic_shapes.png çš„æ–‡ä»¶ï¼Œå…¶ä¸­åŒ…å«äº†æˆ‘ä»¬åˆšåˆšç»˜åˆ¶çš„å›¾å½¢ã€‚
è¿›é˜¶æŠ€å·§ å›¾å½¢å˜æ¢ï¼šå¹³ç§»ã€æ—‹è½¬ä¸ç¼©æ”¾ Cairo çš„ä¸€ä¸ªå¼ºå¤§ä¹‹å¤„åœ¨äºå…¶åæ ‡å˜æ¢ç³»ç»Ÿã€‚ä½ å¯ä»¥ç§»åŠ¨ã€æ—‹è½¬æˆ–ç¼©æ”¾æ•´ä¸ªåæ ‡ç³»ï¼Œä»è€Œè½»æ¾åœ°ç»˜åˆ¶å¤æ‚çš„é‡å¤æ€§å›¾æ¡ˆæˆ–å¯¹é½å¯¹è±¡ã€‚
cairo_translate(cr, tx, ty): å°†åæ ‡ç³»çš„åŸç‚¹ (0,0) ç§»åŠ¨åˆ° (tx, ty)ã€‚ cairo_rotate(cr, angle): å°†åæ ‡ç³»æ—‹è½¬æŒ‡å®šçš„è§’åº¦ï¼ˆä»¥å¼§åº¦ä¸ºå•ä½ï¼‰ã€‚ cairo_scale(cr, sx, sy): åˆ†åˆ«åœ¨ x å’Œ y è½´ä¸Šç¼©æ”¾åæ ‡ç³»ã€‚ ä¸€ä¸ªé‡è¦çš„å®è·µæ˜¯ä½¿ç”¨ cairo_save(cr) å’Œ cairo_restore(cr) æ¥åŒ…è£¹å˜æ¢æ“ä½œï¼Œè¿™å°±åƒåœ¨ Photoshop ä¸­åˆ›å»ºå’Œé”€æ¯å›¾å±‚ä¸€æ ·ï¼Œå¯ä»¥ç¡®ä¿å˜æ¢æ•ˆæœä¸ä¼šå½±å“åˆ°åç»­çš„ç»˜å›¾ã€‚
1// ... åœ¨ä¹‹å‰çš„ä»£ç ä¸­æ·»åŠ  ... 2 3cairo_save(cr); // ä¿å­˜å½“å‰çŠ¶æ€ 4 5// å°†åæ ‡ç³»ç§»åˆ°ç”»å¸ƒä¸­å¿ƒ 6cairo_translate(cr, width / 2.0, height / 2.0); 7// æ—‹è½¬45åº¦ 8cairo_rotate(cr, 45 * M_PI / 180.0); 9 10// åœ¨æ—‹è½¬åçš„åæ ‡ç³»ä¸­å¿ƒç»˜åˆ¶ä¸€ä¸ªæ­£æ–¹å½¢ 11cairo_set_source_rgba(cr, 0.5, 0.0, 0.5, 0.5); // åŠé€æ˜ç´«è‰² 12cairo_rectangle(cr, -50, -50, 100, 100); 13cairo_fill(cr); 14 15cairo_restore(cr); // æ¢å¤åˆ°ä¿å­˜å‰çš„çŠ¶æ€ 16 17// ... ç»§ç»­å…¶ä»–ç»˜å›¾ ... æ¸²æŸ“æ–‡æœ¬ Cairo æä¾›äº†å¼ºå¤§çš„æ–‡æœ¬æ¸²æŸ“åŠŸèƒ½ã€‚
1// ... 2cairo_select_font_face(cr, &#34;Sans&#34;, CAIRO_FONT_SLANT_NORMAL, CAIRO_FONT_WEIGHT_BOLD); 3cairo_set_font_size(cr, 50.0); 4cairo_set_source_rgb(cr, 0.2, 0.2, 0.2); 5cairo_move_to(cr, 150, 250); 6cairo_show_text(cr, &#34;Hello, Cairo!&#34;); 7// ... å®é™…åº”ç”¨ç¤ºä¾‹ï¼šç»˜åˆ¶ä¸€ä¸ªç®€å•çš„æˆ¿å­åœºæ™¯ è®©æˆ‘ä»¬æŠŠå­¦åˆ°çš„çŸ¥è¯†ç»“åˆèµ·æ¥ï¼Œç»˜åˆ¶ä¸€ä¸ªåŒ…å«æˆ¿å­ã€å¤ªé˜³å’Œæ–‡å­—çš„åœºæ™¯ã€‚
1#include &lt;cairo/cairo.h&gt; 2#include &lt;cmath&gt; 3 4int main() { 5 cairo_surface_t* surface = cairo_image_surface_create(CAIRO_FORMAT_ARGB32, 600, 400); 6 cairo_t* cr = cairo_create(surface); 7 8 // èƒŒæ™¯ 9 cairo_set_source_rgb(cr, 0.8, 0.9, 1.0); // æ·¡è“è‰²å¤©ç©º 10 cairo_paint(cr); 11 12 // å¤ªé˜³ 13 cairo_set_source_rgb(cr, 1.0, 0.9, 0.0); // é»„è‰² 14 cairo_arc(cr, 500, 80, 50, 0, 2 * M_PI); 15 cairo_fill(cr); 16 17 // æˆ¿å­ä¸»ä½“ 18 cairo_set_source_rgb(cr, 0.8, 0.7, 0.6); 19 cairo_rectangle(cr, 100, 200, 200, 150); 20 cairo_fill_preserve(cr); // å¡«å……å¹¶ä¿ç•™è·¯å¾„ç”¨äºæè¾¹ 21 cairo_set_source_rgb(cr, 0.1, 0.1, 0.1); 22 cairo_set_line_width(cr, 4.0); 23 cairo_stroke(cr); 24 25 // æˆ¿é¡¶ 26 cairo_move_to(cr, 80, 200); 27 cairo_line_to(cr, 200, 120); 28 cairo_line_to(cr, 320, 200); 29 cairo_close_path(cr); // é—­åˆè·¯å¾„å½¢æˆä¸‰è§’å½¢ 30 cairo_set_source_rgb(cr, 0.9, 0.3, 0.2); 31 cairo_fill_preserve(cr); 32 cairo_set_source_rgb(cr, 0.1, 0.1, 0.1); 33 cairo_stroke(cr); 34 35 // é—¨ 36 cairo_rectangle(cr, 180, 280, 40, 70); 37 cairo_set_source_rgb(cr, 0.5, 0.3, 0.1); 38 cairo_fill(cr); 39 40 // æ¬¢è¿è¯­ 41 cairo_select_font_face(cr, &#34;Georgia&#34;, CAIRO_FONT_SLANT_ITALIC, CAIRO_FONT_WEIGHT_NORMAL); 42 cairo_set_font_size(cr, 24.0); 43 cairo_set_source_rgb(cr, 0.1, 0.1, 0.1); 44 cairo_move_to(cr, 120, 380); 45 cairo_show_text(cr, &#34;Welcome to Cairo!&#34;); 46 47 // ä¿å­˜å¹¶æ¸…ç† 48 cairo_surface_write_to_png(surface, &#34;house_scene.png&#34;); 49 cairo_destroy(cr); 50 cairo_surface_destroy(surface); 51 52 return 0; 53} ç»“è®ºä¸åç»­å­¦ä¹  é€šè¿‡æœ¬æ•™ç¨‹ï¼Œä½ å·²ç»æŒæ¡äº†ä½¿ç”¨ Cairo è¿›è¡Œ 2D çŸ¢é‡ç»˜å›¾çš„åŸºæœ¬æµç¨‹ã€‚Cairo çš„å¼ºå¤§è¿œä¸æ­¢äºæ­¤ï¼Œä½ å¯ä»¥è¿›ä¸€æ­¥æ¢ç´¢ï¼š
æ¸å˜ä¸å›¾æ¡ˆï¼šåˆ›å»ºæ›´ä¸°å¯Œçš„è§†è§‰æ•ˆæœã€‚ é«˜çº§è·¯å¾„æ“ä½œï¼šå¦‚ cairo_clipï¼Œç”¨äºåˆ›å»ºé®ç½©æ•ˆæœã€‚ ä¸åŒçš„ Surfaceï¼šå°è¯•å°†ä½ çš„ç»˜å›¾è¾“å‡ºä¸º PDF (cairo_pdf_surface_create) æˆ– SVG (cairo_svg_surface_create)ã€‚ äº¤äº’å¼åº”ç”¨ï¼šå°† Cairo ä¸ GTKã€Qt æˆ–å…¶ä»– GUI æ¡†æ¶ç»“åˆï¼Œåˆ›å»ºå¸¦æœ‰åŠ¨æ€å›¾å½¢çš„æ¡Œé¢åº”ç”¨ã€‚ è¦æ·±å…¥å­¦ä¹ ï¼Œæœ€å¥½çš„èµ„æºæ°¸è¿œæ˜¯å®˜æ–¹æ–‡æ¡£å’Œç¤ºä¾‹ã€‚ç°åœ¨ï¼Œå¼€å§‹ä½ çš„åˆ›ä½œä¹‹æ—…å§ï¼
`,url:"https://hugo-dead-simple.netlify.com/blog/cairo%E5%9B%BE%E5%BD%A2%E5%BA%93%E5%85%A5%E9%97%A8.html"},"https://hugo-dead-simple.netlify.com/categories/index.html":{title:"Categories",tags:[],content:"",url:"https://hugo-dead-simple.netlify.com/categories/index.html"},"https://hugo-dead-simple.netlify.com/tags/index.html":{title:"Tags",tags:[],content:"",url:"https://hugo-dead-simple.netlify.com/tags/index.html"},"https://hugo-dead-simple.netlify.com/categories/%E5%9B%BE%E5%BD%A2%E5%9B%BE%E5%83%8F.html":{title:"å›¾å½¢å›¾åƒ",tags:[],content:"",url:"https://hugo-dead-simple.netlify.com/categories/%E5%9B%BE%E5%BD%A2%E5%9B%BE%E5%83%8F.html"},"https://hugo-dead-simple.netlify.com/tags/%E5%9B%BE%E5%BD%A2%E5%AD%A6.html":{title:"å›¾å½¢å­¦",tags:[],content:"",url:"https://hugo-dead-simple.netlify.com/tags/%E5%9B%BE%E5%BD%A2%E5%AD%A6.html"},"https://hugo-dead-simple.netlify.com/tags/%E6%95%99%E7%A8%8B.html":{title:"æ•™ç¨‹",tags:[],content:"",url:"https://hugo-dead-simple.netlify.com/tags/%E6%95%99%E7%A8%8B.html"},"https://hugo-dead-simple.netlify.com/categories/%E7%BC%96%E7%A8%8B.html":{title:"ç¼–ç¨‹",tags:[],content:"",url:"https://hugo-dead-simple.netlify.com/categories/%E7%BC%96%E7%A8%8B.html"},"https://hugo-dead-simple.netlify.com/blog/x64dbg%E5%BF%AB%E6%8D%B7%E9%94%AE.html":{title:"x64dbgå¿«æ·é”®",tags:[""],content:`-å·é”® å›é€€ Ctrl+A åˆ†æ Ctrl+HOME è½¬åˆ°å‡½æ•°å¤´ Alt+K æŸ¥å †æ ˆå†å² Ctrl+Shift+â†‘â†“ å †æ ˆä¸­ è°ƒè¯•è·Ÿè¸ªè®°å½•ä¸­ è¾“å‡ºçš„æ—¥å¿—çª—å£ä¸­ åæ‹›çš„é¡¶ä¸Šé™„è¿‘ è¡Œä¸ºç‚¹é™„è¿‘ Ctrl+F12çš„è°ƒç”¨è¿”å›å¤„ åˆå§‹åŒ–é˜¶æ®µçš„ä»£ç ä¸­ ä»»ä½•å¯ä»¥&quot;å€Ÿç”¨&quot;çš„ä¸€åˆ‡æ–¹å¼å’Œæ‰‹æ®µ
`,url:"https://hugo-dead-simple.netlify.com/blog/x64dbg%E5%BF%AB%E6%8D%B7%E9%94%AE.html"},"https://hugo-dead-simple.netlify.com/tags/lldb.html":{title:"Lldb",tags:[],content:"",url:"https://hugo-dead-simple.netlify.com/tags/lldb.html"},"https://hugo-dead-simple.netlify.com/blog/lldb%E8%B0%83%E8%AF%95%E7%A8%8B%E5%BA%8F%E9%87%8D%E5%AE%9A%E5%90%91%E8%BE%93%E5%85%A5.html":{title:"lldbè°ƒè¯•ç¨‹åºé‡å®šå‘è¾“å…¥",tags:[""],content:`å¥½çš„ï¼Œåœ¨ Mac M1 èŠ¯ç‰‡ä¸Šä½¿ç”¨å‘½ä»¤è¡Œ lldb è°ƒè¯•ï¼Œå¹¶ä¸ºç¨‹åºæŒ‡å®šè¾“å…¥æ–‡ä»¶ï¼Œè¿™éœ€è¦ä¸¤æ­¥å…³é”®æ“ä½œï¼š
ä¸ºä½ çš„å¯æ‰§è¡Œæ–‡ä»¶è¿›è¡Œä»£ç ç­¾å (è¿™æ˜¯ M1/M2/M3 èŠ¯ç‰‡ Mac çš„ç‰¹æ®Šè¦æ±‚)ã€‚ åœ¨ lldb å†…éƒ¨ä½¿ç”¨æ­£ç¡®çš„å‘½ä»¤æ¥é‡å®šå‘è¾“å…¥ã€‚ ä½ ä¸èƒ½åƒåœ¨ shell é‡Œé‚£æ ·ç›´æ¥ä½¿ç”¨ &lt; ç¬¦å·ï¼Œå³ lldb 1.out &lt; in.txt æ˜¯é”™è¯¯çš„ï¼Œå› ä¸ºè¿™ä¼šæŠŠ in.txt çš„å†…å®¹è¾“å…¥ç»™ lldb ç¨‹åºæœ¬èº«ï¼Œè€Œä¸æ˜¯ä½ è¦è°ƒè¯•çš„ 1.outã€‚
ä¸‹é¢æ˜¯è¯¦ç»†çš„æ­¥éª¤å’Œè§£é‡Šã€‚
å‡†å¤‡å·¥ä½œï¼šä¸€ä¸ªç¤ºä¾‹ç¨‹åº æˆ‘ä»¬å…ˆåˆ›å»ºä¸€ä¸ªç®€å•çš„ C++ ç¨‹åºå’Œè¾“å…¥æ–‡ä»¶æ¥è¿›è¡Œæ¼”ç¤ºã€‚
1. åˆ›å»ºæºä»£ç  test.cpp è¿™ä¸ªç¨‹åºä¼šè¯»å–ä¸€ä¸ªæ•´æ•°å’Œä¸€ä¸ªå­—ç¬¦ä¸²ã€‚
1#include &lt;iostream&gt; 2#include &lt;string&gt; 3 4int main() { 5 int id; 6 std::string name; 7 8 std::cout &lt;&lt; &#34;å‡†å¤‡ä»æ ‡å‡†è¾“å…¥è¯»å–æ•°æ®...&#34; &lt;&lt; std::endl; 9 10 // ä»æ ‡å‡†è¾“å…¥(stdin)è¯»å–æ•°æ® 11 std::cin &gt;&gt; id; 12 std::cin &gt;&gt; name; 13 14 std::cout &lt;&lt; &#34;è¯»å–åˆ°çš„ ID: &#34; &lt;&lt; id &lt;&lt; std::endl; 15 std::cout &lt;&lt; &#34;è¯»å–åˆ°çš„ Name: &#34; &lt;&lt; name &lt;&lt; std::endl; 16 17 return 0; 18} 2. åˆ›å»ºè¾“å…¥æ–‡ä»¶ in.txt æ–‡ä»¶çš„å†…å®¹è¦å’Œç¨‹åºè¯»å–çš„æ ¼å¼å¯¹åº”ã€‚
1101 2Gemini 3. ç¼–è¯‘ç¨‹åº ä½¿ç”¨ g++ ç¼–è¯‘ï¼Œå¹¶ä¸”ä¸€å®šè¦åŠ ä¸Š -g å‚æ•°ï¼Œè¿™æ ·æ‰ä¼šåŒ…å«è°ƒè¯•ä¿¡æ¯ï¼Œå¦åˆ™ lldb çœ‹ä¸åˆ°æºä»£ç ã€‚
1g++ -g test.cpp -o 1.out ç°åœ¨ä½ çš„æ–‡ä»¶å¤¹é‡Œåº”è¯¥æœ‰ 1.out å’Œ in.txt äº†ã€‚
âš ï¸ æ­¥éª¤ä¸€ï¼šä»£ç ç­¾å (M1/M2/M3 Mac å¿…éœ€) åœ¨ Apple Silicon èŠ¯ç‰‡çš„ Mac ä¸Šï¼Œå‡ºäºå®‰å…¨åŸå› ï¼Œè°ƒè¯•å™¨ lldb æ— æ³•é™„åŠ åˆ°æ²¡æœ‰ç»è¿‡ç­¾åçš„å¯æ‰§è¡Œæ–‡ä»¶ä¸Šã€‚ä½ éœ€è¦ä¸º 1.out åˆ›å»ºä¸€ä¸ªä¸´æ—¶çš„â€œå³å¸­ç­¾åâ€(ad-hoc signature) å¹¶èµ‹äºˆå®ƒè°ƒè¯•æƒé™ã€‚
1. åˆ›å»ºä¸€ä¸ªæƒé™æè¿°æ–‡ä»¶ entitlements.xml åœ¨ä¸ 1.out ç›¸åŒçš„ç›®å½•ä¸‹ï¼Œåˆ›å»ºä¸€ä¸ªåä¸º entitlements.xml çš„æ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹ï¼š
1&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt; 2&lt;!DOCTYPE plist PUBLIC &#34;-//Apple//DTD PLIST 1.0//EN&#34; &#34;http://www.apple.com/DTDs/PropertyList-1.0.dtd&#34;&gt; 3&lt;plist version=&#34;1.0&#34;&gt; 4&lt;dict&gt; 5 &lt;key&gt;com.apple.security.get-task-allow&lt;/key&gt; 6 &lt;true/&gt; 7&lt;/dict&gt; 8&lt;/plist&gt; è¿™ä¸ªæ–‡ä»¶é‡Œçš„ com.apple.security.get-task-allow é”®è®¾ç½®ä¸º trueï¼Œå°±æ˜¯å‘Šè¯‰ç³»ç»Ÿâ€œå…è®¸å…¶ä»–è¿›ç¨‹ï¼ˆæ¯”å¦‚è°ƒè¯•å™¨ï¼‰é™„åŠ åˆ°è¿™ä¸ªç¨‹åºä¸Šâ€ã€‚
2. ä½¿ç”¨ codesign å‘½ä»¤è¿›è¡Œç­¾å æ‰“å¼€ç»ˆç«¯ï¼Œè¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼š
1codesign -s - --entitlements entitlements.xml --force ./1.out -s -ï¼šè¡¨ç¤ºä½¿ç”¨ä¸€ä¸ªä¸´æ—¶çš„å³å¸­ç­¾åï¼Œä¸éœ€è¦å¼€å‘è€…è¯ä¹¦ã€‚ --entitlements entitlements.xmlï¼šå°†ä¸Šé¢åˆ›å»ºçš„æƒé™æ–‡ä»¶åº”ç”¨åˆ°ç¨‹åºä¸Šã€‚ --forceï¼šå¼ºåˆ¶è¦†ç›–ç°æœ‰çš„ç­¾åï¼ˆå¦‚æœæœ‰çš„è¯ï¼‰ã€‚ ./1.outï¼šä½ è¦ç­¾åçš„ç›®æ ‡æ–‡ä»¶ã€‚ æ‰§è¡ŒæˆåŠŸåï¼Œ1.out å°±å…·å¤‡äº†è¢«è°ƒè¯•çš„èµ„æ ¼ã€‚æ¯æ¬¡é‡æ–°ç¼–è¯‘åï¼Œéƒ½éœ€è¦é‡æ–°è¿›è¡Œç­¾åã€‚
ğŸš€ æ­¥éª¤äºŒï¼šä½¿ç”¨ LLDB è¿›è¡Œè°ƒè¯•å’Œè¾“å…¥é‡å®šå‘ ç°åœ¨å¯ä»¥å¼€å§‹çœŸæ­£çš„è°ƒè¯•äº†ã€‚
1. å¯åŠ¨ LLDB åœ¨ç»ˆç«¯ä¸­ï¼Œç”¨ lldb åŠ è½½ä½ çš„ç¨‹åºï¼š
1lldb ./1.out ä½ ä¼šçœ‹åˆ° lldb çš„æç¤ºç¬¦ (lldb)ã€‚
1(lldb) target create &#34;./1.out&#34; 2Current executable set to &#39;/path/to/your/project/1.out&#39; (arm64). 3(lldb) 2. è®¾ç½®æ–­ç‚¹ åœ¨ç¨‹åºå¼€å§‹è¿è¡Œå‰ï¼Œæˆ‘ä»¬å…ˆåœ¨ main å‡½æ•°è®¾ç½®ä¸€ä¸ªæ–­ç‚¹ã€‚
1(lldb) b main æˆ–è€…ï¼Œå¦‚æœä½ æƒ³åœ¨è¯»å–æ•°æ®çš„é‚£ä¸€è¡Œè®¾ç½®æ–­ç‚¹ï¼š
1(lldb) b test.cpp:11 3. è¿è¡Œç¨‹åºå¹¶é‡å®šå‘è¾“å…¥ (æ ¸å¿ƒæ­¥éª¤) ä½¿ç”¨ process launch å‘½ä»¤ï¼ˆå¯ä»¥ç®€å†™ä¸º runï¼‰æ¥å¯åŠ¨ç¨‹åºï¼Œå¹¶ä½¿ç”¨ --stdin (æˆ–ç®€å†™ -i) æ ‡å¿—æ¥æŒ‡å®šè¾“å…¥æ–‡ä»¶ã€‚
1(lldb) process launch --stdin in.txt æˆ–è€…ä½¿ç”¨ç®€å†™å½¢å¼ï¼š
1(lldb) run -i in.txt 4. å¼€å§‹è°ƒè¯• ç¨‹åºä¼šå¼€å§‹è¿è¡Œï¼Œå¹¶åœ¨ä½ è®¾ç½®çš„æ–­ç‚¹å¤„åœä¸‹æ¥ã€‚
1Process 12345 launched: &#39;/path/to/your/project/1.out&#39; (arm64) 2... 3Process 12345 stopped 4* thread #1, queue = &#39;com.apple.main-thread&#39;, stop reason = breakpoint 1.1 5 frame #0: 0x0000000100003e8c 1.out\`main at test.cpp:7 6 4 7 5 int main() { 8 6 int id; 9-&gt; 7 std::string name; 10 8 11 9 std::cout &lt;&lt; &#34;å‡†å¤‡ä»æ ‡å‡†è¾“å…¥è¯»å–æ•°æ®...&#34; &lt;&lt; std::endl; 12 10 13 11 // ä»æ ‡å‡†è¾“å…¥(stdin)è¯»å–æ•°æ® 14Target 0: (1.out) stopped. 15(lldb) ç°åœ¨ä½ å°±å¯ä»¥ä½¿ç”¨ lldb çš„å„ç§å‘½ä»¤è¿›è¡Œè°ƒè¯•äº†ï¼š
n (next): æ‰§è¡Œä¸‹ä¸€è¡Œä»£ç ã€‚ c (continue): ç»§ç»­æ‰§è¡Œç›´åˆ°ä¸‹ä¸€ä¸ªæ–­ç‚¹æˆ–ç¨‹åºç»“æŸã€‚ p &lt;variable&gt; (print): æ‰“å°å˜é‡çš„å€¼ã€‚ å½“ä½ æ‰§è¡Œè¿‡ std::cin &gt;&gt; id; ä¹‹åï¼Œå¯ä»¥æ‰“å° id çš„å€¼æ¥éªŒè¯å®ƒæ˜¯å¦æˆåŠŸä» in.txt ä¸­è¯»å–äº†æ•°æ®ã€‚
1(lldb) n 2... (æ‰§è¡Œå‡ æ­¥ç›´åˆ° cin ä¹‹å) 3(lldb) p id 4(int) $0 = 101 5(lldb) p name 6(std::string) $1 = &#34;Gemini&#34; ä½ ä¼šçœ‹åˆ°å˜é‡çš„å€¼å’Œ in.txt æ–‡ä»¶ä¸­çš„å†…å®¹å®Œå…¨ä¸€è‡´ã€‚
æ€»ç»“ å®Œæ•´çš„æµç¨‹æ˜¯ï¼š
g++ -g your_code.cpp -o 1.out (ç¼–è¯‘) codesign -s - --entitlements entitlements.xml --force ./1.out (ç­¾åï¼Œä»… M1/2/3 Mac é¦–æ¬¡æˆ–é‡æ–°ç¼–è¯‘åéœ€è¦) lldb ./1.out (å¯åŠ¨ lldb) (lldb) b main (è®¾ç½®æ–­ç‚¹) (lldb) run -i in.txt (è¿è¡Œå¹¶é‡å®šå‘è¾“å…¥) å¼€å§‹ä½ çš„è°ƒè¯•ä¹‹æ—…ï¼ `,url:"https://hugo-dead-simple.netlify.com/blog/lldb%E8%B0%83%E8%AF%95%E7%A8%8B%E5%BA%8F%E9%87%8D%E5%AE%9A%E5%90%91%E8%BE%93%E5%85%A5.html"},"https://hugo-dead-simple.netlify.com/tags/m1.html":{title:"M1",tags:[],content:"",url:"https://hugo-dead-simple.netlify.com/tags/m1.html"},"https://hugo-dead-simple.netlify.com/categories/macos.html":{title:"MacOS",tags:[],content:"",url:"https://hugo-dead-simple.netlify.com/categories/macos.html"},"https://hugo-dead-simple.netlify.com/tags/macos.html":{title:"MacOS",tags:[],content:"",url:"https://hugo-dead-simple.netlify.com/tags/macos.html"},"https://hugo-dead-simple.netlify.com/tags/ssh.html":{title:"SSH",tags:[],content:"",url:"https://hugo-dead-simple.netlify.com/tags/ssh.html"},"https://hugo-dead-simple.netlify.com/categories/%E6%8A%80%E6%9C%AF.html":{title:"æŠ€æœ¯",tags:[],content:"",url:"https://hugo-dead-simple.netlify.com/categories/%E6%8A%80%E6%9C%AF.html"},"https://hugo-dead-simple.netlify.com/blog/%E8%A7%A3%E5%86%B3m1%E4%B8%8Blldb%E4%B8%8D%E8%83%BD%E8%B0%83%E8%AF%95%E7%9A%84%E9%97%AE%E9%A2%98.html":{title:"è§£å†³M1ä¸‹lldbä¸èƒ½è°ƒè¯•çš„é—®é¢˜",tags:["lldb","M1","macOS","è°ƒè¯•","SSH"],content:`é—®é¢˜æè¿° åœ¨ä½¿ç”¨ Apple M1 èŠ¯ç‰‡çš„ Mac é€šè¿‡ SSH è¿œç¨‹è¿æ¥æ—¶ï¼Œå°è¯•ä½¿ç”¨ LLDB è¿›è¡Œè°ƒè¯•æ—¶é‡åˆ°ä»¥ä¸‹é”™è¯¯ï¼š
1lldb error: process exited with status -1 (this is a non-interactive debug session, cannot get permission to debug processes.) è¿™ä¸ªé—®é¢˜é€šå¸¸å‡ºç°åœ¨ä»¥ä¸‹åœºæ™¯ï¼š
é€šè¿‡ SSH è¿œç¨‹è¿æ¥åˆ° M1 Mac åœ¨ç»ˆç«¯å¤ç”¨å™¨ï¼ˆå¦‚ tmuxã€zellijï¼‰ä¸­ä½¿ç”¨ LLDB å°è¯•è°ƒè¯•éå½“å‰ç”¨æˆ·æ‹¥æœ‰çš„è¿›ç¨‹ è§£å†³æ–¹æ¡ˆ è¿™ä¸ªé—®é¢˜çš„åŸå› æ˜¯ macOS çš„å®‰å…¨æœºåˆ¶é™åˆ¶äº†éäº¤äº’å¼ä¼šè¯ä¸­çš„è°ƒè¯•æƒé™ã€‚è§£å†³æ–¹æ³•å¾ˆç®€å•ï¼š
1. å¯ç”¨å¼€å‘è€…å·¥å…·å®‰å…¨æƒé™ åœ¨ç»ˆç«¯ä¸­æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š
1sudo DevToolsSecurity -enable è¿™ä¸ªå‘½ä»¤ä¼šå¯ç”¨å¼€å‘è€…å·¥å…·çš„å®‰å…¨è®¾ç½®ï¼Œå…è®¸ LLDB åœ¨éäº¤äº’å¼ä¼šè¯ä¸­è·å–è°ƒè¯•æƒé™ã€‚
2. éªŒè¯é…ç½® æ‰§è¡Œä»¥ä¸‹å‘½ä»¤éªŒè¯é…ç½®æ˜¯å¦æˆåŠŸï¼š
1DevToolsSecurity --status å¦‚æœæ˜¾ç¤º &ldquo;Developer tools security is ENABLED.&rdquo; åˆ™è¡¨ç¤ºé…ç½®æˆåŠŸã€‚
é€‚ç”¨åœºæ™¯ è¿™ä¸ªè§£å†³æ–¹æ¡ˆé€‚ç”¨äºï¼š
âœ… Apple M1/M2/M3 èŠ¯ç‰‡çš„ Mac âœ… é€šè¿‡ SSH è¿œç¨‹è¿æ¥è°ƒè¯• âœ… åœ¨ tmuxã€zellij ç­‰ç»ˆç«¯å¤ç”¨å™¨ä¸­è°ƒè¯• âœ… macOS Monterey åŠä»¥ä¸Šç‰ˆæœ¬ å‚è€ƒæ¥æº è¿™ä¸ªè§£å†³æ–¹æ¡ˆæ¥è‡ª Stack Overflow çš„ç›¸å…³è®¨è®ºï¼šCan&rsquo;t debug using lldb on Apple M1 over SSH
&ldquo;While this doesn&rsquo;t solve your answer, I ran into this exact error with macOS 12.3 on Intel silicon and using sudo DevToolsSecurity -enable solved it for me. After that, I was able to run lldb inside tmux through ssh.&rdquo; â€“ penguin359
æ€»ç»“ é€šè¿‡æ‰§è¡Œ sudo DevToolsSecurity -enable å‘½ä»¤ï¼Œå¯ä»¥æˆåŠŸè§£å†³åœ¨ M1 Mac ä¸Šé€šè¿‡ SSH å’Œç»ˆç«¯å¤ç”¨å™¨ä½¿ç”¨ LLDB è°ƒè¯•æ—¶çš„æƒé™é—®é¢˜ã€‚è¿™ä¸ªæ–¹æ³•ç®€å•æœ‰æ•ˆï¼Œä¸éœ€è¦å¤æ‚çš„é…ç½®ã€‚
`,url:"https://hugo-dead-simple.netlify.com/blog/%E8%A7%A3%E5%86%B3m1%E4%B8%8Blldb%E4%B8%8D%E8%83%BD%E8%B0%83%E8%AF%95%E7%9A%84%E9%97%AE%E9%A2%98.html"},"https://hugo-dead-simple.netlify.com/tags/%E8%B0%83%E8%AF%95.html":{title:"è°ƒè¯•",tags:[],content:"",url:"https://hugo-dead-simple.netlify.com/tags/%E8%B0%83%E8%AF%95.html"},"https://hugo-dead-simple.netlify.com/tags/zellij.html":{title:"Zellij",tags:[],content:"",url:"https://hugo-dead-simple.netlify.com/tags/zellij.html"},"https://hugo-dead-simple.netlify.com/blog/zellij%E4%BD%BF%E7%94%A8%E5%85%A5%E9%97%A8.html":{title:"zellijä½¿ç”¨å…¥é—¨",tags:["å·¥å…·","ç»ˆç«¯","zellij"],content:` å®˜ç½‘ èµ·å› : æˆ‘ä¸æƒ³å†ä½¿ç”¨tmux ,å› ä¸ºå®ƒé…ç½®èµ·æ¥å¾ˆéº»çƒ¦, è€Œä¸”å¿«æ·é”®ä¹Ÿéœ€è¦å¤§é‡çš„å®šåˆ¶æ‰èƒ½ç”¨å¾—é¡ºæ‰‹. åœ¨å¯»æ‰¾æ›¿ä»£å“çš„è¿‡ç¨‹ä¸­, æˆ‘å‘ç°äº† Zellij, ä¸€ä¸ªç°ä»£çš„ç»ˆç«¯å¤šè·¯å¤ç”¨å™¨, å®ƒå¼€ç®±å³ç”¨, åŠŸèƒ½å¼ºå¤§ä¸”æ˜“äºä¸Šæ‰‹.
ä»€ä¹ˆæ˜¯ Zellij? Zellij æ˜¯ä¸€ä¸ªä¸ºå¼€å‘è€…ã€è¿ç»´å·¥ç¨‹å¸ˆå’Œæ‰€æœ‰ç»ˆç«¯çˆ±å¥½è€…è®¾è®¡çš„ç»ˆç«¯å·¥ä½œåŒº. å®ƒå†…ç½®äº†å¸ƒå±€ç³»ç»Ÿã€æ ‡ç­¾é¡µå’Œå¼ºå¤§çš„å‘½ä»¤çª—æ ¼, è®©ä½ å¯ä»¥åœ¨ä¸€ä¸ªçª—å£ä¸­è½»æ¾ç®¡ç†å¤šä¸ªç»ˆç«¯ä¼šè¯. ä¸ tmux ç±»ä¼¼, å³ä½¿ä½ æ–­å¼€ SSH è¿æ¥, ä½ çš„ç»ˆç«¯ä¼šè¯ä¹Ÿä¼šä¿æŒè¿è¡Œ.
å®‰è£… åœ¨ macOS ä¸Š, ä½ å¯ä»¥ä½¿ç”¨ Homebrew è½»æ¾å®‰è£…:
1brew install zellij å¯¹äºå…¶ä»–æ“ä½œç³»ç»Ÿ, è¯·å‚è€ƒå®˜æ–¹å®‰è£…æ–‡æ¡£.
å¿«é€Ÿå…¥é—¨ å¯åŠ¨å’Œé€€å‡º ç›´æ¥åœ¨ç»ˆç«¯ä¸­è¾“å…¥ zellij å³å¯å¯åŠ¨ä¸€ä¸ªæ–°çš„ä¼šè¯:
1zellij ä½ ä¼šçœ‹åˆ° Zellij çš„ç•Œé¢, åº•éƒ¨æœ‰ä¸€æ¡çŠ¶æ€æ , æ˜¾ç¤ºäº†å½“å‰çš„æ¨¡å¼å’Œä¸€äº›æœ‰ç”¨çš„æç¤º.
è¦é€€å‡º Zellij, ä½ å¯ä»¥:
åœ¨æ‰€æœ‰çª—æ ¼ä¸­è¾“å…¥ exit æ¥å…³é—­å®ƒä»¬. ä½¿ç”¨å¿«æ·é”® Ctrl + q, ç„¶åæŒ‰ y ç¡®è®¤. åˆ†ç¦» (Detach) å’Œæ¢å¤ (Attach) ä¼šè¯ è¿™æ˜¯ç»ˆç«¯å¤šè·¯å¤ç”¨å™¨çš„æ ¸å¿ƒåŠŸèƒ½. ä½ å¯ä»¥åœ¨ä¸€ä¸ªä¼šè¯ä¸­å·¥ä½œ, ç„¶åå®‰å…¨åœ°æ–­å¼€å®ƒ, è®©ç¨‹åºåœ¨åå°ç»§ç»­è¿è¡Œ.
åˆ†ç¦»ä¼šè¯: åœ¨ä¼šè¯ä¸­æŒ‰ä¸‹ Ctrl + o, ç„¶åæŒ‰ d. åˆ—å‡ºæ‰€æœ‰ä¼šè¯: 1zellij list-sessions æ¢å¤ä¼šè¯: 1zellij attach &lt;SESSION_NAME&gt; åŸºæœ¬æ“ä½œ Zellij çš„ä¸€å¤§ä¼˜ç‚¹æ˜¯å…¶ç”¨æˆ·å‹å¥½çš„å¿«æ·é”®. å½“ä½ æŒ‰ä¸‹ Ctrl ç»„åˆé”®æ—¶, åº•éƒ¨æ ä¼šæç¤ºä½ æ¥ä¸‹æ¥å¯ä»¥æŒ‰å“ªäº›é”®.
çª—æ ¼ (Panes) ç®¡ç† Ctrl + p: è¿›å…¥çª—æ ¼ç®¡ç†æ¨¡å¼. n: åˆ›å»ºä¸€ä¸ªæ–°çª—æ ¼ (é»˜è®¤åœ¨å³ä¾§). d: åœ¨ä¸‹æ–¹åˆ›å»ºä¸€ä¸ªæ–°çª—æ ¼. h / j / k / l (æˆ–æ–¹å‘é”®): åœ¨çª—æ ¼ä¹‹é—´ç§»åŠ¨. x: å…³é—­å½“å‰çª—æ ¼. f: å…¨å±å½“å‰çª—æ ¼. [ / ]: åœ¨ä¸Šä¸€ä¸ª/ä¸‹ä¸€ä¸ªæ´»åŠ¨çª—æ ¼ä¹‹é—´åˆ‡æ¢. æ ‡ç­¾é¡µ (Tabs) ç®¡ç† Ctrl + t: è¿›å…¥æ ‡ç­¾é¡µç®¡ç†æ¨¡å¼. n: åˆ›å»ºä¸€ä¸ªæ–°æ ‡ç­¾é¡µ. h / l (æˆ–æ–¹å‘é”®): åœ¨æ ‡ç­¾é¡µä¹‹é—´åˆ‡æ¢. x: å…³é—­å½“å‰æ ‡ç­¾é¡µ. æ»šåŠ¨å’Œæœç´¢ Ctrl + s: è¿›å…¥æ»šåŠ¨æ¨¡å¼. ä½ å¯ä»¥ä½¿ç”¨ k / j æˆ– PageUp / PageDown æ¥ä¸Šä¸‹æ»šåŠ¨. åœ¨æ»šåŠ¨æ¨¡å¼ä¸‹, è¾“å…¥ / å¯ä»¥è¿›è¡Œæœç´¢. é…ç½® Zellij çš„é…ç½®éå¸¸çµæ´»ï¼Œä½¿ç”¨ KDL è¯­è¨€ã€‚ä½ å¯ä»¥é€šè¿‡åˆ›å»ºä¸€ä¸ªé…ç½®æ–‡ä»¶æ¥è‡ªå®šä¹‰ Zellij çš„å‡ ä¹æ‰€æœ‰æ–¹é¢ï¼Œä»ä¸»é¢˜åˆ°å¿«æ·é”®å’Œå¸ƒå±€ã€‚
åˆ›å»ºé…ç½®æ–‡ä»¶ è¦å¼€å§‹é…ç½® Zellijï¼Œä½ éœ€è¦åˆ›å»ºä¸€ä¸ªé…ç½®æ–‡ä»¶ã€‚ä½ å¯ä»¥è®© Zellij ä¸ºä½ ç”Ÿæˆä¸€ä¸ªé»˜è®¤çš„é…ç½®æ–‡ä»¶ï¼š
1zellij setup --dump-config &gt; ~/.config/zellij/config.kdl è¿™ä¼šå°†é»˜è®¤é…ç½®å†™å…¥ ~/.config/zellij/config.kdl æ–‡ä»¶ä¸­ã€‚ç°åœ¨ä½ å¯ä»¥ç¼–è¾‘è¿™ä¸ªæ–‡ä»¶æ¥è‡ªå®šä¹‰ä½ çš„ Zellij ä½“éªŒã€‚
å¸¸ç”¨é…ç½®ç¤ºä¾‹ 1. æ›´æ”¹ä¸»é¢˜ Zellij å†…ç½®äº†å¤šæ¬¾ä¸»é¢˜ã€‚ä½ å¯ä»¥åœ¨é…ç½®æ–‡ä»¶ä¸­è®¾ç½® theme é€‰é¡¹æ¥æ›´æ”¹ä¸»é¢˜ã€‚ä¾‹å¦‚ï¼Œè¦ä½¿ç”¨ gruvbox-dark ä¸»é¢˜ï¼š
1// In ~/.config/zellij/config.kdl 2theme &#34;gruvbox-dark&#34; ä½ å¯ä»¥åœ¨å®˜æ–¹ä¸»é¢˜ä»“åº“æ‰¾åˆ°æ›´å¤šä¸»é¢˜ã€‚
2. è‡ªå®šä¹‰å¿«æ·é”® ä½ å¯ä»¥é‡æ–°ç»‘å®šå¿«æ·é”®ä»¥é€‚åº”ä½ çš„å·¥ä½œæµç¨‹ã€‚ä¾‹å¦‚, å¦‚æœä½ æƒ³å°†&quot;é”å®šç•Œé¢&quot;çš„å¿«æ·é”®ä» Ctrl + g æ”¹ä¸º Ctrl + l:
1// In ~/.config/zellij/config.kdl 2keybinds { 3 unbind &#34;Ctrl g&#34; 4 locked { 5 bind &#34;Ctrl l&#34; { Lock; } 6 } 7} 3. é»˜è®¤å¸ƒå±€ ä½ å¯ä»¥è®¾ç½® Zellij å¯åŠ¨æ—¶åŠ è½½çš„é»˜è®¤å¸ƒå±€ã€‚é¦–å…ˆï¼Œä½ éœ€è¦åˆ›å»ºä¸€ä¸ªå¸ƒå±€æ–‡ä»¶ï¼ˆä¾‹å¦‚ ~/.config/zellij/layouts/my-layout.kdlï¼‰ï¼Œç„¶ååœ¨é…ç½®æ–‡ä»¶ä¸­æŒ‡å®šå®ƒï¼š
1// In ~/.config/zellij/config.kdl 2default_layout &#34;my-layout&#34; Zellij çš„é…ç½®é€‰é¡¹éå¸¸ä¸°å¯Œï¼Œä½ å¯ä»¥æŸ¥é˜…å®˜æ–¹æ–‡æ¡£äº†è§£æ‰€æœ‰å¯ç”¨çš„é…ç½®é¡¹ã€‚
å¸ƒå±€ ä¸€ä¸ªä¾‹å­ 1// layout_file.kdl 2 3layout { 4 pane 5 pane split_direction=&#34;vertical&#34; { 6 pane 7 pane command=&#34;htop&#34; 8 } 9} å¯¼å‡ºä¸€ä¸ªé»˜è®¤å¸ƒå±€ 1zellij setup --dump-layout default &gt; /tmp/my-quickstart-layout-file.kdl åˆ›å»ºä¸€ä¸ªè‡ªå·±çš„å¸ƒå±€\` ä¿®æ”¹é»˜è®¤çš„float panel çš„å¤§å° é»˜è®¤çš„float å¸ƒå±€,å¯¹æˆ‘æ¥è¯´ï¼Œå¤ªå°äº†æˆ‘å¸Œæœ›æŠŠå®ƒæ”¹å¤§ä¸€ç‚¹
ä¸ºä»€ä¹ˆé€‰æ‹© Zellij? å¼€ç®±å³ç”¨: é»˜è®¤é…ç½®å’Œå¿«æ·é”®éå¸¸ç›´è§‚, æ— éœ€åƒ tmux é‚£æ ·è¿›è¡Œå¤§é‡é…ç½®. ç”¨æˆ·å‹å¥½: çŠ¶æ€æ ä¼šæ ¹æ®ä½ æŒ‰ä¸‹çš„é”®æä¾›ä¸Šä¸‹æ–‡æç¤º, æå¤§åœ°é™ä½äº†å­¦ä¹ æˆæœ¬. å†…ç½®å¸ƒå±€: Zellij æ‹¥æœ‰å¼ºå¤§çš„å¸ƒå±€ç³»ç»Ÿ, å¯ä»¥ä¿å­˜å’ŒåŠ è½½å¤æ‚çš„çª—æ ¼å¸ƒå±€. WebAssembly æ’ä»¶: æ”¯æŒä½¿ç”¨ä»»ä½•å¯ä»¥ç¼–è¯‘ä¸º WASM çš„è¯­è¨€ç¼–å†™æ’ä»¶, æ‰©å±•æ€§å¼º. æ€»ç»“ Zellij æ˜¯ä¸€ä¸ªå‡ºè‰²çš„ tmux æ›¿ä»£å“, ç‰¹åˆ«æ˜¯å¯¹äºé‚£äº›åŒå€¦äº†å¤æ‚é…ç½®å¹¶å¸Œæœ›è·å¾—ç°ä»£åŒ–ç»ˆç«¯ä½“éªŒçš„ç”¨æˆ·. å®ƒè®©ä½ èƒ½å¤Ÿæ›´ä¸“æ³¨äºå·¥ä½œæœ¬èº«, è€Œä¸æ˜¯å·¥å…·çš„é…ç½®. å¦‚æœä½ è¿˜åœ¨ä½¿ç”¨ tmux æˆ–è€…æ­£åœ¨å¯»æ‰¾ä¸€ä¸ªç»ˆç«¯å¤šè·¯å¤ç”¨å™¨, æˆ‘å¼ºçƒˆå»ºè®®ä½ è¯•è¯• Zellij.
`,url:"https://hugo-dead-simple.netlify.com/blog/zellij%E4%BD%BF%E7%94%A8%E5%85%A5%E9%97%A8.html"},"https://hugo-dead-simple.netlify.com/tags/%E5%B7%A5%E5%85%B7.html":{title:"å·¥å…·",tags:[],content:"",url:"https://hugo-dead-simple.netlify.com/tags/%E5%B7%A5%E5%85%B7.html"},"https://hugo-dead-simple.netlify.com/tags/%E7%BB%88%E7%AB%AF.html":{title:"ç»ˆç«¯",tags:[],content:"",url:"https://hugo-dead-simple.netlify.com/tags/%E7%BB%88%E7%AB%AF.html"},"https://hugo-dead-simple.netlify.com/tags/tmux.html":{title:"Tmux",tags:[],content:"",url:"https://hugo-dead-simple.netlify.com/tags/tmux.html"},"https://hugo-dead-simple.netlify.com/blog/tmux%E5%B8%B8%E7%94%A8%E5%BF%AB%E6%8D%B7%E9%94%AE.html":{title:"Tmux å¿«æ·é”®é€ŸæŸ¥è¡¨",tags:["tmux","å·¥å…·"],content:`æœ¬æ–‡æ¡£æ ¹æ®æˆ‘çš„ tmux.conf é…ç½®æ–‡ä»¶ æ•´ç†è€Œæˆã€‚
å‰ç¼€é”® (Prefix) æ‰€æœ‰ tmux å‘½ä»¤éƒ½éœ€è¦å…ˆæŒ‰ä¸‹ä¸€ä¸ªå‰ç¼€é”®ã€‚ä½ çš„é…ç½®ä¸­ä¿ç•™äº†é»˜è®¤çš„å‰ç¼€é”®ã€‚
å‰ç¼€é”®: Ctrl + b ä¸‹æ–‡ä¸­ï¼Œå‰ç¼€ æŒ‡çš„å°±æ˜¯å…ˆæŒ‰ä¸‹ Ctrl + b ç»„åˆé”®ã€‚
ä¼šè¯ä¸çª—å£ç®¡ç† å¿«æ·é”® åŠŸèƒ½ å‰ç¼€ c åœ¨å½“å‰è·¯å¾„åˆ›å»ºä¸€ä¸ªæ–°çª—å£ å‰ç¼€ , é‡å‘½åå½“å‰çª—å£ å‰ç¼€ &amp; å…³é—­å½“å‰çª—å£ï¼ˆä¼šæœ‰ç¡®è®¤æç¤ºï¼‰ å‰ç¼€ p åˆ‡æ¢åˆ°ä¸Šä¸€ä¸ªçª—å£ å‰ç¼€ n åˆ‡æ¢åˆ°ä¸‹ä¸€ä¸ªçª—å£ å‰ç¼€ [æ•°å­—] åˆ‡æ¢åˆ°æŒ‡å®šç¼–å·çš„çª—å£ (å¦‚ å‰ç¼€ 1) å‰ç¼€ &lt; å°†å½“å‰çª—å£å‘å·¦ç§»åŠ¨ä¸€ä¸ªä½ç½® å‰ç¼€ &gt; å°†å½“å‰çª—å£å‘å³ç§»åŠ¨ä¸€ä¸ªä½ç½® å‰ç¼€ d åˆ†ç¦» (Detach) å½“å‰ä¼šè¯ï¼Œè¿”å›ç»ˆç«¯ å‰ç¼€ Ctrl x å…³é—­æ•´ä¸ªä¼šè¯ (ä¼šæœ‰ç¡®è®¤æç¤º) é¢æ¿ (Pane) ç®¡ç† é¢æ¿åˆ†å‰² å¿«æ·é”® åŠŸèƒ½ å‰ç¼€ \` (æˆ–%\`) å‰ç¼€ - (æˆ– &quot;) å‚ç›´åˆ†å‰²ï¼Œåœ¨å½“å‰é¢æ¿ä¸‹æ–¹åˆ›å»ºä¸€ä¸ªæ–°é¢æ¿ å‰ç¼€ \\ æ°´å¹³åˆ†å‰²ï¼Œæ–°é¢æ¿å æ»¡æ•´ä¸ªçª—å£é«˜åº¦ å‰ç¼€ _ å‚ç›´åˆ†å‰²ï¼Œæ–°é¢æ¿å æ»¡æ•´ä¸ªçª—å£å®½åº¦ æ³¨æ„ï¼šæ‰€æœ‰æ–°åˆ†å‰²çš„é¢æ¿éƒ½ä¼šåœ¨å½“å‰é¢æ¿çš„è·¯å¾„ä¸‹æ‰“å¼€ã€‚
é¢æ¿å¯¼èˆª ä½¿ç”¨ Vim é£æ ¼çš„æŒ‰é”®åœ¨é¢æ¿é—´ç§»åŠ¨ã€‚
å¿«æ·é”® åŠŸèƒ½ å‰ç¼€ h (æˆ– Ctrl+h) ç§»åŠ¨åˆ°å·¦è¾¹çš„é¢æ¿ å‰ç¼€ j (æˆ– Ctrl+j) ç§»åŠ¨åˆ°ä¸‹è¾¹çš„é¢æ¿ å‰ç¼€ k (æˆ– Ctrl+k) ç§»åŠ¨åˆ°ä¸Šè¾¹çš„é¢æ¿ å‰ç¼€ l (æˆ– Ctrl+l) ç§»åŠ¨åˆ°å³è¾¹çš„é¢æ¿ é¢æ¿è°ƒæ•´ä¸äº¤æ¢ å¿«æ·é”® åŠŸèƒ½ å‰ç¼€ H (å¤§å†™) å‘å·¦æ‰©å±•é¢æ¿ 5 ä¸ªå•å…ƒæ ¼ å‰ç¼€ J (å¤§å†™) å‘ä¸‹æ‰©å±•é¢æ¿ 5 ä¸ªå•å…ƒæ ¼ å‰ç¼€ K (å¤§å†™) å‘ä¸Šæ‰©å±•é¢æ¿ 5ä¸ªå•å…ƒæ ¼ å‰ç¼€ L (å¤§å†™) å‘å³æ‰©å±•é¢æ¿ 5 ä¸ªå•å…ƒæ ¼ å‰ç¼€ Ctrl u ä¸ä¸Šä¸€ä¸ªé¢æ¿äº¤æ¢ä½ç½® å‰ç¼€ Ctrl d ä¸ä¸‹ä¸€ä¸ªé¢æ¿äº¤æ¢ä½ç½® å‰ç¼€ z ç¼©æ”¾ (Zoom) å½“å‰é¢æ¿è‡³å…¨å±/æ¢å¤ å‰ç¼€ x å…³é—­å½“å‰é¢æ¿ å¤åˆ¶æ¨¡å¼ä¸å‰ªè´´æ¿ ä½ çš„é…ç½®å¼€å¯äº†é¼ æ ‡æ¨¡å¼å’Œ vi é£æ ¼çš„å¤åˆ¶æ¨¡å¼ï¼Œå¹¶é›†æˆäº†ç³»ç»Ÿå‰ªè´´æ¿ã€‚
å¿«æ·é”® / æ“ä½œ åŠŸèƒ½ å‰ç¼€ [ è¿›å…¥å¤åˆ¶æ¨¡å¼ é¼ æ ‡æ»šè½® åœ¨é¢æ¿ä¸­å‘ä¸Š/ä¸‹æ»šåŠ¨ v (åœ¨å¤åˆ¶æ¨¡å¼ä¸­) å¼€å§‹é€‰æ‹©æ–‡æœ¬ y (åœ¨å¤åˆ¶æ¨¡å¼ä¸­) å¤åˆ¶é€‰ä¸­çš„æ–‡æœ¬åˆ° tmux å‰ªè´´æ¿ Ctrl c (åœ¨å¤åˆ¶æ¨¡å¼ä¸­) å¤åˆ¶é€‰ä¸­çš„æ–‡æœ¬åˆ°ç³»ç»Ÿå‰ªè´´æ¿ q é€€å‡ºå¤åˆ¶æ¨¡å¼ é¼ æ ‡åŒå‡» é€‰ä¸­å•è¯å¹¶å¤åˆ¶åˆ°ç³»ç»Ÿå‰ªè´´æ¿ é¼ æ ‡ä¸‰å‡» é€‰ä¸­æ•´è¡Œå¹¶å¤åˆ¶åˆ°ç³»ç»Ÿå‰ªè´´æ¿ å‰ç¼€ ] ç²˜è´´ tmux å‰ªè´´æ¿ä¸­çš„å†…å®¹ æ’ä»¶ç®¡ç† (TPM) å¿«æ·é”® åŠŸèƒ½ å‰ç¼€ I (å¤§å†™) å®‰è£… tmux.conf ä¸­åˆ—å‡ºçš„æ–°æ’ä»¶ å‰ç¼€ U (å¤§å†™) æ›´æ–°æ‰€æœ‰å·²å®‰è£…çš„æ’ä»¶ å‰ç¼€ alt u å¸è½½ tmux.conf ä¸­å·²ç§»é™¤çš„æ’ä»¶ å…¶ä»– å¿«æ·é”® åŠŸèƒ½ å‰ç¼€ Ctrl s åˆ‡æ¢çŠ¶æ€æ çš„æ˜¾ç¤º/éšè— å‰ç¼€ ? æ˜¾ç¤ºæ‰€æœ‰å¿«æ·é”®ç»‘å®šåˆ—è¡¨ `,url:"https://hugo-dead-simple.netlify.com/blog/tmux%E5%B8%B8%E7%94%A8%E5%BF%AB%E6%8D%B7%E9%94%AE.html"},"https://hugo-dead-simple.netlify.com/nvim-for-oi/luasnip.html":{title:"LuaSnip",tags:[""],content:` github : https://github.com/L3MON4D3/LuaSnip æ–‡æ¡£ https://github.com/L3MON4D3/LuaSnip/blob/master/DOC.md ä¸­æ–‡æ–‡æ¡£: https://zjp-cn.github.io/neovim0.6-blogs/nvim/luasnip/doc1.html example lua snip : https://github.com/L3MON4D3/LuaSnip/blob/master/Examples/snippets.lua åŸºç¡€ åœ¨ LuaSnip ä¸­ï¼Œä»£ç ç‰‡æ®µç”±èŠ‚ç‚¹ (nodes) ç»„æˆã€‚èŠ‚ç‚¹åˆ†ç±»ï¼š
textNodeï¼šé™æ€æ–‡æœ¬ insertNodeï¼šå¯ç¼–è¾‘çš„æ–‡æœ¬ functionNodeï¼šå‡½æ•°èŠ‚ç‚¹ï¼Œå¯ä»å…¶ä»–èŠ‚ç‚¹çš„å†…å®¹ç”Ÿæˆçš„æ–‡æœ¬ å…¶ä»–èŠ‚ç‚¹ choiceNodeï¼šåœ¨ä¸¤ä¸ªèŠ‚ç‚¹ï¼ˆæˆ–æ›´å¤šèŠ‚ç‚¹ï¼‰ä¹‹é—´è¿›è¡Œé€‰æ‹© restoreNodeï¼šå­˜å‚¨å’Œæ¢å¤åˆ°èŠ‚ç‚¹çš„è¾“å…¥ dynamicNodeï¼šåŠ¨æ€èŠ‚ç‚¹ï¼ŒåŸºäºè¾“å…¥ç”Ÿæˆçš„èŠ‚ç‚¹ é€šå¸¸ä½¿ç”¨ s(trigger:string, nodes:table) å½¢å¼çš„å‡½æ•°åˆ›å»ºä»£ç ç‰‡æ®µã€‚
`,url:"https://hugo-dead-simple.netlify.com/nvim-for-oi/luasnip.html"},"https://hugo-dead-simple.netlify.com/tags/lua.html":{title:"Lua",tags:[],content:"",url:"https://hugo-dead-simple.netlify.com/tags/lua.html"},"https://hugo-dead-simple.netlify.com/program_language/lua/lua%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1.html":{title:"Luaä¸­çš„é¢å‘å¯¹è±¡ç¼–ç¨‹",tags:["lua"],content:`å—¨ï¼å¾ˆé«˜å…´èƒ½å’Œä½ ä¸€èµ·æ¢ç´¢Luaè¿™é—¨ä¼˜é›…ä¸”å¼ºå¤§çš„è¯­è¨€ã€‚ä½ å¯èƒ½çŸ¥é“ï¼ŒLuaå¤©ç”Ÿå¹¶æ²¡æœ‰åƒJavaæˆ–C++é‚£æ ·çš„å†…ç½®ç±»å’Œå¯¹è±¡ç³»ç»Ÿã€‚ä½†åˆ«æ‹…å¿ƒï¼Œè¿™æ­£æ˜¯å®ƒçš„é­…åŠ›æ‰€åœ¨ï¼è¿™é—¨è¯­è¨€æä¾›äº†æå…¶çµæ´»çš„å…ƒç¼–ç¨‹æœºåˆ¶ï¼Œè®©æˆ‘ä»¬èƒ½å¤Ÿä»é›¶å¼€å§‹ï¼Œäº²æ‰‹æ„å»ºä¸€ä¸ªå±äºè‡ªå·±çš„é¢å‘å¯¹è±¡ï¼ˆObject-Oriented Programmingï¼Œç®€ç§°OOPï¼‰ä¸–ç•Œã€‚
è¿™ç¯‡åšå®¢å°†å¸¦ä½ æ·±å…¥ç†è§£Luaä¸­å®ç°OOPçš„å‡ ç§æ ¸å¿ƒæ€æƒ³ï¼Œä»æœ€åŸºç¡€çš„è¡¨ï¼ˆtableï¼‰å’Œå…ƒè¡¨ï¼ˆmetatableï¼‰ï¼Œåˆ°å®ç”¨çš„ç»§æ‰¿å’Œå¤šæ€ã€‚å‡†å¤‡å¥½äº†å—ï¼Ÿè®©æˆ‘ä»¬å¼€å§‹å§ï¼
æ ¸å¿ƒæ¦‚å¿µï¼šè¡¨ã€å…ƒè¡¨å’Œ__index åœ¨Luaä¸­ï¼Œä¸€åˆ‡çš†è¡¨ã€‚è¡¨æ˜¯Luaä¸­å”¯ä¸€çš„æ•°æ®ç»“æ„ï¼Œå®ƒæ—¢å¯ä»¥æ˜¯æ•°ç»„ï¼Œä¹Ÿå¯ä»¥æ˜¯å“ˆå¸Œè¡¨ã€‚è€Œå®ç°OOPçš„å…³é”®ï¼Œå°±åœ¨äºå¦‚ä½•åˆ©ç”¨å…ƒè¡¨æ¥èµ‹äºˆè¡¨æ–°çš„è¡Œä¸ºã€‚
ä½ å¯ä»¥æŠŠå…ƒè¡¨æƒ³è±¡æˆä¸€ä¸ªè¡¨çš„â€œé…ç½®æ–‡ä»¶â€æˆ–è€…â€œè¡Œä¸ºè“å›¾â€ã€‚å½“ä½ åœ¨ä¸€ä¸ªè¡¨ä¸Šæ‰§è¡ŒæŸä¸ªæ“ä½œï¼ˆæ¯”å¦‚è®¿é—®ä¸€ä¸ªä¸å­˜åœ¨çš„é”®ï¼‰æ—¶ï¼Œå¦‚æœè¿™ä¸ªè¡¨è®¾ç½®äº†å…ƒè¡¨ï¼ŒLuaå°±ä¼šå»å…ƒè¡¨ä¸­æŸ¥æ‰¾å¯¹åº”çš„ç‰¹æ®Šå­—æ®µï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸ºå…ƒæ–¹æ³•ï¼ˆmetamethodï¼‰ã€‚
å®ç°OOPï¼Œæˆ‘ä»¬ä¸»è¦å…³æ³¨ä¸€ä¸ªå…ƒæ–¹æ³•ï¼š__indexã€‚
__indexçš„ç¥å¥‡ä¹‹å¤„åœ¨äºï¼šå½“ä½ æƒ³åœ¨ä¸€ä¸ªè¡¨ä¸­è®¿é—®ä¸€ä¸ªä¸å­˜åœ¨çš„é”®æ—¶ï¼ŒLuaä¸ä¼šç›´æ¥è¿”å›nilï¼Œè€Œæ˜¯ä¼šå»è¿™ä¸ªè¡¨çš„å…ƒè¡¨ä¸­ï¼ŒæŸ¥æ‰¾__indexå­—æ®µã€‚
å¦‚æœ__indexæ˜¯ä¸€ä¸ªè¡¨ï¼ŒLuaå°±ä¼šåœ¨è¿™ä¸ªè¡¨ä¸­ç»§ç»­æŸ¥æ‰¾è¿™ä¸ªé”®ã€‚ å¦‚æœ__indexæ˜¯ä¸€ä¸ªå‡½æ•°ï¼ŒLuaå°±ä¼šè°ƒç”¨è¿™ä¸ªå‡½æ•°ï¼Œå¹¶æŠŠåŸå§‹çš„è¡¨å’Œé”®ä½œä¸ºå‚æ•°ä¼ å…¥ã€‚ æˆ‘ä»¬ä¸»è¦åˆ©ç”¨ç¬¬ä¸€ç§æƒ…å†µæ¥å®ç°â€œç»§æ‰¿â€çš„è¡Œä¸ºã€‚
å‚è€ƒ lua 5.3 ä¸­æ–‡æ‰‹å†Œ 2.4 â€“ å…ƒè¡¨åŠå…ƒæ–¹æ³• æ–¹æ¡ˆä¸€ï¼šåŸºç¡€çš„åŸºäºè¡¨çš„OOP è¿™æ˜¯æœ€ç®€å•ï¼Œä¹Ÿæ˜¯æœ€å¸¸è§çš„å®ç°æ–¹å¼ã€‚æˆ‘ä»¬åˆ©ç”¨__indexæŒ‡å‘ä¸€ä¸ªåŸå‹è¡¨ï¼ˆprototype tableï¼‰ï¼Œè¿™ä¸ªåŸå‹è¡¨å°±åƒæ˜¯æˆ‘ä»¬çš„â€œç±»â€ï¼Œé‡Œé¢å­˜æ”¾ç€æ‰€æœ‰å¯¹è±¡å…±äº«çš„æ–¹æ³•ã€‚
è®©æˆ‘ä»¬æ¥åˆ›å»ºä¸€ä¸ªç®€å•çš„Vector2ç±»ï¼Œä»£è¡¨äºŒç»´å‘é‡ã€‚
1-- Vector2.lua 2local Vector2 = {} -- æˆ‘ä»¬çš„â€œç±»â€åŸå‹è¡¨ 3Vector2.__index = Vector2 -- å…³é”®æ­¥éª¤ï¼šè®¾ç½®å…ƒè¡¨ï¼ŒæŒ‡å‘è‡ªèº« 4 5function Vector2.new(x, y) 6 local self = {x = x, y = y} -- åˆ›å»ºå®ä¾‹ 7 setmetatable(self, Vector2) -- è®¾ç½®å®ä¾‹çš„å…ƒè¡¨ä¸ºVector2 8 return self 9end 10 11function Vector2:add(other) 12 -- æ³¨æ„ï¼šè¿™é‡Œçš„å†’å·è¯­æ³•ç³–ä¼šæŠŠselfä½œä¸ºç¬¬ä¸€ä¸ªå‚æ•°ä¼ å…¥ 13 return Vector2.new(self.x + other.x, self.y + other.y) 14end 15 16function Vector2:tostring() 17 return string.format(&#34;Vector2(%f, %f)&#34;, self.x, self.y) 18end 19 20local v1 = Vector2.new(1, 2) 21local v2 = Vector2.new(3, 4) 22 23local v3 = v1:add(v2) 24 25print(v3:tostring()) -- è¾“å‡ºï¼šVector2(4.000000, 6.000000) å‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ
æˆ‘ä»¬é¦–å…ˆåˆ›å»ºäº†ä¸€ä¸ªVector2è¡¨ï¼Œå®ƒå°†ä½œä¸ºæˆ‘ä»¬çš„ç±»å’ŒåŸå‹ã€‚ Vector2.__index = Vector2æ˜¯æ ¸å¿ƒã€‚å½“æˆ‘ä»¬é€šè¿‡v1:add(v2)è°ƒç”¨addæ–¹æ³•æ—¶ï¼ŒLuaå‘ç°v1ä¸­æ²¡æœ‰addé”®ã€‚ äºæ˜¯ï¼Œå®ƒä¼šå»v1çš„å…ƒè¡¨ï¼ˆä¹Ÿå°±æ˜¯Vector2ï¼‰ä¸­æŸ¥æ‰¾__indexã€‚ __indexæŒ‡å‘äº†Vector2è‡ªèº«ï¼Œæ‰€ä»¥Luaåœ¨Vector2ä¸­æ‰¾åˆ°äº†addæ–¹æ³•å¹¶è°ƒç”¨äº†å®ƒã€‚ Vector2:addè¯­æ³•ç³–ä¼šæŠŠv1ä½œä¸ºselfå‚æ•°ä¼ å…¥ï¼Œå®ç°äº†æ–¹æ³•è°ƒç”¨ã€‚ è¿™ç§æ–¹å¼çš„ä¼˜ç‚¹æ˜¯ç®€å•æ˜äº†ï¼Œå®¹æ˜“ç†è§£ã€‚ç¼ºç‚¹æ˜¯å½“ä½ çš„ç±»å’Œç»§æ‰¿å…³ç³»å˜å¾—å¤æ‚æ—¶ï¼Œç®¡ç†èµ·æ¥å¯èƒ½ä¼šæœ‰äº›æ··ä¹±ã€‚
æ–¹æ¡ˆäºŒï¼šè¿›é˜¶çš„å¤šå±‚ç»§æ‰¿ ç°åœ¨ï¼Œæˆ‘ä»¬æ¥è®©äº‹æƒ…å˜å¾—æ›´æœ‰è¶£ä¸€äº›ã€‚å‡è®¾æˆ‘ä»¬æƒ³åˆ›å»ºä¸€ä¸ªCreatureç±»ï¼Œç„¶åè®©Heroå’ŒMonsterç»§æ‰¿å®ƒã€‚
å¤šå±‚ç»§æ‰¿çš„å…³é”®åœ¨äºï¼Œå­ç±»çš„__indexå…ƒæ–¹æ³•è¦æŒ‡å‘çˆ¶ç±»ã€‚
1-- Creature.lua 2local Creature = {} 3Creature.__index = Creature 4 5function Creature.new(name, health) 6 local self = {name = name, health = health} 7 setmetatable(self, Creature) 8 return self 9end 10 11function Creature:speak(message) 12 print(self.name .. &#34; says: &#34; .. message) 13end 14 15-- Hero.luaï¼Œç»§æ‰¿è‡ªCreature 16local Hero = {} 17setmetatable(Hero, {__index = Creature}) -- Heroçš„å…ƒè¡¨æŒ‡å‘Creature 18 19function Hero.new(name, health, level) 20 -- å…ˆåˆ›å»ºçˆ¶ç±»å®ä¾‹ 21 local self = Creature.new(name, health) 22 -- å†æ·»åŠ å­ç±»ç‰¹æœ‰çš„å±æ€§ 23 self.level = level 24 -- å…³é”®ï¼šç”¨Heroçš„å…ƒè¡¨æ›¿æ¢çˆ¶ç±»çš„å…ƒè¡¨ 25 setmetatable(self, Hero) 26 return self 27end 28 29function Hero:attack(target) 30 self:speak(&#34;Take that!&#34;) -- è°ƒç”¨çˆ¶ç±»æ–¹æ³• 31 print(self.name .. &#34; attacks &#34; .. target.name .. &#34; with level &#34; .. self.level) 32end 33 34local hero = Hero.new(&#34;Arthur&#34;, 100, 10) 35local monster = Creature.new(&#34;Goblin&#34;, 50) 36 37hero:speak(&#34;I&#39;m here!&#34;) -- çˆ¶ç±»æ–¹æ³• 38hero:attack(monster) -- å­ç±»æ–¹æ³• å‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ
æˆ‘ä»¬ç»™Heroè¡¨è®¾ç½®äº†ä¸€ä¸ªå…ƒè¡¨ï¼Œå®ƒçš„__indexæŒ‡å‘Creatureã€‚è¿™å°±åƒæ˜¯è¯´ï¼šâ€œå¦‚æœHeroé‡Œæ‰¾ä¸åˆ°æŸä¸ªæ–¹æ³•ï¼Œå°±å»Creatureé‡Œæ‰¾ã€‚â€ åœ¨Hero.newä¸­ï¼Œæˆ‘ä»¬å…ˆç”¨Creature.newåˆ›å»ºäº†ä¸€ä¸ªå®ä¾‹ï¼Œå®ƒç»§æ‰¿äº†Creatureçš„å…ƒè¡¨ã€‚ ç„¶åï¼Œæˆ‘ä»¬æŠŠè¿™ä¸ªå®ä¾‹çš„å…ƒè¡¨æ›¿æ¢æˆäº†Heroã€‚ å½“è°ƒç”¨hero:attackæ—¶ï¼ŒLuaåœ¨heroä¸­æ‰¾åˆ°äº†attackæ–¹æ³•ã€‚ å½“è°ƒç”¨self:speakæ—¶ï¼ŒLuaåœ¨heroä¸­æ‰¾ä¸åˆ°speakï¼Œäºæ˜¯å»heroçš„å…ƒè¡¨ï¼ˆHeroï¼‰ä¸­æŸ¥æ‰¾__indexã€‚ Heroçš„å…ƒè¡¨æŒ‡å‘äº†Creatureï¼Œæ‰€ä»¥Luaåœ¨Creatureä¸­æ‰¾åˆ°äº†speakæ–¹æ³•ã€‚å®Œç¾ï¼ è¿™å°±æ˜¯å¤šå±‚ç»§æ‰¿åœ¨Luaä¸­çš„å®ç°æ–¹å¼ï¼Œé€šè¿‡å…ƒè¡¨å±‚å±‚åµŒå¥—ï¼Œå½¢æˆä¸€ä¸ªæŸ¥æ‰¾é“¾ï¼Œå®ç°äº†ç±»ä¼¼åŸå‹é“¾ç»§æ‰¿çš„è¡Œä¸ºã€‚
æ–¹æ¡ˆä¸‰ï¼šæ›´ä¼˜é›…çš„å®ç°ï¼šä½¿ç”¨é—­åŒ…å’Œç§æœ‰å˜é‡ è™½ç„¶ä¸Šé¢çš„æ–¹æ¡ˆèƒ½å¾ˆå¥½åœ°å·¥ä½œï¼Œä½†æ‰€æœ‰çš„å±æ€§éƒ½æ˜¯å…¬å¼€çš„ï¼Œè¿™åœ¨ä¸€äº›æƒ…å†µä¸‹å¯èƒ½ä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„ã€‚æˆ‘ä»¬å¯ä»¥åˆ©ç”¨Luaçš„**é—­åŒ…ï¼ˆclosureï¼‰**ç‰¹æ€§æ¥åˆ›å»ºç§æœ‰å˜é‡ã€‚
1local function create_vector2(x, y) 2 -- è¿™é‡Œçš„xå’Œyæ˜¯ç§æœ‰å˜é‡ 3 4 local self = {} -- å®ä¾‹è¡¨ 5 6 function self.add(other) 7 return create_vector2(x + other.x, y + other.y) 8 end 9 10 function self.tostring() 11 return string.format(&#34;Vector2(%f, %f)&#34;, x, y) 12 end 13 14 -- æä¾›ä¸€ä¸ªå…¬å¼€çš„è®¿é—®å™¨ï¼Œä»¥ä¾¿å¤–éƒ¨è·å–xå’Œyçš„å€¼ 15 self.get_x = function() return x end 16 self.get_y = function() return y end 17 18 return self 19end 20 21local v1 = create_vector2(1, 2) 22local v2 = create_vector2(3, 4) 23 24local v3 = v1.add(v2) 25 26print(v3.tostring()) -- è¾“å‡ºï¼šVector2(4.000000, 6.000000) 27-- print(v3.x) -- é”™è¯¯ï¼šè¯•å›¾è®¿é—®ç§æœ‰å˜é‡ è¿™ç§æ–¹æ¡ˆçš„ä¼˜ç‚¹åœ¨äºï¼š
ç§æœ‰æ€§ï¼šxå’Œyå˜é‡è¢«é—­åŒ…æ•è·ï¼Œå¤–éƒ¨æ— æ³•ç›´æ¥è®¿é—®ã€‚ ç›´è§‚ï¼šåˆ›å»ºå®ä¾‹çš„å‡½æ•°create_vector2æ›´åƒæ˜¯ä¼ ç»Ÿçš„æ„é€ å‡½æ•°ã€‚ ç¼ºç‚¹æ˜¯ï¼š
å†…å­˜å¼€é”€ï¼šæ¯ä¸ªå®ä¾‹éƒ½ä¼šåˆ›å»ºè‡ªå·±çš„ä¸€å¥—å‡½æ•°å‰¯æœ¬ï¼Œè€Œä¸æ˜¯å…±äº«ä¸€ä¸ªåŸå‹ã€‚è¿™åœ¨åˆ›å»ºå¤§é‡è½»é‡çº§å¯¹è±¡æ—¶å¯èƒ½ä¼šæœ‰æ€§èƒ½é—®é¢˜ã€‚ ä¸æ”¯æŒç»§æ‰¿ï¼šè¿™ç§æ–¹æ³•å¾ˆéš¾ä¼˜é›…åœ°å®ç°ç»§æ‰¿ã€‚ æ€»ç»“ä¸å»ºè®® æ–¹æ¡ˆ ä¼˜ç‚¹ ç¼ºç‚¹ é€‚ç”¨åœºæ™¯ åŸºäºå…ƒè¡¨ å†…å­˜é«˜æ•ˆï¼ˆæ–¹æ³•å…±äº«ï¼‰ï¼Œçµæ´»ï¼Œæ”¯æŒç»§æ‰¿ éœ€è¦ç†è§£å…ƒè¡¨æœºåˆ¶ï¼Œä»£ç ç¨å¤æ‚ å¤§å¤šæ•°éœ€è¦OOPçš„åœºæ™¯ï¼Œç‰¹åˆ«æ˜¯æ¸¸æˆå¼€å‘å’Œæ¡†æ¶è®¾è®¡ åŸºäºé—­åŒ… æ˜“äºå®ç°ç§æœ‰å˜é‡ï¼Œä»£ç ç›´è§‚ å†…å­˜å¼€é”€å¤§ï¼Œä¸æ”¯æŒç»§æ‰¿ å°è§„æ¨¡ã€å¯¹å†…å­˜ä¸æ•æ„Ÿã€ä¸éœ€è¦ç»§æ‰¿çš„åœºæ™¯ å¯¹äºå¤§å¤šæ•°æƒ…å†µï¼Œæˆ‘å¼ºçƒˆå»ºè®®ä½¿ç”¨ç¬¬ä¸€ç§åŸºäºå…ƒè¡¨çš„æ–¹æ¡ˆã€‚å®ƒæ—¢é«˜æ•ˆåˆçµæ´»ï¼Œæ˜¯Luaç¤¾åŒºæœ€å¹¿æ³›ä½¿ç”¨çš„OOPå®ç°æ–¹å¼ã€‚ä¸€æ—¦ä½ ç†è§£äº†__indexçš„é­”æ³•ï¼Œä½ å°±èƒ½åœ¨Luaä¸­è½»æ¾æ„å»ºå‡ºå¼ºå¤§è€Œä¼˜é›…çš„å¯¹è±¡ç³»ç»Ÿã€‚
ç°åœ¨ï¼Œæ‹¿èµ·ä½ çš„ç¼–è¾‘å™¨ï¼Œå°è¯•è‡ªå·±æ„å»ºä¸€ä¸ªç©å®¶ã€æ•Œäººå’Œç‰©å“çš„ç®€å•ä¸–ç•Œå§ï¼ç›¸ä¿¡ä½ ä¼šåœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­å‘ç°Luaçš„ç‹¬ç‰¹é­…åŠ›ã€‚
å¦‚æœä½ å¯¹Luaä¸­çš„å…¶ä»–å…ƒæ–¹æ³•ï¼ˆæ¯”å¦‚__addã€__lenç­‰ï¼‰æ„Ÿå…´è¶£ï¼Œæˆ–è€…æƒ³äº†è§£æ›´é«˜çº§çš„OOPè®¾è®¡æ¨¡å¼ï¼Œæ¬¢è¿éšæ—¶ä¸æˆ‘äº¤æµã€‚ç¼–ç¨‹çš„ä¹è¶£ï¼Œå°±åœ¨äºä¸æ–­æ¢ç´¢å’Œåˆ›é€ ï¼
Bç«™è§†é¢‘ã€Luaã€‘å…ƒè¡¨ã€å…ƒæ–¹æ³•ã€é¢å‘å¯¹è±¡ `,url:"https://hugo-dead-simple.netlify.com/program_language/lua/lua%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1.html"},"https://hugo-dead-simple.netlify.com/nvim-for-oi/snack-learn.html":{title:"snack-leaern",tags:[""],content:"step 1 1-- learn/step1.lua 2-- ç›®æ ‡ï¼šç†è§£é€‰æ‹©å™¨çš„æœ€åŸºæœ¬å½¢æ€ï¼šè¾“å…¥ä¸€ä¸ªåˆ—è¡¨ï¼Œè¾“å‡ºç”¨æˆ·çš„é€‰æ‹©ã€‚ 3-- æŠ€æœ¯ç‚¹ï¼šä½¿ç”¨ Neovim å†…ç½®çš„ `vim.ui.select`ã€‚ 4 5local M = {} 6 7function M.run() 8 -- 1. å®šä¹‰æˆ‘ä»¬è¦é€‰æ‹©çš„æ•°æ® 9 local fruits = { &#34;Apple&#34;, &#34;Orange&#34;, &#34;Banana&#34;, &#34;Grape&#34; } 10 11 -- 2. è°ƒç”¨ `vim.ui.select`ï¼Œå®ƒä¼šå¼¹å‡ºä¸€ä¸ªUIè®©ç”¨æˆ·é€‰æ‹© 12 -- ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯æˆ‘ä»¬çš„æ•°æ®åˆ—è¡¨ 13 -- ç¬¬äºŒä¸ªå‚æ•°æ˜¯ä¸€ä¸ªé…ç½®è¡¨ï¼Œæˆ‘ä»¬åœ¨è¿™é‡Œå®šä¹‰äº†æç¤ºç¬¦ `prompt` 14 -- ç¬¬ä¸‰ä¸ªå‚æ•°æ˜¯ä¸€ä¸ªå›è°ƒå‡½æ•°(callback)ï¼Œå½“ç”¨æˆ·åšå‡ºé€‰æ‹©åï¼Œè¿™ä¸ªå‡½æ•°ä¼šè¢«æ‰§è¡Œ 15 vim.ui.select(fruits, { prompt = &#34;Select a fruit:&#34; }, function(choice) 16 -- `choice` å°±æ˜¯ç”¨æˆ·é€‰æ‹©çš„é¡¹ï¼Œå¦‚æœç”¨æˆ·æŒ‰ &lt;Esc&gt; å–æ¶ˆï¼Œ`choice` ä¼šæ˜¯ nil 17 if not choice then 18 print(&#34;Picker was cancelled.&#34;) 19 return 20 end 21 22 -- 3. åœ¨å‘½ä»¤è¡Œè¾“å‡ºç”¨æˆ·çš„é€‰æ‹© 23 print(&#34;You selected: &#34; .. choice) 24 end) 25end 26 27return M ",url:"https://hugo-dead-simple.netlify.com/nvim-for-oi/snack-learn.html"},"https://hugo-dead-simple.netlify.com/tags/nvim.html":{title:"Nvim",tags:[],content:"",url:"https://hugo-dead-simple.netlify.com/tags/nvim.html"},"https://hugo-dead-simple.netlify.com/nvim-for-oi/dap.html":{title:"nvim-dap",tags:["nvim"],content:`https://github.com/mfussenegger/nvim-dap
Debug Adapter Protocol client implementation for Neovim
å®‰è£… 1return { 2 &#34;mfussenegger/nvim-dap&#34;, 3 config = function() 4 end 5} Debug Adapter installation æˆ‘ä½¿ç”¨dap ui,æŒ‰æ–‡æ¡£,æˆ‘åœ¨linuxä¸‹ä½¿ç”¨ vscode-cpptools,åœ¨ macosä¸Šä½¿ç”¨ codelldb
linux ä¸‹å®‰è£… æ ¹æ®ç³»ç»Ÿåœ¨github cpp-tools releasesä¸‹è½½å¯¹åº”ç³»ç»Ÿçš„visx Unpack it. .vsix is a zip file and you can use unzip to extract the contents. Ensure extension/debugAdapters/bin/OpenDebugAD7 is executable. Adapter definition
1local dap = require(&#39;dap&#39;) 2dap.adapters.cppdbg = { 3 id = &#39;cppdbg&#39;, 4 type = &#39;executable&#39;, 5 command = &#39;/absolute/path/to/cpptools/extension/debugAdapters/bin/OpenDebugAD7&#39;, 6} Configuration The VSCode C/C++ documentation contains a full reference for all options supported by the debug adapter.
Common configuration examples:
1local dap = require(&#39;dap&#39;) 2dap.configurations.cpp = { 3 { 4 name = &#34;Launch file&#34;, 5 type = &#34;cppdbg&#34;, 6 request = &#34;launch&#34;, 7 program = function() 8 return vim.fn.input(&#39;Path to executable: &#39;, vim.fn.getcwd() .. &#39;/&#39;, &#39;file&#39;) 9 end, 10 cwd = &#39;\${workspaceFolder}&#39;, 11 stopAtEntry = true, 12 }, 13 { 14 name = &#39;Attach to gdbserver :1234&#39;, 15 type = &#39;cppdbg&#39;, 16 request = &#39;launch&#39;, 17 MIMode = &#39;gdb&#39;, 18 miDebuggerServerAddress = &#39;localhost:1234&#39;, 19 miDebuggerPath = &#39;/usr/bin/gdb&#39;, 20 cwd = &#39;\${workspaceFolder}&#39;, 21 program = function() 22 return vim.fn.input(&#39;Path to executable: &#39;, vim.fn.getcwd() .. &#39;/&#39;, &#39;file&#39;) 23 end, 24 }, 25} macos ä¸‹å®‰è£… Installation
Install codelldb: Download the VS Code extension. Unpack it. .vsix is a zip file and you can use unzip to extract the contents codelldb-darwin-arm64.vsix
é…åˆnvim-dap-ui ä½¿ç”¨ FAQ å¦‚ä½•ä½¿ç”¨display å¦‚ä½•ä½¿ç”¨æ¡ä»¶æ–­ç‚¹: è®¾ç½®æ¡ä»¶æ–­ç‚¹çš„æ ¸å¿ƒæ˜¯è°ƒç”¨ require('dap').set_breakpoint() å‡½æ•°ï¼Œå¹¶å‘å…¶ä¼ é€’ä¸€ä¸ªæ¡ä»¶è¡¨è¾¾å¼å­—ç¬¦ä¸²ã€‚
å‚è€ƒ The complete guide to iOS &amp; macOS development in Neovim `,url:"https://hugo-dead-simple.netlify.com/nvim-for-oi/dap.html"},"https://hugo-dead-simple.netlify.com/nvim-for-oi/bookmark.html":{title:"bookmark",tags:["nvim","oi"],content:`å½“ç„¶ï¼Œä¸ºä»£ç è¡Œæ·»åŠ æ ‡è®°ï¼ˆé€šå¸¸ç§°ä¸ºâ€œä¹¦ç­¾â€æˆ–â€œBookmarksâ€ï¼‰ä»¥ä¾¿å¿«é€Ÿå¯¼èˆªæ˜¯ä¸€ä¸ªéå¸¸å¸¸è§çš„éœ€æ±‚ã€‚Neovim ä¸ä»…æœ‰å¼ºå¤§çš„å†…ç½®æ ‡è®°åŠŸèƒ½ï¼Œè¿˜æœ‰è®¸å¤šä¼˜ç§€çš„æ’ä»¶å¯ä»¥æå¤§åœ°å¢å¼ºè¿™ä¸€ä½“éªŒã€‚
1 Neovim çš„å†…ç½®æ ‡è®° (Built-in Marks) é¦–å…ˆï¼Œä½ éœ€è¦äº†è§£ Neovim è‡ªå¸¦çš„ã€æ— éœ€ä»»ä½•æ’ä»¶çš„æ ‡è®°åŠŸèƒ½ã€‚å®ƒéå¸¸å¼ºå¤§å’Œå¿«é€Ÿã€‚
æ–‡ä»¶å†…æ ‡è®° (Lowercase Marks):
m{a-z}: åœ¨å½“å‰å…‰æ ‡è¡Œåˆ›å»ºä¸€ä¸ªåä¸º {char} çš„æ ‡è®°ã€‚ä¾‹å¦‚ï¼Œma ä¼šåœ¨å½“å‰è¡Œåˆ›å»ºä¸€ä¸ªåä¸º &lsquo;a&rsquo; çš„æ ‡è®°ã€‚è¿™äº›æ ‡è®°åªåœ¨å½“å‰æ–‡ä»¶ä¸­æœ‰æ•ˆã€‚ \`a æˆ– 'a: è·³è½¬åˆ°æ ‡è®° &lsquo;a&rsquo;ã€‚ \`a (åå¼•å·) ä¼šè·³è½¬åˆ°æ ‡è®°æ‰€åœ¨è¡Œçš„ç¡®åˆ‡å…‰æ ‡ä½ç½®ã€‚ 'a (å•å¼•å·) ä¼šè·³è½¬åˆ°æ ‡è®°æ‰€åœ¨è¡Œçš„è¡Œé¦–ã€‚ å…¨å±€æ ‡è®° (Uppercase Marks):
m{A-Z}: åˆ›å»ºä¸€ä¸ªå…¨å±€æ ‡è®°ã€‚ä¾‹å¦‚ï¼ŒmAã€‚è¿™äº›æ ‡è®°åœ¨å¤šä¸ªæ–‡ä»¶ä¹‹é—´éƒ½æœ‰æ•ˆï¼ˆåªè¦ Neovim ä¼šè¯è¿˜åœ¨ï¼‰ï¼Œå¹¶ä¸”ä¼šè®°å½•æ–‡ä»¶è·¯å¾„ã€‚ \`A æˆ– 'A: ä»ä»»ä½•æ–‡ä»¶è·³è½¬åˆ°æ ‡è®° &lsquo;A&rsquo; æ‰€åœ¨çš„ä½ç½®ã€‚ æŸ¥çœ‹æ‰€æœ‰æ ‡è®°:
è¾“å…¥å‘½ä»¤ :marks å¯ä»¥æŸ¥çœ‹æ‰€æœ‰å·²è®¾ç½®çš„æ ‡è®°ã€‚ ä¼˜ç‚¹: å†…ç½®ï¼Œé€Ÿåº¦æå¿«ï¼Œæ— éœ€é…ç½®ã€‚ ç¼ºç‚¹: æ ‡è®°æ˜¯ä¸å¯è§çš„ï¼Œä½ å¿…é¡»è®°ä½ä½ æŠŠå“ªä¸ªæ ‡è®°æ”¾åœ¨äº†å“ªé‡Œï¼Œæˆ–è€…é€šè¿‡ :marks å‘½ä»¤æŸ¥çœ‹ã€‚
2 æ’ä»¶æ¨è ä¸ºäº†è§£å†³å†…ç½®æ ‡è®°ä¸å¯è§çš„é—®é¢˜ï¼Œç¤¾åŒºå¼€å‘äº†è®¸å¤šæ’ä»¶ï¼Œå®ƒä»¬é€šå¸¸ä¼šåœ¨å¸¦æœ‰æ ‡è®°çš„è¡Œæ—è¾¹æ·»åŠ ä¸€ä¸ªâ€œç¬¦å·â€æˆ–â€œå›¾æ ‡â€ï¼Œå¹¶æä¾›æ›´å‹å¥½çš„äº¤äº’æ–¹å¼ã€‚
ğŸ‘‘ é¦–é€‰æ¨è: marks.nvim é“¾æ¥: chentoast/marks.nvim
è¿™æ˜¯ä¸€ä¸ªç°ä»£åŒ–çš„ Neovim æ’ä»¶ï¼Œä¸“é—¨ç”¨äºå¢å¼ºå†…ç½®çš„ marks åŠŸèƒ½ã€‚å®ƒä¼šè®©ä½ çš„å†…ç½®æ ‡è®°å˜å¾—å¯è§ï¼Œå¹¶æ·»åŠ äº†è®¸å¤šæ–¹ä¾¿çš„åŠŸèƒ½ï¼Œæ˜¯ç›®å‰æœ€ä¼˜é›…çš„è§£å†³æ–¹æ¡ˆä¹‹ä¸€ã€‚
ç‰¹ç‚¹:
å¯è§†åŒ–: åœ¨è¡Œå·åˆ—æˆ–ç¬¦å·åˆ—ä¸ºä½ è®¾ç½®çš„æ ‡è®°æ·»åŠ å›¾æ ‡ã€‚ æ— ç¼é›†æˆ: å®ƒæ“ä½œçš„ä»ç„¶æ˜¯ Neovim çš„åŸç”Ÿ marksï¼Œæ‰€ä»¥ä½ ä¾ç„¶å¯ä»¥ä½¿ç”¨ ma å’Œ 'a ç­‰å‘½ä»¤ã€‚ å¿«é€Ÿå¯¼èˆª: æä¾›äº†åœ¨æ ‡è®°ä¹‹é—´å¾ªç¯è·³è½¬çš„å‘½ä»¤ã€‚ Telescope é›†æˆ: å¯ä»¥ç”¨ Telescope æ¨¡ç³Šæœç´¢å¹¶è·³è½¬åˆ°æ‰€æœ‰æ ‡è®°ã€‚ æŒä¹…åŒ–: å¯ä»¥è·¨ä¼šè¯ä¿å­˜æ ‡è®°ã€‚ ä½¿ç”¨ lazy.nvim çš„å®‰è£…é…ç½®ç¤ºä¾‹:
1{ 2 &#34;chentoast/marks.nvim&#34;, 3 event = &#34;BufReadPost&#34;, -- ä¼˜åŒ–å¯åŠ¨é€Ÿåº¦ 4 config = function() 5 require(&#39;marks&#39;).setup({ 6 -- é»˜è®¤æ ‡è®°ï¼Œä½ å¯ä»¥è‡ªå®šä¹‰ 7 default_mappings = true, 8 -- ä½ å¯ä»¥åœ¨è¿™é‡Œè¿›è¡Œè¯¦ç»†é…ç½® 9 -- æ¯”å¦‚è‡ªå®šä¹‰å›¾æ ‡ã€é¢œè‰²ç­‰ 10 }) 11 end, 12} é»˜è®¤æƒ…å†µä¸‹ï¼Œå®ƒä¼šæ˜ å°„ä¸€äº›å¿«æ·é”®ï¼Œä¾‹å¦‚ï¼š
m,: åœ¨å½“å‰è¡Œè®¾ç½®/å–æ¶ˆä¸‹ä¸€ä¸ªå¯ç”¨æ ‡è®°ã€‚ m[ / m]: åœ¨æ ‡è®°ä¹‹é—´å‘å‰/å‘åè·³è½¬ã€‚ ğŸš€ æµç¨‹é©±åŠ¨çš„é€‰æ‹©: harpoon é“¾æ¥: ThePrimeagen/harpoon
Harpoon çš„ç†å¿µç•¥æœ‰ä¸åŒã€‚å®ƒä¸åªæ˜¯ä¸€ä¸ªç®€å•çš„ä¹¦ç­¾ç³»ç»Ÿï¼Œè€Œæ˜¯ä¸€ä¸ªé¢å‘å·¥ä½œæµçš„â€œå¿«é€Ÿè®¿é—®åˆ—è¡¨â€ã€‚ä½ å¯ä»¥æŠŠä»»ä½•æ–‡ä»¶ä¸­çš„ä»»ä½•ä½ç½®â€œé’‰â€åˆ° Harpoon åˆ—è¡¨ä¸­ï¼Œç„¶åé€šè¿‡ç´¢å¼•æˆ–å¿«æ·é”®åœ¨è¿™ä¸ªåˆ—è¡¨ä¹‹é—´å¿«é€Ÿç©¿æ¢­ã€‚
ç‰¹ç‚¹:
ä»»åŠ¡åˆ—è¡¨: éå¸¸é€‚åˆåœ¨ä¸€ä¸ªä»»åŠ¡ä¸­ï¼Œä½ éœ€è¦åœ¨å‡ ä¸ªå…³é”®ä½ç½®ä¹‹é—´åå¤æ¨ªè·³çš„åœºæ™¯ã€‚ UI èœå•: æä¾›ä¸€ä¸ªæµ®åŠ¨çª—å£æ¥ç®¡ç†ä½ çš„ Harpoon åˆ—è¡¨ã€‚ æå…¶å¿«é€Ÿ: åˆ‡æ¢é€Ÿåº¦éå¸¸å¿«ã€‚ ä½¿ç”¨ lazy.nvim çš„å®‰è£…é…ç½®ç¤ºä¾‹:
1{ 2 &#34;ThePrimeagen/harpoon&#34;, 3 branch = &#34;harpoon2&#34;, -- æ¨èä½¿ç”¨ harpoon2 åˆ†æ”¯ 4 dependencies = { &#34;nvim-lua/plenary.nvim&#34; }, 5 config = function() 6 local harpoon = require(&#34;harpoon&#34;) 7 harpoon:setup({}) 8 9 -- åŸºç¡€å¿«æ·é”®ç»‘å®š 10 vim.keymap.set(&#34;n&#34;, &#34;&lt;leader&gt;a&#34;, function() harpoon:list():add() end, { desc = &#34;Harpoon add file&#34; }) 11 vim.keymap.set(&#34;n&#34;, &#34;&lt;C-e&gt;&#34;, function() harpoon.ui:toggle_quick_menu(harpoon:list()) end, { desc = &#34;Harpoon quick menu&#34; }) 12 13 vim.keymap.set(&#34;n&#34;, &#34;&lt;C-h&gt;&#34;, function() harpoon:list():select(1) end, { desc = &#34;Harpoon to file 1&#34; }) 14 vim.keymap.set(&#34;n&#34;, &#34;&lt;C-t&gt;&#34;, function() harpoon:list():select(2) end, { desc = &#34;Harpoon to file 2&#34; }) 15 vim.keymap.set(&#34;n&#34;, &#34;&lt;C-n&gt;&#34;, function() harpoon:list():select(3) end, { desc = &#34;Harpoon to file 3&#34; }) 16 vim.keymap.set(&#34;n&#34;, &#34;&lt;C-s&gt;&#34;, function() harpoon:list():select(4) end, { desc = &#34;Harpoon to file 4&#34; }) 17 end, 18} æ€»ç»“ä¸å¦‚ä½•é€‰æ‹© æ–¹æ¡ˆ å“²å­¦ ä¼˜ç‚¹ é€‚åˆåœºæ™¯ å†…ç½® Marks åŸºç¡€åŠŸèƒ½ é›¶å¼€é”€ï¼Œæé€Ÿ ä¸´æ—¶ã€ä¸€æ¬¡æ€§çš„å¿«é€Ÿè·³è½¬ï¼Œä¸æƒ³å®‰è£…é¢å¤–æ’ä»¶ã€‚ marks.nvim å¢å¼ºå†…ç½® å¯è§†åŒ–ï¼ŒåŠŸèƒ½å…¨é¢ï¼Œä¸åŸç”Ÿå‘½ä»¤ç»“åˆå¥½ æƒ³è¦ä¸€ä¸ªç»å…¸ã€å¼ºå¤§ã€å¯è§†åŒ–çš„â€œä¹¦ç­¾â€ç³»ç»Ÿï¼Œè®©ä»£ç æ ‡è®°ä¸€ç›®äº†ç„¶ã€‚ harpoon å·¥ä½œæµåˆ—è¡¨ ä»»åŠ¡å¯¼å‘ï¼Œåœ¨å°‘é‡å›ºå®šä½ç½®é—´åˆ‡æ¢æå…¶é«˜æ•ˆ åœ¨é‡æ„æˆ–è°ƒè¯•æ—¶ï¼Œéœ€è¦åœ¨å‡ ä¸ªï¼ˆé€šå¸¸æ˜¯2-5ä¸ªï¼‰å…³é”®ä»£ç ç‚¹ä¹‹é—´é«˜é¢‘åˆ‡æ¢ã€‚ æˆ‘çš„å»ºè®®æ˜¯ï¼š
ä» marks.nvim å¼€å§‹ã€‚å®ƒæœ€ç¬¦åˆä½ â€œæ·»åŠ  mark å¹¶å¿«é€Ÿè·³è½¬â€çš„ç›´æ¥éœ€æ±‚ï¼Œå¹¶ä¸”é€šè¿‡å¯è§†åŒ–æå¤§åœ°æ”¹è¿›äº† Neovim çš„åŸç”ŸåŠŸèƒ½ï¼Œå­¦ä¹ æˆæœ¬å¾ˆä½ã€‚
å¦‚æœä½ å‘ç°ä½ çš„å·¥ä½œæ¨¡å¼ç»å¸¸æ˜¯å›´ç»•å°‘æ•°å‡ ä¸ªâ€œçƒ­ç‚¹â€ä½ç½®å±•å¼€ï¼Œé‚£ä¹ˆå†å°è¯• harpoonï¼Œå®ƒå¯èƒ½ä¼šæå¤§åœ°æå‡ä½ çš„å·¥ä½œæ•ˆç‡ã€‚
`,url:"https://hugo-dead-simple.netlify.com/nvim-for-oi/bookmark.html"},"https://hugo-dead-simple.netlify.com/nvim-for-oi/lsp-clang.html":{title:"lsp-clang",tags:[""],content:`lsp ä½œç”¨ ç®€å•æ¥è¯´ï¼Œclangd å°±åƒä¸€ä¸ªç²¾é€š C++ çš„è¶…çº§åŠ©æ‰‹ï¼Œå®ƒå®æ—¶åœ°åˆ†æä½ çš„ä»£ç ï¼Œç„¶åæŠŠåˆ†æç»“æœé€šè¿‡ LSPï¼ˆè¯­è¨€æœåŠ¡å™¨åè®®ï¼‰å‘Šè¯‰ Neovimã€‚Neovim å†æ ¹æ®è¿™äº›ä¿¡æ¯ï¼Œä¸ºä½ æä¾›ä¸€ç³»åˆ—å¼ºå¤§çš„ IDE åŠŸèƒ½ã€‚
clangd çš„æ ¸å¿ƒä½œç”¨å°±æ˜¯ï¼šè®© Neovim â€œç†è§£â€ C++ ä»£ç ã€‚
ä¸‹é¢æ˜¯å®ƒå…·ä½“èƒ½ä¸ºä½ åšçš„äº‹æƒ…ï¼Œä»¥åŠå¦‚ä½•ä½¿ç”¨ä½ åœ¨ä¸Šä¸€ä»½é…ç½®ä¸­è®¾ç½®çš„å¿«æ·é”®æ¥ä½“éªŒå®ƒä»¬ï¼š
1. æ™ºèƒ½ä»£ç è¡¥å…¨ (Intelligent Code Completion) è¿™æ˜¯æœ€ç›´è§‚çš„åŠŸèƒ½ã€‚å½“ä½ è¾“å…¥ä»£ç æ—¶ï¼Œclangd ä¼šæ ¹æ®ä¸Šä¸‹æ–‡æä¾›ç²¾ç¡®çš„è¡¥å…¨å»ºè®®ã€‚
æœ‰ä»€ä¹ˆç”¨ï¼Ÿ
å‡å°‘è¾“å…¥ï¼šä¸ç”¨å†æ‰‹åŠ¨æ•²å†™å®Œæ•´çš„å‡½æ•°åã€å˜é‡åã€‚ é¿å…æ‹¼å†™é”™è¯¯ï¼šä»è¡¥å…¨åˆ—è¡¨ä¸­é€‰æ‹©å¯ä»¥ç¡®ä¿åç§°æ­£ç¡®æ— è¯¯ã€‚ API æ¢ç´¢ï¼šå½“ä½ è¾“å…¥ä¸€ä¸ªå¯¹è±¡å’Œ . æˆ– -&gt; åï¼Œclangd ä¼šåˆ—å‡ºæ‰€æœ‰å¯ç”¨çš„æˆå‘˜å‡½æ•°å’Œå˜é‡ï¼Œå¸®åŠ©ä½ å¿«é€Ÿäº†è§£ä¸€ä¸ªç±»çš„åŠŸèƒ½ï¼Œè€Œæ— éœ€å»æŸ¥é˜…æ–‡æ¡£ã€‚ å¦‚ä½•ä½“éªŒï¼Ÿ
éœ€è¦é…åˆä¸€ä¸ªè¡¥å…¨æ’ä»¶ï¼Œæ¯”å¦‚ nvim-cmpã€‚ å½“ä½ è¾“å…¥ä»£ç æ—¶ï¼Œè¡¥å…¨çª—å£ä¼šè‡ªåŠ¨å¼¹å‡ºã€‚ä¾‹å¦‚ï¼Œè¾“å…¥ std::vector&lt;int&gt; v; v. å°±ä¼šçœ‹åˆ° push_back, size, begin ç­‰æˆå‘˜å‡½æ•°ã€‚ 2. å®æ—¶è¯Šæ–­ï¼šé”™è¯¯å’Œè­¦å‘Š (Real-time Diagnostics) clangd ä¼šåœ¨ä½ ç¼–å†™ä»£ç çš„åŒæ—¶è¿›è¡Œé™æ€åˆ†æï¼Œå®æ—¶åœ°æ ‡è®°å‡ºè¯­æ³•é”™è¯¯ã€ç±»å‹ä¸åŒ¹é…ã€æ½œåœ¨çš„ bug å’Œä¸ç¬¦åˆè§„èŒƒçš„ä»£ç ã€‚
æœ‰ä»€ä¹ˆç”¨ï¼Ÿ
å¿«é€Ÿåé¦ˆå¾ªç¯ï¼šä½ ä¸éœ€è¦ç­‰åˆ°ç¼–è¯‘ä»£ç æ—¶æ‰å‘ç°ä¸€ä¸ªç®€å•çš„è¯­æ³•é”™è¯¯ã€‚é”™è¯¯ä¼šç«‹å³åœ¨ä½ çš„ç¼–è¾‘å™¨ä¸­é«˜äº®å‡ºæ¥ï¼Œå¤§å¤§ç¼©çŸ­äº†â€œç¼–ç -ç¼–è¯‘-è°ƒè¯•â€çš„å‘¨æœŸã€‚ æå‡ä»£ç è´¨é‡ï¼šå®ƒä¸ä»…èƒ½å‘ç°ç¼–è¯‘é”™è¯¯ï¼Œè¿˜èƒ½é€šè¿‡ clang-tidy ç»™å‡ºä»£ç é£æ ¼å»ºè®®å’Œæ½œåœ¨é£é™©è­¦å‘Šã€‚ å¦‚ä½•ä½“éªŒï¼Ÿ
ä»£ç ä¸­çš„é”™è¯¯æˆ–è­¦å‘Šä¸‹æ–¹ä¼šå‡ºç°æ³¢æµªçº¿ã€‚ è¡Œå·åˆ—ä¼šæ˜¾ç¤ºå›¾æ ‡ï¼ˆä¾‹å¦‚ ï— è¡¨ç¤ºé”™è¯¯ï¼Œï± è¡¨ç¤ºè­¦å‘Šï¼‰ã€‚ å°†å…‰æ ‡ç§»åŠ¨åˆ°æœ‰é—®é¢˜çš„ä»£ç ä¸Šï¼Œä½¿ç”¨å¿«æ·é”® &lt;leader&gt;e å¯ä»¥æµ®çª—æ˜¾ç¤ºè¯¦ç»†çš„è¯Šæ–­ä¿¡æ¯ã€‚ ä½¿ç”¨ [d å’Œ ]d å¯ä»¥åœ¨æ–‡ä»¶ä¸­çš„å¤šä¸ªè¯Šæ–­ç‚¹ä¹‹é—´å¿«é€Ÿè·³è½¬ã€‚ 3. ä»£ç å¯¼èˆª (Code Navigation) åœ¨å¤§å‹é¡¹ç›®ä¸­ï¼Œèƒ½å¤Ÿå¿«é€Ÿåœ°åœ¨ä»£ç åº“ä¸­è·³è½¬æ˜¯è‡³å…³é‡è¦çš„ã€‚
æœ‰ä»€ä¹ˆç”¨ï¼Ÿ
å¿«é€Ÿç†è§£ä»£ç ï¼šæƒ³çŸ¥é“ä¸€ä¸ªå‡½æ•°æ˜¯åšä»€ä¹ˆçš„ï¼Ÿç›´æ¥è·³è½¬åˆ°å®ƒçš„å®šä¹‰å¤„æŸ¥çœ‹æºç ã€‚ ç†æ¸…è°ƒç”¨å…³ç³»ï¼šæƒ³çŸ¥é“ä¸€ä¸ªå‡½æ•°è¢«å“ªäº›åœ°æ–¹è°ƒç”¨äº†ï¼Ÿä¸€é”®åˆ—å‡ºæ‰€æœ‰å¼•ç”¨ã€‚ å¦‚ä½•ä½“éªŒï¼Ÿ
å°†å…‰æ ‡æ”¾åœ¨ä¸€ä¸ªå‡½æ•°æˆ–å˜é‡ä¸Šï¼š æŒ‰ gd (Go to Definition) ä¼šè·³è½¬åˆ°å®ƒçš„å®šä¹‰ä½ç½®ã€‚ æŒ‰ gi (Go to Implementation) ä¼šè·³è½¬åˆ°å®ƒçš„å…·ä½“å®ç°ä½ç½®ï¼ˆå¯¹è™šå‡½æ•°ç‰¹åˆ«æœ‰ç”¨ï¼‰ã€‚ æŒ‰ gr (Go to References) ä¼šåˆ—å‡ºé¡¹ç›®ä¸­æ‰€æœ‰å¼•ç”¨äº†è¯¥ç¬¦å·çš„åœ°æ–¹ã€‚ 4. ä»£ç ä¿¡æ¯æ‚¬æµ®æç¤º (Hover Information) å½“ä½ ä¸ç¡®å®šä¸€ä¸ªå‡½æ•°æˆ–å˜é‡çš„ç±»å‹ã€ç­¾åæˆ–æ–‡æ¡£æ—¶ï¼Œå¯ä»¥å¿«é€ŸæŸ¥çœ‹ã€‚
æœ‰ä»€ä¹ˆç”¨ï¼Ÿ
æ— éœ€ç¦»å¼€ç¼–è¾‘å™¨ï¼šä¸ç”¨åˆ‡æ¢åˆ°æµè§ˆå™¨æˆ–å¤´æ–‡ä»¶å»æŸ¥æ‰¾å‡½æ•°åŸå‹æˆ–æ³¨é‡Šã€‚ å¿«é€Ÿç¡®è®¤ï¼šå¿«é€ŸæŸ¥çœ‹å˜é‡çš„æ¨å¯¼ç±»å‹ (auto)ï¼Œæˆ–è€…å‡½æ•°çš„å‚æ•°å’Œè¿”å›å€¼ã€‚ å¦‚ä½•ä½“éªŒï¼Ÿ
å°†å…‰æ ‡æ‚¬åœåœ¨ä¸€ä¸ªå‡½æ•°ã€å˜é‡æˆ–ç±»å‹ä¸Šï¼Œç„¶åæŒ‰ Kã€‚ä¸€ä¸ªæµ®åŠ¨çª—å£ä¼šæ˜¾ç¤ºå®ƒçš„è¯¦ç»†ä¿¡æ¯ï¼ŒåŒ…æ‹¬ Doxygen é£æ ¼çš„æ³¨é‡Šã€‚ 5. ä»£ç é‡æ„ä¸ä»£ç åŠ¨ä½œ (Refactoring &amp; Code Actions) clangd å¯ä»¥å®‰å…¨ã€è‡ªåŠ¨åœ°å¸®ä½ ä¿®æ”¹ä»£ç ã€‚
æœ‰ä»€ä¹ˆç”¨ï¼Ÿ
å®‰å…¨é‡å‘½åï¼šå½“ä½ éœ€è¦ä¿®æ”¹ä¸€ä¸ªå‡½æ•°æˆ–å˜é‡çš„åå­—æ—¶ï¼Œæ‰‹åŠ¨ä¿®æ”¹éå¸¸å±é™©ï¼Œå®¹æ˜“é—æ¼ã€‚é‡æ„åŠŸèƒ½å¯ä»¥ä¸€æ¬¡æ€§ã€å®‰å…¨åœ°ä¿®æ”¹é¡¹ç›®ä¸­æ‰€æœ‰å¼•ç”¨çš„åœ°æ–¹ã€‚ è‡ªåŠ¨ä¿®å¤å’Œä¼˜åŒ–ï¼šclangd ä¼šæä¾›ä¸€äº›â€œä»£ç åŠ¨ä½œâ€ï¼Œæ¯”å¦‚è‡ªåŠ¨æ·»åŠ ç¼ºå¤±çš„ #includeï¼Œå°†å®ç°ä»£ç æå–åˆ°æºæ–‡ä»¶ï¼Œæˆ–è€…æ ¹æ® clang-tidy çš„å»ºè®®è‡ªåŠ¨ä¿®å¤ä»£ç ã€‚ å¦‚ä½•ä½“éªŒï¼Ÿ
å°†å…‰æ ‡æ”¾åœ¨è¦é‡å‘½åçš„ç¬¦å·ä¸Šï¼ŒæŒ‰ &lt;F2&gt;ï¼Œè¾“å…¥æ–°åå­—åå›è½¦ï¼Œæ‰€æœ‰ç›¸å…³çš„åœ°æ–¹éƒ½ä¼šè¢«ä¿®æ”¹ã€‚ å°†å…‰æ ‡æ”¾åœ¨æœ‰è­¦å‘Šæˆ–ç‰¹å®šä»£ç å—ä¸Šï¼ŒæŒ‰ &lt;leader&gt;ca (Code Action) ä¼šå¼¹å‡ºä¸€ä¸ªèœå•ï¼Œè®©ä½ é€‰æ‹©å¯ä»¥æ‰§è¡Œçš„æ“ä½œã€‚ æ€»ç»“ æ‹¥æœ‰ clangd ä¹‹å‰ï¼ŒNeovim æ˜¯ä¸€ä¸ªå¸¦è¯­æ³•é«˜äº®çš„æ–‡æœ¬ç¼–è¾‘å™¨ã€‚ æ‹¥æœ‰ clangd ä¹‹åï¼ŒNeovim å˜æˆäº†ä¸€ä¸ªä¸º C++ é‡èº«å®šåˆ¶çš„ã€ç†è§£ä»£ç é€»è¾‘çš„æ™ºèƒ½å¼€å‘ç¯å¢ƒ (IDE)ã€‚
å®ƒå¸®ä½ å†™å¾—æ›´å¿«ï¼ˆä»£ç è¡¥å…¨ï¼‰ã€çœ‹å¾—æ›´æ¸…ï¼ˆä»£ç å¯¼èˆªå’Œæ‚¬æµ®æç¤ºï¼‰ã€æ”¹å¾—æ›´å‡†ï¼ˆé‡æ„ï¼‰ã€é”™å¾—æ›´å°‘ï¼ˆå®æ—¶è¯Šæ–­ï¼‰ã€‚å°¤å…¶æ˜¯åœ¨å¤„ç†ä¸ç†Ÿæ‚‰æˆ–è€…åºå¤§çš„ä»£ç åº“æ—¶ï¼Œè¿™äº›åŠŸèƒ½å¸¦æ¥çš„æ•ˆç‡æå‡æ˜¯é©å‘½æ€§çš„ã€‚
`,url:"https://hugo-dead-simple.netlify.com/nvim-for-oi/lsp-clang.html"},"https://hugo-dead-simple.netlify.com/blog/my-awesome-tools.html":{title:"my-awesome-tools",tags:["self-record"],content:"1 Linux Tool dialog - ç”¨äºåœ¨ shell è„šæœ¬ä¸­åˆ›å»ºæ–‡æœ¬ç”¨æˆ·ç•Œé¢çš„å·¥å…·ï¼Œæ”¯æŒå¯¹è¯æ¡†ã€èœå•ã€è¿›åº¦æ¡ç­‰äº¤äº’å…ƒç´  gumï¼šä¸€ä¸ªç”± Charmbracelet å¼€å‘çš„å‘½ä»¤è¡Œå·¥å…·ï¼Œç”¨äºåˆ›å»ºæ¼‚äº®çš„äº¤äº’å¼ Shell è„šæœ¬ï¼Œæ”¯æŒè¾“å…¥ã€é€‰æ‹©ã€ç¡®è®¤ç­‰ UI ç»„ä»¶ï¼Œé€‚åˆå¢å¼ºç»ˆç«¯ç”¨æˆ·ä½“éªŒã€‚ sunlei awesome-tools - ä¸€ä¸ªæ”¶é›†å„ç§å®ç”¨å·¥å…·å’Œèµ„æºçš„ç²¾é€‰åˆ—è¡¨ï¼Œæ¶µç›–å¼€å‘ã€è®¾è®¡ã€æ•ˆç‡ç­‰å¤šä¸ªé¢†åŸŸ 2 Windows CapsWriter çš„ç¦»çº¿ç‰ˆï¼Œä¸€ä¸ªå¥½ç”¨çš„ PC ç«¯çš„è¯­éŸ³è¾“å…¥å·¥å…· 1cpu å¤ªåƒåœ¾,å¯¼è‡´æœ‰å»¶è¿Ÿ 2è¯•è¯•æŠŠ config.py é‡Œé¢çš„ num_threads = 6 æ”¹æˆ 1 æˆ– 2 ï¼Œå†é‡å¯æœåŠ¡ç«¯ï¼Œè¯•ä¸‹èƒ½ä¸èƒ½æ”¹å–„ã€‚ H1DDENADM1NCapsWriter-Offline - ç¦»çº¿è¯­éŸ³è¾“å…¥å·¥å…·ï¼Œæ”¯æŒç®€ç¹ä½“è½¬æ¢ã€ä¸­è¯‘è‹±ã€å­—å¹•è½¬å½•ï¼Œé‡‡ç”¨ SenseVoice æ¨¡å‹ï¼Œæ”¯æŒä¸­ç²¤è‹±æ—¥éŸ©å¤šè¯­ç§ ABBYY FineReader OCR Pro - ä¸“ä¸šçš„ OCR æ–‡å­—è¯†åˆ«è½¯ä»¶ï¼Œæ”¯æŒ PDF è½¬æ¢ã€æ–‡æ¡£ç¼–è¾‘å’Œå¤šè¯­è¨€è¯†åˆ« PillOCR: ä¸€ä¸ªåŸºäºå¤§æ¨¡å‹apiçš„OCRå·¥å…·ã€‚ TrafficMonitor: è¿™æ˜¯ä¸€ä¸ªç”¨äºæ˜¾ç¤ºå½“å‰ç½‘é€Ÿã€CPUåŠå†…å­˜åˆ©ç”¨ç‡çš„æ¡Œé¢æ‚¬æµ®çª—è½¯ä»¶ï¼Œå¹¶æ”¯æŒä»»åŠ¡æ æ˜¾ç¤ºï¼Œæ”¯æŒæ›´æ¢çš®è‚¤ã€‚ pot-desktop - ä¸€ä¸ªè·¨å¹³å°çš„ç¿»è¯‘è½¯ä»¶ï¼Œæ”¯æŒåˆ’è¯ç¿»è¯‘ã€æˆªå›¾ç¿»è¯‘ç­‰å¤šç§ç¿»è¯‘æ–¹å¼ 3 c++ nlohmann/json - ç°ä»£ C++ çš„ JSON åº“ï¼Œæä¾›ç›´è§‚çš„ API å’Œå¼ºå¤§çš„åŠŸèƒ½ï¼Œæ”¯æŒåºåˆ—åŒ–ã€ååºåˆ—åŒ–å’Œæ“ä½œ JSON æ•°æ® 4 Js ğŸ® kaplay - ä¸€ä¸ª JavaScript/TypeScript æ¸¸æˆå¼€å‘åº“ï¼Œæä¾›ç®€å•æ˜“ç”¨çš„ API å’Œä¸°å¯Œçš„æ¸¸æˆå¼€å‘åŠŸèƒ½ Manim.js - åŸºäº JavaScript (p5.js) çš„æ•°å­¦åŠ¨ç”»å¼•æ“ï¼Œå¤åˆ» 3Blue1Brown çš„åŠ¨ç”»é£æ ¼ï¼Œç”¨äºåˆ›å»ºæ•°å­¦å¯è§†åŒ–å†…å®¹ 5 Docker cloud-clipboard - å±€åŸŸç½‘å†…ä½¿ç”¨çš„åœ¨çº¿å‰ªè´´æ¿å·¥å…·ï¼Œæ”¯æŒçº¯æ–‡æœ¬å’Œæ–‡ä»¶ä¼ è¾“ï¼Œæ–¹ä¾¿å¤šè®¾å¤‡é—´å…±äº«å†…å®¹ 6 Vue vite-plugin-singlefile - Vite æ’ä»¶ï¼Œç”¨äºå°†æ•´ä¸ªåº”ç”¨æ‰“åŒ…æˆå•ä¸ª HTML æ–‡ä»¶ï¼Œä¾¿äºåˆ†å‘å’Œéƒ¨ç½² 7 AI å·¥å…·ä½¿ç”¨ system-prompts-and-models-of-ai-tools - æ”¶é›†å„ç§ AI å·¥å…·çš„ç³»ç»Ÿæç¤ºè¯å’Œæ¨¡å‹ä¿¡æ¯ï¼ŒåŒ…æ‹¬ Cursorã€Devinã€Replit Agent ç­‰ awesome-chatgpt-prompts - ç²¾é€‰çš„ ChatGPT æç¤ºè¯é›†åˆï¼Œå¸®åŠ©ç”¨æˆ·æ›´å¥½åœ°ä½¿ç”¨ ChatGPT å’Œå…¶ä»–å¤§è¯­è¨€æ¨¡å‹å·¥å…· prompts.chat - æä¾›ä¼˜è´¨ AI æç¤ºè¯çš„ç½‘ç«™ï¼ŒåŒ…å«å„ç§åœºæ™¯ä¸‹çš„å®ç”¨æç¤ºè¯æ¨¡æ¿ ",url:"https://hugo-dead-simple.netlify.com/blog/my-awesome-tools.html"},"https://hugo-dead-simple.netlify.com/nvim-for-oi/clangd.html":{title:"nvim-lsp-clangd",tags:["nvim","oi"],content:`åœ¨ Neovim ä¸­ä¸ä½¿ç”¨ nvim-lspconfig æ’ä»¶æ¥æ‰‹åŠ¨é…ç½® clangd æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„å­¦ä¹  Neovim å†…ç½® LSP API çš„æ–¹å¼ã€‚è¿™èƒ½è®©ä½ æ›´æ·±å…¥åœ°ç†è§£ LSP å®¢æˆ·ç«¯æ˜¯å¦‚ä½•å·¥ä½œçš„ã€‚
ä¸‹é¢æ˜¯è¯¦ç»†çš„æ­¥éª¤å’Œä¸€ä»½å®Œæ•´çš„ Lua é…ç½®ç¤ºä¾‹ã€‚
æ ¸å¿ƒæ€è·¯ ä¸ä½¿ç”¨ nvim-lspconfig çš„æ ¸å¿ƒæ˜¯ç›´æ¥è°ƒç”¨ Neovim çš„åŸç”Ÿ LSP å‡½æ•° vim.lsp.start()ã€‚è¿™ä¸ªå‡½æ•°è´Ÿè´£å¯åŠ¨ä¸€ä¸ª LSP æœåŠ¡è¿›ç¨‹ï¼Œå¹¶å°†å…¶é™„åŠ åˆ°å½“å‰çš„ç¼“å†²åŒºã€‚
ä¸»è¦æ­¥éª¤å¦‚ä¸‹ï¼š
ç¡®ä¿ clangd å·²å®‰è£…ï¼šNeovim ä¸ä¼šå¸®ä½ å®‰è£… LSP æœåŠ¡å™¨ï¼Œä½ éœ€è¦è‡ªå·±é€šè¿‡ç³»ç»ŸåŒ…ç®¡ç†å™¨å®‰è£…ã€‚ å®šä¹‰ on_attach å‡½æ•°ï¼šè¿™ä¸ªå‡½æ•°åœ¨ LSP æˆåŠŸé™„åŠ åˆ°ä¸€ä¸ªç¼“å†²åŒºåæ‰§è¡Œã€‚æˆ‘ä»¬åœ¨è¿™é‡Œè®¾ç½®å¿«æ·é”®ã€é«˜äº®ç­‰ã€‚ å®šä¹‰ LSP æœåŠ¡å™¨é…ç½®ï¼šåˆ›å»ºä¸€ä¸ªé…ç½®è¡¨ï¼Œå‘Šè¯‰ Neovim å¦‚ä½•å¯åŠ¨ clangdï¼ˆå‘½ä»¤ã€æ ¹ç›®å½•ã€æ–‡ä»¶ç±»å‹ç­‰ï¼‰ã€‚ ä½¿ç”¨ autocmd è§¦å‘ LSPï¼šåˆ›å»ºä¸€ä¸ªè‡ªåŠ¨å‘½ä»¤ï¼Œåœ¨æ‰“å¼€ C/C++ æ–‡ä»¶æ—¶ï¼Œè°ƒç”¨ vim.lsp.start() æ¥å¯åŠ¨ clangdã€‚ æ­¥éª¤ 1: å®‰è£… clangd é¦–å…ˆï¼Œç¡®ä¿ä½ çš„ç³»ç»Ÿä¸Šå·²ç»å®‰è£…äº† clangdã€‚
macOS (Homebrew):
1brew install llvm 2# Homebrew å®‰è£…çš„ llvm å¯èƒ½éœ€è¦æ‰‹åŠ¨é“¾æ¥ï¼Œæˆ–è€…ä½ å¯ä»¥åœ¨é…ç½®ä¸­æŒ‡å®šå®Œæ•´è·¯å¾„ Ubuntu/Debian:
1sudo apt update 2sudo apt install clangd Arch Linux:
1sudo pacman -S clangd å®‰è£…åï¼Œåœ¨ç»ˆç«¯è¿è¡Œ clangd --version ç¡®è®¤å®ƒå·²ç»å®‰è£…å¹¶ä¸”åœ¨ä½ çš„ PATH ä¸­ã€‚
æ­¥éª¤ 2: åˆ›å»º compile_commands.json (éå¸¸é‡è¦!) clangd éœ€è¦ compile_commands.json æ–‡ä»¶æ¥äº†è§£ä½ çš„é¡¹ç›®æ˜¯å¦‚ä½•ç¼–è¯‘çš„ï¼ˆæ¯”å¦‚å¤´æ–‡ä»¶è·¯å¾„ã€å®å®šä¹‰ç­‰ï¼‰ã€‚æ²¡æœ‰è¿™ä¸ªæ–‡ä»¶ï¼Œclangd çš„åŠŸèƒ½ä¼šå¤§æ‰“æŠ˜æ‰£ï¼Œå°¤å…¶æ˜¯åœ¨å¤§å‹é¡¹ç›®ä¸­ã€‚
å¦‚æœä½ çš„é¡¹ç›®ä½¿ç”¨ CMakeï¼Œç”Ÿæˆå®ƒéå¸¸ç®€å•ï¼š
1# åœ¨ä½ çš„æ„å»ºç›®å½•ä¸­ 2cmake -DCMAKE_EXPORT_COMPILE_COMMANDS=1 .. è¿™ä¼šåœ¨æ„å»ºç›®å½•ä¸­ç”Ÿæˆä¸€ä¸ª compile_commands.json æ–‡ä»¶ã€‚clangd ä¼šè‡ªåŠ¨åœ¨å½“å‰æ–‡ä»¶æ‰€åœ¨ç›®å½•åŠçˆ¶ç›®å½•ä¸­å¯»æ‰¾å®ƒã€‚
æ­¥éª¤ 3: Neovim Lua é…ç½® å°†ä»¥ä¸‹ä»£ç æ”¾å…¥ä½ çš„ Neovim é…ç½®æ–‡ä»¶ä¸­ï¼ˆä¾‹å¦‚ ~/.config/nvim/lua/lsp/clangd.luaï¼‰ï¼Œç„¶ååœ¨ä½ çš„ init.lua ä¸­ require å®ƒã€‚
è¿™æ˜¯ä¸€ä¸ªå®Œæ•´ä¸”å¸¦æœ‰è¯¦ç»†æ³¨é‡Šçš„ç¤ºä¾‹ï¼š
1-- ~/.config/nvim/lua/lsp/clangd.lua 2 3print(&#34;åŠ è½½è‡ªå®šä¹‰ clangd é…ç½®...&#34;) 4 5-- 1. å®šä¹‰ on_attach å‡½æ•° 6-- è¿™ä¸ªå‡½æ•°ä¼šåœ¨ LSP å®¢æˆ·ç«¯æˆåŠŸé™„åŠ åˆ°ç¼“å†²åŒºæ—¶è°ƒç”¨ 7-- æˆ‘ä»¬åœ¨è¿™é‡Œä¸ºè¯¥ç¼“å†²åŒºè®¾ç½® LSP ç›¸å…³çš„å¿«æ·é”® 8local on_attach = function(client, bufnr) 9 -- å¯ç”¨ä»£ç è¡¥å…¨ (å¦‚æœä½ ä½¿ç”¨ nvim-cmp) 10 -- client.server_capabilities.completionProvider = true -- è¿™è¡Œé€šå¸¸ä¸éœ€è¦ï¼Œå› ä¸º capabilities å·²ç»å¤„ç†äº† 11 12 print(&#34;clangd å·²é™„åŠ åˆ°ç¼“å†²åŒº: &#34; .. bufnr) 13 14 -- è®¾ç½®å¿«æ·é”® 15 local opts = { noremap = true, silent = true, buffer = bufnr } 16 local keymap = vim.keymap.set 17 18 -- è·³è½¬åˆ°å®šä¹‰ 19 keymap(&#39;n&#39;, &#39;gd&#39;, vim.lsp.buf.definition, opts) 20 -- æŸ¥çœ‹æ‚¬æµ®æ–‡æ¡£ 21 keymap(&#39;n&#39;, &#39;K&#39;, vim.lsp.buf.hover, opts) 22 -- è·³è½¬åˆ°å®ç° 23 keymap(&#39;n&#39;, &#39;gi&#39;, vim.lsp.buf.implementation, opts) 24 -- åˆ—å‡ºå¼•ç”¨ 25 keymap(&#39;n&#39;, &#39;gr&#39;, vim.lsp.buf.references, opts) 26 -- é‡å‘½åç¬¦å· 27 keymap(&#39;n&#39;, &#39;&lt;F2&gt;&#39;, vim.lsp.buf.rename, opts) 28 -- æ˜¾ç¤ºä»£ç åŠ¨ä½œ (ä¿®å¤ã€é‡æ„ç­‰) 29 keymap(&#39;n&#39;, &#39;&lt;leader&gt;ca&#39;, vim.lsp.buf.code_action, opts) 30 -- æ˜¾ç¤ºå½“å‰è¡Œçš„è¯Šæ–­ä¿¡æ¯ (é”™è¯¯ã€è­¦å‘Š) 31 keymap(&#39;n&#39;, &#39;&lt;leader&gt;e&#39;, vim.diagnostic.open_float, opts) 32 -- è·³è½¬åˆ°ä¸Šä¸€ä¸ª/ä¸‹ä¸€ä¸ªè¯Šæ–­ 33 keymap(&#39;n&#39;, &#39;[d&#39;, vim.diagnostic.goto_prev, opts) 34 keymap(&#39;n&#39;, &#39;]d&#39;, vim.diagnostic.goto_next, opts) 35 36 -- è®¾ç½®é«˜äº® 37 -- å½“å…‰æ ‡ç§»åŠ¨åˆ°æœ‰å¼•ç”¨çš„ç¬¦å·ä¸Šæ—¶ï¼Œé«˜äº®æ‰€æœ‰å¼•ç”¨ 38 vim.api.nvim_create_autocmd(&#39;CursorHold&#39;, { 39 buffer = bufnr, 40 callback = function() 41 vim.lsp.buf.document_highlight() 42 end, 43 }) 44 vim.api.nvim_create_autocmd(&#39;CursorMoved&#39;, { 45 buffer = bufnr, 46 callback = function() 47 vim.lsp.buf.clear_references() 48 end, 49 }) 50 51end 52 53-- 2. å®šä¹‰ LSP èƒ½åŠ› (Capabilities) 54-- è¿™å‘Šè¯‰ LSP æœåŠ¡å™¨ï¼Œå®¢æˆ·ç«¯ï¼ˆNeovimï¼‰æ”¯æŒå“ªäº›åŠŸèƒ½ 55-- å¦‚æœä½ ä½¿ç”¨ nvim-cmp è¿›è¡Œè¡¥å…¨ï¼Œéœ€è¦ä» cmp_nvim_lsp è·å– capabilities 56local capabilities = require(&#39;cmp_nvim_lsp&#39;).default_capabilities(vim.lsp.protocol.make_client_capabilities()) 57 58-- 3. åˆ›å»ºè‡ªåŠ¨å‘½ä»¤æ¥å¯åŠ¨ clangd 59-- å½“æ‰“å¼€ C/C++/Objective-C æ–‡ä»¶æ—¶ï¼Œä¼šè§¦å‘è¿™ä¸ªè‡ªåŠ¨å‘½ä»¤ 60vim.api.nvim_create_autocmd(&#39;FileType&#39;, { 61 pattern = { &#39;c&#39;, &#39;cpp&#39;, &#39;objc&#39;, &#39;objcpp&#39;, &#39;cuda&#39; }, -- è§¦å‘ clangd çš„æ–‡ä»¶ç±»å‹ 62 callback = function() 63 -- ä½¿ç”¨ vim.lsp.start() å¯åŠ¨å®¢æˆ·ç«¯ 64 vim.lsp.start({ 65 -- å®¢æˆ·ç«¯çš„åç§°ï¼Œå¯ä»¥è‡ªå®šä¹‰ 66 name = &#39;my-clangd-server&#39;, 67 68 -- å¯åŠ¨ LSP æœåŠ¡å™¨çš„å‘½ä»¤ 69 -- å¦‚æœ clangd ä¸åœ¨ä½ çš„ PATH ä¸­ï¼Œä½ éœ€è¦æä¾›å®Œæ•´è·¯å¾„ 70 -- ä½ ä¹Ÿå¯ä»¥åœ¨è¿™é‡Œä¼ é€’ clangd çš„å‘½ä»¤è¡Œå‚æ•° 71 cmd = { 72 &#39;clangd&#39;, 73 &#39;--query-driver=/usr/bin/gcc,**/gcc-*,/usr/bin/g++,**/g++-*&#39;, -- å¸®åŠ© clangd æ‰¾åˆ°ç³»ç»Ÿå¤´æ–‡ä»¶ 74 &#39;--background-index&#39;, -- åå°ç´¢å¼• 75 &#39;--clang-tidy&#39;, -- å¯ç”¨ clang-tidy 76 &#39;--completion-style=detailed&#39;, 77 }, 78 79 -- æŸ¥æ‰¾é¡¹ç›®æ ¹ç›®å½•çš„é€»è¾‘ 80 -- clangd ä¼šè‡ªåŠ¨å¯»æ‰¾ compile_commands.json æˆ– .git ç›®å½• 81 -- è¿™é‡Œä½¿ç”¨ Neovim å†…ç½®çš„å·¥å…·å‡½æ•° 82 root_dir = vim.lsp.util.root_pattern(&#39;.git&#39;, &#39;compile_commands.json&#39;, &#39;compile_flags.txt&#39;), 83 84 -- æ–‡ä»¶ç±»å‹ 85 filetypes = { &#39;c&#39;, &#39;cpp&#39;, &#39;objc&#39;, &#39;objcpp&#39;, &#39;cuda&#39; }, 86 87 -- é™„åŠ å‡½æ•° 88 on_attach = on_attach, 89 90 -- èƒ½åŠ› 91 capabilities = capabilities, 92 93 -- æœåŠ¡å™¨ç‰¹å®šè®¾ç½® (settings) 94 -- å¯¹äº clangdï¼Œå¤§å¤šæ•°é…ç½®é€šè¿‡å‘½ä»¤è¡Œå‚æ•°æˆ– .clangd é…ç½®æ–‡ä»¶å®Œæˆ 95 settings = { 96 -- è¿™é‡Œå¯ä»¥æ”¾ä¸€äº› clangd çš„ç‰¹å®šé…ç½®ï¼Œä½†é€šå¸¸ç•™ç©º 97 }, 98 }) 99 end, 100}) 101 102-- (å¯é€‰) é…ç½®è¯Šæ–­ä¿¡æ¯çš„æ˜¾ç¤ºæ–¹å¼ 103vim.diagnostic.config({ 104 virtual_text = true, -- åœ¨è¡Œå°¾æ˜¾ç¤ºé”™è¯¯ä¿¡æ¯ 105 signs = true, -- åœ¨è¡Œå·åˆ—æ˜¾ç¤ºå›¾æ ‡ 106 underline = true, 107 update_in_insert = false, 108 severity_sort = true, 109}) 110 111-- (å¯é€‰) è®¾ç½®è¯Šæ–­å›¾æ ‡ (éœ€è¦ Nerd Font å­—ä½“æ”¯æŒ) 112local signs = { Error = &#34;ï— &#34;, Warn = &#34;ï± &#34;, Hint = &#34;ïš &#34;, Info = &#34;ïª &#34; } 113for type, icon in pairs(signs) do 114 local hl = &#34;DiagnosticSign&#34; .. type 115 vim.fn.sign_define(hl, { text = icon, texthl = hl, numhl = hl }) 116end 117 118print(&#34;è‡ªå®šä¹‰ clangd é…ç½®åŠ è½½å®Œæ¯•ã€‚&#34;) æ­¥éª¤ 4: åœ¨ init.lua ä¸­åŠ è½½é…ç½® ç¡®ä¿åœ¨ä½ çš„ä¸»é…ç½®æ–‡ä»¶ init.lua ä¸­åŠ è½½ä¸Šé¢åˆ›å»ºçš„ Lua æ–‡ä»¶ï¼š
1-- ~/.config/nvim/init.lua 2 3-- ... å…¶ä»–é…ç½® ... 4 5-- åŠ è½½ LSP ç›¸å…³é…ç½® 6require(&#39;lsp.clangd&#39;) -- å‡è®¾ä½ æŠŠæ–‡ä»¶æ”¾åœ¨ lua/lsp/clangd.lua 7 8-- ... å…¶ä»–é…ç½® ... é…ç½®è§£é‡Š on_attach å‡½æ•°: è¿™æ˜¯è‡ªå®šä¹‰ LSP è¡Œä¸ºçš„å…³é”®ã€‚å®ƒåªä¼šåœ¨ LSP å®¢æˆ·ç«¯æˆåŠŸè¿æ¥åˆ°å½“å‰æ–‡ä»¶åæ‰§è¡Œï¼Œç¡®ä¿äº† vim.lsp.buf.* ç³»åˆ—å‡½æ•°å¯ç”¨ã€‚å°†å¿«æ·é”®è®¾ç½®åœ¨è¿™é‡Œå¯ä»¥é¿å…åœ¨æ²¡æœ‰ LSP çš„ç¼“å†²åŒºä¸­åˆ›å»ºæ— æ•ˆçš„å¿«æ·é”®ã€‚
capabilities: è¿™ä¸ªé…ç½®éå¸¸é‡è¦ï¼Œç‰¹åˆ«æ˜¯å½“ä½ ä½¿ç”¨ nvim-cmp è¿™æ ·çš„è¡¥å…¨æ’ä»¶æ—¶ã€‚å®ƒå‘Šè¯‰ clangdï¼ŒNeovim å®¢æˆ·ç«¯æ”¯æŒå“ªäº›åŠŸèƒ½ï¼ˆä¾‹å¦‚ï¼Œä»£ç ç‰‡æ®µè¡¥å…¨ã€åŠ¨æ€æ³¨å†Œç­‰ï¼‰ã€‚cmp_nvim_lsp æä¾›äº†ä¸€ä¸ªæ–¹ä¾¿çš„å‡½æ•°æ¥ç”Ÿæˆè¿™ä¸ªé…ç½®ã€‚å¦‚æœä½ ä¸ä½¿ç”¨è¡¥å…¨æ’ä»¶ï¼Œå¯ä»¥ä½¿ç”¨é»˜è®¤çš„ vim.lsp.protocol.make_client_capabilities()ã€‚
vim.lsp.start(): è¿™æ˜¯æ ¸å¿ƒå‡½æ•°ã€‚
name: ä¸€ä¸ªå”¯ä¸€çš„æ ‡è¯†ç¬¦ï¼Œæ–¹ä¾¿è°ƒè¯•ã€‚ cmd: ä¸€ä¸ªåŒ…å«å‘½ä»¤åŠå…¶å‚æ•°çš„ tableã€‚è¿™æ˜¯å‘Šè¯‰ Neovim å¦‚ä½•å¯åŠ¨ clangd è¿›ç¨‹çš„åœ°æ–¹ã€‚ä½ å¯ä»¥æ·»åŠ  clangd æ”¯æŒçš„å„ç§å‘½ä»¤è¡Œå‚æ•°æ¥å¾®è°ƒå…¶è¡Œä¸ºã€‚ root_dir: vim.lsp.util.root_pattern æ˜¯ä¸€ä¸ªè¾…åŠ©å‡½æ•°ï¼Œå®ƒä¼šä»å½“å‰æ–‡ä»¶æ‰€åœ¨çš„ç›®å½•å¼€å§‹å‘ä¸ŠæŸ¥æ‰¾ï¼Œç›´åˆ°æ‰¾åˆ° .git ç›®å½•æˆ– compile_commands.json æ–‡ä»¶ï¼Œå¹¶å°†å…¶æ‰€åœ¨çš„ç›®å½•ä½œä¸ºé¡¹ç›®æ ¹ç›®å½•ã€‚ on_attach: å¼•ç”¨æˆ‘ä»¬ä¹‹å‰å®šä¹‰çš„å‡½æ•°ã€‚ autocmd: FileType äº‹ä»¶æ˜¯æœ€é€‚åˆç”¨æ¥å¯åŠ¨ LSP çš„æ—¶æœºã€‚å½“ Neovim è¯†åˆ«åˆ°ä¸€ä¸ªæ–‡ä»¶çš„ç±»å‹æ˜¯ c æˆ– cpp ç­‰æ—¶ï¼Œå°±ä¼šæ‰§è¡Œå›è°ƒå‡½æ•°ï¼Œä»è€Œå¯åŠ¨ clangdã€‚
æ€»ç»“ é€šè¿‡è¿™ç§æ‰‹åŠ¨æ–¹å¼ï¼Œä½ å¯ä»¥å®Œå…¨æ§åˆ¶ clangd çš„å¯åŠ¨å‚æ•°å’Œè¡Œä¸ºï¼Œè€Œæ— éœ€ä¾èµ–ä»»ä½•ä¸­é—´å±‚æ’ä»¶ã€‚è™½ç„¶ nvim-lspconfig é€šè¿‡é¢„è®¾çš„ç¤¾åŒºé…ç½®ç®€åŒ–äº†è¿™ä¸ªè¿‡ç¨‹ï¼Œä½†äº†è§£å…¶åº•å±‚åŸç†å¯¹äºè°ƒè¯•é—®é¢˜å’Œè¿›è¡Œæ·±åº¦å®šåˆ¶éå¸¸æœ‰å¸®åŠ©ã€‚
ç°åœ¨ï¼Œé‡å¯ Neovim å¹¶æ‰“å¼€ä¸€ä¸ª C/C++ é¡¹ç›®ï¼ˆç¡®ä¿æœ‰ compile_commands.jsonï¼‰ï¼Œä½ åº”è¯¥èƒ½çœ‹åˆ° clangd æˆåŠŸå¯åŠ¨ï¼Œå¹¶ä¸”ä½ è®¾ç½®çš„å¿«æ·é”®ä¹Ÿèƒ½æ­£å¸¸å·¥ä½œäº†ã€‚
`,url:"https://hugo-dead-simple.netlify.com/nvim-for-oi/clangd.html"},"https://hugo-dead-simple.netlify.com/categories/oi.html":{title:"Oi",tags:[],content:"",url:"https://hugo-dead-simple.netlify.com/categories/oi.html"},"https://hugo-dead-simple.netlify.com/tags/oi.html":{title:"Oi",tags:[],content:"",url:"https://hugo-dead-simple.netlify.com/tags/oi.html"},"https://hugo-dead-simple.netlify.com/nvim-for-oi/outline.html":{title:"outline",tags:["nvim","oi"],content:`å¥½çš„ï¼Œä½ æ­£åœ¨å¯»æ‰¾çš„è¿™ç±»æ’ä»¶é€šå¸¸è¢«ç§°ä¸ºâ€œç¬¦å·å¤§çº²â€ (Symbol Outline) æˆ–â€œç¬¦å·æ ‘â€ (Symbol Tree)ã€‚å®ƒä»¬åˆ©ç”¨ Neovim çš„ LSP (Language Server Protocol) åŠŸèƒ½æ¥è·å–ä»£ç çš„ç»“æ„ä¿¡æ¯ã€‚
å¯¹äº C++ï¼Œä½ éœ€è¦å…ˆç¡®ä¿ä½ çš„ Neovim å·²ç»é…ç½®å¥½äº† LSPï¼Œå¹¶ä¸”å®‰è£…äº† C++ çš„è¯­è¨€æœåŠ¡å™¨ï¼Œæœ€å¸¸ç”¨çš„æ˜¯ clangdã€‚
è¿™é‡Œæœ‰å‡ ä¸ªéå¸¸å‡ºè‰²çš„æ’ä»¶å¯ä»¥å®Œç¾å®ç°ä½ æƒ³è¦çš„åŠŸèƒ½ï¼Œå®ƒä»¬éƒ½éå¸¸æ¥è¿‘ VS Code çš„å¤§çº²è§†å›¾ã€‚
ğŸ‘‘ é¦–é€‰æ¨è: symbols-outline.nvim é“¾æ¥: simrat39/symbols-outline.nvim
è¿™å¯èƒ½æ˜¯æœ€ç›´æ¥ã€æœ€åƒ VS Code å¤§çº²çš„æ’ä»¶ã€‚å®ƒæä¾›ä¸€ä¸ªä¾§è¾¹æ ï¼Œç”¨æ ‘çŠ¶ç»“æ„æ¸…æ™°åœ°å±•ç¤ºå½“å‰æ–‡ä»¶ä¸­çš„æ‰€æœ‰ç¬¦å·ï¼ˆç±»ã€å‡½æ•°ã€å˜é‡ã€å®ç­‰ï¼‰ï¼Œå¹¶ä¸”ç‚¹å‡»å³å¯è·³è½¬ã€‚
ç‰¹ç‚¹:
éå¸¸ç›´è§‚çš„æ ‘çŠ¶è§†å›¾ã€‚ è‡ªåŠ¨éšä»£ç ä¿®æ”¹è€Œæ›´æ–°ã€‚ æ”¯æŒä¸°å¯Œçš„å›¾æ ‡ (éœ€è¦ nvim-web-devicons)ã€‚ é«˜åº¦å¯å®šåˆ¶ï¼Œå¯ä»¥è°ƒæ•´ä½ç½®ã€å®½åº¦ç­‰ã€‚ ä½¿ç”¨ lazy.nvim çš„å®‰è£…é…ç½®ç¤ºä¾‹:
1{ 2 &#34;simrat39/symbols-outline.nvim&#34;, 3 keys = { 4 { &#34;&lt;leader&gt;o&#34;, &#34;&lt;cmd&gt;SymbolsOutline&lt;cr&gt;&#34;, desc = &#34;Toggle Outline&#34; } 5 }, 6 config = function() 7 require(&#34;symbols-outline&#34;).setup() 8 end, 9} ä¸Šé¢çš„é…ç½®æ·»åŠ äº†ä¸€ä¸ªå¿«æ·é”® &lt;leader&gt;o æ¥æ‰“å¼€æˆ–å…³é—­å¤§çº²ä¾§è¾¹æ ã€‚ ğŸš€ å¼ºå¤§å¤‡é€‰: aerial.nvim é“¾æ¥: stevearc/aerial.nvim
Aerial æ˜¯å¦ä¸€ä¸ªåŠŸèƒ½æå…¶å¼ºå¤§çš„å¤§çº²æ’ä»¶ã€‚å®ƒä¸ä»…èƒ½æ˜¾ç¤ºç¬¦å·ï¼Œè¿˜èƒ½ä¸ nvim-navic (ä¸€ä¸ªåœ¨é¡¶éƒ¨æ˜¾ç¤ºå½“å‰ä»£ç ä¸Šä¸‹æ–‡çš„æ’ä»¶) ç­‰å·¥å…·é›†æˆï¼Œæä¾›æ›´ä¸°å¯Œçš„å¯¼èˆªä½“éªŒã€‚
ç‰¹ç‚¹:
æ”¯æŒå¤šç§åç«¯ï¼ˆLSP, Treesitterï¼‰ï¼Œä¿¡æ¯æ›´å…¨é¢ã€‚ UI é«˜åº¦å¯å®šåˆ¶ï¼Œå¯ä»¥ä½œä¸ºä¾§è¾¹æ æˆ–æµ®åŠ¨çª—å£ã€‚ å¯ä»¥æ˜¾ç¤ºä»£ç çš„å±‚çº§ç»“æ„ï¼Œéå¸¸é€‚åˆå¤§å‹é¡¹ç›®ã€‚ è¿‡æ»¤å’Œæ’åºåŠŸèƒ½å¼ºå¤§ã€‚ ä½¿ç”¨ lazy.nvim çš„å®‰è£…é…ç½®ç¤ºä¾‹:
1{ 2 &#34;stevearc/aerial.nvim&#34;, 3 -- å¯é€‰ä¾èµ–ï¼Œä½†å¼ºçƒˆæ¨è 4 dependencies = { 5 &#34;nvim-treesitter/nvim-treesitter&#34;, 6 &#34;nvim-tree/nvim-web-devicons&#34; 7 }, 8 keys = { 9 { &#34;&lt;leader&gt;o&#34;, &#34;&lt;cmd&gt;AerialToggle&lt;cr&gt;&#34;, desc = &#34;Toggle Outline&#34; } 10 }, 11 config = function() 12 require(&#39;aerial&#39;).setup({ 13 -- ä½ å¯ä»¥åœ¨è¿™é‡Œè¿›è¡Œå„ç§å®šåˆ¶ 14 -- æ¯”å¦‚ï¼Œé»˜è®¤åœ¨æ‰“å¼€æ–‡ä»¶æ—¶è‡ªåŠ¨æ‰“å¼€ aerial 15 -- on_attach = function(bufnr) 16 -- vim.api.nvim_create_autocmd(&#34;BufEnter&#34;, { 17 -- buffer = bufnr, 18 -- callback = function() 19 -- require(&#34;aerial&#34;).open({focus = false}) 20 -- end 21 -- }) 22 -- end 23 }) 24 end, 25} ğŸš è½»é‡å¤‡é€‰: Telescope (å†…ç½®åŠŸèƒ½) å¦‚æœä½ å·²ç»åœ¨ä½¿ç”¨ nvim-telescope/telescope.nvimï¼Œä½ å…¶å®å·²ç»æœ‰äº†ä¸€ä¸ªè½»é‡çº§çš„å¤§çº²åŠŸèƒ½ï¼Œå®ƒä¸æ˜¯ä¸€ä¸ªæŒä¹…çš„ä¾§è¾¹æ ï¼Œè€Œæ˜¯ä¸€ä¸ªå¯ä»¥éšæ—¶å‘¼å‡ºçš„æµ®åŠ¨æœç´¢æ¡†ã€‚
å¦‚ä½•ä½¿ç”¨: åœ¨æ™®é€šæ¨¡å¼ä¸‹ï¼Œç›´æ¥è¾“å…¥å‘½ä»¤ï¼š
1:Telescope lsp_document_symbols è¿™ä¼šå¼¹å‡ºä¸€ä¸ªæµ®åŠ¨çª—å£ï¼Œåˆ—å‡ºå½“å‰æ–‡ä»¶æ‰€æœ‰çš„ç¬¦å·ï¼Œä½ å¯ä»¥é€šè¿‡æ¨¡ç³Šæœç´¢å¿«é€Ÿå®šä½å¹¶è·³è½¬ã€‚
ç‰¹ç‚¹:
æ— éœ€å®‰è£…é¢å¤–æ’ä»¶ï¼ˆå¦‚æœä½ å·²å®‰è£… Telescopeï¼‰ã€‚ åˆ©ç”¨ Telescope å¼ºå¤§çš„æ¨¡ç³Šæœç´¢å’Œé¢„è§ˆåŠŸèƒ½ã€‚ æ›´é€‚åˆâ€œç”¨å®Œå³èµ°â€çš„å¿«é€Ÿè·³è½¬åœºæ™¯ã€‚ å»ºè®®ä¸ºå®ƒç»‘å®šä¸€ä¸ªå¿«æ·é”®:
1-- åœ¨ä½ çš„ Telescope é…ç½®æˆ–é”®ä½é…ç½®æ–‡ä»¶ä¸­ 2keys = { 3 { 4 &#34;&lt;leader&gt;os&#34;, -- &#39;o&#39; for outline, &#39;s&#39; for symbols 5 &#34;&lt;cmd&gt;Telescope lsp_document_symbols&lt;cr&gt;&#34;, 6 desc = &#34;Outline Symbols&#34; 7 }, 8} æ€»ç»“ä¸å¦‚ä½•é€‰æ‹© æ’ä»¶ UI é£æ ¼ ä¼˜ç‚¹ é€‚åˆåœºæ™¯ symbols-outline.nvim ä¾§è¾¹æ  (Sidebar) æœ€åƒ VS Codeï¼Œç›´è§‚æ˜“ç”¨ æƒ³è¦ä¸€ä¸ªå›ºå®šã€å¸¸é©»çš„å¤§çº²è§†å›¾æ¥éšæ—¶æŸ¥çœ‹ä»£ç ç»“æ„çš„ç”¨æˆ·ã€‚ aerial.nvim ä¾§è¾¹æ  / æµ®åŠ¨çª—å£ åŠŸèƒ½æœ€å¼ºå¤§ï¼Œé«˜åº¦å¯å®šåˆ¶ï¼Œé›†æˆæ€§å¥½ è¿½æ±‚æè‡´å®šåˆ¶å’Œå¼ºå¤§åŠŸèƒ½ï¼Œå¸Œæœ›å¤§çº²èƒ½ä¸å…¶ä»–å¯¼èˆªå·¥å…·è”åŠ¨çš„å¼€å‘è€…ã€‚ Telescope æµ®åŠ¨æœç´¢æ¡† è½»é‡ï¼Œæ— éœ€é¢å¤–æ’ä»¶ï¼Œæœç´¢é©±åŠ¨ ä¹ æƒ¯ä½¿ç”¨ Telescope è¿›è¡Œä¸€åˆ‡æ“ä½œï¼Œå–œæ¬¢ç”¨æœç´¢ä»£æ›¿ç‚¹å‡»ï¼Œä¸æƒ³è¦å¸¸é©»ä¾§è¾¹æ çš„ç”¨æˆ·ã€‚ æˆ‘çš„å»ºè®®æ˜¯ï¼š
å¦‚æœä½ åˆšä» VS Code è½¬è¿‡æ¥ï¼Œæƒ³è¦æœ€ç›¸ä¼¼çš„ä½“éªŒï¼Œè¯·ç›´æ¥å®‰è£… symbols-outline.nvimã€‚
å¦‚æœä½ æ˜¯ä¸€ä¸ªå–œæ¬¢æ·±åº¦å®šåˆ¶å’ŒæŠ˜è…¾çš„ &ldquo;Power User&rdquo;ï¼Œå¯ä»¥è¯•è¯• aerial.nvimã€‚
å¦‚æœä½ å´‡å°šæç®€ï¼Œå¹¶ä¸”æ˜¯ Telescope çš„é‡åº¦ç”¨æˆ·ï¼Œé‚£ä¹ˆä½¿ç”¨å†…ç½®çš„ lsp_document_symbols å°±è¶³å¤Ÿäº†ã€‚
`,url:"https://hugo-dead-simple.netlify.com/nvim-for-oi/outline.html"},"https://hugo-dead-simple.netlify.com/tags/self-record.html":{title:"Self-Record",tags:[],content:"",url:"https://hugo-dead-simple.netlify.com/tags/self-record.html"},"https://hugo-dead-simple.netlify.com/nvim-for-oi/vim-interaction.html":{title:"vimäº¤äº’",tags:["nvim"],content:`Interaction
https://neovim.io/doc/user/lua.html#vim.ui.input()
å½“ç„¶æœ‰ï¼è¿™æ˜¯ä¸€ä¸ªéå¸¸å¥½çš„é—®é¢˜ï¼Œä¹Ÿæ˜¯ Neovim åŒºåˆ«äºä¼ ç»Ÿ Vim çš„ä¸€å¤§ä¼˜åŠ¿ã€‚Neovim æä¾›äº†å¤šç§åˆ›å»ºå’Œç®¡ç†â€œå¯¹è¯æ¡†â€æˆ–äº¤äº’å¼ UI çš„æ–¹å¼ï¼Œä»ç®€å•çš„å‘½ä»¤è¡Œè¾“å…¥åˆ°åŠŸèƒ½å¼ºå¤§çš„æµ®åŠ¨çª—å£åº”æœ‰å°½æœ‰ã€‚
ç”±äº Neovim æ˜¯ä¸€ä¸ªç»ˆç«¯åº”ç”¨ï¼ˆTUIï¼‰ï¼Œå®ƒçš„â€œå¯¹è¯æ¡†â€é€šå¸¸ä»¥æµ®åŠ¨çª—å£æˆ–å‘½ä»¤è¡Œæç¤ºçš„å½¢å¼å‡ºç°ã€‚
ä¸‹é¢æˆ‘å°†ä¸ºä½ ä»‹ç»ä¸‰ç§ç”±æµ…å…¥æ·±ã€æœ€ä¸»æµçš„å®ç°æ–¹å¼ï¼š
æ ‡å‡† API (vim.ui): æœ€ç®€å•ã€æœ€æ ‡å‡†çš„äº¤äº’æ–¹å¼ã€‚ ç¾åŒ–æ’ä»¶ (dressing.nvim): è®©æ ‡å‡† API çš„å¯¹è¯æ¡†å˜å¾—éå¸¸æ¼‚äº®ã€‚ UI åº“ (nui.nvim): å®Œå…¨ä»é›¶å¼€å§‹æ„å»ºä½ è‡ªå·±çš„ã€å¤æ‚çš„å¯¹è¯æ¡†ã€‚ æ–¹å¼ä¸€ï¼šä½¿ç”¨æ ‡å‡† vim.ui API Neovim æä¾›äº†ä¸€å¥—æ ‡å‡†çš„ã€å¯è¢«æ’ä»¶è¦†ç›–çš„ UI æ¥å£ï¼švim.ui.input() å’Œ vim.ui.select()ã€‚è¿™æ˜¯ç¼–å†™äº¤äº’åŠŸèƒ½çš„é¦–é€‰æ–¹å¼ï¼Œå› ä¸ºå®ƒå…·æœ‰æœ€å¥½çš„å…¼å®¹æ€§ã€‚
1. vim.ui.input() - è·å–ç”¨æˆ·æ–‡æœ¬è¾“å…¥ è¿™ä¸ªå‡½æ•°ä¼šå¼¹å‡ºä¸€ä¸ªæç¤ºï¼Œè®©ç”¨æˆ·è¾“å…¥ä¸€æ®µæ–‡æœ¬ã€‚
ç¤ºä¾‹ï¼š åˆ›å»ºä¸€ä¸ªå‘½ä»¤ï¼Œè¯¢é—®ä½ çš„åå­—ï¼Œç„¶åæ‰“å°æ¬¢è¿ä¿¡æ¯ã€‚
1-- ä½ å¯ä»¥æŠŠè¿™ä¸ªå‡½æ•°æ”¾åœ¨ä½ çš„ä»»æ„é…ç½®æ–‡ä»¶ä¸­ 2function AskNameAndGreet() 3 vim.ui.input({ prompt = &#34;What is your name? &#34; }, function(name) 4 if name then 5 vim.notify(&#34;Hello, &#34; .. name .. &#34;!&#34;, vim.log.levels.INFO) 6 else 7 vim.notify(&#34;Greeting cancelled.&#34;, vim.log.levels.WARN) 8 end 9 end) 10end 11 12-- åˆ›å»ºä¸€ä¸ªç”¨æˆ·å‘½ä»¤æ¥è°ƒç”¨è¿™ä¸ªå‡½æ•° 13vim.api.nvim_create_user_command(&#34;Greet&#34;, AskNameAndGreet, {}) å¦‚ä½•ä½¿ç”¨ï¼š
å°†ä¸Šè¿°ä»£ç æ·»åŠ åˆ°ä½ çš„é…ç½®ä¸­ï¼ˆä¾‹å¦‚ init.luaï¼‰ã€‚ é‡å¯ Neovimã€‚ åœ¨å‘½ä»¤æ¨¡å¼ä¸‹è¾“å…¥ :Greet å¹¶å›è½¦ã€‚ é»˜è®¤æƒ…å†µä¸‹ï¼Œè¿™ä¼šåœ¨å‘½ä»¤è¡Œæ˜¾ç¤ºä¸€ä¸ªç®€å•çš„è¾“å…¥æç¤ºã€‚
2. vim.ui.select() - è®©ç”¨æˆ·ä»åˆ—è¡¨ä¸­é€‰æ‹© è¿™ä¸ªå‡½æ•°ä¼šæ˜¾ç¤ºä¸€ä¸ªåˆ—è¡¨ï¼Œè®©ç”¨æˆ·é€‰æ‹©å…¶ä¸­ä¸€é¡¹ã€‚
ç¤ºä¾‹ï¼š åˆ›å»ºä¸€ä¸ªå‘½ä»¤ï¼Œè®©ä½ é€‰æ‹©ä¸€ä¸ªç¼–ç¨‹è¯­è¨€ï¼Œç„¶åå‘Šè¯‰ä½ ä½ çš„é€‰æ‹©ã€‚
1function ChooseLanguage() 2 local items = { &#34;C++&#34;, &#34;Rust&#34;, &#34;Lua&#34;, &#34;TypeScript&#34; } 3 vim.ui.select(items, { prompt = &#34;Choose your favorite language:&#34; }, function(choice) 4 if choice then 5 vim.notify(&#34;You chose: &#34; .. choice) 6 else 7 vim.notify(&#34;Selection cancelled.&#34;) 8 end 9 end) 10end 11 12vim.api.nvim_create_user_command(&#34;ChooseLang&#34;, ChooseLanguage, {}) å¦‚ä½•ä½¿ç”¨ï¼š
å°†ä»£ç åŠ å…¥é…ç½®å¹¶é‡å¯ã€‚ è¾“å…¥ :ChooseLang å¹¶å›è½¦ã€‚ é»˜è®¤æƒ…å†µä¸‹ï¼Œè¿™ä¼šåœ¨å‘½ä»¤è¡Œæ˜¾ç¤ºå¸¦ç¼–å·çš„é€‰é¡¹åˆ—è¡¨ã€‚
é‡ç‚¹ï¼švim.ui çš„ç¾å¦™ä¹‹å¤„åœ¨äºï¼Œå®ƒçš„å¤–è§‚æ˜¯å¯ä»¥è¢«å…¶ä»–æ’ä»¶â€œç¾åŒ–â€çš„ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬çœ‹å¦‚ä½•åšåˆ°ã€‚
æ–¹å¼äºŒï¼šä½¿ç”¨ dressing.nvim å‡çº§å¯¹è¯æ¡†å¤–è§‚ dressing.nvim æ˜¯ä¸€ä¸ªâ€œèƒ¶æ°´â€æ’ä»¶ï¼Œå®ƒçš„å”¯ä¸€ä½œç”¨å°±æ˜¯å°† vim.ui.input å’Œ vim.ui.select çš„è¯·æ±‚ï¼Œè½¬å‘ç»™å…¶ä»–æ›´ç¾è§‚çš„ UI æ’ä»¶ï¼Œæ¯”å¦‚ Telescopeã€fzf-lua æˆ–è€…å®ƒè‡ªå·±å†…ç½®çš„æ¼‚äº®æµ®åŠ¨çª—å£ã€‚
è¿™æ˜¯å®ç°æ¼‚äº®å¯¹è¯æ¡†æœ€ç®€å•ã€æœ€æ¨èçš„æ–¹å¼ã€‚
é…ç½® (lazy.nvim):
1-- lua/plugins/dressing.lua 2return { 3 &#34;stevearc/dressing.nvim&#34;, 4 event = &#34;VeryLazy&#34;, 5 opts = { 6 -- backend = { &#34;telescope&#34;, &#34;fzf_lua&#34;, &#34;fzf&#34;, &#34;builtin&#34;, &#34;nui&#34; }, -- ä½ å¯ä»¥æŒ‡å®šåç«¯çš„ä¼˜å…ˆçº§ 7 input = { 8 -- ä½¿ç”¨å†…ç½®çš„æ¼‚äº®æµ®åŠ¨çª—å£ä½œä¸ºè¾“å…¥æ¡† 9 backend = &#34;builtin&#34;, 10 }, 11 select = { 12 -- ä½¿ç”¨å†…ç½®çš„æµ®åŠ¨çª—å£ä½œä¸ºé€‰æ‹©å™¨ 13 backend = &#34;builtin&#34;, 14 -- å¦‚æœä½ æ›´å–œæ¬¢ Telescopeï¼Œå¯ä»¥è¿™æ ·è®¾ç½®ï¼š 15 -- backend = &#34;telescope&#34;, 16 }, 17 }, 18} æ•ˆæœï¼š å®‰è£…å¹¶é…ç½®å¥½ dressing.nvim åï¼Œä½ ä¸éœ€è¦ä¿®æ”¹ä»»ä½•ä»£ç ã€‚å†æ¬¡è¿è¡Œ :Greet æˆ– :ChooseLang å‘½ä»¤ï¼Œä½ ä¼šå‘ç°åŸæ¥çš„å‘½ä»¤è¡Œæç¤ºå˜æˆäº†ä¸€ä¸ªå±…ä¸­çš„ã€å¸¦è¾¹æ¡†çš„æ¼‚äº®æµ®åŠ¨çª—å£ï¼
æ–¹å¼ä¸‰ï¼šä½¿ç”¨ nui.nvim æ„å»ºå®Œå…¨è‡ªå®šä¹‰çš„å¯¹è¯æ¡† å½“ä½ éœ€è¦æ„å»ºä¸€ä¸ªéæ ‡å‡†çš„ã€å¸ƒå±€å¤æ‚çš„å¯¹è¯æ¡†æ—¶ï¼ˆä¾‹å¦‚ï¼Œä¸€ä¸ªåŒ…å«å¤šä¸ªè¾“å…¥æ¡†å’ŒæŒ‰é’®çš„çª—å£ï¼‰ï¼Œnui.nvim å°±æ˜¯ä½ çš„ç»ˆææ­¦å™¨ã€‚å®ƒæ˜¯ä¸€ä¸ªåº•å±‚çš„ UI ç»„ä»¶åº“ï¼Œè®©ä½ åƒæ‹¼ä¹é«˜ä¸€æ ·ç»„åˆå‡ºä»»æ„ç•Œé¢ã€‚
dressing.nvim çš„ builtin åç«¯å°±æ˜¯åŸºäº nui.nvim æ„å»ºçš„ã€‚
ç¤ºä¾‹ï¼š åˆ›å»ºä¸€ä¸ªç®€å•çš„å¸¦è¾¹æ¡†å’Œæ ‡é¢˜çš„æµ®åŠ¨çª—å£ã€‚
è¿™æ˜¯ä¸€ä¸ªæ›´åº•å±‚çš„ APIï¼Œä»£ç ä¼šç›¸å¯¹å¤æ‚ä¸€äº›ã€‚
1function ShowCustomDialog() 2 local nui = require(&#34;nui&#34;) 3 local Popup = nui.require(&#34;nui.popup&#34;) 4 5 local popup = Popup({ 6 enter = true, -- åˆ›å»ºåç«‹å³è¿›å…¥ 7 focusable = true, -- å¯èšç„¦ 8 border = { 9 style = &#34;rounded&#34;, -- åœ†è§’è¾¹æ¡† 10 text = { 11 top = &#34; My Custom Dialog &#34;, 12 top_align = &#34;center&#34;, 13 }, 14 }, 15 position = &#34;50%&#34;, -- æ°´å¹³å±…ä¸­ 16 size = { 17 width = &#34;80%&#34;, 18 height = &#34;60%&#34;, 19 }, 20 }) 21 22 -- æŒ‚è½½ UI ç»„ä»¶ï¼Œä½¿å…¶æ˜¾ç¤ºå‡ºæ¥ 23 popup:mount() 24 25 -- å½“çª—å£å…³é—­æ—¶ï¼Œå¸è½½å®ƒä»¥é‡Šæ”¾èµ„æº 26 popup:on(&#34;BufLeave&#34;, function() 27 popup:unmount() 28 end) 29end 30 31vim.api.nvim_create_user_command(&#34;CustomDialog&#34;, ShowCustomDialog, {}) å¦‚ä½•ä½¿ç”¨ï¼š
ç¡®ä¿ä½ å·²å®‰è£… nui.nvim (dressing.nvim ä¼šè‡ªåŠ¨å®‰è£…å®ƒä½œä¸ºä¾èµ–ï¼‰ã€‚ å°†ä»£ç åŠ å…¥é…ç½®å¹¶é‡å¯ã€‚ è¾“å…¥ :CustomDialog å³å¯çœ‹åˆ°ä¸€ä¸ªç©ºçš„ã€è‡ªå®šä¹‰æ ·å¼çš„æµ®åŠ¨çª—å£ã€‚ä½ å¯ä»¥åœ¨æ­¤åŸºç¡€ä¸Šæ·»åŠ æ›´å¤šç»„ä»¶ã€‚ æ€»ç»“ä¸æ¨è æ–¹æ³• ä¼˜ç‚¹ ç¼ºç‚¹ é€‚ç”¨åœºæ™¯ vim.ui API æ ‡å‡†ã€å¯ç§»æ¤ã€ç®€å• é»˜è®¤å¤–è§‚ç®€é™‹ ç¼–å†™æ‰€æœ‰äº¤äº’é€»è¾‘çš„é¦–é€‰ã€‚ dressing.nvim é…ç½®ç®€å•ã€æ•ˆæœç«‹ç«¿è§å½± ä¾èµ–å…¶ä»–æ’ä»¶ è®© vim.ui å˜æ¼‚äº®çš„â€œä¸€åŠ³æ°¸é€¸â€æ–¹æ¡ˆã€‚ nui.nvim æå…¶çµæ´»ï¼Œå®Œå…¨æ§åˆ¶ UI API ç›¸å¯¹å¤æ‚ï¼Œä»£ç é‡å¤§ ç¼–å†™æ’ä»¶ï¼Œæˆ–éœ€è¦é«˜åº¦è‡ªå®šä¹‰çš„å¤æ‚å¯¹è¯æ¡†ã€‚ æˆ‘çš„å»ºè®®æ˜¯ï¼š
å§‹ç»ˆä½¿ç”¨ vim.ui.input å’Œ vim.ui.select æ¥ç¼–å†™ä½ çš„äº¤äº’åŠŸèƒ½ã€‚ç„¶åï¼Œå®‰è£… dressing.nvim æ¥ç¾åŒ–å®ƒä»¬ã€‚è¿™æ ·ä½ çš„ä»£ç æ—¢æ ‡å‡†åˆèƒ½åœ¨ä»»ä½•é…ç½®äº† dressing.nvim çš„ Neovim ä¸Šè·å¾—æ¼‚äº®çš„ UIã€‚åªæœ‰åœ¨ dressing.nvim æ— æ³•æ»¡è¶³ä½ å¤æ‚çš„å¸ƒå±€éœ€æ±‚æ—¶ï¼Œæ‰è€ƒè™‘ç›´æ¥ä½¿ç”¨ nui.nvimã€‚
è§£æ”¾åŒæ‰‹ï¼šsnacks.nvim inputæ¨¡å—è¯­éŸ³è¾“å…¥å…¨æŒ‡å—
`,url:"https://hugo-dead-simple.netlify.com/nvim-for-oi/vim-interaction.html"},"https://hugo-dead-simple.netlify.com/nvim-for-oi/which-key.html":{title:"which-key",tags:["nvim","oi"],content:`1. ä½¿ç”¨ which-key æœ€ä½³å®è·µ å½“ç„¶ï¼Œä½¿ç”¨ which-key.nvim çš„ç›®æ ‡ä¸ä»…ä»…æ˜¯â€œæ˜¾ç¤ºæŒ‰é”®â€ï¼Œæ›´æ˜¯ä¸ºäº†æ„å»ºä¸€ä¸ªå¯å‘ç°ã€æœ‰é€»è¾‘ã€æ˜“äºè®°å¿†çš„é”®ä½ç³»ç»Ÿã€‚ä»¥ä¸‹æ˜¯ä¸€äº›è¢«å¹¿æ³›è®¤å¯çš„æœ€ä½³å®è·µï¼š
1.1. åˆç†ç»„ç»‡ä½ çš„æŒ‰é”® (Organize Your Keys Logically) è¿™æ˜¯æœ€æ ¸å¿ƒçš„ä¸€ç‚¹ã€‚ä¸è¦éšæ„æ”¾ç½®é”®ä½ï¼Œè¦ç”¨åˆ†ç»„å’ŒåŠ©è®°ç¬¦æ¥æ„å»ºä½ çš„é…ç½®ã€‚
ä½¿ç”¨åŠ©è®°ç¬¦ (Mnemonics): é”®ä½çš„é¦–å­—æ¯åº”è¯¥å’Œå®ƒæ‰§è¡Œçš„åŠ¨ä½œç›¸å…³è”ã€‚è¿™ä½¿å¾—è®°å¿†æˆæœ¬å¤§å¤§é™ä½ã€‚
&lt;leader&gt;f -&gt; Find (æŸ¥æ‰¾) &lt;leader&gt;g -&gt; Git (Git ç›¸å…³) &lt;leader&gt;b -&gt; Buffers (ç¼“å†²åŒº) &lt;leader&gt;p -&gt; Project (é¡¹ç›®) &lt;leader&gt;t -&gt; Toggle (åˆ‡æ¢) or Terminal (ç»ˆç«¯) åˆ›å»ºåµŒå¥—åˆ†ç»„: which-key æœ€å¼ºå¤§çš„åŠŸèƒ½å°±æ˜¯åˆ†ç»„ã€‚å°†ç›¸å…³çš„åŠŸèƒ½ç»„ç»‡åœ¨ä¸€èµ·ã€‚
ä¸€ä¸ªå…¸å‹çš„ Git åˆ†ç»„ç¤ºä¾‹ï¼š
1{ 2 &#34;&lt;leader&gt;g&#34;, 3 group = &#34;Git&#34;, 4 -- è¿™ä¸ªåˆ†ç»„çš„å›¾æ ‡ 5 icon = &#34;ï¡&#34;, 6}, 7{ &#34;&lt;leader&gt;gs&#34;, &#34;&lt;cmd&gt;Telescope git_status&lt;cr&gt;&#34;, desc = &#34;Status&#34; }, 8{ &#34;&lt;leader&gt;gc&#34;, &#34;&lt;cmd&gt;Telescope git_commits&lt;cr&gt;&#34;, desc = &#34;Commits&#34; }, 9{ &#34;&lt;leader&gt;gb&#34;, &#34;&lt;cmd&gt;Telescope git_branches&lt;cr&gt;&#34;, desc = &#34;Branches&#34; }, 10{ &#34;&lt;leader&gt;gp&#34;, &#34;&lt;cmd&gt;Git push&lt;cr&gt;&#34;, desc = &#34;Push&#34; }, 11{ &#34;&lt;leader&gt;gl&#34;, &#34;&lt;cmd&gt;Git pull&lt;cr&gt;&#34;, desc = &#34;Pull&#34; }, å½“ä½ æŒ‰ä¸‹ &lt;leader&gt;g åï¼Œwhich-key ä¼šå¼¹å‡ºä¸€ä¸ªæ ‡é¢˜ä¸º &ldquo;Git&rdquo; çš„èœå•ï¼Œé‡Œé¢åˆ—å‡ºäº† Status, Commits, Branches ç­‰é€‰é¡¹ï¼Œéå¸¸æ¸…æ™°ã€‚
1.2. ç¼–å†™æ¸…æ™°ã€ç®€æ´çš„æè¿° (Write Clear and Concise Descriptions) desc å­—æ®µæ˜¯ç”¨æˆ·çœ‹åˆ°çš„æç¤ºï¼Œå®ƒçš„å¥½åç›´æ¥å½±å“ä½“éªŒã€‚
æè¿°â€œåšä»€ä¹ˆâ€ï¼Œè€Œä¸æ˜¯â€œç”¨ä»€ä¹ˆå·¥å…·â€:
æ¨è: desc = &quot;Find Files&quot; ä¸æ¨è: desc = &quot;Telescope find_files&quot; ç”¨æˆ·å…³å¿ƒçš„æ˜¯â€œæŸ¥æ‰¾æ–‡ä»¶â€è¿™ä¸ªåŠ¨ä½œï¼Œè€Œä¸æ˜¯èƒŒåç”¨çš„æ˜¯ Telescope è¿˜æ˜¯ fzf.vimã€‚ ä¿æŒç®€æ´: èœå•ç©ºé—´æœ‰é™ï¼Œæè¿°è¦ä¸€ç›®äº†ç„¶ã€‚
åŠ¨è¯å¼€å¤´: å°½é‡ä½¿ç”¨ &ldquo;Find&rdquo;, &ldquo;Go to&rdquo;, &ldquo;Toggle&rdquo;, &ldquo;Open&rdquo;, &ldquo;Format&rdquo; ç­‰åŠ¨è¯å¼€å¤´çš„æè¿°ï¼Œè¡¨æ„æ›´æ˜ç¡®ã€‚
1.3. åˆ©ç”¨ Lazy Loading (Leverage Lazy Loading) ä¸ºäº†ä¼˜åŒ– Neovim çš„å¯åŠ¨é€Ÿåº¦ï¼Œä½ åº”è¯¥å°½å¯èƒ½åœ°æ‡’åŠ è½½æ’ä»¶ã€‚which-key ä¸ lazy.nvim æ’ä»¶ç®¡ç†å™¨å¯ä»¥å®Œç¾é…åˆã€‚
å°†é”®ä½ç»‘å®šå’Œæ’ä»¶é…ç½®æ”¾åœ¨ä¸€èµ·: è¿™æ˜¯ç°ä»£ Neovim é…ç½®çš„æœ€ä½³å®è·µã€‚lazy.nvim å…è®¸ä½ ä½¿ç”¨ keys è¡¨æ¥å®šä¹‰é”®ä½ï¼Œè¿™äº›é”®ä½ä¼šåœ¨ä½ æŒ‰ä¸‹æ—¶æ‰è§¦å‘æ’ä»¶åŠ è½½ã€‚which-key ä¼šè‡ªåŠ¨è¯†åˆ«è¿™äº›é”®ä½ã€‚
1-- plugins/telescope.lua 2return { 3 &#34;nvim-telescope/telescope.nvim&#34;, 4 dependencies = { &#34;nvim-lua/plenary.nvim&#34; }, 5 -- ä½¿ç”¨ keys æ¥å®šä¹‰é”®ä½ï¼Œè¿™ä¼šè‡ªåŠ¨å®ç°æ‡’åŠ è½½ 6 keys = { 7 { &#34;&lt;leader&gt;ff&#34;, &#34;&lt;cmd&gt;Telescope find_files&lt;cr&gt;&#34;, desc = &#34;Find Files&#34; }, 8 { &#34;&lt;leader&gt;fg&#34;, &#34;&lt;cmd&gt;Telescope live_grep&lt;cr&gt;&#34;, desc = &#34;Live Grep&#34; }, 9 { &#34;&lt;leader&gt;fb&#34;, &#34;&lt;cmd&gt;Telescope buffers&lt;cr&gt;&#34;, desc = &#34;Find Buffers&#34; }, 10 -- which-key ä¼šè‡ªåŠ¨æŠŠè¿™äº›é”®ä½æ”¶é›†èµ·æ¥å¹¶æ˜¾ç¤º 11 }, 12} è¿™æ ·åšçš„å¥½å¤„æ˜¯ï¼š
Telescope ä¸ä¼šåœ¨å¯åŠ¨æ—¶åŠ è½½ï¼Œåªæœ‰å½“ä½ æŒ‰ä¸‹ &lt;leader&gt;ff ç­‰é”®æ—¶æ‰ä¼šåŠ è½½ã€‚ é”®ä½é…ç½®å’Œæ’ä»¶æœ¬èº«åœ¨ä¸€èµ·ï¼Œæ–¹ä¾¿ç®¡ç†ã€‚ which-key æ— éœ€é¢å¤–é…ç½®ï¼Œå°±èƒ½æ™ºèƒ½åœ°å±•ç¤ºè¿™äº›æ‡’åŠ è½½çš„é”®ä½ã€‚ 1.4. åˆ†ç¦»ä½ çš„é”®ä½é…ç½® (Separate Your Keymap Configurations) å¯¹äºä¸å±äºä»»ä½•ç‰¹å®šæ’ä»¶çš„æ ¸å¿ƒé”®ä½ï¼ˆä¾‹å¦‚çª—å£ç®¡ç†ã€ç¼“å†²åŒºè·³è½¬ï¼‰ï¼Œæœ€å¥½å°†å®ƒä»¬ç»Ÿä¸€æ”¾åœ¨ä¸€ä¸ªåœ°æ–¹ã€‚
åˆ›å»ºä¸€ä¸ªä¸“é—¨çš„æ–‡ä»¶ï¼Œä¾‹å¦‚ lua/core/keymaps.luaã€‚ åœ¨è¿™ä¸ªæ–‡ä»¶ä¸­å®šä¹‰ä½ çš„é€šç”¨é”®ä½ç»‘å®šã€‚ åœ¨ä½ çš„ init.lua ä¸­åŠ è½½è¿™ä¸ªæ–‡ä»¶ã€‚ è¿™æ ·å¯ä»¥è®©ä½ çš„é…ç½®ç»“æ„æ›´åŠ æ¸…æ™°ï¼Œæ˜“äºæŸ¥æ‰¾å’Œä¿®æ”¹ã€‚
1-- lua/core/keymaps.lua 2-- ä½¿ç”¨ which-key.add() æ¥æ³¨å†Œ 3local wk = require(&#34;which-key&#34;) 4 5wk.add({ 6 { &#34;&lt;leader&gt;w&#34;, group = &#34;Window&#34; }, 7 { &#34;&lt;leader&gt;wv&#34;, &#34;&lt;C-w&gt;v&#34;, desc = &#34;Split Vertical&#34; }, 8 { &#34;&lt;leader&gt;ws&#34;, &#34;&lt;C-w&gt;s&#34;, desc = &#34;Split Horizontal&#34; }, 9 { &#34;&lt;leader&gt;wc&#34;, &#34;&lt;C-w&gt;c&#34;, desc = &#34;Close Window&#34; }, 10 11 { &#34;&lt;leader&gt;h&#34;, &#34;&lt;C-w&gt;h&#34;, desc = &#34;Navigate Left&#34; }, 12 { &#34;&lt;leader&gt;j&#34;, &#34;&lt;C-w&gt;j&#34;, desc = &#34;Navigate Down&#34; }, 13 -- ... etc 14}) 1.5. å–„ç”¨é«˜çº§åŠŸèƒ½ (Make Good Use of Advanced Features) å›¾æ ‡ (Icons): å¦‚æœä½ å®‰è£…äº† nvim-web-deviconsï¼Œå¯ä»¥ä¸ºåˆ†ç»„æˆ–å•ä¸ªæ¡ç›®æ·»åŠ å›¾æ ‡ï¼Œè®©èœå•æ›´ç¾è§‚ã€æ›´å…·è¾¨è¯†åº¦ã€‚ 1{ &#34;&lt;leader&gt;f&#34;, group = &#34;Find&#34;, icon = &#34;ï€‚&#34; }, -- ï¢ ï€‚ ï‡¥ ç­‰ Nerd Font å›¾æ ‡ æ¡ä»¶æ˜¾ç¤º (cond): å¯ä»¥æ ¹æ®ç‰¹å®šæ¡ä»¶å†³å®šæ˜¯å¦æ˜¾ç¤ºæŸä¸ªé”®ä½ã€‚ä¾‹å¦‚ï¼Œåªåœ¨å½“å‰ç¼“å†²åŒºæ”¯æŒä»£ç æ ¼å¼åŒ–æ—¶ï¼Œæ‰æ˜¾ç¤ºæ ¼å¼åŒ–å¿«æ·é”®ã€‚ 1{ 2 &#34;&lt;leader&gt;lf&#34;, 3 function() vim.lsp.buf.format() end, 4 desc = &#34;Format Code&#34;, 5 -- ä»…å½“ LSP æ”¯æŒæ ¼å¼åŒ–æ—¶æ‰æ˜¾ç¤ºæ­¤æŒ‰é”® 6 cond = function() 7 return vim.lsp.get_active_clients({ bufnr = 0, method = &#34;textDocument/formatting&#34; })[1] 8 end 9} åŒºåˆ†æ¨¡å¼ (mode): ä¸è¦å¿˜è®°ä¸ºä¸åŒçš„æ¨¡å¼ï¼ˆå¦‚ Visual æ¨¡å¼ vï¼ŒInsert æ¨¡å¼ iï¼‰è®¾ç½®ä¸åŒçš„é”®ä½ã€‚which-key åŒæ ·æ”¯æŒã€‚ 1.6. æ€»ç»“ which-key çš„æœ€ä½³å®è·µæ ¸å¿ƒæ€æƒ³æ˜¯**â€œè®¾è®¡â€è€Œéâ€œå †ç Œâ€**ã€‚ä¸€ä¸ªå¥½çš„ which-key é…ç½®æœ¬èº«å°±æ˜¯ä¸€ä»½åŠ¨æ€ã€äº¤äº’å¼çš„ä¸ªäººæ–‡æ¡£ï¼Œå®ƒèƒ½å¼•å¯¼ä½ æ›´é«˜æ•ˆåœ°ä½¿ç”¨ Neovimï¼Œå¹¶æœ€ç»ˆå¸®ä½ æŠŠè¿™äº›é”®ä½å½¢æˆè‚Œè‚‰è®°å¿†ã€‚
2. å®šä¹‰åˆ†ç»„åœ¨â€œå…±åŒå‰ç¼€â€ä¸Š ä¾‹å­
1-- åœ¨ä½ çš„ plugins/gitsigns.lua æ–‡ä»¶ä¸­ 2return { 3 &#34;lewis6991/gitsigns.nvim&#34;, 4 -- å…¶ä»–é…ç½®... 5 keys = { 6 -- â†“â†“â†“ è¿™å°±æ˜¯é‚£ä¸ªç‰¹æ®Šçš„â€œæ˜¾å¼åˆ†ç»„æ¡ç›®â€ â†“â†“â†“ 7 { 8 &#34;&lt;leader&gt;g&#34;, 9 group = &#34;Git&#34;, -- å­èœå•çš„æ ‡é¢˜ 10 desc = &#34;Git (Gitsigns)&#34;, -- åœ¨&lt;leader&gt;èœå•ä¸­æ˜¾ç¤ºçš„æè¿° 11 icon = &#34;ï¡&#34;, -- Nerd Font å›¾æ ‡ (å¯é€‰) 12 -- æ³¨æ„: è¿™é‡Œæ²¡æœ‰ç¬¬äºŒä¸ªå…ƒç´  (rhs å‘½ä»¤) 13 }, 14 15 -- â†“â†“â†“ ä¸‹é¢æ˜¯è¿™ä¸ªåˆ†ç»„é‡Œçš„å…·ä½“é”®ä½ â†“â†“â†“ 16 { &#34;&lt;leader&gt;gj&#34;, &#34;&lt;cmd&gt;Gitsigns next_hunk&lt;cr&gt;&#34;, desc = &#34;Next Hunk&#34; }, 17 { &#34;&lt;leader&gt;gk&#34;, &#34;&lt;cmd&gt;Gitsigns prev_hunk&lt;cr&gt;&#34;, desc = &#34;Previous Hunk&#34; }, 18 { &#34;&lt;leader&gt;gp&#34;, &#34;&lt;cmd&gt;Gitsigns preview_hunk&lt;cr&gt;&#34;, desc = &#34;Preview Hunk&#34; }, 19 { &#34;&lt;leader&gt;gs&#34;, &#34;&lt;cmd&gt;Gitsigns stage_hunk&lt;cr&gt;&#34;, desc = &#34;Stage Hunk&#34; }, 20 { &#34;&lt;leader&gt;gu&#34;, &#34;&lt;cmd&gt;Gitsigns undo_stage_hunk&lt;cr&gt;&#34;, desc = &#34;Undo Stage&#34; }, 21 { &#34;&lt;leader&gt;gr&#34;, &#34;&lt;cmd&gt;Gitsigns reset_hunk&lt;cr&gt;&#34;, desc = &#34;Reset Hunk&#34; }, 22 }, 23} `,url:"https://hugo-dead-simple.netlify.com/nvim-for-oi/which-key.html"},"https://hugo-dead-simple.netlify.com/nvim-for-oi/%E8%AE%BE%E8%AE%A1%E6%80%9D%E6%83%B3.html":{title:"è®¾è®¡æ€æƒ³",tags:[""],content:`å¤ªæ£’äº†ï¼è¿™æ˜¯ä¸€ä¸ªéå¸¸ç»å…¸ä¸”æœ‰ä»·å€¼çš„åœºæ™¯ã€‚ä¸º Codeforces (æˆ–å…¶ä»– competitive programming å¹³å°) æ‰“é€ ä¸€ä¸ªé«˜æ•ˆçš„ Neovim å·¥ä½œæµï¼Œå¯ä»¥æå¤§åœ°æå‡ä½ çš„è§£é¢˜é€Ÿåº¦å’Œä½“éªŒã€‚
æˆ‘ä»¬å°†å›´ç»•ä¸€ç³»åˆ—ç²¾å¿ƒè®¾è®¡çš„ Bash è„šæœ¬å’Œ Neovim é…ç½®ï¼Œæ„å»ºä¸€ä¸ªæ— ç¼çš„â€œç¼–ç -ç¼–è¯‘-æµ‹è¯•-è°ƒè¯•â€å¾ªç¯ã€‚
æ ¸å¿ƒç†å¿µ ä½ çš„å·¥ä½œç›®å½•å°†å›´ç»•ä¸€ä¸ªé—®é¢˜ä¸€ä¸ªæ–‡ä»¶å¤¹çš„æ¨¡å¼å±•å¼€ã€‚ä¾‹å¦‚ï¼š
1/home/user/codeforces/ 2â”œâ”€â”€ 1800A/ 3â”‚ â”œâ”€â”€ main.cpp 4â”‚ â”œâ”€â”€ input.txt 5â”‚ â”œâ”€â”€ answer.txt 6â”‚ â””â”€â”€ .vscode/ 7â”‚ â””â”€â”€ launch.json (ç”¨äº DAP è°ƒè¯•) 8â”œâ”€â”€ 1800B/ 9â”‚ â””â”€â”€ ... 10â””â”€â”€ templates/ 11 â”œâ”€â”€ default.cpp 12 â”œâ”€â”€ graph.cpp 13 â””â”€â”€ math.cpp æ¯ä¸ªæ–‡ä»¶å¤¹éƒ½æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„å·¥ä½œåŒºï¼ŒåŒ…å«ä»£ç ã€è¾“å…¥ã€æ ‡å‡†è¾“å‡ºå’Œè°ƒè¯•é…ç½®ã€‚
ç¬¬ä¸€æ­¥ï¼šè®¾ç½®æ¨¡æ¿å’Œåˆå§‹åŒ–è„šæœ¬ è¿™æ˜¯æ‰€æœ‰å·¥ä½œçš„èµ·ç‚¹ã€‚æˆ‘ä»¬éœ€è¦ä¸€ä¸ªè„šæœ¬æ¥å¿«é€Ÿåˆ›å»ºä¸Šè¿°çš„ç›®å½•ç»“æ„ã€‚
1. ä»£ç æ¨¡æ¿ (~/codeforces/templates/default.cpp) é¦–å…ˆï¼Œåˆ›å»ºä¸€ä¸ªæˆ–å¤šä¸ªä½ å¸¸ç”¨çš„ä»£ç æ¨¡æ¿ã€‚è¿™æ˜¯ä¸€ä¸ªåŸºç¡€æ¨¡æ¿ç¤ºä¾‹ï¼š
1// ~/codeforces/templates/default.cpp 2#include &lt;iostream&gt; 3#include &lt;vector&gt; 4#include &lt;string&gt; 5#include &lt;algorithm&gt; 6// ... å…¶ä»–å¸¸ç”¨å¤´æ–‡ä»¶ 7 8// Fast I/O 9void fast_io() { 10 std::ios_base::sync_with_stdio(false); 11 std::cin.tie(NULL); 12} 13 14// ä¸»è§£é¢˜å‡½æ•° 15void solve() { 16 // åœ¨è¿™é‡Œå†™ä½ çš„ä»£ç  17} 18 19int main() { 20 fast_io(); 21 int t = 1; 22 std::cin &gt;&gt; t; // å¦‚æœæ˜¯å¤šç»„æµ‹è¯•ç”¨ä¾‹ 23 while (t--) { 24 solve(); 25 } 26 return 0; 27} 2. åˆå§‹åŒ–è„šæœ¬ (cf-new.sh) åœ¨ä½ çš„ PATH ç¯å¢ƒå˜é‡èƒ½æ‰¾åˆ°çš„åœ°æ–¹ï¼ˆä¾‹å¦‚ ~/.local/bin/ï¼‰åˆ›å»ºä¸€ä¸ªåä¸º cf-new.sh çš„è„šæœ¬ã€‚
1#!/bin/bash 2 3# cf-new.sh - åˆ›å»ºä¸€ä¸ªæ–°çš„ Codeforces é—®é¢˜ç›®å½• 4 5# æ£€æŸ¥æ˜¯å¦æä¾›äº†é—®é¢˜åç§° 6if [ -z &#34;$1&#34; ]; then 7 echo &#34;Usage: $0 &lt;problem_name&gt; [template_name]&#34; 8 exit 1 9fi 10 11PROBLEM_NAME=$1 12TEMPLATE_NAME=\${2:-default} # å¦‚æœæ²¡æœ‰æä¾›æ¨¡æ¿åï¼Œåˆ™é»˜è®¤ä¸º default 13BASE_DIR=&#34;/home/user/codeforces&#34; # !! ä¿®æ”¹ä¸ºä½ çš„ Codeforces æ ¹ç›®å½• 14TEMPLATE_PATH=&#34;$BASE_DIR/templates/\${TEMPLATE_NAME}.cpp&#34; 15PROBLEM_DIR=&#34;$BASE_DIR/$PROBLEM_NAME&#34; 16 17# æ£€æŸ¥æ¨¡æ¿æ˜¯å¦å­˜åœ¨ 18if [ ! -f &#34;$TEMPLATE_PATH&#34; ]; then 19 echo &#34;Error: Template &#39;\${TEMPLATE_NAME}.cpp&#39; not found at $TEMPLATE_PATH&#34; 20 exit 1 21fi 22 23# åˆ›å»ºé—®é¢˜ç›®å½• 24mkdir -p &#34;$PROBLEM_DIR&#34; 25cd &#34;$PROBLEM_DIR&#34; || exit 26 27# å¤åˆ¶æ¨¡æ¿æ–‡ä»¶å¹¶åˆ›å»ºè¾“å…¥/è¾“å‡ºæ–‡ä»¶ 28cp &#34;$TEMPLATE_PATH&#34; &#34;main.cpp&#34; 29touch &#34;input.txt&#34; 30touch &#34;answer.txt&#34; 31 32echo &#34;Successfully created problem directory: $PROBLEM_DIR&#34; 33echo &#34;Files created: main.cpp, input.txt, answer.txt&#34; 34 35# (å¯é€‰) è‡ªåŠ¨ç”¨ nvim æ‰“å¼€ 36nvim main.cpp å¦‚ä½•ä½¿ç”¨å®ƒï¼Ÿ æ‰“å¼€ç»ˆç«¯ï¼Œè¿è¡Œï¼š chmod +x ~/.local/bin/cf-new.sh (åªéœ€è¿è¡Œä¸€æ¬¡ï¼Œä½¿å…¶å¯æ‰§è¡Œ)
ç°åœ¨ï¼Œè¦å¼€å§‹è§£å†³ 1800A é¢˜ï¼Œåªéœ€ï¼š cf-new.sh 1800A
å¦‚æœä½ æƒ³ç”¨å›¾è®ºæ¨¡æ¿ï¼š cf-new.sh 1800C graph
ç¬¬äºŒæ­¥ï¼šæ ¸å¿ƒå·¥ä½œæµè„šæœ¬ (ç¼–è¯‘ã€è¿è¡Œã€å¯¹æ¯”) åœ¨ä½ çš„ PATH ä¸‹åˆ›å»ºä»¥ä¸‹ä¸¤ä¸ªè„šæœ¬ã€‚
1. ç¼–è¯‘å’Œè¿è¡Œè„šæœ¬ (cf-run.sh) è¿™ä¸ªè„šæœ¬æ˜¯ä½ çš„ä¸»åŠ›ã€‚å®ƒä¼šç¼–è¯‘ã€è¿è¡Œã€è®¡æ—¶ï¼Œå¹¶å°†è¾“å‡ºé‡å®šå‘ã€‚
1#!/bin/bash 2 3# cf-run.sh - ç¼–è¯‘å¹¶è¿è¡Œ C++ æ–‡ä»¶ï¼Œä½¿ç”¨ input.txt ä½œä¸ºè¾“å…¥ 4 5FILENAME=&#34;main.cpp&#34; 6EXE_NAME=&#34;main_debug&#34; 7INPUT_FILE=&#34;input.txt&#34; 8OUTPUT_FILE=&#34;my_output.txt&#34; 9 10# ç¼–è¯‘ä»£ç  11# -g: ç”Ÿæˆè°ƒè¯•ä¿¡æ¯ 12# -std=c++17: ä½¿ç”¨ C++17 æ ‡å‡† 13# -Wall: æ˜¾ç¤ºæ‰€æœ‰è­¦å‘Š 14# -fsanitize=address,undefined: (å¯é€‰ä½†å¼ºçƒˆæ¨è) æ£€æŸ¥å†…å­˜å’Œæœªå®šä¹‰è¡Œä¸º 15g++ -g -std=c++17 -Wall -fsanitize=address,undefined &#34;$FILENAME&#34; -o &#34;$EXE_NAME&#34; 16 17# æ£€æŸ¥ç¼–è¯‘æ˜¯å¦æˆåŠŸ 18if [ $? -ne 0 ]; then 19 echo &#34;--- COMPILE ERROR ---&#34; 20 exit 1 21fi 22 23echo &#34;--- COMPILE SUCCESS ---&#34; 24echo &#34;--- RUNNING ---&#34; 25 26# è¿è¡Œå¹¶è®¡æ—¶ 27/usr/bin/time -f &#34;--- Execution Time: %es ---&#34; ./&#34;$EXE_NAME&#34; &lt; &#34;$INPUT_FILE&#34; &gt; &#34;$OUTPUT_FILE&#34; 28 29echo &#34;--- FINISHED ---&#34; 30echo &#34;Output is in $OUTPUT_FILE&#34; chmod +x ~/.local/bin/cf-run.sh
2. å¯¹æ¯”ç»“æœè„šæœ¬ (cf-diff.sh) è¿™ä¸ªè„šæœ¬ç”¨äºå¯¹æ¯”ä½ çš„è¾“å‡ºå’Œæ ‡å‡†ç­”æ¡ˆã€‚
1#!/bin/bash 2 3# cf-diff.sh - å¯¹æ¯” my_output.txt å’Œ answer.txt 4 5MY_OUT=&#34;my_output.txt&#34; 6ANS_OUT=&#34;answer.txt&#34; 7 8if [ ! -f &#34;$MY_OUT&#34; ] || [ ! -f &#34;$ANS_OUT&#34; ]; then 9 echo &#34;Error: Make sure both $MY_OUT and $ANS_OUT exist.&#34; 10 exit 1 11fi 12 13# ä½¿ç”¨ diff å‘½ä»¤ï¼Œ--color é€‰é¡¹å¯ä»¥åœ¨ç»ˆç«¯ä¸­é«˜äº®å·®å¼‚ 14diff --color=always -y --suppress-common-lines &#34;$MY_OUT&#34; &#34;$ANS_OUT&#34; 15 16if [ $? -eq 0 ]; then 17 echo &#34;--- All Correct! ---&#34; 18fi chmod +x ~/.local/bin/cf-diff.sh
ç¬¬ä¸‰æ­¥ï¼šNeovim é›†æˆ (å¿«æ·é”®å’Œæ’ä»¶) ç°åœ¨æˆ‘ä»¬å°†è¿™äº›è„šæœ¬å’ŒåŠŸèƒ½æ— ç¼é›†æˆåˆ° Neovim ä¸­ã€‚
1. é›†æˆç»ˆç«¯ (toggleterm.nvim) ä¸€ä¸ªå¥½çš„æµ®åŠ¨ç»ˆç«¯å¯¹äºæŸ¥çœ‹ç¼–è¯‘ç»“æœå’Œè¾“å‡ºè‡³å…³é‡è¦ã€‚
1-- lua/plugins/toggleterm.lua 2return { 3 &#39;akinsho/toggleterm.nvim&#39;, 4 version = &#34;*&#34;, 5 opts = { 6 direction = &#39;float&#39;, 7 float_opts = { 8 border = &#39;curved&#39;, 9 }, 10 }, 11} 2. å®šä¹‰æ ¸å¿ƒå¿«æ·é”® åœ¨ä½ çš„ Neovim é…ç½®ä¸­ï¼ˆä¾‹å¦‚ init.lua æˆ– lua/keymaps.luaï¼‰ï¼Œæ·»åŠ ï¼š
1-- åˆ›å»ºä¸€ä¸ªå‡½æ•°æ¥æ‰“å¼€æµ®åŠ¨ç»ˆç«¯å¹¶æ‰§è¡Œå‘½ä»¤ 2function RunInToggleTerm(cmd) 3 -- å¯»æ‰¾ä¸€ä¸ªåä¸º &#39;floatterm&#39; çš„ç»ˆç«¯ï¼Œå¦‚æœæ²¡æœ‰å°±åˆ›å»ºä¸€ä¸ª 4 local term = require(&#39;toggleterm.terminal&#39;).get(&#39;floatterm&#39;) 5 if not term then 6 term = require(&#39;toggleterm.terminal&#39;).Terminal:new({ id = &#39;floatterm&#39;, hidden = true }) 7 end 8 9 -- æ‰“å¼€ç»ˆç«¯çª—å£å¹¶å‘é€å‘½ä»¤ 10 require(&#39;toggleterm&#39;).toggle(term:id()) 11 vim.cmd(&#39;startinsert&#39;) 12 vim.api.nvim_chan_send(term.job_id, cmd .. &#39;\\n&#39;) 13end 14 15-- ç¼–è¯‘ &amp; è¿è¡Œ 16vim.keymap.set(&#39;n&#39;, &#39;&lt;leader&gt;r&#39;, function() RunInToggleTerm(&#39;cf-run.sh&#39;) end, { desc = &#34;CF: Compile &amp; Run&#34; }) 17 18-- å¯¹æ¯”ç»“æœ 19vim.keymap.set(&#39;n&#39;, &#39;&lt;leader&gt;d&#39;, function() RunInToggleTerm(&#39;cf-diff.sh&#39;) end, { desc = &#34;CF: Diff Output&#34; }) 20 21-- åˆ‡æ¢åˆ°ç»ˆç«¯ï¼ˆç”¨äºæ‰‹åŠ¨æ“ä½œï¼‰ 22vim.keymap.set(&#39;n&#39;, &#39;&lt;leader&gt;tt&#39;, &#39;&lt;cmd&gt;ToggleTerm&lt;cr&gt;&#39;, { desc = &#34;Toggle Terminal&#34; }) 3. DAP å¿«é€Ÿè°ƒè¯• (launch.json) ä¸ºäº†è®© nvim-dap åœ¨è¿™ä¸ªå·¥ä½œæµä¸­å‘æŒ¥ä½œç”¨ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ªèƒ½è‡ªåŠ¨è¯»å– input.txt çš„ launch.json æ–‡ä»¶ã€‚
ä½ å¯ä»¥æŠŠè¿™ä¸ªæ–‡ä»¶æ”¾åœ¨ä½ çš„ templates ç›®å½•ä¸‹ï¼Œè®© cf-new.sh è‡ªåŠ¨åˆ›å»º .vscode ç›®å½•å¹¶å¤åˆ¶å®ƒã€‚
~/codeforces/templates/launch.json
1{ 2 &#34;version&#34;: &#34;0.2.0&#34;, 3 &#34;configurations&#34;: [ 4 { 5 &#34;name&#34;: &#34;(gdb) Launch&#34;, 6 &#34;type&#34;: &#34;cppdbg&#34;, 7 &#34;request&#34;: &#34;launch&#34;, 8 &#34;program&#34;: &#34;\${workspaceFolder}/main_debug&#34;, 9 &#34;args&#34;: [], 10 &#34;stopAtEntry&#34;: false, 11 &#34;cwd&#34;: &#34;\${workspaceFolder}&#34;, 12 &#34;environment&#34;: [], 13 &#34;externalConsole&#34;: false, 14 &#34;MIMode&#34;: &#34;gdb&#34;, 15 &#34;miDebuggerPath&#34;: &#34;/usr/bin/gdb&#34;, 16 &#34;setupCommands&#34;: [ 17 { 18 &#34;description&#34;: &#34;Enable pretty-printing for gdb&#34;, 19 &#34;text&#34;: &#34;-enable-pretty-printing&#34;, 20 &#34;ignoreFailures&#34;: true 21 } 22 ], 23 // æ ¸å¿ƒéƒ¨åˆ†ï¼šå°†æ ‡å‡†è¾“å…¥é‡å®šå‘åˆ° input.txt 24 &#34;pipeTransport&#34;: { 25 &#34;pipeCwd&#34;: &#34;\${workspaceFolder}&#34;, 26 &#34;pipeProgram&#34;: &#34;bash&#34;, 27 &#34;pipeArgs&#34;: [&#34;-c&#34;], 28 &#34;debuggerPath&#34;: &#34;/usr/bin/gdb&#34; 29 }, 30 &#34;sourceFileMap&#34;: { 31 &#34;/build/glibc-SzIz7B/glibc-2.31&#34;: &#34;/usr/src/glibc&#34; 32 }, 33 &#34;preLaunchTask&#34;: &#34;C/C++: g++ build active file&#34; 34 } 35 ] 36} ä¿®æ”¹ cf-new.sh: åœ¨ mkdir å’Œ cp ä¹‹é—´åŠ å…¥ï¼š
1# ... 2mkdir -p &#34;$PROBLEM_DIR/.vscode&#34; 3cd &#34;$PROBLEM_DIR&#34; || exit 4 5cp &#34;$BASE_DIR/templates/launch.json&#34; &#34;.vscode/launch.json&#34; 6# ... 4. Competitive Programming ä»£ç ç‰‡æ®µ ä½¿ç”¨ LuaSnipï¼Œä½ å¯ä»¥å®šä¹‰ä¸€äº›éå¸¸æœ‰ç”¨çš„ç‰‡æ®µã€‚åœ¨ä½ çš„ luasnip é…ç½®æ–‡ä»¶ä¸­æ·»åŠ ï¼š
1-- ç¤ºä¾‹ï¼šå¿«é€Ÿ for å¾ªç¯ 2s(&#34;fori&#34;, fmt( 3 &#34;for (int {1} = 0; {1} &lt; {2}; ++{1}) {{\\n\\t{3}\\n}}&#34;, 4 { i(1, &#34;i&#34;), i(2, &#34;n&#34;), i(0) } 5)), 6 7-- ç¤ºä¾‹ï¼šè¯»å–ä¸€ä¸ª vector 8s(&#34;readv&#34;, fmt( 9 &#34;std::vector&lt;{1}&gt; {2}({3});\\nfor (int i = 0; i &lt; {3}; ++i) {{\\n\\tstd::cin &gt;&gt; {2}[i];\\n}}&#34;, 10 { i(1, &#34;int&#34;), i(2, &#34;v&#34;), i(3, &#34;n&#34;) } 11)), æœ€ç»ˆå·¥ä½œæµç¨‹æ¼”ç¤º ç°åœ¨ï¼Œä½ æ‹¥æœ‰äº†ä¸€ä¸ªå®Œæ•´çš„â€œé©¾é©¶èˆ±â€ã€‚è§£å†³ä¸€é“é¢˜çš„æµç¨‹å¦‚ä¸‹ï¼š
å¯åŠ¨: cf-new.sh 1800Aã€‚Nvim è‡ªåŠ¨æ‰“å¼€ main.cppã€‚ ç¼–ç : ä½ å¼€å§‹ç¼–å†™ solve() å‡½æ•°ã€‚ éœ€è¦ä¸€ä¸ª for å¾ªç¯ï¼Ÿè¾“å…¥ fori ç„¶åæŒ‰ &lt;Tab&gt;ã€‚ éœ€è¦è¯»å–ä¸€ä¸ª vectorï¼Ÿè¾“å…¥ readv ç„¶åæŒ‰ &lt;Tab&gt;ã€‚ å‡†å¤‡æµ‹è¯•: ä»é¢˜ç›®é¡µé¢å¤åˆ¶ç¤ºä¾‹è¾“å…¥ï¼Œç²˜è´´åˆ° input.txt æ–‡ä»¶ä¸­ã€‚ å¤åˆ¶ç¤ºä¾‹è¾“å‡ºï¼Œç²˜è´´åˆ° answer.txt æ–‡ä»¶ä¸­ã€‚ å¿«é€Ÿæµ‹è¯•: å›åˆ° main.cppï¼ŒæŒ‰ä¸‹ &lt;leader&gt;rã€‚ ä¸€ä¸ªæµ®åŠ¨ç»ˆç«¯å¼¹å‡ºï¼Œæ˜¾ç¤ºç¼–è¯‘å’Œè¿è¡Œç»“æœã€‚ éªŒè¯ç»“æœ: æŒ‰ä¸‹ &lt;leader&gt;dã€‚ æµ®åŠ¨ç»ˆç«¯ä¼šæ˜¾ç¤ºä½ çš„è¾“å‡ºå’Œæ ‡å‡†ç­”æ¡ˆçš„å·®å¼‚ã€‚å¦‚æœå®Œå…¨æ­£ç¡®ï¼Œä¼šæç¤º &ldquo;All Correct!&quot;ã€‚ è°ƒè¯•: å¦‚æœç»“æœé”™è¯¯ï¼Œä½ å¯ä»¥åœ¨ä»£ç ä¸­è®¾ç½®æ–­ç‚¹ï¼ˆé»˜è®¤ &lt;F9&gt;ï¼‰ã€‚ æŒ‰ä¸‹ &lt;F5&gt; å¯åŠ¨ DAP è°ƒè¯•ä¼šè¯ã€‚DAP ä¼šè‡ªåŠ¨ä½¿ç”¨ input.txt ä½œä¸ºè¾“å…¥ï¼Œä½ å¯ä»¥åœ¨æ–­ç‚¹å¤„æ£€æŸ¥å˜é‡ï¼Œå•æ­¥æ‰§è¡Œï¼Œå°±åƒåœ¨ IDE ä¸­ä¸€æ ·ã€‚ é‡å¤: ä¿®å¤ bug åï¼Œå›åˆ°ç¬¬ 4 æ­¥ï¼Œå¾ªç¯å¾€å¤ï¼Œç›´åˆ°é€šè¿‡æ‰€æœ‰ç¤ºä¾‹ã€‚ è¿™ä¸ªå·¥ä½œæµå°† Neovim çš„é€Ÿåº¦ã€ç»ˆç«¯çš„å¼ºå¤§åŠŸèƒ½å’Œ IDE çš„è°ƒè¯•èƒ½åŠ›å®Œç¾åœ°ç»“åˆåœ¨ä¸€èµ·ï¼Œä¸“ä¸º competitive programming çš„é«˜å¼ºåº¦ã€å¿«èŠ‚å¥ç¯å¢ƒè€Œè®¾è®¡ã€‚
`,url:"https://hugo-dead-simple.netlify.com/nvim-for-oi/%E8%AE%BE%E8%AE%A1%E6%80%9D%E6%83%B3.html"},"https://hugo-dead-simple.netlify.com/blog/archlinux%E4%B8%8B%E7%BD%91%E7%BB%9C%E5%BB%B6%E8%BF%9F%E9%97%AE%E9%A2%98.html":{title:"archlinuxä¸‹ç½‘ç»œå»¶è¿Ÿé—®é¢˜",tags:["linux","bug fix"],content:`1. èµ·å›  æœ€è¿‘åœ¨ä½¿ç”¨archlinux,å‘ç°ç½‘ç»œå»¶è¿Ÿå¾ˆé«˜,ä½†æ˜¯å…¶ä»–è®¾å¤‡æ­£å¸¸,äºæ˜¯å¼€å§‹æ’æŸ¥é—®é¢˜.
2. é—®é¢˜æ’æŸ¥ ç›´æ¥é—®AI,AI å‘Šè¯‰æˆ‘æœ€å¤§çš„å¯èƒ½æ˜¯:
Wi-Fi çœç”µæ¨¡å¼ (Power Save Management): è¿™æ˜¯ æœ€å¯ç–‘çš„è½¯ä»¶å±‚é¢åŸå› ã€‚Linux å†…æ ¸ä¸ºäº†èŠ‚çœç”µåŠ›ï¼Œå¯èƒ½ä¼šè®© Wi-Fi ç½‘å¡é¢‘ç¹è¿›å…¥ä¼‘çœ å’Œå”¤é†’çŠ¶æ€ï¼Œå¯¼è‡´å“åº”å»¶è¿Ÿæ€¥å‰§å¢åŠ ã€‚
1sudo pacman -S wireless_tools 1iwconfig wlan0 | grep &#34;Power Management&#34; å¦‚æœæ˜¾ç¤ºä¸º Power Management:onï¼Œè¯´æ˜çœç”µæ¨¡å¼å·²å¼€å¯ã€‚
ä¸´æ—¶è§£å†³
1sudo iwconfig &lt;your wlan-name&gt; power off pingå€¼,æ¢å¤æ­£å¸¸
3. è§£å†³æ–¹æ¡ˆ 1sudo vim /etc/NetworkManager/conf.d/wifi-powersave.conf æ·»åŠ ä»¥ä¸‹å†…å®¹ï¼š
1[connection] 2wifi.powersave = 2 ä¸€è¡Œå‘½ä»¤
1sudo cat &gt; /etc/NetworkManager/conf.d/wifi-powersave.conf &lt;&lt;EOF 2[connection] 3wifi.powersave = 2 4EOF ç„¶åé‡å¯ NetworkManagerï¼š
1sudo systemctl restart NetworkManager å‚è€ƒ NetworkManager Wi-Fi powersaving configuration Arch Linux Wi-Fi Power Management `,url:"https://hugo-dead-simple.netlify.com/blog/archlinux%E4%B8%8B%E7%BD%91%E7%BB%9C%E5%BB%B6%E8%BF%9F%E9%97%AE%E9%A2%98.html"},"https://hugo-dead-simple.netlify.com/tags/bug-fix.html":{title:"Bug Fix",tags:[],content:"",url:"https://hugo-dead-simple.netlify.com/tags/bug-fix.html"},"https://hugo-dead-simple.netlify.com/tags/linux.html":{title:"Linux",tags:[],content:"",url:"https://hugo-dead-simple.netlify.com/tags/linux.html"},"https://hugo-dead-simple.netlify.com/tags/vim.html":{title:"Vim",tags:[],content:"",url:"https://hugo-dead-simple.netlify.com/tags/vim.html"},"https://hugo-dead-simple.netlify.com/nvim-for-oi/readme.html":{title:"é…ç½®ä¸€ä¸ªé€‚åˆoiçš„nvim",tags:["vim"],content:`1. èµ·å›  æˆ‘çš„å¤§éƒ¨åˆ†ä»£ç ç¼–å†™å·²ç»è½¬åˆ°vscode,åªæœ‰å†™ OJä»£ç çš„ä½¿ç”¨çš„æ˜¯vim(å› ä¸ºå¿«). ç°åœ¨æˆ‘å‡†å¤‡é…ç½®ä¸€ä¸ªä¸“ç”¨çš„nvim,ç²¾ç®€ä¸€ä¸‹é…ç½®.
2. lazy.nvim è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨lazy.nvim ä½œä¸ºæˆ‘ä»¬çš„æ’ä»¶ç®¡ç†å™¨,å› ä¸ºå›½å†…çš„ç¯å¢ƒï¼Œæˆ‘ä»¬é…ç½®ä¸€ä¸‹githubä¸‹è½½proxy
~/.config/nvim/lua/config/lazy.lua
lazy.nvim é…ç½® 1-- åˆå§‹åŒ– lazy.nvim 2local gitproxy = &#34;https://gh-proxy.com/&#34; 3local lazypath = vim.fn.stdpath(&#34;data&#34;) .. &#34;/lazy/lazy.nvim&#34; 4if not (vim.uv or vim.loop).fs_stat(lazypath) then 5 local lazyrepo = gitproxy .. &#34;https://github.com/folke/lazy.nvim.git&#34; 6 local out = vim.fn.system({ &#34;git&#34;, &#34;clone&#34;, &#34;--filter=blob:none&#34;, &#34;--branch=stable&#34;, lazyrepo, lazypath }) 7 if vim.v.shell_error ~= 0 then 8 vim.api.nvim_echo({ 9 { &#34;Failed to clone lazy.nvim:\\n&#34;, &#34;ErrorMsg&#34; }, 10 { out, &#34;WarningMsg&#34; }, 11 { &#34;\\nPress any key to exit...&#34; }, 12 }, true, {}) 13 vim.fn.getchar() 14 os.exit(1) 15 end 16end 17vim.opt.rtp:prepend(lazypath) 18 19-- åœ¨åŠ è½½ lazy.nvim ä¹‹å‰ç¡®ä¿è®¾ç½® \`mapleader\` å’Œ \`maplocalleader\`ï¼Œä»¥ç¡®ä¿æ˜ å°„æ­£ç¡®ã€‚ 20-- è¿™é‡Œä¹Ÿæ˜¯è®¾ç½®å…¶ä»–é€‰é¡¹ (vim.opt) çš„å¥½åœ°æ–¹ 21vim.g.mapleader = &#34; &#34; 22vim.g.maplocalleader = &#34;\\\\&#34; 23 24-- è®¾ç½® lazy.nvim 25require(&#34;lazy&#34;).setup({ 26 -- ä¸è‡ªåŠ¨æ£€æŸ¥æ’ä»¶æ›´æ–° 27 checker = { enabled = false }, 28 -- åœ¨è¿™é‡Œæ·»åŠ ä½ çš„æ’ä»¶é…ç½® 29 spec = { 30 -- same as: require(&#34;lazy&#34;).setup(&#34;plugins&#34;) 31 -- ä» lua/plugins ç›®å½•åŠ è½½æ’ä»¶é…ç½® 32 { import = &#34;plugins&#34; } 33 }, 34 35 git = { 36 log = { &#34;-8&#34; }, -- æ˜¾ç¤ºæœ€è¿‘8æ¬¡æäº¤ 37 timeout = 120, -- ç»ˆæ­¢è¶…è¿‡2åˆ†é’Ÿçš„è¿›ç¨‹ 38 url_format = gitproxy .. &#34;https://github.com/%s.git&#34;, 39 -- lazy.nvim éœ€è¦ git &gt;=2.19.0ã€‚å¦‚æœä½ æƒ³åœ¨æ—§ç‰ˆæœ¬ä¸­ä½¿ç”¨ lazyï¼Œ 40 -- å¯ä»¥å°†ä¸‹é¢è®¾ç½®ä¸º falseã€‚è¿™æ ·åº”è¯¥å¯ä»¥å·¥ä½œï¼Œä½†ä¸è¢«æ”¯æŒå¹¶ä¸”ä¼š 41 -- å¤§å¹…å¢åŠ ä¸‹è½½é‡ã€‚ 42 filter = true, 43 -- ç½‘ç»œç›¸å…³ git æ“ä½œ (clone, fetch, checkout) çš„é¢‘ç‡ 44 throttle = { 45 enabled = false, -- é»˜è®¤ä¸å¯ç”¨ 46 -- æ¯5ç§’æœ€å¤š2ä¸ªæ“ä½œ 47 rate = 2, 48 duration = 5 * 1000, -- ä»¥æ¯«ç§’ä¸ºå•ä½ 49 }, 50 -- åœ¨ä¸ºæ’ä»¶å†æ¬¡è¿è¡Œ fetch ä¹‹å‰ç­‰å¾…çš„ç§’æ•°ã€‚ 51 -- é‡å¤çš„æ›´æ–°/æ£€æŸ¥æ“ä½œå°†ä¸ä¼šå†æ¬¡è¿è¡Œï¼Œç›´åˆ°è¿™ä¸ª 52 -- å†·å´æœŸè¿‡å»ã€‚ 53 cooldown = 0, 54 }, 55}) 3. ä¸»é¢˜ æˆ‘å–œæ¬¢gruvbox,è¿™é‡Œä½¿ç”¨ellisonleao/gruvbox.nvim,æ ¹æ®lazy.nvim structure plugins and lazy.nvim Installation
Any lua file in ~/.config/nvim/lua/plugins/*.lua will be automatically merged in the main plugin spec
~/.config/nvim/lua/config/lazy.lua ä¸­çš„ spec å­—æ®µé…ç½®å¦‚ä¸‹:
1require(&#34;lazy&#34;).setup({ 2 spec = { 3 -- same as: require(&#34;lazy&#34;).setup(&#34;plugins&#34;) 4 -- ä» lua/plugins ç›®å½•åŠ è½½æ’ä»¶é…ç½® 5 { import = &#34;plugins&#34; }, 6 }, 7}) ~/.config/nvim/lua/plugins/gruvbox.lua å†™å…¥å¦‚ä¸‹:
1return { 2 &#34;ellisonleao/gruvbox.nvim&#34;, 3 priority = 1000, 4 config = function() 5 vim.cmd.colorscheme(&#34;gruvbox&#34;) 6 end, 7} 4. é€‰é¡¹é…ç½® é€‰é¡¹é…ç½®
ä¸»è¦ç”¨åˆ°çš„å°±æ˜¯ vim.gã€vim.optã€vim.cmd ç­‰ï¼Œæˆ‘åˆ¶é€ äº†ä¸€ä¸ªå¿«é€Ÿå‚ç…§å¯¹æ¯”çš„è¡¨æ ¼
In Vim In nvim Note let g:foo = bar vim.g.foo = bar set foo = bar vim.opt.foo = bar set foo = vim.opt.foo = true some_vimscript vim.cmd(some_vimscript) æŒ‰é”®é…ç½® 1-- define common options 2local opts = { 3 noremap = true, -- non-recursive 4 silent = true, -- do not show message 5} 6 7----------------- 8-- Normal mode -- 9----------------- 10 11-- Hint: see \`:h vim.map.set()\` 12-- Better window navigation 13vim.keymap.set(&#39;n&#39;, &#39;&lt;C-h&gt;&#39;, &#39;&lt;C-w&gt;h&#39;, opts) 14vim.keymap.set(&#39;n&#39;, &#39;&lt;C-j&gt;&#39;, &#39;&lt;C-w&gt;j&#39;, opts) 15vim.keymap.set(&#39;n&#39;, &#39;&lt;C-k&gt;&#39;, &#39;&lt;C-w&gt;k&#39;, opts) 16vim.keymap.set(&#39;n&#39;, &#39;&lt;C-l&gt;&#39;, &#39;&lt;C-w&gt;l&#39;, opts) 17 18-- Resize with arrows 19-- delta: 2 lines 20vim.keymap.set(&#39;n&#39;, &#39;&lt;C-Up&gt;&#39;, &#39;:resize -2&lt;CR&gt;&#39;, opts) 21vim.keymap.set(&#39;n&#39;, &#39;&lt;C-Down&gt;&#39;, &#39;:resize +2&lt;CR&gt;&#39;, opts) 22vim.keymap.set(&#39;n&#39;, &#39;&lt;C-Left&gt;&#39;, &#39;:vertical resize -2&lt;CR&gt;&#39;, opts) 23vim.keymap.set(&#39;n&#39;, &#39;&lt;C-Right&gt;&#39;, &#39;:vertical resize +2&lt;CR&gt;&#39;, opts) 24 25----------------- 26-- Visual mode -- 27----------------- 28 29-- Hint: start visual mode with the same area as the previous area and the same mode 30vim.keymap.set(&#39;v&#39;, &#39;&lt;&#39;, &#39;&lt;gv&#39;, opts) 31vim.keymap.set(&#39;v&#39;, &#39;&gt;&#39;, &#39;&gt;gv&#39;, opts) æ’ä»¶ lualine lualine.nvimæ˜¯ä¸€ä¸ªçŠ¶æ€æ æ’ä»¶
lua/plugins/lualine.lua
1return { 2 &#34;nvim-lualine/lualine.nvim&#34;, 3 dependencies = { &#34;nvim-tree/nvim-web-devicons&#34; }, 4 config = function() 5 require(&#34;lualine&#34;).setup({ 6 options = { 7 theme = &#34;gruvbox&#34;, 8 }, 9 }) 10 end, 11} é…ç½®
Comment.nvim å’Œ lang-cpp.lua which-key.nvim Create key bindings that stick. WhichKey helps you remember your Neovim keymaps, by showing available keybindings in a popup as you type.
ç®€è€Œè¨€ä¹‹å°±æ˜¯æˆ‘ä»¬å¯ä»¥ä½¿ç”¨è¿™ä¸ªæ’ä»¶,æ¥æç¤ºæˆ‘ä»¬è½¯ä»¶çš„å¿«æ·é”®æ˜¯ä»€ä¹ˆï¼Ÿ
å…·ä½“ä½¿ç”¨å‚è€ƒwhich-key.nvim ä½¿ç”¨,æœ€ä½³å®è·µ:
1-- åœ¨ä½ çš„ plugins/gitsigns.lua æ–‡ä»¶ä¸­ 2return { 3 &#34;lewis6991/gitsigns.nvim&#34;, 4 -- å…¶ä»–é…ç½®... 5 keys = { 6 -- â†“â†“â†“ è¿™å°±æ˜¯é‚£ä¸ªç‰¹æ®Šçš„â€œæ˜¾å¼åˆ†ç»„æ¡ç›®â€ â†“â†“â†“ 7 { 8 &#34;&lt;leader&gt;g&#34;, 9 group = &#34;Git&#34;, -- å­èœå•çš„æ ‡é¢˜ 10 desc = &#34;Git (Gitsigns)&#34;, -- åœ¨&lt;leader&gt;èœå•ä¸­æ˜¾ç¤ºçš„æè¿° 11 icon = &#34;ï¡&#34;, -- Nerd Font å›¾æ ‡ (å¯é€‰) 12 -- æ³¨æ„: è¿™é‡Œæ²¡æœ‰ç¬¬äºŒä¸ªå…ƒç´  (rhs å‘½ä»¤) 13 }, 14 15 -- â†“â†“â†“ ä¸‹é¢æ˜¯è¿™ä¸ªåˆ†ç»„é‡Œçš„å…·ä½“é”®ä½ â†“â†“â†“ 16 { &#34;&lt;leader&gt;gj&#34;, &#34;&lt;cmd&gt;Gitsigns next_hunk&lt;cr&gt;&#34;, desc = &#34;Next Hunk&#34; }, 17 { &#34;&lt;leader&gt;gk&#34;, &#34;&lt;cmd&gt;Gitsigns prev_hunk&lt;cr&gt;&#34;, desc = &#34;Previous Hunk&#34; }, 18 { &#34;&lt;leader&gt;gp&#34;, &#34;&lt;cmd&gt;Gitsigns preview_hunk&lt;cr&gt;&#34;, desc = &#34;Preview Hunk&#34; }, 19 { &#34;&lt;leader&gt;gs&#34;, &#34;&lt;cmd&gt;Gitsigns stage_hunk&lt;cr&gt;&#34;, desc = &#34;Stage Hunk&#34; }, 20 { &#34;&lt;leader&gt;gu&#34;, &#34;&lt;cmd&gt;Gitsigns undo_stage_hunk&lt;cr&gt;&#34;, desc = &#34;Undo Stage&#34; }, 21 { &#34;&lt;leader&gt;gr&#34;, &#34;&lt;cmd&gt;Gitsigns reset_hunk&lt;cr&gt;&#34;, desc = &#34;Reset Hunk&#34; }, 22 }, 23} 1. marks.nvim æ–‡ä»¶å†…æ ‡è®° (Marks)
mx è®¾ç½®æ ‡è®° x (x ä¸ºä»»æ„å­—æ¯ a-z) m, è®¾ç½®ä¸‹ä¸€ä¸ªå¯ç”¨çš„å°å†™å­—æ¯æ ‡è®° m; åœ¨å½“å‰è¡Œä¸Šåˆ‡æ¢æ ‡è®° (å¦‚æœå½“å‰è¡Œæ²¡æœ‰æ ‡è®°ï¼Œåˆ™æ·»åŠ ä¸€ä¸ªï¼›å¦‚æœæœ‰ï¼Œåˆ™åˆ é™¤å®ƒ) dmx åˆ é™¤æ ‡è®° x dm- åˆ é™¤å½“å‰è¡Œä¸Šçš„æ‰€æœ‰æ ‡è®° dm&lt;space&gt; åˆ é™¤å½“å‰ç¼“å†²åŒºï¼ˆæ–‡ä»¶ï¼‰ä¸­çš„æ‰€æœ‰æ ‡è®° m] è·³è½¬åˆ°ä¸‹ä¸€ä¸ªæ ‡è®° m[ è·³è½¬åˆ°ä¸Šä¸€ä¸ªæ ‡è®° m: é¢„è§ˆæ ‡è®°ã€‚ç³»ç»Ÿä¼šæç¤ºæ‚¨è¾“å…¥è¦é¢„è§ˆçš„ç‰¹å®šæ ‡è®°ï¼›å¦‚æœç›´æ¥æŒ‰ å›è½¦é”®ï¼Œåˆ™ä¼šé¢„è§ˆä¸‹ä¸€ä¸ªæ ‡è®°ã€‚
è·¨æ–‡ä»¶ä¹¦ç­¾ (Bookmarks)
m[0-9] æ·»åŠ ä¸€ä¸ªä¹¦ç­¾åˆ°ä¹¦ç­¾ç»„ [0-9] ä¸­ (ä¾‹å¦‚ m1 ä¼šåœ¨ç¬¬1ç»„æ·»åŠ ä¸€ä¸ªä¹¦ç­¾) dm[0-9] åˆ é™¤ä¹¦ç­¾ç»„ [0-9] ä¸­çš„æ‰€æœ‰ä¹¦ç­¾ m} è·³è½¬åˆ°ä¸‹ä¸€ä¸ªåŒç±»å‹çš„ä¹¦ç­¾ (ç±»å‹ä¸å…‰æ ‡ä¸‹çš„ä¹¦ç­¾ç›¸åŒ)ã€‚æ­¤åŠŸèƒ½å¯è·¨ç¼“å†²åŒºï¼ˆæ–‡ä»¶ï¼‰å·¥ä½œã€‚ m{ è·³è½¬åˆ°ä¸Šä¸€ä¸ªåŒç±»å‹çš„ä¹¦ç­¾ (ç±»å‹ä¸å…‰æ ‡ä¸‹çš„ä¹¦ç­¾ç›¸åŒ)ã€‚æ­¤åŠŸèƒ½å¯è·¨ç¼“å†²åŒºï¼ˆæ–‡ä»¶ï¼‰å·¥ä½œã€‚ dm= åˆ é™¤å…‰æ ‡æ‰€åœ¨ä½ç½®çš„ä¹¦ç­¾ é…åˆ whichkey.nvimçš„' or \` ä½¿ç”¨,å®ç°å¿«é€Ÿçš„è·³è½¬
2. lsp ä» Neovim v0.11 å¼€å§‹å¼•å…¥äº† vim.lsp.config å’Œ vim.lsp.enable è¿™ 2 ä¸ª API å¯¹ LSP è¿›è¡Œé…ç½®ï¼Œè¿™ä¸‹å†ä¹Ÿä¸ç”¨å®‰è£… nvim-lspconfig äº†ã€‚ä½†æˆ‘ä»¬å¯èƒ½è¿˜æ˜¯éœ€è¦ä¸€ä¸ª LSP Registry ç”¨æ¥æ–¹ä¾¿åœ°ä¸‹è½½ LSPï¼Œæ¯”å¦‚ mason.nvim(è¿™é‡Œæˆ‘é€‰æ‹©æ‰‹åŠ¨ä¸‹è½½clangd)
é¦–å…ˆçœ‹ä¸€ä¸‹ nvimå®˜æ–¹lsp æ–‡æ¡£ TODO ç®€å•é…ç½®å¦‚ä¸‹
å®ç°åŠŸèƒ½: å®æ—¶é”™è¯¯æ˜¾ç¤º 3. nvim-cmp è¿™é‡Œä½¿ç”¨ç»å…¸nvim-cmp
nvim-cmp gihub åœ°å€ LazyVim nvim-cmp é…ç½® 4. nvim-telescope 5. nvim-autopairs 6. nvim-comment 7. nvim-bufferline 8. nvim-lualine 10. nvim-gitsigns 11. nvim-toggleterm 12. nvim-whichkey 13. nvim-dap 14. nvim-dap-ui 15. nvim-dap-virtual-text 16. nvim-dap-python 17. nvim-dap-go 18. nvim-dap-ruby 19. nvim-dap-vscode-js 20. nvim-dap-ui 21. nvim-dap-virtual-text 22. nvim-dap-python 23. nvim-dap-go 24. nvim-dap-ruby 25. nvim-dap-vscode-js 26. nvim-dap-ui 27. nvim-dap-virtual-text 28. nvim-dap-python 29. nvim-dap-go 30. nvim-dap-ruby 31. nvim-dap-vscode-js 32. nvim-dap-ui 33. nvim-dap-virtual-text 34. nvim-dap-python 35. nvim-dap-go 36. nvim-dap-ruby 37. nvim-dap-vscode-js 38. nvim-dap-ui 39. nvim-dap-virtual-text 40. nvim-dap-python 41. nvim-dap-go 42. nvim-dap-ruby 43. nvim-dap-vscode-js 44. nvim-dap-ui 45. n 5. å‚è€ƒ ä»é›¶å¼€å§‹é…ç½® Neovim(Nvim) `,url:"https://hugo-dead-simple.netlify.com/nvim-for-oi/readme.html"},"https://hugo-dead-simple.netlify.com/books/index.html":{title:"Books",tags:[],content:"",url:"https://hugo-dead-simple.netlify.com/books/index.html"},"https://hugo-dead-simple.netlify.com/categories/%E5%BE%AE%E7%A7%AF%E5%88%86.html":{title:"å¾®ç§¯åˆ†",tags:[],content:"",url:"https://hugo-dead-simple.netlify.com/categories/%E5%BE%AE%E7%A7%AF%E5%88%86.html"},"https://hugo-dead-simple.netlify.com/tags/%E6%95%B0%E5%AD%A6.html":{title:"æ•°å­¦",tags:[],content:"",url:"https://hugo-dead-simple.netlify.com/tags/%E6%95%B0%E5%AD%A6.html"},"https://hugo-dead-simple.netlify.com/books/%E5%BE%AE%E7%A7%AF%E5%88%86/chapter1.html":{title:"ç¬¬ä¸€è®² æé™å’Œè¿ç»­",tags:["æ•°å­¦"],content:`1. æ•°åˆ—æé™çš„å®šä¹‰ æŠ½è±¡,å½¢è±¡åŒ–çš„è¯´ æé™ &lt;=&gt; æ— é™çš„æ¥è¿‘
å®šä¹‰ å®šä¹‰å¯¹äºä¸€ä¸ªæ— ç©·æ•°åˆ—{an}\\{a_{n}\\}{anâ€‹}ï¼Œå¦‚æœå­˜åœ¨ä¸€ä¸ªå¸¸æ•°AAAï¼Œæ— è®ºé¢„å…ˆæŒ‡å®šå¤šä¹ˆå°çš„æ­£æ•°Îµ\\varepsilonÎµï¼Œéƒ½èƒ½åœ¨æ•°åˆ—ä¸­æ‰¾åˆ°ä¸€é¡¹aNa_{N}aNâ€‹ï¼Œä½¿å¾—è¿™ä¸€é¡¹åé¢æ‰€æœ‰çš„é¡¹ä¸AAAçš„å·®çš„ç»å¯¹å€¼éƒ½å°äºÎµ\\varepsilonÎµï¼ˆå³å½“n&gt;Nn&gt;Nn&gt;Næ—¶ï¼Œâˆ£anâˆ’Aâˆ£&lt;Îµ|a_{n}-A|&lt;\\varepsilonâˆ£anâ€‹âˆ’Aâˆ£&lt;Îµæ’æˆç«‹ï¼‰ï¼Œå°±æŠŠå¸¸æ•°AAAå«åšæ•°åˆ—{ana_{n}anâ€‹}çš„æé™ï¼Œè®°ä½œ limâ¡nâ†’âˆan=A.\\lim_{n\\to\\infty}a_{n}=A.nâ†’âˆlimâ€‹anâ€‹=A. Îµâˆ’N\\varepsilon-NÎµâˆ’N è¯­è¨€ ä¸Šè¿°å®šä¹‰å¯ä»¥ç®€è¿°ä¸º ä»»æ„ç»™å®šÎµ&gt;0\\varepsilon&gt;0Îµ&gt;0ï¼Œå¦‚æœæ€»å­˜åœ¨è‡ªç„¶æ•°NNNï¼Œä½¿å¾—å½“n&gt;Nn&gt;Nn&gt;Næ—¶ï¼Œä¸ç­‰å¼âˆ£anâˆ’Aâˆ£&lt;Îµ|a_{n}-A|&lt;\\varepsilonâˆ£anâ€‹âˆ’Aâˆ£&lt;Îµæ’æˆç«‹ï¼Œå°±è¯´æ•°åˆ—{ana_{n}anâ€‹}çš„æé™æ˜¯AAAã€‚ è¿™ä¸ªå®šä¹‰è¿˜å¯ä»¥ç”¨è®°å·è¡¨ç¤ºä¸º âˆ£anâˆ’Aâˆ£&lt;Îµâ†–â†™n&gt;N \\begin{aligned} &amp;|a_{n}-A|&lt;\\varepsilon \\\\ &amp;\\nwarrow \\qquad \\swarrow \\\\ &amp; \\quad n&gt;N \\end{aligned} â€‹âˆ£anâ€‹âˆ’Aâˆ£&lt;Îµâ†–â†™n&gt;Nâ€‹ 2. æé™çš„å››åˆ™è¿ç®— ä¿¡æ¯ è¿ç”¨æ³•åˆ™æ—¶åº”æ³¨æ„ä¹‹ç‚¹ï¼Œå¯¹æ•°åˆ—å’Œå‡½æ•°æé™æ˜¯ä¸€æ ·çš„ï¼ ä»¥ä¸‹æ˜¯æ•°åˆ—æé™çš„å››åˆ™è¿ç®—æ³•åˆ™ï¼š å¦‚æœ limâ¡nâ†’âˆan=A\\lim_{n\\to\\infty}a_n=Alimnâ†’âˆâ€‹anâ€‹=A, limâ¡nâ†’âˆbn=B\\lim_{n\\to\\infty}b_n=Blimnâ†’âˆâ€‹bnâ€‹=B, é‚£ä¹ˆï¼ limâ¡nâ†’âˆ(anÂ±bn)=AÂ±Blimâ¡nâ†’âˆ(anâ‹…bn)=Aâ‹…Blimâ¡nâ†’âˆanbn=AB(bnâ‰ 0,Â Bâ‰ 0) \\begin{align} &amp;\\lim\\limits_{n\\to\\infty}(a_n\\pm b_n)=A\\pm B \\tag 1 \\\\ &amp;\\lim\\limits_{n\\to\\infty}(a_n\\cdot b_n)=A\\cdot B \\tag 2 \\\\ &amp;\\lim\\limits_{n\\to\\infty}\\frac{a_n}{b_n}=\\frac{A}{B} (b_n\\neq 0,\\ B\\neq 0) \\tag 3 \\end{align} â€‹nâ†’âˆlimâ€‹(anâ€‹Â±bnâ€‹)=AÂ±Bnâ†’âˆlimâ€‹(anâ€‹â‹…bnâ€‹)=Aâ‹…Bnâ†’âˆlimâ€‹bnâ€‹anâ€‹â€‹=BAâ€‹(bnâ€‹î€ =0,Â Bî€ =0)â€‹(1)(2)(3)â€‹ åœ¨ä½¿ç”¨å®ƒä»¬æ—¶ï¼Œè¦ç‰¹åˆ«æ³¨æ„å„ä¸ªæ³•åˆ™æˆç«‹çš„æ¡ä»¶ï¼
æ³•åˆ™(1) , (2) , (3)å¯ä»¥æ¨å¹¿åˆ°æœ‰é™ä¸ªæ•°åˆ—çš„æƒ…å½¢ï¼ æ³•åˆ™(1) , (2) , (3)an,bna_n,b_nanâ€‹,bnâ€‹çš„æé™å¿…é¡»å­˜åœ¨ åœ¨è¿ç”¨æ³•åˆ™(3)æ—¶ï¼Œå¿…é¡»æ³¨æ„åˆ†æ¯çš„æé™ä¸èƒ½ä¸ºé›¶ï¼ 3. æ— ç©·ç­‰æ¯”æ•°åˆ—çš„å„é¡¹å’Œ æ— ç©·ç­‰æ¯”æ•°åˆ—çš„å’Œ
Sn= S_n = Snâ€‹=sn=a+aq+aq2+â‹¯+aqnâˆ’1qÃ—sn=aq+aq2+â‹¯+aqn \\begin{align} s_n = a + aq + aq^2 + \\cdots + aq^{n-1} \\tag 1 \\\\ q\\times s_n = aq + aq^2 + \\cdots + aq^{n} \\tag 2 \\\\ \\end{align} snâ€‹=a+aq+aq2+â‹¯+aqnâˆ’1qÃ—snâ€‹=aq+aq2+â‹¯+aqnâ€‹(1)(2)â€‹(qâˆ’1)sn=aqnâˆ’asn=a(qnâˆ’1)qâˆ’1=a(1âˆ’qn)1âˆ’q \\begin{aligned} (q-1)s_n &amp;= aq^{n} - a \\\\ s_n &amp;= \\frac{a(q^{n} -1)}{q-1} = \\frac{a(1 - q^{n} )}{1-q} \\end{aligned} (qâˆ’1)snâ€‹snâ€‹â€‹=aqnâˆ’a=qâˆ’1a(qnâˆ’1)â€‹=1âˆ’qa(1âˆ’qn)â€‹â€‹äºæ˜¯å¾—åˆ°
limâ¡nâ†’âˆ=a1âˆ’q(1âˆ’limâ¡nâ†’âˆqn) \\lim\\limits_{n \\to \\infty} = \\frac{a}{1-q} (1-\\lim\\limits_{n\\to \\infty} q^n) nâ†’âˆlimâ€‹=1âˆ’qaâ€‹(1âˆ’nâ†’âˆlimâ€‹qn)å¦‚æœ âˆ£qâˆ£&lt;0\\left| q \\right| &lt; 0âˆ£qâˆ£&lt;0
limâ¡nâ†’âˆ=a1âˆ’q(1âˆ’limâ¡nâ†’âˆqn)=a1âˆ’q \\lim\\limits_{n \\to \\infty} = \\frac{a}{1-q} (1-\\lim\\limits_{n\\to \\infty} q^n) = \\frac{a}{1-q} nâ†’âˆlimâ€‹=1âˆ’qaâ€‹(1âˆ’nâ†’âˆlimâ€‹qn)=1âˆ’qaâ€‹4. ä¸¤ä¸ªé‡è¦æé™ limâ¡xâ†’0sinâ¡xxlimâ¡xâ†’âˆ(1+1x)x \\begin{align} &amp;\\lim\\limits_{x\\to 0}\\frac{\\sin x}{x} \\tag 1 \\\\ &amp;\\lim\\limits_{x\\to \\infty}(1+ \\frac{1}{x})^x \\tag 2 \\end{align} â€‹xâ†’0limâ€‹xsinxâ€‹xâ†’âˆlimâ€‹(1+x1â€‹)xâ€‹(1)(2)â€‹ æ¥è‡ª: https://www.geogebra.org/m/h6DxENYh
5. å‡½æ•°çš„è¿ç»­æ€§ æŠ½è±¡ è¿ç»­ &lt;=&gt; æ²¡æœ‰æ–­è£‚ï¼Œå¯ä»¥ä¸€ç¬”ç”»æˆ
å®šä¹‰ è®¾å‡½æ•° f(x)f(x)f(x) åœ¨ç‚¹ x0x_0x0â€‹ çš„æŸä¸ªé‚»åŸŸå†…æœ‰å®šä¹‰ï¼Œå¦‚æœæ»¡è¶³ä»¥ä¸‹æ¡ä»¶ï¼š limâ¡xâ†’x0f(x)=f(x0) \\lim_{x \\to x_0} f(x) = f(x_0) xâ†’x0â€‹limâ€‹f(x)=f(x0â€‹) åˆ™ç§°å‡½æ•° f(x)f(x)f(x) åœ¨ç‚¹ x0x_0x0â€‹ å¤„è¿ç»­ã€‚
5.1 è¿ç»­æ€§çš„ä¸‰ä¸ªæ¡ä»¶ å‡½æ•° f(x)f(x)f(x) åœ¨ç‚¹ x0x_0x0â€‹ å¤„è¿ç»­ï¼Œå¿…é¡»åŒæ—¶æ»¡è¶³ä»¥ä¸‹ä¸‰ä¸ªæ¡ä»¶ï¼š
æœ‰å®šä¹‰ï¼šf(x0)f(x_0)f(x0â€‹) å­˜åœ¨ï¼ˆå‡½æ•°åœ¨ x0x_0x0â€‹ ç‚¹æœ‰å®šä¹‰ï¼‰ æœ‰æé™ï¼šlimâ¡xâ†’x0f(x)\\lim_{x \\to x_0} f(x)limxâ†’x0â€‹â€‹f(x) å­˜åœ¨ ç›¸ç­‰ï¼šlimâ¡xâ†’x0f(x)=f(x0)\\lim_{x \\to x_0} f(x) = f(x_0)limxâ†’x0â€‹â€‹f(x)=f(x0â€‹) æ³¨æ„ å¦‚æœä¸Šè¿°ä¸‰ä¸ªæ¡ä»¶ä¸­è‡³å°‘æœ‰ä¸€ä¸ªä¸æ»¡è¶³ï¼Œåˆ™å‡½æ•°åœ¨ç‚¹ x0x_0x0â€‹ å¤„ä¸è¿ç»­ï¼Œç§° x0x_0x0â€‹ ä¸ºå‡½æ•°çš„é—´æ–­ç‚¹ã€‚
5.2 å¢é‡å½¢å¼å®šä¹‰ è®¾å‡½æ•° f(x)f(x)f(x) åœ¨ç‚¹ x0x_0x0â€‹ çš„æŸä¸ªé‚»åŸŸå†…æœ‰å®šä¹‰ï¼Œå¦‚æœå½“è‡ªå˜é‡çš„å¢é‡ Î”x\\Delta xÎ”x è¶‹äºé›¶æ—¶ï¼Œå¯¹åº”çš„å‡½æ•°å¢é‡ Î”y\\Delta yÎ”y ä¹Ÿè¶‹äºé›¶ï¼Œå³ï¼š
limâ¡Î”xâ†’0Î”y=limâ¡Î”xâ†’0[f(x0+Î”x)âˆ’f(x0)]=0 \\lim_{\\Delta x \\to 0} \\Delta y = \\lim_{\\Delta x \\to 0} [f(x_0 + \\Delta x) - f(x_0)] = 0 Î”xâ†’0limâ€‹Î”y=Î”xâ†’0limâ€‹[f(x0â€‹+Î”x)âˆ’f(x0â€‹)]=0åˆ™ç§°å‡½æ•° f(x)f(x)f(x) åœ¨ç‚¹ x0x_0x0â€‹ å¤„è¿ç»­ã€‚
5.3 å•ä¾§è¿ç»­æ€§ å·¦è¿ç»­ å¦‚æœ limâ¡xâ†’x0âˆ’f(x)=f(x0)\\lim_{x \\to x_0^-} f(x) = f(x_0)limxâ†’x0âˆ’â€‹â€‹f(x)=f(x0â€‹)ï¼Œåˆ™ç§°å‡½æ•° f(x)f(x)f(x) åœ¨ç‚¹ x0x_0x0â€‹ å¤„å·¦è¿ç»­ã€‚
å³è¿ç»­
å¦‚æœ limâ¡xâ†’x0+f(x)=f(x0)\\lim_{x \\to x_0^+} f(x) = f(x_0)limxâ†’x0+â€‹â€‹f(x)=f(x0â€‹)ï¼Œåˆ™ç§°å‡½æ•° f(x)f(x)f(x) åœ¨ç‚¹ x0x_0x0â€‹ å¤„å³è¿ç»­ã€‚
é‡è¦ç»“è®º å‡½æ•° f(x)f(x)f(x) åœ¨ç‚¹ x0x_0x0â€‹ å¤„è¿ç»­çš„å……åˆ†å¿…è¦æ¡ä»¶æ˜¯ï¼šå‡½æ•°åœ¨è¯¥ç‚¹æ—¢å·¦è¿ç»­åˆå³è¿ç»­ã€‚
5.4 åŒºé—´ä¸Šçš„è¿ç»­æ€§ å¼€åŒºé—´ (a,b)(a,b)(a,b) ä¸Šçš„è¿ç»­æ€§ï¼šå¦‚æœå‡½æ•° f(x)f(x)f(x) åœ¨å¼€åŒºé—´ (a,b)(a,b)(a,b) å†…æ¯ä¸€ç‚¹éƒ½è¿ç»­ï¼Œåˆ™ç§° f(x)f(x)f(x) åœ¨ (a,b)(a,b)(a,b) å†…è¿ç»­ã€‚
é—­åŒºé—´ [a,b][a,b][a,b] ä¸Šçš„è¿ç»­æ€§ï¼šå¦‚æœå‡½æ•° f(x)f(x)f(x) åœ¨å¼€åŒºé—´ (a,b)(a,b)(a,b) å†…è¿ç»­ï¼Œä¸”åœ¨å·¦ç«¯ç‚¹ aaa å¤„å³è¿ç»­ï¼Œåœ¨å³ç«¯ç‚¹ bbb å¤„å·¦è¿ç»­ï¼Œåˆ™ç§° f(x)f(x)f(x) åœ¨é—­åŒºé—´ [a,b][a,b][a,b] ä¸Šè¿ç»­ã€‚
5.5 è¿ç»­å‡½æ•°çš„æ€§è´¨ è¿ç»­å‡½æ•°çš„æ€§è´¨ å››åˆ™è¿ç®—æ€§è´¨ï¼šå¦‚æœå‡½æ•° f(x)f(x)f(x) å’Œ g(x)g(x)g(x) åœ¨ç‚¹ x0x_0x0â€‹ å¤„è¿ç»­ï¼Œåˆ™å®ƒä»¬çš„å’Œã€å·®ã€ç§¯ã€å•†ï¼ˆåˆ†æ¯ä¸ä¸ºé›¶ï¼‰ä¹Ÿåœ¨ç‚¹ x0x_0x0â€‹ å¤„è¿ç»­ã€‚
å¤åˆå‡½æ•°æ€§è´¨ï¼šå¦‚æœå‡½æ•° u=g(x)u = g(x)u=g(x) åœ¨ç‚¹ x0x_0x0â€‹ å¤„è¿ç»­ï¼Œä¸”å‡½æ•° y=f(u)y = f(u)y=f(u) åœ¨ç‚¹ u0=g(x0)u_0 = g(x_0)u0â€‹=g(x0â€‹) å¤„è¿ç»­ï¼Œåˆ™å¤åˆå‡½æ•° y=f[g(x)]y = f[g(x)]y=f[g(x)] åœ¨ç‚¹ x0x_0x0â€‹ å¤„è¿ç»­ã€‚
åå‡½æ•°æ€§è´¨ï¼šå¦‚æœå‡½æ•° y=f(x)y = f(x)y=f(x) åœ¨åŒºé—´ III ä¸Šå•è°ƒä¸”è¿ç»­ï¼Œåˆ™å…¶åå‡½æ•° x=fâˆ’1(y)x = f^{-1}(y)x=fâˆ’1(y) ä¹Ÿåœ¨å¯¹åº”çš„åŒºé—´ä¸Šå•è°ƒä¸”è¿ç»­ã€‚
5.6 åˆç­‰å‡½æ•°çš„è¿ç»­æ€§ é‡è¦ç»“è®º æ‰€æœ‰åŸºæœ¬åˆç­‰å‡½æ•°ï¼ˆå¹‚å‡½æ•°ã€æŒ‡æ•°å‡½æ•°ã€å¯¹æ•°å‡½æ•°ã€ä¸‰è§’å‡½æ•°ã€åä¸‰è§’å‡½æ•°ç­‰ï¼‰åœ¨å…¶å®šä¹‰åŸŸå†…éƒ½æ˜¯è¿ç»­çš„ã€‚
ç”±åŸºæœ¬åˆç­‰å‡½æ•°ç»è¿‡æœ‰é™æ¬¡å››åˆ™è¿ç®—å’Œå¤åˆè¿ç®—å¾—åˆ°çš„åˆç­‰å‡½æ•°ï¼Œåœ¨å…¶å®šä¹‰åŒºé—´å†…éƒ½æ˜¯è¿ç»­çš„ã€‚
5.7 é—´æ–­ç‚¹çš„åˆ†ç±» ç¬¬ä¸€ç±»é—´æ–­ç‚¹ï¼ˆå¯å»é—´æ–­ç‚¹ï¼‰ å¦‚æœ limâ¡xâ†’x0f(x)\\lim_{x \\to x_0} f(x)limxâ†’x0â€‹â€‹f(x) å­˜åœ¨ï¼Œä½†ä¸ç­‰äº f(x0)f(x_0)f(x0â€‹) æˆ–è€… f(x0)f(x_0)f(x0â€‹) æ— å®šä¹‰ï¼Œåˆ™ç§° x0x_0x0â€‹ ä¸ºå¯å»é—´æ–­ç‚¹ã€‚
ç¬¬äºŒç±»é—´æ–­ç‚¹ å¦‚æœ limâ¡xâ†’x0f(x)\\lim_{x \\to x_0} f(x)limxâ†’x0â€‹â€‹f(x) ä¸å­˜åœ¨ï¼Œåˆ™ç§° x0x_0x0â€‹ ä¸ºç¬¬äºŒç±»é—´æ–­ç‚¹ã€‚
5.8 ä¾‹é¢˜åˆ†æ ä¾‹é¢˜1 è®¨è®ºå‡½æ•° f(x)={x2,xâ‰¤1x+1,x&gt;1f(x) = \\begin{cases} x^2, &amp; x \\leq 1 \\\\ x+1, &amp; x &gt; 1 \\end{cases}f(x)={x2,x+1,â€‹xâ‰¤1x&gt;1â€‹ åœ¨ç‚¹ x=1x = 1x=1 å¤„çš„è¿ç»­æ€§ã€‚
è§£ï¼š
è®¡ç®—å‡½æ•°å€¼ï¼šf(1)=12=1f(1) = 1^2 = 1f(1)=12=1 è®¡ç®—å·¦æé™ï¼šlimâ¡xâ†’1âˆ’f(x)=limâ¡xâ†’1âˆ’x2=1\\lim_{x \\to 1^-} f(x) = \\lim_{x \\to 1^-} x^2 = 1limxâ†’1âˆ’â€‹f(x)=limxâ†’1âˆ’â€‹x2=1 è®¡ç®—å³æé™ï¼šlimâ¡xâ†’1+f(x)=limâ¡xâ†’1+(x+1)=2\\lim_{x \\to 1^+} f(x) = \\lim_{x \\to 1^+} (x+1) = 2limxâ†’1+â€‹f(x)=limxâ†’1+â€‹(x+1)=2 å› ä¸ºå·¦æé™ â‰ \\neqî€ = å³æé™ï¼Œæ‰€ä»¥æé™ä¸å­˜åœ¨ã€‚ ç»“è®ºï¼šå‡½æ•°åœ¨ x=1x = 1x=1 å¤„ä¸è¿ç»­ï¼Œè¿™æ˜¯ä¸€ä¸ªè·³è·ƒé—´æ–­ç‚¹ï¼ˆå±äºç¬¬ä¸€ç±»é—´æ–­ç‚¹ï¼‰ã€‚
ä¾‹é¢˜2 è®¨è®ºå‡½æ•° f(x)=sinâ¡xxf(x) = \\frac{\\sin x}{x}f(x)=xsinxâ€‹ åœ¨ç‚¹ x=0x = 0x=0 å¤„çš„è¿ç»­æ€§ã€‚
è§£ï¼š
å‡½æ•°åœ¨ x=0x = 0x=0 å¤„æ— å®šä¹‰ è®¡ç®—æé™ï¼šlimâ¡xâ†’0sinâ¡xx=1\\lim_{x \\to 0} \\frac{\\sin x}{x} = 1limxâ†’0â€‹xsinxâ€‹=1ï¼ˆé‡è¦æé™ï¼‰ æé™å­˜åœ¨ä½†å‡½æ•°æ— å®šä¹‰ ç»“è®ºï¼šx=0x = 0x=0 æ˜¯ä¸€ä¸ªå¯å»é—´æ–­ç‚¹ã€‚å¦‚æœè¡¥å……å®šä¹‰ f(0)=1f(0) = 1f(0)=1ï¼Œåˆ™å‡½æ•°åœ¨ x=0x = 0x=0 å¤„è¿ç»­ã€‚å‡½æ•° fx åœ¨ç‚¹ x0å¤„ï¼Œè¿ç»­
`,url:"https://hugo-dead-simple.netlify.com/books/%E5%BE%AE%E7%A7%AF%E5%88%86/chapter1.html"},"https://hugo-dead-simple.netlify.com/blog/vscode-markdown%E4%B8%8D%E8%83%BD%E4%BD%BF%E7%94%A8snippets%E7%9A%84%E9%97%AE%E9%A2%98.html":{title:"vscode-markdownä¸èƒ½ä½¿ç”¨snippetsçš„é—®é¢˜",tags:[],content:`æ‰“å¼€ç”¨æˆ·çš„setting.jsonï¼Œ
åŠ å…¥ä¸‹é¢çš„é…ç½®ï¼š
1 // markdownä¸æ˜¾ç¤ºä»£ç å—çš„é—®é¢˜ 2	&#34;[markdown]&#34;: { 3	&#34;editor.quickSuggestions&#34;: { 4	&#34;other&#34;: &#34;on&#34; 5	} 6	}, ä¸ç”Ÿæ•ˆçš„åŸå› ï¼š
è¿™ä¸ª&quot;other&quot;é¡¹çš„é…ç½®ï¼Œé»˜è®¤å€¼æ˜¯&rsquo;off'
`,url:"https://hugo-dead-simple.netlify.com/blog/vscode-markdown%E4%B8%8D%E8%83%BD%E4%BD%BF%E7%94%A8snippets%E7%9A%84%E9%97%AE%E9%A2%98.html"},"https://hugo-dead-simple.netlify.com/math/%E4%B8%89%E8%A7%92%E4%B8%8D%E7%AD%89%E5%BC%8F.html":{title:"ä¸‰è§’ä¸ç­‰å¼",tags:[],content:`å½“ç„¶å¯ä»¥ã€‚è¯æ˜ä¸‰è§’ä¸ç­‰å¼ (Triangle Inequality) æœ‰å¤šç§æ–¹æ³•ï¼Œè¿™é‡Œå°†ä»‹ç»æœ€å¸¸ç”¨çš„ä¸¤ç§è¯æ˜æ–¹æ³•ï¼ˆä»£æ•°æ–¹æ³•ï¼‰ï¼Œå¹¶è¾…ä»¥å…¶ç›´è§‚çš„å‡ ä½•è§£é‡Šã€‚
å£è¯€ Abstract ä¸¤æ•°ä¹‹å’Œçš„ç»å¯¹å€¼å°äºä¸¤æ•°ç»å¯¹å€¼å’Œ
ä¸‰è§’ä¸ç­‰å¼ å¯¹äºä»»æ„å®æ•° xxx å’Œ yyyï¼Œä¸‰è§’ä¸ç­‰å¼è¡¨è¿°ä¸ºï¼š
âˆ£x+yâˆ£â‰¤âˆ£xâˆ£+âˆ£yâˆ£|x + y| \\leq |x| + |y|âˆ£x+yâˆ£â‰¤âˆ£xâˆ£+âˆ£yâˆ£ç”¨è¯­è¨€æè¿°å°±æ˜¯ï¼šä¸¤ä¸ªæ•°ä¹‹å’Œçš„ç»å¯¹å€¼ï¼Œå°äºæˆ–ç­‰äºè¿™ä¸¤ä¸ªæ•°ç»å¯¹å€¼çš„å’Œã€‚
è¯æ˜æ–¹æ³•ä¸€ï¼šåˆ©ç”¨å¹³æ–¹ï¼ˆæœ€å¸¸ç”¨ï¼‰ è¿™ç§æ–¹æ³•çš„æ ¸å¿ƒæ€æƒ³æ˜¯ï¼Œå¯¹äºä»»ä½•éè´Ÿæ•° AAA å’Œ BBBï¼Œä¸ç­‰å¼ Aâ‰¤BA \\leq BAâ‰¤B ç­‰ä»·äº A2â‰¤B2A^2 \\leq B^2A2â‰¤B2ã€‚å› ä¸ºç»å¯¹å€¼æ€»æ˜¯éè´Ÿçš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥æ¯”è¾ƒ âˆ£x+yâˆ£|x+y|âˆ£x+yâˆ£ å’Œ (âˆ£xâˆ£+âˆ£yâˆ£)(|x|+|y|)(âˆ£xâˆ£+âˆ£yâˆ£) çš„å¹³æ–¹ã€‚
æ¯”è¾ƒåŒæ–¹çš„å¹³æ–¹ æˆ‘ä»¬éœ€è¦è¯æ˜ï¼š âˆ£x+yâˆ£2â‰¤(âˆ£xâˆ£+âˆ£yâˆ£)2|x + y|^2 \\leq (|x| + |y|)^2âˆ£x+yâˆ£2â‰¤(âˆ£xâˆ£+âˆ£yâˆ£)2 å±•å¼€å·¦è¾¹ æ ¹æ®ç»å¯¹å€¼çš„æ€§è´¨ âˆ£aâˆ£2=a2|a|^2 = a^2âˆ£aâˆ£2=a2ï¼Œæˆ‘ä»¬æœ‰ï¼š âˆ£x+yâˆ£2=(x+y)2=x2+2xy+y2|x + y|^2 = (x + y)^2 = x^2 + 2xy + y^2âˆ£x+yâˆ£2=(x+y)2=x2+2xy+y2 å±•å¼€å³è¾¹ (âˆ£xâˆ£+âˆ£yâˆ£)2=âˆ£xâˆ£2+2âˆ£xâˆ£âˆ£yâˆ£+âˆ£yâˆ£2(|x| + |y|)^2 = |x|^2 + 2|x||y| + |y|^2(âˆ£xâˆ£+âˆ£yâˆ£)2=âˆ£xâˆ£2+2âˆ£xâˆ£âˆ£yâˆ£+âˆ£yâˆ£2 åŒæ ·ï¼Œæ ¹æ® âˆ£aâˆ£2=a2|a|^2 = a^2âˆ£aâˆ£2=a2 å’Œ âˆ£aâˆ£âˆ£bâˆ£=âˆ£abâˆ£|a||b|=|ab|âˆ£aâˆ£âˆ£bâˆ£=âˆ£abâˆ£ï¼Œä¸Šå¼å¯ä»¥å†™ä¸ºï¼š x2+2âˆ£xyâˆ£+y2x^2 + 2|xy| + y^2x2+2âˆ£xyâˆ£+y2 æ¯”è¾ƒå±•å¼€åçš„ç»“æœ ç°åœ¨æˆ‘ä»¬æ¯”è¾ƒä¸‹é¢ä¸¤ä¸ªè¡¨è¾¾å¼ï¼š
å·¦è¾¹ï¼šx2+2xy+y2x^2 + 2xy + y^2x2+2xy+y2 å³è¾¹ï¼šx2+2âˆ£xyâˆ£+y2x^2 + 2|xy| + y^2x2+2âˆ£xyâˆ£+y2 ç”±äº x2x^2x2 å’Œ y2y^2y2 éƒ¨åˆ†æ˜¯ç›¸åŒçš„ï¼Œæˆ‘ä»¬åªéœ€è¦æ¯”è¾ƒ 2xy2xy2xy å’Œ 2âˆ£xyâˆ£2|xy|2âˆ£xyâˆ£ã€‚
å…³é”®æ­¥éª¤ æ ¹æ®ç»å¯¹å€¼çš„å®šä¹‰ï¼Œå¯¹äºä»»ä½•å®æ•° aaaï¼Œæˆ‘ä»¬æ€»æ˜¯æœ‰ aâ‰¤âˆ£aâˆ£a \\leq |a|aâ‰¤âˆ£aâˆ£ã€‚ å› æ­¤ï¼Œå¯ä»¥ç¡®å®šï¼š xyâ‰¤âˆ£xyâˆ£xy \\leq |xy|xyâ‰¤âˆ£xyâˆ£ ä¸¤è¾¹åŒæ—¶ä¹˜ä»¥ 2ï¼Œå¾—åˆ° 2xyâ‰¤2âˆ£xyâˆ£2xy \\leq 2|xy|2xyâ‰¤2âˆ£xyâˆ£ã€‚
å¾—å‡ºç»“è®º å› ä¸º xyâ‰¤âˆ£xyâˆ£xy \\leq |xy|xyâ‰¤âˆ£xyâˆ£ï¼Œæ‰€ä»¥ï¼š x2+2xy+y2â‰¤x2+2âˆ£xyâˆ£+y2x^2 + 2xy + y^2 \\leq x^2 + 2|xy| + y^2x2+2xy+y2â‰¤x2+2âˆ£xyâˆ£+y2 è¿™å°±è¯æ˜äº†ï¼š âˆ£x+yâˆ£2â‰¤(âˆ£xâˆ£+âˆ£yâˆ£)2|x + y|^2 \\leq (|x| + |y|)^2âˆ£x+yâˆ£2â‰¤(âˆ£xâˆ£+âˆ£yâˆ£)2 ç”±äºä¸¤è¾¹éƒ½æ˜¯éè´Ÿæ•°ï¼Œå¯¹å®ƒä»¬å¼€å¹³æ–¹æ ¹ï¼Œä¸ç­‰å·æ–¹å‘ä¸å˜ï¼š âˆ£x+yâˆ£â‰¤âˆ£xâˆ£+âˆ£yâˆ£|x + y| \\leq |x| + |y|âˆ£x+yâˆ£â‰¤âˆ£xâˆ£+âˆ£yâˆ£ è¯æ¯•ã€‚
ç­‰å·æˆç«‹çš„æ¡ä»¶ ç­‰å·æˆç«‹å½“ä¸”ä»…å½“ä¸Šé¢æ¯”è¾ƒçš„å…³é”®æ­¥éª¤ä¸­ç­‰å·æˆç«‹ï¼Œå³ xy=âˆ£xyâˆ£xy = |xy|xy=âˆ£xyâˆ£ã€‚è¿™ä¹Ÿå°±æ˜¯è¯´ xyâ‰¥0xy \\geq 0xyâ‰¥0ã€‚ å½“ xxx å’Œ yyy åŒå·ï¼ˆéƒ½ä¸ºæ­£æˆ–éƒ½ä¸ºè´Ÿï¼‰æˆ–è‡³å°‘æœ‰ä¸€ä¸ªä¸ºé›¶æ—¶ï¼Œç­‰å·æˆç«‹ã€‚
è¯æ˜æ–¹æ³•äºŒï¼šåˆ†ç±»è®¨è®º è¿™ç§æ–¹æ³•è™½ç„¶ç¨æ˜¾ç¹çï¼Œä½†éå¸¸ç›´è§‚ï¼Œç›´æ¥åˆ©ç”¨äº†ç»å¯¹å€¼çš„å®šä¹‰ã€‚
æƒ…å†µä¸€ï¼šxâ‰¥0x \\geq 0xâ‰¥0 ä¸” yâ‰¥0y \\geq 0yâ‰¥0 æ­¤æ—¶ x+yâ‰¥0x+y \\geq 0x+yâ‰¥0ã€‚ âˆ£x+yâˆ£=x+y|x+y| = x+yâˆ£x+yâˆ£=x+yã€‚ âˆ£xâˆ£+âˆ£yâˆ£=x+y|x| + |y| = x+yâˆ£xâˆ£+âˆ£yâˆ£=x+yã€‚ æ‰€ä»¥ï¼Œ âˆ£x+yâˆ£=âˆ£xâˆ£+âˆ£yâˆ£|x+y| = |x|+|y|âˆ£x+yâˆ£=âˆ£xâˆ£+âˆ£yâˆ£ã€‚ä¸ç­‰å¼æˆç«‹ã€‚
æƒ…å†µäºŒï¼šx&lt;0x &lt; 0x&lt;0 ä¸” y&lt;0y &lt; 0y&lt;0 æ­¤æ—¶ x+y&lt;0x+y &lt; 0x+y&lt;0ã€‚ âˆ£x+yâˆ£=âˆ’(x+y)=âˆ’xâˆ’y|x+y| = -(x+y) = -x - yâˆ£x+yâˆ£=âˆ’(x+y)=âˆ’xâˆ’yã€‚ âˆ£xâˆ£+âˆ£yâˆ£=(âˆ’x)+(âˆ’y)=âˆ’xâˆ’y|x| + |y| = (-x) + (-y) = -x - yâˆ£xâˆ£+âˆ£yâˆ£=(âˆ’x)+(âˆ’y)=âˆ’xâˆ’yã€‚ æ‰€ä»¥ï¼Œ âˆ£x+yâˆ£=âˆ£xâˆ£+âˆ£yâˆ£|x+y| = |x|+|y|âˆ£x+yâˆ£=âˆ£xâˆ£+âˆ£yâˆ£ã€‚ä¸ç­‰å¼æˆç«‹ã€‚
æƒ…å†µä¸‰ï¼šxxx å’Œ yyy å¼‚å· ä¸å¦¨è®¾ x&gt;0x &gt; 0x&gt;0 ä¸” y&lt;0y &lt; 0y&lt;0ã€‚ï¼ˆx&lt;0,y&gt;0x&lt;0, y&gt;0x&lt;0,y&gt;0 çš„æƒ…å†µåŒç†ï¼‰ æ­¤æ—¶ âˆ£xâˆ£=x|x| = xâˆ£xâˆ£=xï¼Œâˆ£yâˆ£=âˆ’y|y| = -yâˆ£yâˆ£=âˆ’yã€‚ æ‰€ä»¥ âˆ£xâˆ£+âˆ£yâˆ£=xâˆ’y|x|+|y| = x - yâˆ£xâˆ£+âˆ£yâˆ£=xâˆ’yã€‚ å¯¹äºå·¦è¾¹ âˆ£x+yâˆ£|x+y|âˆ£x+yâˆ£ï¼Œæœ‰ä¸¤ç§å¯èƒ½ï¼š
å¦‚æœ x+yâ‰¥0x+y \\geq 0x+yâ‰¥0ï¼š âˆ£x+yâˆ£=x+y|x+y| = x+yâˆ£x+yâˆ£=x+yã€‚ æˆ‘ä»¬éœ€è¦è¯æ˜ x+yâ‰¤xâˆ’yx+y \\leq x-yx+yâ‰¤xâˆ’yã€‚è¿™ç­‰ä»·äº yâ‰¤âˆ’yy \\leq -yyâ‰¤âˆ’yï¼Œå³ 2yâ‰¤02y \\leq 02yâ‰¤0ï¼Œä¹Ÿå°±æ˜¯ yâ‰¤0y \\leq 0yâ‰¤0ã€‚è¿™ä¸æˆ‘ä»¬çš„å‡è®¾ y&lt;0y&lt;0y&lt;0 ä¸€è‡´ã€‚æ‰€ä»¥ä¸ç­‰å¼æˆç«‹ã€‚ å¦‚æœ x+y&lt;0x+y &lt; 0x+y&lt;0ï¼š âˆ£x+yâˆ£=âˆ’(x+y)=âˆ’xâˆ’y|x+y| = -(x+y) = -x-yâˆ£x+yâˆ£=âˆ’(x+y)=âˆ’xâˆ’yã€‚ æˆ‘ä»¬éœ€è¦è¯æ˜ âˆ’xâˆ’yâ‰¤xâˆ’y-x-y \\leq x-yâˆ’xâˆ’yâ‰¤xâˆ’yã€‚è¿™ç­‰ä»·äº âˆ’xâ‰¤x-x \\leq xâˆ’xâ‰¤xï¼Œå³ 0â‰¤2x0 \\leq 2x0â‰¤2xï¼Œä¹Ÿå°±æ˜¯ xâ‰¥0x \\geq 0xâ‰¥0ã€‚è¿™ä¸æˆ‘ä»¬çš„å‡è®¾ x&gt;0x&gt;0x&gt;0 ä¸€è‡´ã€‚æ‰€ä»¥ä¸ç­‰å¼æˆç«‹ã€‚ ç»¼ä¸Šæ‰€è¿°ï¼Œåœ¨æ‰€æœ‰æƒ…å†µä¸‹ï¼Œä¸ç­‰å¼ âˆ£x+yâˆ£â‰¤âˆ£xâˆ£+âˆ£yâˆ£|x + y| \\leq |x| + |y|âˆ£x+yâˆ£â‰¤âˆ£xâˆ£+âˆ£yâˆ£ éƒ½æˆç«‹ã€‚
å‡ ä½•è§£é‡Š è¿™ä¸ªä¸ç­‰å¼è¢«ç§°ä¸ºâ€œä¸‰è§’â€ä¸ç­‰å¼ï¼Œæ­£æ˜¯å› ä¸ºå®ƒåœ¨å‡ ä½•ä¸Šæœ‰ä¸€ä¸ªéå¸¸ç›´è§‚çš„è§£é‡Šã€‚
æƒ³è±¡åœ¨æ•°è½´ä¸Šæˆ–äºŒç»´å¹³é¢ä¸Šï¼Œæˆ‘ä»¬æœ‰ä¸¤ä¸ªå‘é‡ xâƒ—\\vec{x}x å’Œ yâƒ—\\vec{y}yâ€‹ã€‚
âˆ£xâƒ—âˆ£|\\vec{x}|âˆ£xâˆ£ æ˜¯å‘é‡ xâƒ—\\vec{x}x çš„é•¿åº¦ã€‚ âˆ£yâƒ—âˆ£|\\vec{y}|âˆ£yâ€‹âˆ£ æ˜¯å‘é‡ yâƒ—\\vec{y}yâ€‹ çš„é•¿åº¦ã€‚ xâƒ—+yâƒ—\\vec{x} + \\vec{y}x+yâ€‹ æ˜¯ä¸¤ä¸ªå‘é‡ç›¸åŠ å¾—åˆ°çš„å‘é‡ã€‚ âˆ£xâƒ—+yâƒ—âˆ£|\\vec{x} + \\vec{y}|âˆ£x+yâ€‹âˆ£ æ˜¯å’Œå‘é‡çš„é•¿åº¦ã€‚ è¿™ä¸‰ä¸ªå‘é‡ xâƒ—\\vec{x}xã€yâƒ—\\vec{y}yâ€‹ å’Œ xâƒ—+yâƒ—\\vec{x}+\\vec{y}x+yâ€‹ å¯ä»¥æ„æˆä¸€ä¸ªä¸‰è§’å½¢ã€‚ä¸‰æ¡è¾¹çš„é•¿åº¦åˆ†åˆ«æ˜¯ âˆ£xâƒ—âˆ£|\\vec{x}|âˆ£xâˆ£ã€âˆ£yâƒ—âˆ£|\\vec{y}|âˆ£yâ€‹âˆ£ å’Œ âˆ£xâƒ—+yâƒ—âˆ£|\\vec{x}+\\vec{y}|âˆ£x+yâ€‹âˆ£ã€‚
æ ¹æ®**â€œä¸‰è§’å½¢ä¸­ä»»æ„ä¸¤è¾¹ä¹‹å’Œå¤§äºç¬¬ä¸‰è¾¹â€**è¿™ä¸€åŸºæœ¬å‡ ä½•åŸç†ï¼Œæˆ‘ä»¬è‡ªç„¶å¾—åˆ°ï¼š âˆ£xâƒ—+yâƒ—âˆ£&lt;âˆ£xâƒ—âˆ£+âˆ£yâƒ—âˆ£|\\vec{x} + \\vec{y}| &lt; |\\vec{x}| + |\\vec{y}|âˆ£x+yâ€‹âˆ£&lt;âˆ£xâˆ£+âˆ£yâ€‹âˆ£é‚£ä»€ä¹ˆæ—¶å€™ç­‰å·æˆç«‹å‘¢ï¼Ÿå½“è¿™ä¸ªâ€œä¸‰è§’å½¢â€è¢«â€œå‹æ‰â€æˆä¸€æ¡ç›´çº¿æ—¶ï¼Œå³å‘é‡ xâƒ—\\vec{x}x å’Œ yâƒ—\\vec{y}yâ€‹ æ–¹å‘ç›¸åŒæ—¶ï¼Œæˆ‘ä»¬å¾—åˆ°ï¼š âˆ£xâƒ—+yâƒ—âˆ£=âˆ£xâƒ—âˆ£+âˆ£yâƒ—âˆ£|\\vec{x} + \\vec{y}| = |\\vec{x}| + |\\vec{y}|âˆ£x+yâ€‹âˆ£=âˆ£xâˆ£+âˆ£yâ€‹âˆ£å°†è¿™ä¸¤ç§æƒ…å†µåˆå¹¶ï¼Œæˆ‘ä»¬å°±å¾—åˆ°äº†åœ¨å‘é‡ç©ºé—´ä¸­çš„ä¸‰è§’ä¸ç­‰å¼ï¼šâˆ£xâƒ—+yâƒ—âˆ£â‰¤âˆ£xâƒ—âˆ£+âˆ£yâƒ—âˆ£|\\vec{x} + \\vec{y}| \\leq |\\vec{x}| + |\\vec{y}|âˆ£x+yâ€‹âˆ£â‰¤âˆ£xâˆ£+âˆ£yâ€‹âˆ£ã€‚å®æ•°çš„ä¸‰è§’ä¸ç­‰å¼å¯ä»¥çœ‹ä½œæ˜¯è¿™ä¸ªåŸç†åœ¨ä¸€ç»´ï¼ˆæ•°è½´ï¼‰ä¸Šçš„ç‰¹ä¾‹ã€‚
`,url:"https://hugo-dead-simple.netlify.com/math/%E4%B8%89%E8%A7%92%E4%B8%8D%E7%AD%89%E5%BC%8F.html"},"https://hugo-dead-simple.netlify.com/math/%E5%8F%8D%E4%B8%89%E8%A7%92%E4%B8%8D%E7%AD%89%E5%BC%8F.html":{title:"åä¸‰è§’ä¸ç­‰å¼",tags:[],content:` Question âˆ£xâˆ’aâˆ£&lt;1â†’âˆ£xâˆ£âˆ’âˆ£aâˆ£&lt;1|x - a | &lt; 1 \\rightarrow |x| - |a| &lt; 1âˆ£xâˆ’aâˆ£&lt;1â†’âˆ£xâˆ£âˆ’âˆ£aâˆ£&lt;1 å¦‚ä½•è¯æ˜?
å‰ç½®çŸ¥è¯† ä¸‰è§’ä¸ç­‰å¼
å¥½çš„ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨åä¸‰è§’ä¸ç­‰å¼æ¥è¯æ˜è¿™ä¸ªå‘½é¢˜ã€‚
åä¸‰è§’ä¸ç­‰å¼å£è¯€ Abstract åä¸‰è§’ä¸ç­‰å¼ï¼ˆæ¨èå£è¯€ï¼‰ï¼š å·®çš„ç»å¯¹å€¼ â‰¥ ç»å¯¹å€¼çš„å·®
åä¸‰è§’ä¸ç­‰å¼ï¼ˆå‡ ä½•å£è¯€ï¼‰ï¼š ä¸¤è¾¹ä¹‹å·®çš„ç»å¯¹å€¼ â‰¤ ç¬¬ä¸‰è¾¹ (å‘é‡çš„è§’åº¦)
è¯æ˜ æˆ‘ä»¬è¦è¯æ˜çš„å‘½é¢˜æ˜¯ï¼šå¦‚æœ âˆ£xâˆ’aâˆ£&lt;1|x - a| &lt; 1âˆ£xâˆ’aâˆ£&lt;1ï¼Œé‚£ä¹ˆ âˆ£xâˆ£âˆ’âˆ£aâˆ£&lt;1|x| - |a| &lt; 1âˆ£xâˆ£âˆ’âˆ£aâˆ£&lt;1ã€‚
è¿™ä¸ªè¯æ˜çš„æ ¸å¿ƒæ˜¯åä¸‰è§’ä¸ç­‰å¼ (Reverse Triangle Inequality)ã€‚å¯¹äºä»»æ„å®æ•° xxx å’Œ aaaï¼Œåä¸‰è§’ä¸ç­‰å¼çš„ä¸€ä¸ªå½¢å¼æ˜¯ï¼š
âˆ£xâˆ£âˆ’âˆ£aâˆ£â‰¤âˆ£xâˆ’aâˆ£|x| - |a| \\leq |x - a|âˆ£xâˆ£âˆ’âˆ£aâˆ£â‰¤âˆ£xâˆ’aâˆ£åä¸‰è§’ä¸ç­‰å¼çš„æ¨å¯¼å¦‚ä¸‹ï¼š
æˆ‘ä»¬ä»åŸºæœ¬çš„ä¸‰è§’ä¸ç­‰å¼å¼€å§‹ï¼šâˆ£u+vâˆ£â‰¤âˆ£uâˆ£+âˆ£vâˆ£|u + v| \\leq |u| + |v|âˆ£u+vâˆ£â‰¤âˆ£uâˆ£+âˆ£vâˆ£ã€‚ ä»¤ u=xâˆ’au = x - au=xâˆ’aï¼Œv=av = av=aã€‚ å°†å®ƒä»¬ä»£å…¥ä¸‰è§’ä¸ç­‰å¼ï¼š âˆ£(xâˆ’a)+aâˆ£â‰¤âˆ£xâˆ’aâˆ£+âˆ£aâˆ£|(x - a) + a| \\leq |x - a| + |a|âˆ£(xâˆ’a)+aâˆ£â‰¤âˆ£xâˆ’aâˆ£+âˆ£aâˆ£ ç®€åŒ–å·¦è¾¹ï¼š âˆ£xâˆ£â‰¤âˆ£xâˆ’aâˆ£+âˆ£aâˆ£|x| \\leq |x - a| + |a|âˆ£xâˆ£â‰¤âˆ£xâˆ’aâˆ£+âˆ£aâˆ£ å°† âˆ£aâˆ£|a|âˆ£aâˆ£ ç§»åˆ°ä¸ç­‰å¼çš„å·¦è¾¹ï¼Œæˆ‘ä»¬å°±å¾—åˆ°äº†åä¸‰è§’ä¸ç­‰å¼ï¼š âˆ£xâˆ£âˆ’âˆ£aâˆ£â‰¤âˆ£xâˆ’aâˆ£|x| - |a| \\leq |x - a|âˆ£xâˆ£âˆ’âˆ£aâˆ£â‰¤âˆ£xâˆ’aâˆ£ ç°åœ¨ï¼Œæˆ‘ä»¬æ¥å®Œæˆæ•´ä¸ªè¯æ˜ï¼š
å·²çŸ¥å‰æ (Given)ï¼š âˆ£xâˆ’aâˆ£&lt;1|x - a| &lt; 1âˆ£xâˆ’aâˆ£&lt;1 æ ¹æ®åä¸‰è§’ä¸ç­‰å¼ (From the Reverse Triangle Inequality)ï¼š âˆ£xâˆ£âˆ’âˆ£aâˆ£â‰¤âˆ£xâˆ’aâˆ£|x| - |a| \\leq |x - a|âˆ£xâˆ£âˆ’âˆ£aâˆ£â‰¤âˆ£xâˆ’aâˆ£ ç»“åˆä»¥ä¸Šä¸¤ä¸ªä¸ç­‰å¼ (Combining the two inequalities)ï¼š æˆ‘ä»¬æœ‰ âˆ£xâˆ£âˆ’âˆ£aâˆ£|x| - |a|âˆ£xâˆ£âˆ’âˆ£aâˆ£ çš„å€¼å°äºæˆ–ç­‰äº âˆ£xâˆ’aâˆ£|x - a|âˆ£xâˆ’aâˆ£ï¼Œè€Œ âˆ£xâˆ’aâˆ£|x - a|âˆ£xâˆ’aâˆ£ çš„å€¼åˆä¸¥æ ¼å°äº 1ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥å¾—å‡ºç»“è®ºï¼š âˆ£xâˆ£âˆ’âˆ£aâˆ£â‰¤âˆ£xâˆ’aâˆ£&lt;1|x| - |a| \\leq |x - a| &lt; 1âˆ£xâˆ£âˆ’âˆ£aâˆ£â‰¤âˆ£xâˆ’aâˆ£&lt;1 ç»“è®º (Conclusion)ï¼š å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥æ–­å®šï¼š âˆ£xâˆ£âˆ’âˆ£aâˆ£&lt;1|x| - |a| &lt; 1âˆ£xâˆ£âˆ’âˆ£aâˆ£&lt;1 è¯æ¯• (Q.E.D.)
`,url:"https://hugo-dead-simple.netlify.com/math/%E5%8F%8D%E4%B8%89%E8%A7%92%E4%B8%8D%E7%AD%89%E5%BC%8F.html"},"https://hugo-dead-simple.netlify.com/books/%E7%AE%97%E6%B3%95%E7%AB%9E%E8%B5%9B%E8%BF%9B%E9%98%B6%E6%8C%87%E5%8D%97/%E7%8E%AF%E5%BD%A2%E5%9D%87%E5%88%86%E7%BA%B8%E7%89%8C%E8%A7%A3%E6%9E%90.html":{title:"ç¯å½¢å‡åˆ†çº¸ç‰Œè§£æ",tags:[],content:`è¯æ˜1 å¯é“¾åŒ– P: å¿…ç„¶å­˜åœ¨æŸä¸ªæœ€ä¼˜è§£: è¿™ä¸ªæœ€ä¼˜è§£ä¸­å­˜åœ¨ç›¸é‚»çš„å…ƒç´ æ²¡æœ‰å‘ç”Ÿäº¤æ¢
è¿™ä¸ªå‘½é¢˜çš„å¦å‘½é¢˜:Â¬p\\neg pÂ¬p: å­˜åœ¨æŸä¸ªæ•°æ®,è¿™ä¸ªæ•°æ®çš„æ‰€æœ‰æœ€ä¼˜è§£(âˆ€\\forallâˆ€);ä»»æ„ä¸¤ä¸ªç›¸é‚»çš„å…ƒç´ éƒ½ä¼šå‘ç”Ÿäº¤æ¢,
æˆ‘æŠŠè¿™ç§ä»»æ„ä¸¤ä¸ªç›¸é‚»å…ƒç´ éƒ½å‘ç”Ÿäº¤æ¢çš„æƒ…å†µ:æˆ‘ç§°ä¹‹ä¸º:å°é—­
æ˜¾ç„¶ï¼Œæˆ‘ä»¬è¦è¯æ˜çš„å°±æ˜¯Â¬p\\neg pÂ¬pæ˜¯ä¸æ­£ç¡®çš„,æ¯”è¾ƒç›´è§‰çš„æƒ³æ³•,å°±æ˜¯ä½¿ç”¨åæ­£æ³•.
ä½¿ç”¨åè¯æ³•ï¼Œæˆ‘ä»¬éœ€è¦çŸ¥é“åæ³•å’Œå‰ææ¡ä»¶æœ‰ä¸€å®šçš„å†²çª. é‚£è¿™é‡Œå‘¢æˆ‘ä»¬éœ€è¦æ›´æ·±å…¥çš„ç†è§£å‰ææ¡ä»¶.
å¦‚ä¸Šå›¾æ‰€ç¤º,æˆ‘ä»¬ç»™æ¯ä¸€æ¡è¾¹è¿›è¡Œç¼–å·. æˆ‘ä»¬è§„å®š,å¦‚æœç›¸é‚»çš„ä¸¤ä¸ªå…ƒç´ ä¹‹é—´å‘ç”Ÿçš„äº¤æ¢ä¸ºé¡ºæ—¶é’ˆæ–¹å‘:åˆ™æ•°å€¼ä¸ºæ­£,åä¹‹ä¸ºè´Ÿ.
æ˜¾ç„¶å¾ˆå®¹æ˜“æƒ³åˆ°ï¼Œæˆ‘ä»¬æ‰€æ±‚çš„æœ€å°äº¤æ¢ç‰Œæ•°å°±æ˜¯
sum=âˆ‘âˆ£xiâˆ£(1) sum = \\sum \\left| x_i \\right| \\tag 1 sum=âˆ‘âˆ£xiâ€‹âˆ£(1)é•¿é“¾: æˆ‘ä»¬å°½å¯èƒ½çš„æŠŠç›¸é‚»çš„åŒæ–¹å‘çš„è¾¹ä¸²åœ¨ä¸€èµ·ç»„æˆçš„é“¾.
è®¾ pip_ipiâ€‹ è¡¨ç¤ºæ¯ä¸€ä¸ªç‚¹çš„å‡€æµå‡ºå€¼,æ˜¾ç„¶ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°ä¸‹é¢å…¬å¼:
pi=aiâˆ’avg(2) p_i = a_i - avg \\tag 2 piâ€‹=aiâ€‹âˆ’avg(2)âˆ‘1npi=0(3) \\sum_1^n p_i = 0 \\tag 3 1âˆ‘nâ€‹piâ€‹=0(3)å½“pi&gt;0p_i &gt; 0piâ€‹&gt;0è¡¨ç¤ºéœ€è¦æµå‡º(ç»™åˆ«äººç‰Œ), pi&lt;0p_i&lt;0piâ€‹&lt;0 åä¹‹
æ¨è®ºä¸€: é•¿é“¾çš„èµ·ç‚¹å’Œç»ˆç‚¹å¿…ç„¶å‘ç”Ÿäº¤æ¢
å‚è€ƒæ–¹å‘ æ ¹æ®å…¬å¼ä¸‰,åŠ ä¸Šå¹³è¡¡ç†è®º,ç†è®ºä¸Šï¼Œæˆ‘ä»¬åº”è¯¥ä¹Ÿå¯ä»¥åˆ©ç”¨xix_ixiâ€‹è®¡ç®—å‡ºpip_ipiâ€‹:
å¦‚ä¸Šå›¾figure_2å·¦æ‰€ç¤º: p2=5+1,p3=âˆ’1+(âˆ’3)p_2 = 5 + 1,p_3 = -1 + (-3)p2â€‹=5+1,p3â€‹=âˆ’1+(âˆ’3),è¿™ç§è®¡ç®—æ–¹æ³•éœ€è¦æˆ‘ä»¬çŸ¥é“æ¯ä¸€æ¡è¾¹çš„æ–¹å‘ä»¥åŠæ•°å€¼. ä½†æ˜¯:å½“æˆ‘ä»¬æ¯æ¡è¾¹çš„å˜é‡ä¸ºxix_ixiâ€‹,æˆ‘ä»¬æƒ³è¦é‡‡ç”¨å˜é‡æ³•æ¥ç ”ç©¶é—®é¢˜,å†™è¿™ä¸ªæ—¶å€™ï¼Œæˆ‘ä»¬ä¹Ÿä¸çŸ¥é“æ¯æ¡è¾¹çš„å…·ä½“æ–¹å‘,æˆ‘ä»¬åº”è¯¥å¦‚ä½•åˆ—å‡ºå…¬å¼ pip_ipiâ€‹ å‘¢ï¼Ÿ
å…¶å®è¿™ä¸ªé—®é¢˜çš„æ ¸å¿ƒåœ¨äº: ä¸€æ¡è¾¹å¯¹äºç›¸é‚»çš„ç‚¹å…·æœ‰ä¸åŒçš„æ–¹å«ä¹‰,æ¯”å¦‚x2x_2x2â€‹å¯¹äºç‚¹3å°±æ˜¯æµå…¥,å¯¹äºç‚¹3å°±æ˜¯æµå‡º,æˆ‘ä»¬éœ€è¦è§£å†³è¿™ä¸ªé—®é¢˜.
æ ¹æ®ç”µè·¯çš„ç›¸å…³çŸ¥è¯†çµæ„Ÿ,æˆ‘ä»¬å–é¡ºæ—¶é’ˆä¸ºå‚è€ƒæ–¹å‘,æ‰€æœ‰ä¸å‚è€ƒæ–¹å‘ç›¸åŒçš„è¾¹ä¸ºæ­£å€¼,æ–¹å‘ç›¸åçš„è¾¹è´Ÿå€¼ï¼Œå‘ç°ï¼šæ¯ä¸€ä¸ªç‚¹çš„æµå…¥ç­‰äºå‰ä¸€æ¡è¾¹çš„æ•°å€¼å‡å»åä¸€æ¡è¾¹çš„æ•°å€¼,åˆ™æ¯ä¸€ä¸ªç‚¹çš„æµå…¥åº”è¯¥è®¡ç®—ä¸º:xiâˆ’1âˆ’ximodâ€‰nx_{i-1} - x_{i \\mod n}xiâˆ’1â€‹âˆ’ximodnâ€‹,æ­¤æµå…¥å€¼æ˜¾ç„¶åº”è¯¥ç­‰äºâˆ’pi-p_iâˆ’piâ€‹
xiâˆ’1âˆ’ximodâ€‰n+pi=0 x_{i-1} - x_{i \\mod n} + p_i = 0 \\\\ xiâˆ’1â€‹âˆ’ximodnâ€‹+piâ€‹=0å˜å½¢å¾—: å¹³è¡¡å…¬å¼äºŒ ximodâ€‰n=pi+xiâˆ’1(4) x_{i \\mod n} = p_i + x_{i-1} \\tag 4 ximodnâ€‹=piâ€‹+xiâˆ’1â€‹(4)ä¸€å…ƒä¸€æ¬¡æ–¹ç¨‹ æ˜¾ç„¶æƒ³åˆ°:è‹¥çŸ¥é“x0x_0x0â€‹çš„å€¼æ˜¯å¤šå°‘,åˆ™å…¶ä»–æ‰€æœ‰è¾¹çš„å€¼éƒ½çŸ¥é“,åˆ™æˆ‘ä»¬å¯ä»¥é€šè¿‡ x0x_0x0â€‹ çš„å€¼è®¡ç®—å‡ºå…¶ä»–æ‰€æœ‰ xix_ixiâ€‹ çš„å€¼
è¿™é‡Œå…¶å®æ˜¯çº¿æ€§ä»£æ•°çš„å†…å®¹,æ¶‰åŠåˆ°ä¸€ä¸ªæ¦‚å¿µå«ç‹¬ç«‹æ–¹ç¨‹
x0=x0x1=p1+x0x2=p2+x1=p2+p1+x0x3=p3+x2=p3+p2+p1+x0â‹¯xnâˆ’1=pnâˆ’1+xnâˆ’2=pnâˆ’1+â‹¯+p1+x0 \\begin{aligned} x_0 &amp;= x_0 \\\\ x_1 &amp;= p_1 + x_0 \\\\ x_2 &amp;= p_2 + x_1 &amp;=&amp; p_2+p_1+x_0 \\\\ x_3 &amp;= p_3 + x_2 &amp;=&amp; p_3+p_2+p_1+x_0 \\\\ \\cdots \\\\ x_{n-1} &amp;= p_{n-1}+x_{n-2} &amp;=&amp; p_{n-1} + \\cdots + p_1 + x_0 \\end{aligned} x0â€‹x1â€‹x2â€‹x3â€‹â‹¯xnâˆ’1â€‹â€‹=x0â€‹=p1â€‹+x0â€‹=p2â€‹+x1â€‹=p3â€‹+x2â€‹=pnâˆ’1â€‹+xnâˆ’2â€‹â€‹===â€‹p2â€‹+p1â€‹+x0â€‹p3â€‹+p2â€‹+p1â€‹+x0â€‹pnâˆ’1â€‹+â‹¯+p1â€‹+x0â€‹â€‹è®¾ si=âˆ‘1ipis_i = \\sum_1^i p_isiâ€‹=âˆ‘1iâ€‹piâ€‹,ä¸”âˆ‘1npi=0â‡’sn=0\\sum_1^n p_i = 0 \\Rightarrow s_n = 0âˆ‘1nâ€‹piâ€‹=0â‡’snâ€‹=0, è‹¥å­˜åœ¨xnx_nxnâ€‹ åˆ™ xn=x0x_n = x_0xnâ€‹=x0â€‹
xi=si+x0 x_i = s_i + x_0 xiâ€‹=siâ€‹+x0â€‹xn=sn+x0=x0x_n = s_n+x_0 = x_0xnâ€‹=snâ€‹+x0â€‹=x0â€‹
äºæ˜¯æˆ‘ä»¬å¯ä»¥å¾—åˆ°ä¸€ä¸ªé‡è¦çš„å‡½æ•°:å½“ç¬¬ n ä¸ªäººä¸ç¬¬ä¸€ä¸ªäººä¹‹é—´çš„äº¤æ¢æ’æ•°ä¸º x0x_0x0â€‹ æ—¶,æœ€å°äº¤æ¢ç‰Œæ•°ä¸ºF(x0)F(x_0)F(x0â€‹)
F(x0)=âˆ‘1nâˆ£si+x0âˆ£(a) F(x_0) = \\sum_1^n \\left| {s_i + x_0} \\right| \\tag a F(x0â€‹)=1âˆ‘nâ€‹âˆ£siâ€‹+x0â€‹âˆ£(a)F(x0)F(x_0)F(x0â€‹)æ€§è´¨æ¢ç©¶ æ­¤æ—¶ï¼Œæˆ‘ä»¬è®¤ä¸ºå‘½é¢˜Â¬p\\neg pÂ¬pæ˜¯æˆç«‹çš„,åˆ™ âˆ€i(si+x0â‰ 0)\\forall i ( s_i + x_0 \\neq 0)âˆ€i(siâ€‹+x0â€‹î€ =0),ç”¨é›†åˆçš„æ–¹æ³•æ¥è¡¨ç¤ºå°±æ˜¯ x0âˆ‰{âˆ’s1,âˆ’s2,â‹¯â€‰,âˆ’sn}x_0 \\notin \\{-s_1,-s_2,\\cdots, -s_n\\}x0â€‹âˆˆ/{âˆ’s1â€‹,âˆ’s2â€‹,â‹¯,âˆ’snâ€‹},å¯¹âˆ’si-s_iâˆ’siâ€‹è¿›è¡Œä»å¤§åˆ°å°æ’åºï¼Œå¾—åˆ°ä¸€ä¸ªæ–°çš„åºåˆ—siâ€²s&#x27;_isiâ€²â€‹
è¿™å°±è¯´æ˜ x0å®šä¹‰åŸŸ,æ˜¯åœ¨æ•°è½´ä¸Šå»é™¤äº†siâ€²s&#x27;_isiâ€²â€‹.
å‡è®¾sjâ€²&lt;x0&lt;sj+1â€² s&#x27;_j &lt; x_0 &lt; s&#x27;_{j+1}sjâ€²â€‹&lt;x0â€‹&lt;sj+1â€²â€‹
å¯¹äº iâ©½ji \\leqslant jiâ©½jï¼Œç”±äº x0&gt;sjâ€²â©¾siâ€²x_0 &gt; s&#x27;_{j} \\geqslant s&#x27;_{i}x0â€‹&gt;sjâ€²â€‹â©¾siâ€²â€‹ï¼Œæ‰€ä»¥ âˆ£x0âˆ’siâ€²âˆ£=x0âˆ’siâ€²|x_0 - s&#x27;_{i}| = x_0 - s&#x27;_{i}âˆ£x0â€‹âˆ’siâ€²â€‹âˆ£=x0â€‹âˆ’siâ€²â€‹ å¯¹äº i&gt;ji &gt; ji&gt;jï¼Œç”±äº x0&lt;sj+1â€²â‰¤siâ€²x_0 &lt; s&#x27;_{j+1} â‰¤ s&#x27;_{i}x0â€‹&lt;sj+1â€²â€‹â‰¤siâ€²â€‹ï¼Œæ‰€ä»¥ âˆ£x0âˆ’siâ€²âˆ£=siâ€²âˆ’x0|x_0 - s&#x27;_{i}| = s&#x27;_{i} - x_0âˆ£x0â€‹âˆ’siâ€²â€‹âˆ£=siâ€²â€‹âˆ’x0â€‹ å¸¦å…¥F(x0)F(x_0)F(x0â€‹)å¾—åˆ°:
F(x0)=âˆ‘1j(kâˆ’siâ€²)+âˆ‘j+1n(siâ€²âˆ’k)=jÃ—kâˆ’âˆ‘1jsiâ€²+((nâˆ’j)Ã—âˆ’k)+âˆ‘j+1ksiâ€²=(2jâˆ’n)kâˆ’âˆ‘1jsiâ€²+âˆ‘j+1ksiâ€²=(2jâˆ’n)k+Constant \\begin{aligned} F(x_0) &amp;= \\sum_1^j(k-s&#x27;_i) + \\sum_{j+1}^n(s&#x27;_i - k) \\\\ &amp;= j\\times k -\\sum_1^j{s&#x27;_i} + ((n-j) \\times -k) + \\sum_{j+1} ^k s&#x27;_i \\\\ &amp;= (2j-n)k -\\sum_1^j{s&#x27;_i} + \\sum_{j+1} ^k s&#x27;_i \\\\ &amp;= (2j-n)k + Constant \\end{aligned} F(x0â€‹)â€‹=1âˆ‘jâ€‹(kâˆ’siâ€²â€‹)+j+1âˆ‘nâ€‹(siâ€²â€‹âˆ’k)=jÃ—kâˆ’1âˆ‘jâ€‹siâ€²â€‹+((nâˆ’j)Ã—âˆ’k)+j+1âˆ‘kâ€‹siâ€²â€‹=(2jâˆ’n)kâˆ’1âˆ‘jâ€‹siâ€²â€‹+j+1âˆ‘kâ€‹siâ€²â€‹=(2jâˆ’n)k+Constantâ€‹å…¶ä¸­,ConstantConstantConstantè¡¨ç¤ºå’Œ x0x_0x0â€‹ æ— å…³çš„ä¸€ä¸ªå®šå€¼,F(x0)F(x_0)F(x0â€‹)æ˜¯ä¸€ä¸ªä¸€å…ƒä¸€æ¬¡çº¿æ€§æ–¹ç¨‹,ä¸‹é¢åˆ†æƒ…å†µè®¨è®º
å¦‚æœ 2jâˆ’n&gt;02j - n &gt; 02jâˆ’n&gt;0ï¼ŒF(x0)F(x_0)F(x0â€‹) åœ¨è¿™ä¸ªåŒºé—´å†…æ˜¯å•è°ƒé€’å¢çš„ã€‚è¿™æ„å‘³ç€å¦‚æœæˆ‘ä»¬ç¨å¾®å‡å° x0x_0x0â€‹ï¼ŒF(x0)F(x_0)F(x0â€‹) çš„å€¼å°±ä¼šå˜å°ã€‚æˆ‘ä»¬å¯ä»¥ä¸€ç›´å‡å° x0x_0x0â€‹ ç›´åˆ° x0x_0x0â€‹ åˆ°è¾¾åŒºé—´çš„å·¦ç«¯ç‚¹ sjâ€²s&#x27;_jsjâ€²â€‹ï¼Œæ­¤æ—¶æˆæœ¬ F(sjâ€²)F(s&#x27;_j)F(sjâ€²â€‹) ä¼šæ¯”åŒºé—´å†…ä»»ä½•ä¸€ç‚¹çš„æˆæœ¬éƒ½ä½ã€‚ å¦‚æœ 2jâˆ’n&lt;02j - n &lt; 02jâˆ’n&lt;0ï¼ŒF(x0)F(x_0)F(x0â€‹) åœ¨è¿™ä¸ªåŒºé—´å†…æ˜¯å•è°ƒé€’å‡çš„ã€‚åŒç†ï¼Œæˆ‘ä»¬å¯ä»¥ä¸€ç›´å¢å¤§ x0x_0x0â€‹ ç›´åˆ° x0x_0x0â€‹ åˆ°è¾¾åŒºé—´çš„å³ç«¯ç‚¹ s1j+1s1_{j+1}s1j+1â€‹ï¼Œæ­¤æ—¶æˆæœ¬ F(s1j+1)F(s1_{j+1})F(s1j+1â€‹) ä¼šæ›´ä½ã€‚ å¦‚æœ 2jâˆ’n=02j - n = 02jâˆ’n=0ï¼ŒF(x0)F(x_0)F(x0â€‹) åœ¨è¿™ä¸ªåŒºé—´å†…æ˜¯å¸¸æ•°ã€‚è¿™æ„å‘³ç€åŒºé—´å†…æ‰€æœ‰ç‚¹çš„æˆæœ¬éƒ½ä¸€æ ·ï¼ŒåŒ…æ‹¬ç«¯ç‚¹ sjâ€²s&#x27;_jsjâ€²â€‹ å’Œ sj+1â€²s&#x27;_{j+1}sj+1â€²â€‹ åœ¨æ‰€æœ‰æƒ…å†µä¸‹ï¼Œå¦‚æœæˆ‘ä»¬æœ‰ä¸€ä¸ªæœ€ä¼˜è§£ x0x_0x0â€‹ ä½äºå¼€åŒºé—´ (sjâ€²,sj+1â€²)(s&#x27;_j, s&#x27;_{j+1})(sjâ€²â€‹,sj+1â€²â€‹) å†…ï¼Œæˆ‘ä»¬æ€»èƒ½æ‰¾åˆ°ä¸€ä¸ªæ–°çš„æœ€ä¼˜è§£ x0x_0x0â€‹&rsquo;ï¼ˆå®ƒç­‰äº sjâ€²s&#x27;_jsjâ€²â€‹ æˆ– sj+1â€²s&#x27;_{j+1}sj+1â€²â€‹ï¼‰ï¼Œä½¿å¾— F(x0â€²)â©½F(x0)F(x_0&#x27;) \\leqslant F(x_0)F(x0â€²â€‹)â©½F(x0â€‹)
è¿™ä¸ªæ–°çš„æœ€ä¼˜è§£ x0x_0x0â€‹&rsquo; å±äºå…³é”®ç‚¹é›†åˆ Sâ€²S&#x27;Sâ€²ã€‚ ä½†å¦‚æœ x0x_0x0â€‹&rsquo; å±äº Sâ€²S&#x27;Sâ€²ï¼Œé‚£ä¹ˆ x0â€²=âˆ’six_0&#x27; = -s_ix0â€²â€‹=âˆ’siâ€‹ å¯¹äºæŸä¸ª iii æˆç«‹ã€‚ è¿™æ„å‘³ç€ xi=x0â€²+si=(âˆ’si)+si=0x_i = x_0&#x27; + s_i = (-s_i) + s_i = 0xiâ€‹=x0â€²â€‹+siâ€‹=(âˆ’siâ€‹)+siâ€‹=0 è¿™å°±æ‰¾åˆ°äº†ä¸€ä¸ªæœ€ä¼˜è§£ï¼Œå…¶ä¸­å­˜åœ¨ä¸€å¯¹ç›¸é‚»å…ƒç´ æ²¡æœ‰äº¤æ¢ï¼
è¿™ä¸æˆ‘ä»¬æœ€åˆçš„å‡è®¾â€”â€”â€œä»»ä½•æœ€ä¼˜è§£ä¸­æ‰€æœ‰ç›¸é‚»å…ƒç´ éƒ½å‘ç”Ÿäº¤æ¢â€â€”â€”äº§ç”Ÿäº†ç›´æ¥çš„çŸ›ç›¾ã€‚
é‡è¦è§„å¾‹ æ¥ä¸‹æ¥æˆ‘ä»¬å‘ç°ä¸€ä¸ªéå¸¸é‡è¦çš„è§„å¾‹: å½“æŸä¸€æ¡è¾¹xix_ixiâ€‹çš„æ•°å€¼æ”¹å˜æ—¶,æ¯”å¦‚è¯´å‡ä¸€,é‚£ä¹ˆå…¶ä»–æ‰€æœ‰çš„è¾¹éƒ½è¦æ”¹å˜(åŠ ä¸€æˆ–å‡ä¸€):ä»¥è¾¾åˆ°é‡æ–°çš„å¹³è¡¡.
è¯æ˜2 æ±‚å‡ºæ‹†åˆ†ä½ç½® é€šè¿‡æšä¸¾æŸä¸ªxi=0x_i = 0xiâ€‹=0,æ¥æ±‚è§£
æ ¹æ®å¯é“¾åŒ–è¯æ˜
å‡å¦‚,æˆ‘ä»¬è®¤ä¸ºx0=0x_0 = 0x0â€‹=0,äºæ˜¯æŒ‰ç…§é¡ºæ—¶é’ˆçš„æ–¹å‘ï¼Œæˆ‘ä»¬å°±ä¾æ¬¡å¯ä»¥ç®—å‡ºx1,x2,â‹¯â€‰,xnâˆ’1x_1,x_2,\\cdots,x_{n-1}x1â€‹,x2â€‹,â‹¯,xnâˆ’1â€‹,æ ¹æ®å…¬å¼å››:
xiæ•°å€¼x1=p1âˆ’0s1x2=p2+p1s2x3=p3+p2+p1s3â‹¯â‹¯xnâˆ’1sixn=xn=0sn=0 \\begin{array}{c|c} \\hline x_i &amp; \\text{æ•°å€¼} \\\\ \\hline x_1 = p_1 - 0 &amp; s_1 \\\\ x_2 = p_2 + p1 &amp; s_2 \\\\ x_3 = p_3 +p_2 + p1 &amp; s_3 \\\\ \\cdots &amp; \\cdots \\\\ x_{n-1} &amp; s_i \\\\ x_n = x_n = 0 &amp; s_n =0 \\\\ \\end{array} xiâ€‹x1â€‹=p1â€‹âˆ’0x2â€‹=p2â€‹+p1x3â€‹=p3â€‹+p2â€‹+p1â‹¯xnâˆ’1â€‹xnâ€‹=xnâ€‹=0â€‹æ•°å€¼s1â€‹s2â€‹s3â€‹â‹¯siâ€‹snâ€‹=0â€‹â€‹ç°åœ¨æˆ‘ä»¬ä» xkx_kxkâ€‹ å¼€å§‹æ–­å¼€,é‚£æˆ‘ä»¬å°±æ˜¯ä»xk+1x_{k+1}xk+1â€‹å¼€å§‹æ•°.
xiæ•°å€¼xk+1=pk+1âˆ’0sk+1âˆ’skxk+2=pk+2+pk+1sk+2âˆ’skxk+3=pk+3pk+2+pk+1sk+3âˆ’skâ‹¯â‹¯xn=pn+â‹¯+pk+1snâˆ’skx1=p1+xns1+snâˆ’skx2=p2+x1s2+snâˆ’skx3=p3+x2s3+snâˆ’skâ‹¯â‹¯ \\begin{array}{c|c} \\hline x_i &amp; \\text{æ•°å€¼} \\\\ \\hline x_{k+1} = p_{k+1} - 0 &amp; s_{k+1} - s_{k} \\\\ x_{k+2} = p_{k+2} + p_{k+1} &amp; s_{k+2} - s_{k} \\\\ x_{k+3} = p_{k+3} p_{k+2} + p_{k+1} &amp; s_{k+3} - s_{k} \\\\ \\cdots &amp; \\cdots \\\\ x_n = p_n +\\cdots + p_{k+1} &amp; s_{n} - s_{k} \\\\ x_1 = p_1 + x_n &amp; s_1 +s_n-s_k \\\\ x_2 = p_2 + x_1 &amp; s_2 +s_n-s_k \\\\ x_3 = p_3 + x_2 &amp; s_3 +s_n-s_k \\\\ \\cdots &amp; \\cdots \\end{array} xiâ€‹xk+1â€‹=pk+1â€‹âˆ’0xk+2â€‹=pk+2â€‹+pk+1â€‹xk+3â€‹=pk+3â€‹pk+2â€‹+pk+1â€‹â‹¯xnâ€‹=pnâ€‹+â‹¯+pk+1â€‹x1â€‹=p1â€‹+xnâ€‹x2â€‹=p2â€‹+x1â€‹x3â€‹=p3â€‹+x2â€‹â‹¯â€‹æ•°å€¼sk+1â€‹âˆ’skâ€‹sk+2â€‹âˆ’skâ€‹sk+3â€‹âˆ’skâ€‹â‹¯snâ€‹âˆ’skâ€‹s1â€‹+snâ€‹âˆ’skâ€‹s2â€‹+snâ€‹âˆ’skâ€‹s3â€‹+snâ€‹âˆ’skâ€‹â‹¯â€‹â€‹æˆ‘ä»¬åˆçŸ¥é“sn=âˆ‘pi=0s_n = \\sum p_i = 0snâ€‹=âˆ‘piâ€‹=0
xiæ•°å€¼xk+1=pk+1âˆ’0sk+1âˆ’skxk+2=pk+2+pk+1sk+2âˆ’skxk+3=pk+3pk+2+pk+1sk+3âˆ’skâ‹¯â‹¯xn=pn+â‹¯+pk+1snâˆ’skx1=p1+xns1âˆ’skx2=p2+x1s2âˆ’skx3=p3+x2s3âˆ’skâ‹¯â‹¯ \\begin{array}{c|c} \\hline x_i &amp; \\text{æ•°å€¼} \\\\ \\hline x_{k+1} = p_{k+1} - 0 &amp; s_{k+1} - s_{k} \\\\ x_{k+2} = p_{k+2} + p_{k+1} &amp; s_{k+2} - s_{k} \\\\ x_{k+3} = p_{k+3} p_{k+2} + p_{k+1} &amp; s_{k+3} - s_{k} \\\\ \\cdots &amp; \\cdots \\\\ x_n = p_n +\\cdots + p_{k+1} &amp; s_{n} - s_{k} \\\\ x_1 = p_1 + x_n &amp; s_1 -s_k \\\\ x_2 = p_2 + x_1 &amp; s_2 -s_k \\\\ x_3 = p_3 + x_2 &amp; s_3 -s_k \\\\ \\cdots &amp; \\cdots \\end{array} xiâ€‹xk+1â€‹=pk+1â€‹âˆ’0xk+2â€‹=pk+2â€‹+pk+1â€‹xk+3â€‹=pk+3â€‹pk+2â€‹+pk+1â€‹â‹¯xnâ€‹=pnâ€‹+â‹¯+pk+1â€‹x1â€‹=p1â€‹+xnâ€‹x2â€‹=p2â€‹+x1â€‹x3â€‹=p3â€‹+x2â€‹â‹¯â€‹æ•°å€¼sk+1â€‹âˆ’skâ€‹sk+2â€‹âˆ’skâ€‹sk+3â€‹âˆ’skâ€‹â‹¯snâ€‹âˆ’skâ€‹s1â€‹âˆ’skâ€‹s2â€‹âˆ’skâ€‹s3â€‹âˆ’skâ€‹â‹¯â€‹â€‹æ‰€ä»¥æˆ‘ä»¬å¾—åˆ°,ä»xkx_kxkâ€‹å¤„æ–­å¼€å¾—åˆ°çš„å‡½æ•°F(k)F(k)F(k)
F(k)=âˆ‘âˆ£siâˆ’skâˆ£(b) F(k) = \\sum \\left| s_i-s_k \\right| \\tag b F(k)=âˆ‘âˆ£siâ€‹âˆ’skâ€‹âˆ£(b)å¦‚æœä»x0x_0x0â€‹,ä¹Ÿå°±æ˜¯xnx_nxnâ€‹å¤„æ–­å¼€ F(n)=âˆ‘âˆ£siâˆ’snâˆ£=âˆ‘âˆ£siâˆ£F(n) = \\sum \\left| s_i - s_n \\right| = \\sum \\left| s_i \\right|F(n)=âˆ‘âˆ£siâ€‹âˆ’snâ€‹âˆ£=âˆ‘âˆ£siâ€‹âˆ£,ç¬¦åˆé¢˜ç›®.
ä¸”å…¬å¼ b,æ˜¾ç„¶å°±æ˜¯: ä¸€å †æ•°ä¸­,é€‰å“ªä¸ªæ•°xxx,æ±‚å…¶å®ƒæ•°åˆ°xxxçš„è·ç¦»å’Œæœ€å°? ä¸­ä½æ•°:
å¦‚æœæ•°å­—çš„æ•°é‡æ˜¯å¥‡æ•°,åˆ™é€‰æ‹©æ’åºåä¸­é—´çš„é‚£ä¸ªæ•°å­— å¦‚æœæ•°å­—çš„æ•°é‡æ˜¯å¶æ•°,åˆ™é€‰æ‹©æ’åºåä¸­é—´çš„é‚£ä¸ªä¸¤ä¸ªä¹‹ä¸€éƒ½å¯ä»¥ `,url:"https://hugo-dead-simple.netlify.com/books/%E7%AE%97%E6%B3%95%E7%AB%9E%E8%B5%9B%E8%BF%9B%E9%98%B6%E6%8C%87%E5%8D%97/%E7%8E%AF%E5%BD%A2%E5%9D%87%E5%88%86%E7%BA%B8%E7%89%8C%E8%A7%A3%E6%9E%90.html"},"https://hugo-dead-simple.netlify.com/books/%E5%BE%AE%E7%A7%AF%E5%88%86/chapter2.html":{title:"å‡½æ•°çš„æé™",tags:[],content:`å¯¼å…¥ y=x2y=x^2y=x2åœ¨(1,1)å¤„çš„åˆ‡çº¿çš„æ–œç‡
k(x1)=x2âˆ’1xâˆ’1=(xâˆ’1)(x+1)xâˆ’1=x+1 k(x_1) = \\frac{x^2-1}{x-1} = \\frac{(x-1)(x+1)}{x-1} = x+1 k(x1â€‹)=xâˆ’1x2âˆ’1â€‹=xâˆ’1(xâˆ’1)(x+1)â€‹=x+1å®šä¹‰ å‡½æ•°æé™çš„å®šä¹‰ Îµâˆ’Î´\\varepsilon - \\deltaÎµâˆ’Î´ è¯­è¨€ âˆ€Îµ&gt;0\\forall \\varepsilon &gt;0âˆ€Îµ&gt;0,âˆƒÎ´&gt;0,xâˆˆ(aâˆ’Î´,a+Î´)â‡’âˆ£f(x)âˆ’bâˆ£&lt;Îµ\\exist \\delta &gt; 0,x \\in (a-\\delta,a+\\delta) \\Rightarrow \\left| f(x)-b \\right| &lt; \\varepsilon âˆƒÎ´&gt;0,xâˆˆ(aâˆ’Î´,a+Î´)â‡’âˆ£f(x)âˆ’bâˆ£&lt;Îµ
limâ¡xâ†’af(x)=b\\lim \\limits_{x \\to a} f(x) = bxâ†’alimâ€‹f(x)=b
hugo
`,url:"https://hugo-dead-simple.netlify.com/books/%E5%BE%AE%E7%A7%AF%E5%88%86/chapter2.html"},"https://hugo-dead-simple.netlify.com/blog/github%E6%97%A0%E6%B3%95%E6%8E%A8%E9%80%81.html":{title:"Githubæ— æ³•æ¨é€",tags:[],content:`2025-09-09,æˆ‘å‘ç°æˆ‘çš„ç”µè„‘ git æ— æ³•æ¨é€,
1ssh -vvv -T git@github.com å¡æ­»
ç¥å¥‡çš„æ˜¯,å¹¶ä¸æ˜¯å› ä¸ºhttpsæ— æ³•æ¨é€,è€Œæ˜¯sshæ— æ³•æ¨é€,è¿™æ˜¯æˆ‘ç¬¬ä¸€æ¬¡é‡åˆ°è¿™ç§æƒ…å†µ.
1â•­â”€rainboy@y9000x ~ 2â•°â”€$ nslookup github.com 119.119.119.119 3Server: 119.119.119.119 4Address: 119.119.119.119#53 5 6Non-authoritative answer: 7Name: github.com 8Address: 20.205.243.166 1ssh -T git@20.205.243.166 å¡æ­»
ä½¿ç”¨åœ¨çº¿ dns check : https://dnschecker.org/#A/github.com
å¾—åˆ°ip : 140.82.114.3
1ssh -T git@140.82.114.3 2 3 4The authenticity of host &#39;140.82.114.3 (140.82.114.3)&#39; can&#39;t be established. 5ED25519 key fingerprint is SHA256:+DiY3wvvV6TuJJhbpZisF/zLDA0zPMSvHdkr4UvCOqU. 6This host key is known by the following other names/addresses: 7 ~/.ssh/known_hosts:59: github.com 8 ~/.ssh/known_hosts:98: [ssh.github.com]:443 9 ~/.ssh/known_hosts:99: 140.82.114.4 10Are you sure you want to continue connecting (yes/no/[fingerprint])? yes 11Warning: Permanently added &#39;140.82.114.3&#39; (ED25519) to the list of known hosts. 12Hi Rainboylvx! You&#39;ve successfully authenticated, but GitHub does not provide shell access. æˆåŠŸäº† !?
1ssh -T -p 443 git@ssh.github.com ä¹Ÿèƒ½æˆåŠŸ! çœŸæ˜¯ç¥å¥‡
ä¸å¾—å·²,æˆ‘ä¿®æ”¹äº†~/.ssh/config æ–‡ä»¶
1Host github.com 2 Hostname ssh.github.com 3 Port 443 4 User git æš‚æ—¶å…ˆä½¿ç”¨443ç«¯å£æ¥è®¿é—® github
`,url:"https://hugo-dead-simple.netlify.com/blog/github%E6%97%A0%E6%B3%95%E6%8E%A8%E9%80%81.html"},"https://hugo-dead-simple.netlify.com/books/learn_you_haskell/chapter_1.html":{title:"chapter 1 Introduction",tags:[],content:`è¿™ç¯‡æ–‡ç« æ˜¯ã€ŠLearn You a Haskell for Great Good!ã€‹æ•™ç¨‹çš„å¼•è¨€ï¼Œä¸»è¦å†…å®¹å¯ä»¥æ€»ç»“ä¸ºä»¥ä¸‹å‡ ç‚¹ï¼š
æ•™ç¨‹ç›®æ ‡ï¼šæœ¬æ•™ç¨‹ä¸»è¦é¢å‘æœ‰å‘½ä»¤å¼ç¼–ç¨‹ï¼ˆå¦‚ C++, Java, Pythonï¼‰ç»éªŒï¼Œä½†åˆæ¬¡æ¥è§¦å‡½æ•°å¼ç¼–ç¨‹çš„å¼€å‘è€…ã€‚ä½œè€…å»ºè®®é€šè¿‡é˜…è¯»å¤šç§èµ„æ–™æ¥å­¦ä¹ Haskellï¼Œå› ä¸ºå®ƒèµ·åˆå¯èƒ½æ„Ÿè§‰å¾ˆå¥‡æ€ªï¼Œä½†ä¸€æ—¦â€œå¼€çªâ€å°±ä¼šå˜å¾—å®¹æ˜“ã€‚
Haskellçš„æ ¸å¿ƒç‰¹æ€§ï¼š
çº¯å‡½æ•°å¼ (Purely Functional)ï¼šä½ ä¸æ˜¯å‘Šè¯‰è®¡ç®—æœºâ€œå¦‚ä½•åšâ€ï¼Œè€Œæ˜¯å®šä¹‰â€œæ˜¯ä»€ä¹ˆâ€ã€‚å˜é‡ä¸€æ—¦èµ‹å€¼å°±ä¸å¯æ”¹å˜ï¼Œå‡½æ•°æ²¡æœ‰å‰¯ä½œç”¨ï¼Œè¿™ä¿è¯äº†åŒæ ·çš„è¾“å…¥æ€»èƒ½å¾—åˆ°åŒæ ·çš„è¾“å‡ºã€‚ æƒ°æ€§æ±‚å€¼ (Lazy)ï¼šä»£ç åªåœ¨çœŸæ­£éœ€è¦ç»“æœæ—¶æ‰è¢«æ‰§è¡Œï¼Œè¿™ä½¿å¾—ç¨‹åºæ›´é«˜æ•ˆï¼Œå¹¶èƒ½è½»æ¾å¤„ç†æ— é™å¤§çš„æ•°æ®ç»“æ„ã€‚ é™æ€ç±»å‹ (Statically Typed)ï¼šç¼–è¯‘å™¨åœ¨ç¼–è¯‘é˜¶æ®µå°±èƒ½æ•æ‰å¤§é‡ç±»å‹é”™è¯¯ã€‚åŒæ—¶ï¼Œå…¶å¼ºå¤§çš„ç±»å‹æ¨å¯¼ç³»ç»Ÿæ„å‘³ç€ä½ æ— éœ€ä¸ºæ¯ä¸ªå˜é‡éƒ½æ˜¾å¼å£°æ˜ç±»å‹ã€‚ ä¼˜é›…ç®€æ´ (Elegant and Concise)ï¼šä»£ç é€šå¸¸æ¯”ç­‰æ•ˆçš„å‘½ä»¤å¼ä»£ç æ›´çŸ­ï¼Œæ›´æ˜“äºç»´æŠ¤ã€‚ å¦‚ä½•å¼€å§‹å­¦ä¹ ï¼š
ä½ éœ€è¦ä¸€ä¸ªæ–‡æœ¬ç¼–è¾‘å™¨å’ŒHaskellç¼–è¯‘å™¨ï¼ˆGHCï¼‰ã€‚ æ¨èä½¿ç”¨ GHCup è¿™ä¸ªå·¥å…·æ¥å®‰è£…æ‰€éœ€ç¯å¢ƒã€‚ å­¦ä¹ æ—¶ï¼Œå¯ä»¥ä½¿ç”¨ ghci è¿™ä¸ªäº¤äº’å¼ç¯å¢ƒæ¥åŠ è½½ .hs æ–‡ä»¶å¹¶å®æ—¶æµ‹è¯•å‡½æ•°ï¼Œè¿™æ ·è¾¹å­¦è¾¹ç»ƒæ•ˆç‡æ›´é«˜ã€‚ `,url:"https://hugo-dead-simple.netlify.com/books/learn_you_haskell/chapter_1.html"},"https://hugo-dead-simple.netlify.com/books/learn_you_haskell/chapter_2.html":{title:"chapter 2 Starting Out",tags:[],content:`è¿™æ˜¯ä»€ä¹ˆé¡µé¢ï¼Ÿ è¿™æ˜¯Haskellç¼–ç¨‹æ•™ç¨‹çš„â€œStarting Outâ€ç« èŠ‚ï¼Œæ—¨åœ¨ä»‹ç»Haskellè¯­è¨€çš„åŸºç¡€çŸ¥è¯†ï¼ŒåŒ…æ‹¬äº¤äº’æ¨¡å¼ã€åŸºæœ¬æ“ä½œã€å‡½æ•°å®šä¹‰ã€åˆ—è¡¨å’Œå…ƒç»„ç­‰æ ¸å¿ƒæ¦‚å¿µã€‚é¡µé¢é€šè¿‡ç¤ºä¾‹ä»£ç å’Œè§£é‡Šå¸®åŠ©åˆå­¦è€…å¿«é€Ÿä¸Šæ‰‹ã€‚
ä¸»è¦å†…å®¹ GHCIäº¤äº’æ¨¡å¼ï¼šHaskellä½¿ç”¨GHCIï¼ˆGlasgow Haskell Compiler Interactiveï¼‰è¿›è¡Œäº¤äº’å¼ç¼–ç¨‹ï¼Œå…è®¸ç”¨æˆ·ç›´æ¥è¾“å…¥è¡¨è¾¾å¼å¹¶æŸ¥çœ‹ç»“æœï¼Œä¾‹å¦‚ç®—æœ¯è¿ç®—ï¼ˆå¦‚ 2 + 15ï¼‰å’Œå¸ƒå°”æ“ä½œï¼ˆå¦‚ True &amp;&amp; Falseï¼‰ã€‚
åŸºæœ¬æ“ä½œï¼šåŒ…æ‹¬ç®—æœ¯è¿ç®—ç¬¦ï¼ˆ+ã€-ã€*ã€/ï¼‰ã€å¸ƒå°”è¿ç®—ç¬¦ï¼ˆ&amp;&amp;ã€||ã€notï¼‰å’Œç›¸ç­‰æ¯”è¾ƒï¼ˆ==ã€/=ï¼‰ã€‚Haskellæ˜¯å¼ºç±»å‹è¯­è¨€ï¼Œæ“ä½œæ•°ç±»å‹å¿…é¡»åŒ¹é…ï¼Œå¦åˆ™ä¼šæŠ¥é”™ã€‚
å‡½æ•°å®šä¹‰ä¸è°ƒç”¨ï¼šå‡½æ•°é€šè¿‡ç©ºæ ¼åˆ†éš”å‚æ•°è°ƒç”¨ï¼ˆå¦‚ succ 8 è¿”å› 9ï¼‰ã€‚å‡½æ•°å¯ä»¥å®šä¹‰ä¸ºå‰ç¼€æˆ–ä¸­ç¼€å½¢å¼ï¼ˆä½¿ç”¨åå¼•å·ï¼Œå¦‚ 92 \`div\` 10ï¼‰ã€‚ç¤ºä¾‹åŒ…æ‹¬è‡ªå®šä¹‰å‡½æ•°å¦‚ doubleMe x = x + xã€‚
åˆ—è¡¨ï¼šåˆ—è¡¨æ˜¯åŒè´¨æ•°æ®ç»“æ„ï¼Œç”¨æ–¹æ‹¬å·è¡¨ç¤ºï¼ˆå¦‚ [1,2,3]ï¼‰ã€‚æ”¯æŒæ“ä½œå¦‚è¿æ¥ï¼ˆ++ï¼‰ã€consæ“ä½œç¬¦ï¼ˆ:ï¼‰ã€ç´¢å¼•ï¼ˆ!!ï¼‰ï¼Œä»¥åŠå¸¸ç”¨å‡½æ•°ï¼ˆheadã€tailã€lengthã€reverseç­‰ï¼‰ã€‚åˆ—è¡¨æ¨å¯¼å…è®¸è¿‡æ»¤å’Œè½¬æ¢å…ƒç´ ï¼ˆå¦‚ [x*2 | x &lt;- [1..10], x*2 &gt;= 12]ï¼‰ã€‚
èŒƒå›´å’Œæ— åˆ—è¡¨ï¼šä½¿ç”¨èŒƒå›´ï¼ˆå¦‚ [1..20]ï¼‰ç”Ÿæˆåºåˆ—ï¼Œæ”¯æŒæ­¥é•¿ï¼ˆå¦‚ [2,4..20]ï¼‰ã€‚æ— é™åˆ—è¡¨å¯é€šè¿‡å‡½æ•°å¦‚ cycle å’Œ repeat åˆ›å»ºï¼Œå¹¶ç»“åˆ take æˆªå–ã€‚
å…ƒç»„ï¼šå…ƒç»„å­˜å‚¨å›ºå®šæ•°é‡çš„å¼‚è´¨å…ƒç´ ï¼Œç”¨æ‹¬å·è¡¨ç¤ºï¼ˆå¦‚ (1,&quot;a&quot;)ï¼‰ã€‚ä¸åˆ—è¡¨ä¸åŒï¼Œå…ƒç»„å¤§å°å’Œç±»å‹å›ºå®šã€‚å¸¸ç”¨å‡½æ•°åŒ…æ‹¬ fst å’Œ snd ç”¨äº pairsï¼Œä»¥åŠ zip ç”¨äºåˆå¹¶åˆ—è¡¨æˆå…ƒç»„åˆ—è¡¨ã€‚
å®ç”¨ç¤ºä¾‹ï¼šé¡µé¢åŒ…å«å¤šä¸ªä»£ç ç¤ºä¾‹ï¼Œå¦‚è®¡ç®—ç›´è§’ä¸‰è§’å½¢å‘¨é•¿ï¼Œæ¼”ç¤ºå¦‚ä½•ç»“åˆåˆ—è¡¨æ¨å¯¼å’Œæ¡ä»¶è¿‡æ»¤è§£å†³é—®é¢˜ã€‚
ç›®çš„ è¯¥é¡µé¢ä¸ºHaskellåˆå­¦è€…æä¾›å®è·µåŸºç¡€ï¼Œé€šè¿‡äº¤äº’å¼ç¤ºä¾‹å’Œç®€å•å‡½æ•°å®šä¹‰ï¼ŒåŸ¹å…»å‡½æ•°å¼ç¼–ç¨‹æ€ç»´ã€‚é‡ç‚¹åœ¨äºç†è§£ç±»å‹ç³»ç»Ÿã€åˆ—è¡¨å¤„ç†å’Œå‡½æ•°ç»„åˆï¼Œä¸ºåç»­å­¦ä¹ é“ºå«ã€‚
`,url:"https://hugo-dead-simple.netlify.com/books/learn_you_haskell/chapter_2.html"},"https://hugo-dead-simple.netlify.com/books/learn_you_haskell/index.html":{title:"learn you haskell for great good",tags:[],content:`èµ„æº ä¸­æ–‡ç‰ˆ https://learnyouahaskell.mno2.org/zh-cn è‹±æ–‡ç‰ˆ https://learnyouahaskell.com/chapters archlinux å‚è€ƒ è¿™é‡Œ ä¸‹å®‰è£…ä¸ç¼–è¯‘
1sudo pacman -S ghc 2cat &gt; 1.hs &lt;&lt; EOF 3main = putStrLn &#34;Hello, world!&#34; 4EOF 5ghc -dynamic 1.hs 6./1 æœ€ç®€å•çš„æ–¹æ³•å¯ä»¥æ˜¯ç”¨ åœ¨çº¿haskell: https://play.haskell.org/
ç›®å½• Introduction Starting Out `,url:"https://hugo-dead-simple.netlify.com/books/learn_you_haskell/index.html"},"https://hugo-dead-simple.netlify.com/books/lua/quick_learn.html":{title:"Lua å¿«é€Ÿæ•™ç¨‹",tags:[],content:` Lua å¿«é€Ÿæ•™ç¨‹ å¥½çš„ï¼Œæ—¢ç„¶ä½ ç†Ÿæ‚‰ C/C++/Python/Node.jsï¼Œé‚£ Lua å¯¹ä½ æ¥è¯´ä¼šéå¸¸å®¹æ˜“ä¸Šæ‰‹ã€‚
æŠŠå®ƒæƒ³è±¡æˆï¼šä¸€ä¸ªè¯­æ³•æ›´ç®€æ´ã€æ ¸å¿ƒæ›´å°çš„ Pythonï¼Œå…¶ä¸­å”¯ä¸€çš„å¤æ‚æ•°æ®ç»“æ„æ˜¯ tableï¼ˆè¡¨ï¼‰ã€‚
æ ¸å¿ƒè¦ç‚¹ (ä¸ä½ ç†Ÿæ‚‰çš„è¯­è¨€å¯¹æ¯”):
åŠ¨æ€ç±»å‹: å’Œ Python/JS ä¸€æ ·ã€‚
nil: ç±»ä¼¼ Python çš„ None æˆ– JS çš„ null/undefinedã€‚åœ¨æ¡ä»¶åˆ¤æ–­ä¸­ï¼Œnil å’Œ false ä¸ºå‡ï¼Œå…¶ä»–éƒ½ä¸ºçœŸã€‚
table (è¡¨) æ˜¯ä¸‡èƒ½çš„ table1 lua 5.3 table doc:
å¯ä»¥å½“æ•°ç»„ï¼šarr = {10, 20, 30} (ç´¢å¼•ä» 1 å¼€å§‹ï¼) å¯ä»¥å½“å­—å…¸/å¯¹è±¡ï¼šobj = {name = &quot;Lua&quot;, version = 5.4} æˆ– obj.name = &quot;Lua&quot; æ²¡æœ‰å•ç‹¬çš„ç±»ï¼Œé¢å‘å¯¹è±¡é€šè¿‡ table + metatable (å…ƒè¡¨) å®ç°ã€‚ ç´¢å¼•ä» 1 å¼€å§‹: è¿™æ˜¯æœ€å¤§çš„â€œå‘â€ï¼arr[1] æ˜¯ç¬¬ä¸€ä¸ªå…ƒç´ ã€‚
å˜é‡ä½œç”¨åŸŸ: é»˜è®¤å…¨å±€ã€‚å¿…é¡»ç”¨ local å£°æ˜å±€éƒ¨å˜é‡ (éå¸¸é‡è¦ï¼)ã€‚
1x = 10 -- å…¨å±€ 2local y = 20 -- å±€éƒ¨ forå¾ªç¯
forå¾ªç¯åœ¨æŸäº›ç¨‹åº¦ä¸Šï¼Œå’Œwhileå¾ªç¯å¾ˆç›¸ä¼¼ï¼Œä½†æ˜¯forå¾ªç¯å¯ä»¥æ›´åŠ ç®€æ´åœ°è¡¨è¾¾ä¸­é—´ç´¯ç§¯çš„é‡
æˆ‘ä»¬é¦–å…ˆæ¥å­¦ä¹ forè¿™ä¸ªå¾ªç¯è¯­æ³•ï¼Œæ•´ä½“çš„æ ¼å¼å¦‚ä¸‹ï¼š
1for ä¸´æ—¶å˜é‡å=å¼€å§‹å€¼,ç»“æŸå€¼,æ­¥é•¿ do 2 å¾ªç¯çš„ä»£ç  3end å…¶ä¸­ï¼Œæ­¥é•¿å¯ä»¥çœç•¥ï¼Œé»˜è®¤ä¸º1
ä¸´æ—¶å˜é‡åå¯ä»¥ç›´æ¥åœ¨ä»£ç åŒºåŸŸä½¿ç”¨ï¼ˆä½†ä¸å¯æ›´æ”¹ï¼‰ï¼Œæ¯æ¬¡å¾ªç¯ä¼šè‡ªåŠ¨åŠ æ­¥é•¿å€¼ï¼Œå¹¶ä¸”åœ¨åˆ°è¾¾ç»“æŸå€¼ååœæ­¢å¾ªç¯
ä¸‹é¢ä¸¾ä¸€ä¸ªä¾‹å­ï¼Œæˆ‘ä»¬è®¡ç®—ä»1åŠ åˆ°100çš„ç»“æœï¼š
1 2local result = 0 3 4for i=1,100 do 5 result = result + i 6end 7 8print(result) å‡½æ•°æ˜¯ä¸€ç­‰å…¬æ°‘: å’Œ Python/JS ä¸€æ ·ï¼Œå¯ä»¥èµ‹å€¼ç»™å˜é‡ï¼Œä½œä¸ºå‚æ•°ä¼ é€’ï¼Œä½œä¸ºè¿”å›å€¼ã€‚
1local function greet(name) 2 print(&#34;Hello, &#34; .. name) -- \`..\` æ˜¯å­—ç¬¦ä¸²è¿æ¥ç¬¦ 3end 4local say_hi = greet 5say_hi(&#34;World&#34;) æ²¡æœ‰ ++, --, +=, -=: éœ€è¦å†™ i = i + 1ã€‚
ä»£ç å—ç”± end ç»“æŸ: if ... then ... elseif ... then ... else ... end, for ... do ... end, while ... do ... end, function ... endã€‚
æ³¨é‡Š: å•è¡Œ --, å¤šè¡Œ --[[ ... --]]ã€‚
é¢å‘å¯¹è±¡ (Metatables): è¿™æ˜¯ Lua ç‹¬ç‰¹ä¹‹å¤„ã€‚metatable å…è®¸ä½ æ”¹å˜ table çš„è¡Œä¸ºï¼Œæ¯”å¦‚é‡è½½æ“ä½œç¬¦ã€å®ç°ç»§æ‰¿ã€‚
1local my_table = {} 2local my_metatable = { 3 __index = function(table_itself, key) 4 return &#34;Key &#39;&#34; .. key .. &#34;&#39; not found&#34; 5 end 6} 7setmetatable(my_table, my_metatable) 8print(my_table.non_existent_key) -- è¾“å‡º: Key &#39;non_existent_key&#39; not found åç¨‹ (Coroutines): å†…å»ºçš„è½»é‡çº§çº¿ç¨‹ï¼Œç”¨äºåä½œå¼å¤šä»»åŠ¡ï¼Œç±»ä¼¼ Python çš„ generator æˆ– JS çš„ async/await çš„ä¸€ç§åº•å±‚å®ç°ã€‚
ä¸€åˆ†é’Ÿä»£ç ç¤ºä¾‹æ„Ÿå—:
1-- å˜é‡å’Œæ‰“å° 2local name = &#34;Lua User&#34; 3local age = 30 4print(&#34;Hello, &#34; .. name .. &#34;! You are &#34; .. age .. &#34; years old.&#34;) -- \`..\` å­—ç¬¦ä¸²è¿æ¥ 5 6-- è¡¨ (æ•°ç»„é£æ ¼ï¼Œç´¢å¼•ä»1å¼€å§‹!) 7local fruits = {&#34;apple&#34;, &#34;banana&#34;, &#34;orange&#34;} 8print(fruits[1]) -- è¾“å‡º: apple 9 10-- è¡¨ (å­—å…¸/å¯¹è±¡é£æ ¼) 11local person = {name = &#34;Alice&#34;, age = 25} 12print(person.name) -- è¾“å‡º: Alice 13print(person[&#34;age&#34;]) -- è¾“å‡º: 25 14 15-- æ¡ä»¶è¯­å¥ 16if age &gt; 18 then 17 print(&#34;Adult&#34;) 18else 19 print(&#34;Minor&#34;) 20end 21 22-- å¾ªç¯ 23for i = 1, 3 do -- ä» 1 åˆ° 3 (åŒ…å«3) 24 print(&#34;Fruit &#34; .. i .. &#34;: &#34; .. fruits[i]) 25end 26 27for key, value in pairs(person) do 28 print(key .. &#34;: &#34; .. value) 29end 30 31-- å‡½æ•° 32local function add(a, b) 33 return a + b 34end 35local sum_result = add(5, 3) 36print(&#34;Sum: &#34; .. sum_result) -- è¾“å‡º: Sum: 8 37 38-- è®°ä½ï¼šé»˜è®¤å…¨å±€å˜é‡ï¼Œä¸€å®šè¦ç”¨ localï¼ å…³é”®åŒºåˆ«æ€»ç»“ï¼š
table æ˜¯å”¯ä¸€æ•°æ®ç»“æ„ã€‚ ç´¢å¼•ä» 1 å¼€å§‹ã€‚ local å£°æ˜å±€éƒ¨å˜é‡ã€‚ ç”¨ metatable å®ç°é«˜çº§ç‰¹æ€§ (å¦‚ OOP)ã€‚ ä½ å·²ç»æŒæ¡äº†æ›´å¤æ‚çš„è¯­è¨€ï¼ŒLua å¯¹ä½ æ¥è¯´å°±æ˜¯å°èœä¸€ç¢Ÿã€‚ç›´æ¥ä¸Šæ‰‹å†™ä»£ç ï¼Œé‡åˆ°é—®é¢˜æŸ¥é˜…ã€ŠProgramming in Luaã€‹(PIL) å®˜æ–¹æ–‡æ¡£å³å¯ã€‚
`,url:"https://hugo-dead-simple.netlify.com/books/lua/quick_learn.html"},"https://hugo-dead-simple.netlify.com/books/%E7%BA%BF%E6%80%A7%E4%BB%A3%E6%95%B0%E5%8F%8A%E5%85%B6%E5%BA%94%E7%94%A8/chapter_1.html":{title:"ç¬¬ä¸€ç« ",tags:[],content:`1 çº¿æ€§æ–¹ç¨‹ç»„ 1.1 ç›¸å…³å®šä¹‰ çº¿æ€§æ–¹ç¨‹ çº¿æ€§æ–¹ç¨‹ç»„ è§£é›† çº¿æ€§æ–¹ç¨‹ç»„ç­‰ä»·çš„å®šä¹‰: è§£çš„é›†åˆ (è§£é›†) ç›¸ç­‰ ç›¸å®¹ - æœ‰è§£,ä¸ç›¸å®¹ ç³»æ•°çŸ©é˜µ: æ–¹ç¨‹ç»„ä¸­æ‰€æœ‰ç³»æ•°ç»„æˆçš„çŸ©é˜µ å¢å¹¿çŸ©é˜µ: ç³»æ•°çŸ©é˜µ + å¸¸æ•°é¡¹ç»„æˆçš„çŸ©é˜µ è§£æ–¹ç¨‹ç»„çš„ä¸€èˆ¬æ–¹æ³•: åŸºæœ¬æ€è·¯: æŠŠæ–¹ç¨‹ç»„ç”¨ä¸€ä¸ªæ›´å®¹æ˜“è§£çš„ç­‰ä»·æ–¹ç¨‹ç»„ä»£æ›¿ æ¶ˆå»æœªçŸ¥æ•° (æ¶ˆå…ƒæ³•) ä¸‰ç§åŸºæœ¬å˜æ¢ äº¤æ¢ä¸¤ä¸ªæ–¹ç¨‹çš„ä½ç½® ç”¨ä¸€ä¸ªæ–¹ç¨‹å‡å»å¦ä¸€ä¸ªæ–¹ç¨‹çš„å€æ•° ç”¨ä¸€ä¸ªéé›¶å¸¸æ•°ä¹˜ä»¥ä¸€ä¸ªæ–¹ç¨‹ æ˜¾ç„¶ï¼Œè¿™ä¸‰ç§å˜æ¢ï¼Œæ¯ä¸€æ¬¡å˜æ¢å®ƒçš„éƒ½ä¼šå¾—åˆ°ä¸€ä¸ªç­‰ä»·æ–¹ç¨‹ç»„(è¿™é‡Œå°±ä¸è¯æ˜äº†) åˆç­‰è¡Œå˜æ¢ çº¿æ€§æ–¹ç¨‹ç»„çš„ä¸¤ä¸ªåŸºæœ¬é—®é¢˜ æ–¹ç¨‹ç»„æ˜¯å¦ç›¸å®¹ï¼Œå³å®ƒæ˜¯å¦è‡³å°‘æœ‰ä¸€ä¸ªè§£ (æœ‰è§£)ï¼Ÿ è‹¥å®ƒæœ‰è§£ï¼Œå®ƒæ˜¯å¦åªæœ‰ä¸€ä¸ªè§£ï¼Œå³è§£æ˜¯å¦å”¯ä¸€ï¼Ÿ 2 è¡ŒåŒ–ç®€ä¸é˜¶æ¢¯å‹çŸ©é˜µ éé›¶è¡Œ éé›¶è¡Œçš„å…ˆå¯¼å…ƒç´  è¡Œé˜¶æ¢¯å½¢çŸ©é˜µå®šä¹‰ å®šä¹‰ä¸€ä¸ªçŸ©é˜µç§°ä¸ºé˜¶æ¢¯å½¢ï¼ˆæˆ–è¡Œé˜¶æ¢¯å½¢ï¼‰ï¼Œè‹¥å®ƒæœ‰ä»¥ä¸‹ä¸‰ä¸ªæ€§è´¨ï¼š
æ¯ä¸€éé›¶è¡Œéƒ½åœ¨æ¯ä¸€é›¶è¡Œä¹‹ä¸Š æŸä¸€è¡Œçš„å…ˆå¯¼å…ƒç´ æ‰€åœ¨çš„åˆ—ä½äºå‰ä¸€è¡Œå…ˆå¯¼å…ƒç´ çš„å³è¾¹ æŸä¸€å…ˆå¯¼å…ƒç´ æ‰€åœ¨åˆ—ä¸‹æ–¹å…ƒç´ éƒ½æ˜¯é›¶ï¼Œ è‹¥ä¸€ä¸ªé˜¶æ¢¯å½¢çŸ©é˜µè¿˜æ»¡è¶³ä»¥ä¸‹æ€§è´¨ï¼Œåˆ™ç§°å®ƒä¸ºç®€åŒ–é˜¶æ¢¯å½¢ï¼ˆæˆ–ç®€åŒ–è¡Œé˜¶æ¢¯å½¢ï¼‰ 4. æ¯ä¸€éé›¶è¡Œçš„å…ˆå¯¼å…ƒç´ æ˜¯ 111 5. æ¯ä¸€å…ˆå¯¼å…ƒç´  111 æ˜¯è¯¥å…ƒç´ æ‰€åœ¨åˆ—çš„å”¯ä¸€éé›¶å…ƒç´ 
1 21. ä»»ä½•éé›¶çŸ©é˜µéƒ½å¯ä»¥è¡ŒåŒ–ç®€(å³ä½¿ç”¨åˆç­‰è¡Œå˜åŒ–)å˜ä¸ºé˜¶æ¢¯å½¢çŸ©é˜µ 32. ä¸€ä¸ªçŸ©é˜µåªèƒ½åŒ–ä¸ºå”¯ä¸€çš„ç®€åŒ–é˜¶æ¢¯å‹çŸ©é˜µ 2.1 å®šç† 1: ç®€åŒ–é˜¶æ¢¯å½¢çŸ©é˜µçš„å”¯ä¸€æ€§ åŸºæœ¬å˜é‡ (å…ˆå¯¼å˜é‡) è‡ªç”±å˜é‡ 2.2 å®šç† 2: è§£çš„å­˜åœ¨äºç»´ä¸€æ€§å®šç† `,url:"https://hugo-dead-simple.netlify.com/books/%E7%BA%BF%E6%80%A7%E4%BB%A3%E6%95%B0%E5%8F%8A%E5%85%B6%E5%BA%94%E7%94%A8/chapter_1.html"},"https://hugo-dead-simple.netlify.com/books/%E7%BA%BF%E6%80%A7%E4%BB%A3%E6%95%B0%E5%8F%8A%E5%85%B6%E5%BA%94%E7%94%A8/index.html":{title:"çº¿æ€§ä»£æ•°åŠå…¶åº”ç”¨",tags:[],content:" ç¬¬ä¸€ç«  ",url:"https://hugo-dead-simple.netlify.com/books/%E7%BA%BF%E6%80%A7%E4%BB%A3%E6%95%B0%E5%8F%8A%E5%85%B6%E5%BA%94%E7%94%A8/index.html"},"https://hugo-dead-simple.netlify.com/books/group_theory/index.html":{title:"è¿‘ä¸–ä»£æ•°",tags:[],content:"ä¹¦ ç¬¬ä¸€ç«  1.1 ç­‰ä»·å…³ç³»ä¸é›†åˆçš„åˆ†ç±» 1.2-ç¾¤çš„æ¦‚å¿µ ",url:"https://hugo-dead-simple.netlify.com/books/group_theory/index.html"},"https://hugo-dead-simple.netlify.com/blog/latex%E6%95%B0%E5%AD%A6%E5%85%AC%E5%BC%8F%E6%89%8B%E5%86%8C.html":{title:"Latexæ•°å­¦å…¬å¼æ‰‹å†Œ",tags:[],content:`å‰è¨€ å‡†å¤‡æ•´ç†ä¸€ä¸‹æˆ‘æ‰€ä½¿ç”¨çš„Latexæ•°å­¦å…¬å¼(å…¶å®æˆ‘å¤§éƒ¨åˆ†æ—¶é—´éƒ½åœ¨ä½¿ç”¨katex )
ä¸‹é¢åˆ—ä¸¾ä¸€äº›æœ‰ç”¨çš„èµ„æº
katex document https://katex.org/docs/api LaTeXå…¬å¼æ‰‹å†Œ(å…¨ç½‘æœ€å…¨) - æ¨±èŠ±èµ - åšå®¢å›­ è¿™ä¸ªæ˜¾ç¤ºæœ‰é—®é¢˜ï¼Œæœ‰æ—¶é—´çš„è¯ï¼Œæˆ‘ä¼š fork ä¸€ä¸‹ä¿®æ”¹ https://1024th.github.io/MathJax_Tutorial_CN/#/quickstart åœ¨çº¿latexå…¬å¼ç¼–è¾‘å™¨ https://www.latexlive.com/ Latex å…¬å¼æ‰‹å†Œ è½¬è½½è‡ª: https://blog.csdn.net/Yushan_Ji/article/details/134322574
åŸºæœ¬ç¬¦å· å°å†™å¸Œè…Šå­—æ¯ æ³¨ï¼šéƒ¨åˆ†å¸Œè…Šå­—æ¯åœ¨æ•°å­¦å…¬å¼ä¸­å¸¸ä»¥å˜é‡å½¢å¼å‡ºç°ï¼Œä¾‹å¦‚ Ïµ\\epsilonÏµ åœ¨æ•°å­¦ä¸­ä¸€èˆ¬å†™æ³•ä¸º Îµ\\varepsilonÎµï¼ŒÏ•\\phiÏ• åœ¨æ•°å­¦ä¸­é€šå¸¸å†™ä½œ Ï†\\varphiÏ†
ç¬¦å· è¯­æ³• ç¬¦å· è¯­æ³• ç¬¦å· è¯­æ³• Î±\\alphaÎ± \\alpha Î²\\betaÎ² \\beta Î³\\gammaÎ³ \\gamma Î¸\\thetaÎ¸ \\theta Îµ\\varepsilonÎµ \\varepsilon Î´\\deltaÎ´ \\delta Î¼\\muÎ¼ \\mu Î½\\nuÎ½ \\nu Î·\\etaÎ· \\eta Î¶\\zetaÎ¶ \\zeta Î»\\lambdaÎ» \\lambda Ïˆ\\psiÏˆ \\psi Ïƒ\\sigmaÏƒ \\sigma Î¾\\xiÎ¾ \\xi Ï„\\tauÏ„ \\tau Ï•\\phiÏ• \\phi Ï†\\varphiÏ† \\varphi Ï\\rhoÏ \\rho Ï‡\\chiÏ‡ \\chi Ï‰\\omegaÏ‰ \\omega Ï€\\piÏ€ \\pi å¤§å†™å¸Œè…Šå­—æ¯ å¤§å†™å¸Œè…Šå­—æ¯é€šå¸¸æ˜¯å°å†™å¸Œè…Šå­—æ¯çš„ LATEX è¯­æ³•ç¬¬ä¸€ä¸ªå­—æ¯æ”¹ä¸ºå¤§å†™ï¼Œè§ä¸‹è¡¨
ç¬¦å· è¯­æ³• ç¬¦å· è¯­æ³• ç¬¦å· è¯­æ³• Î£\\SigmaÎ£ \\Sigma Î \\PiÎ  \\Pi Î”\\DeltaÎ” \\Delta Î“\\GammaÎ“ \\Gamma Î¨\\PsiÎ¨ \\Psi Î˜\\ThetaÎ˜ \\Theta Î›\\LambdaÎ› \\Lambda Î©\\OmegaÎ© \\Omega Î¦\\PhiÎ¦ \\Phi Î\\XiÎ \\Xi å¸¸ç”¨å­—ä½“ é»˜è®¤çš„å­—ä½“ä¸º ABCdefABCdefABCdefï¼Œä¹Ÿå°±æ˜¯ \\mathnormal{ABCdef}ï¼ˆå½“ç„¶ï¼Œæ‰“å…¬å¼çš„æ—¶å€™ä¸éœ€è¦åŠ ä¸Šè¿™ä¸ª \\mathnormalï¼Œç›´æ¥æ‰“å­—æ¯å°±æ˜¯è¿™ä¸ªæ•ˆæœï¼‰
å­—ä½“ è¯­æ³• å­—ä½“ è¯­æ³• ABCdef\\mathrm{ABCdef}ABCdef \\mathrm{ABCdef} ABCdef\\mathbf{ABCdef}ABCdef \\mathbf{ABCdef} ABCdef\\mathit{ABCdef}ABCdef \\mathit{ABCdef} ABCdef\\pmb{ABCdef}ABCdef \\pmb{ABCdef} ABCdef\\mathscr{ABCdef}ABCdef \\mathscr{ABCdef} ABCdef\\mathcal{ABCdef}ABCdef \\mathcal{ABCdef} ABCdef\\mathfrak{ABCdef}ABCdef \\mathfrak{ABCdef} ABCdef\\mathbb{ABCdef}ABCdef \\mathbb{ABCdef} å¸¸è§è¿ç®—ç¬¦ è¿ç®—ç¬¦ è¯­æ³• è¿ç®—ç¬¦ è¯­æ³• è¿ç®—ç¬¦ è¯­æ³• +++ + âˆ’-âˆ’ - Ã—\\timesÃ— \\times Â±\\pmÂ± \\pm â‹…\\cdotâ‹… \\cdot âˆ—\\astâˆ— \\ast âˆª\\cupâˆª \\cup âˆ©\\capâˆ© \\cap âˆ˜\\circâˆ˜ \\circ âˆ¨\\lorâˆ¨ \\lor æˆ– \\vee âˆ§\\landâˆ§ \\land æˆ– \\wedge Â¬\\lnotÂ¬ \\lnot âŠ•\\oplusâŠ• \\oplus âŠ–\\ominusâŠ– \\ominus âŠ—\\otimesâŠ— \\otimes âŠ™\\odotâŠ™ \\odot âŠ˜\\oslashâŠ˜ \\oslash âˆ™\\bulletâˆ™ \\bullet x\\sqrt{x}xâ€‹ \\sqrt{x} xn\\sqrt[n]{x}nxâ€‹ \\sqrt[n]{x} å¤§å°ºå¯¸è¿ç®—ç¬¦ è¿ç®—ç¬¦ è¯­æ³• è¿ç®—ç¬¦ è¯­æ³• è¿ç®—ç¬¦ è¯­æ³• âˆ‘\\sumâˆ‘ \\sum âˆ\\prodâˆ \\prod âˆ«\\intâˆ« \\int â‹ƒ\\bigcupâ‹ƒ \\bigcup â‹‚\\bigcapâ‹‚ \\bigcap âˆ®\\ointâˆ® \\oint â‹\\bigveeâ‹ \\bigvee â‹€\\bigwedgeâ‹€ \\bigwedge âˆ¬\\iintâˆ¬ \\iint âˆ\\coprodâˆ \\coprod â¨†\\bigsqcupâ¨† \\bigsqcup âˆ¯\\oiintâˆ¬â€‹ \\oiint å¸¸è§å…³ç³»ç¬¦å· ç¬¦å· è¯­æ³• ç¬¦å· è¯­æ³• ç¬¦å· è¯­æ³• &lt;&lt;&lt; &lt; \\&gt; &gt; === = â‰¤\\leqâ‰¤ \\leq â‰¥\\geqâ‰¥ \\geq â‰ \\neqî€ = \\neq â‰ª\\llâ‰ª \\ll â‰«\\ggâ‰« \\gg â‰¡\\equivâ‰¡ \\equiv âŠ‚\\subsetâŠ‚ \\subset âŠƒ\\supsetâŠƒ \\supset â‰ˆ\\approxâ‰ˆ \\approx âŠ†\\subseteqâŠ† \\subseteq âŠ‡\\supseteqâŠ‡ \\supseteq âˆ¼\\simâˆ¼ \\sim âˆˆ\\inâˆˆ \\in âˆ‹\\niâˆ‹ \\ni âˆ\\proptoâˆ \\propto âŠ¢\\vdashâŠ¢ \\vdash âŠ£\\dashvâŠ£ \\dashv âŠ¨\\modelsâŠ¨ \\models âˆ£\\midâˆ£ \\mid âˆ¥\\parallelâˆ¥ \\parallel âŠ¥\\perpâŠ¥ \\perp âˆ‰\\notinâˆˆ/ \\notin â‹ˆ\\Joinâ‹ˆ \\Join â‰\\nsimâ‰ \\nsim âŠŠ\\subsetneqâŠŠ \\subsetneq âŠ‹\\supsetneqâŠ‹ \\supsetneq æ•°å­¦æ¨¡å¼é‡éŸ³ç¬¦ ç¬¦å· è¯­æ³• ç¬¦å· è¯­æ³• ç¬¦å· è¯­æ³• a^\\hat{a}a^ \\hat{a} aË‰\\bar{a}aË‰ \\bar{a} a~\\tilde{a}a~ \\tilde{a} aâƒ—\\vec{a}a \\vec{a} aË™\\dot{a}aË™ \\dot{a} aÂ¨\\ddot{a}aÂ¨ \\ddot{a} abc^\\widehat{abc}abc \\widehat{abc} abc~\\widetilde{abc}abc \\widetilde{abc} abcâ€¾\\overline{abc}abc \\overline{abc} ç®­å¤´ å¦‚æœéœ€è¦é•¿ç®­å¤´ï¼Œåªéœ€è¦åœ¨è¯­æ³•å‰é¢åŠ ä¸Š \\longï¼Œä¾‹å¦‚ \\longleftarrow å³ä¸º âŸµ\\longleftarrowâŸµï¼Œå¦‚æœåŠ ä¸Š \\Long åˆ™å˜ä¸ºåŒçº¿é•¿ç®­å¤´ï¼Œä¾‹å¦‚ \\Longleftarrow å³ä¸º âŸ¸\\LongleftarrowâŸ¸
ç¬¦å· è¯­æ³• ç¬¦å· è¯­æ³• ç¬¦å· è¯­æ³• â†\\leftarrowâ† \\leftarrow â†’\\rightarrowâ†’ \\rightarrow â†”\\leftrightarrowâ†” \\leftrightarrow â‡\\Leftarrowâ‡ \\Leftarrow â‡’\\Rightarrowâ‡’ \\Rightarrow â‡”\\Leftrightarrowâ‡” \\Leftrightarrow â†‘\\uparrowâ†‘ \\uparrow â†“\\downarrowâ†“ \\downarrow â†•\\updownarrowâ†• \\updownarrow â‡‘\\Uparrowâ‡‘ \\Uparrow â‡“\\Downarrowâ‡“ \\Downarrow â‡•\\Updownarrowâ‡• \\Updownarrow â†¼\\leftharpoonupâ†¼ \\leftharpoonup â†½\\leftharpoondownâ†½ \\leftharpoondown â‡€\\rightharpoonupâ‡€ \\rightharpoonup â‡\\rightharpoondownâ‡ \\rightharpoondown â‡Œ\\rightleftharpoonsâ‡Œ \\rightleftharpoons â‡‹\\leftrightharpoonsâ‡‹ \\leftrightharpoons âŸºâ€…\\iffâŸº \\iff â†¦\\mapstoâ†¦ \\mapsto æ‹¬å· æ‹¬å· è¯­æ³• æ‹¬å· è¯­æ³• æ‹¬å· è¯­æ³• ()()() () [][][] [] {} \\{\\} âŒŠâŒ‹\\lfloor\\rfloorâŒŠâŒ‹ \\lfloor\\rfloor âŒˆâŒ‰\\lceil\\rceilâŒˆâŒ‰ \\lceil\\rceil âŸ¨âŸ©\\langle\\rangleâŸ¨âŸ© \\langle\\rangle å¤§å°ºå¯¸æ‹¬å· æ‹¬å· è¯­æ³• æ‹¬å· è¯­æ³• ()\\left(\\right)() \\left(\\right) []\\left[ \\right][] \\left[\\right] x1x2â€¦xnân\\overbrace{x_1 x_2 \\ldots x_n}^{n}x1â€‹x2â€‹â€¦xnâ€‹â€‹nâ€‹ \\overbrace{x_1 x_2 \\ldots x_n}^{n} x1x2â€¦xnâŸn\\underbrace{x_1 x_2 \\ldots x_n}_{n}nx1â€‹x2â€‹â€¦xnâ€‹â€‹â€‹ \\underbrace{x_1 x_2 \\ldots x_n}_{n} æ³¨ï¼šå¤§å°ºå¯¸çš„ () å’Œ [] æ˜¯å¯ä»¥æ ¹æ®å…¬å¼çš„é«˜åº¦è‡ªåŠ¨è°ƒèŠ‚çš„ï¼Œä¾‹å¦‚
1\\arg\\min_{\\theta} 2\\left[ 3 -\\sum_{i=1}^{n} 4 \\left[ 5 \\mathbf{y}^{(i)}\\ln(h_{\\theta}(\\mathbf{x}^{(i)})) + 6 (1-\\mathbf{y}^{(i)})\\ln(1-h_{\\theta}(\\mathbf{x}^{(i)})) 7 \\right] 8\\right] argâ¡minâ¡Î¸[âˆ’âˆ‘i=1n[y(i)lnâ¡(hÎ¸(x(i)))+(1âˆ’y(i))lnâ¡(1âˆ’hÎ¸(x(i)))]] \\arg\\min_{\\theta} \\left[ -\\sum_{i=1}^{n} \\left[ \\mathbf{y}^{(i)}\\ln(h_{\\theta}(\\mathbf{x}^{(i)})) + (1-\\mathbf{y}^{(i)})\\ln(1-h_{\\theta}(\\mathbf{x}^{(i)})) \\right] \\right] argÎ¸minâ€‹[âˆ’i=1âˆ‘nâ€‹[y(i)ln(hÎ¸â€‹(x(i)))+(1âˆ’y(i))ln(1âˆ’hÎ¸â€‹(x(i)))]]å¯ä»¥çœ‹å‡ºï¼Œæ‹¬å·é«˜åº¦å¯ä»¥æ¡†ä½æ•´ä¸ªå…¬å¼ã€‚å› æ­¤åœ¨è¿™ç§å¤§å‹çš„å…¬å¼ä¸­ï¼Œä½¿ç”¨å¤§å°ºå¯¸æ‹¬å·è§†è§‰æ•ˆæœæ›´ç¾è§‚ã€‚
å…¶ä»–å¸¸è§ç¬¦å· ç¬¦å· è¯­æ³• ç¬¦å· è¯­æ³• ç¬¦å· è¯­æ³• forall\\\\forallforall \\forall exists\\\\existsexists \\exist angle\\\\angleangle \\angle emptyset\\\\emptysetemptyset \\emptyset partial\\\\partialpartial \\partial infty\\\\inftyinfty \\infty ldots\\\\ldotsldots \\ldots cdots\\\\cdotscdots \\cdots dots\\\\dotsdots \\dots vdots\\\\vdotsvdots \\vdots ddots\\\\ddotsddots \\ddots prime\\\\primeprime \\prime because\\\\becausebecause \\because therefore\\\\thereforetherefore \\therefore Box\\\\BoxBox \\Box triangle\\\\triangletriangle \\triangle S\\\\SS \\S æ•°å­¦å…¬å¼å†™æ³• ä¸Šä¸‹æ ‡ ^ï¼šä¸Šæ ‡ _ï¼šä¸‹æ ‡ ä¾‹å¦‚:
\\sum_{i=1}^{n}X_n è¡¨ç¤º sum_i=1nX_n\\\\sum\\_{i=1}^{n}X\\_nsum_i=1nX_n \\int_{0}^{\\infty}x^2dx è¡¨ç¤º int_0inftyx2dx\\\\int\\_{0}^{\\\\infty}x^2dxint_0inftyx2dx \\prod_{i=1}^{n}X_n è¡¨ç¤º prod_i=1nX_n\\\\prod\\_{i=1}^{n}X\\_nprod_i=1nX_n åˆ†æ•° ä½¿ç”¨ \\frac{}{} å³å¯ï¼Œä¾‹å¦‚ \\frac{a}{b} è¡¨ç¤º fracab\\\\frac{a}{b}fracab
æ’å…¥æ–‡å­— ä½¿ç”¨ \\textï¼Œä¾‹å¦‚ \\text{hello,world!} è¡¨ç¤º texthello,worldâ€‰â£\\\\text{hello,world\\!}texthello,world
å¸¸è§å‡½æ•° å‡½æ•° è¯­æ³• å‡½æ•° è¯­æ³• å‡½æ•° è¯­æ³• log()\\\\log()log() \\log() ln()\\\\ln()ln() \\ln() lg()\\\\lg()lg() \\lg() max\\\\maxmax \\max min\\\\minmin \\min lim_xtoinfty\\\\lim\\_{x \\\\to \\\\infty}lim_xtoinfty \\lim_{x \\to \\infty} argmax_cinC\\\\arg\\\\max\\_{c \\\\in C}argmax_cinC \\arg\\max_{c \\in C} argmin_cinC\\\\arg\\\\min\\_{c \\\\in C}argmin_cinC \\arg\\min_{c \\in C} exp\\\\expexp \\exp çŸ©é˜µã€è¡Œåˆ—å¼ &amp; è¡¨ç¤ºåˆ†éš”å…ƒç´ ï¼Œ\\\\ è¡¨ç¤ºæ¢è¡Œ
1A= 2\\begin{pmatrix} 3a_{11} &amp; a_{12} \\\\ 4a_{21} &amp; a_{22} 5\\end{pmatrix} A=(a_11a_12a_21a_22)A= \\begin{pmatrix} a\\_{11} &amp; a\\_{12} \\\\ a\\_{21} &amp; a\\_{22} \\end{pmatrix} A=(a_11a_21â€‹a_12a_22â€‹)1A= 2\\begin{bmatrix} 3a_{11} &amp; a_{12} \\\\ 4a_{21} &amp; a_{22} 5\\end{bmatrix} A=[a_11a_12a_21a_22]A= \\begin{bmatrix} a\\_{11} &amp; a\\_{12} \\\\ a\\_{21} &amp; a\\_{22} \\end{bmatrix} A=[a_11a_21â€‹a_12a_22â€‹]1A= 2\\begin{Bmatrix} 3a_{11} &amp; a_{12} \\\\ 4a_{21} &amp; a_{22} 5\\end{Bmatrix} A={a_11a_12a_21a_22}A= \\begin{Bmatrix} a\\_{11} &amp; a\\_{12} \\\\ a\\_{21} &amp; a\\_{22} \\end{Bmatrix} A={a_11a_21â€‹a_12a_22â€‹}1A= 2\\begin{vmatrix} 3a_{11} &amp; a_{12} \\\\ 4a_{21} &amp; a_{22} 5\\end{vmatrix} A=âˆ£a_11a_12a_21a_22âˆ£A= \\begin{vmatrix} a\\_{11} &amp; a\\_{12} \\\\ a\\_{21} &amp; a\\_{22} \\end{vmatrix} A=â€‹a_11a_21â€‹a_12a_22â€‹â€‹1A= 2\\begin{Vmatrix} 3a_{11} &amp; a_{12} \\\\ 4a_{21} &amp; a_{22} 5\\end{Vmatrix} A=âˆ¥a_11a_12a_21a_22âˆ¥A= \\begin{Vmatrix} a\\_{11} &amp; a\\_{12} \\\\ a\\_{21} &amp; a\\_{22} \\end{Vmatrix} A=â€‹a_11a_21â€‹a_12a_22â€‹â€‹1A= 2\\begin{matrix} 3a_{11} &amp; a_{12} \\\\ 4a_{21} &amp; a_{22} 5\\end{matrix} A=a_11a_12a_21a_22A= \\begin{matrix} a\\_{11} &amp; a\\_{12} \\\\ a\\_{21} &amp; a\\_{22} \\end{matrix} A=a_11a_21â€‹a_12a_22â€‹å¤šè¡Œå…¬å¼å¯¹é½ ä½¿ç”¨ \\begin{split} \\end{split}ï¼Œåœ¨éœ€è¦å¯¹é½çš„åœ°æ–¹æ·»åŠ  &amp; ç¬¦å·ï¼Œæ³¨æ„éœ€è¦ç”¨ \\\\ æ¥æ¢è¡Œã€‚
ä¾‹å¦‚ï¼š
1\\begin{split} 2L(\\theta) 3&amp;=	\\arg\\max_{\\theta}\\ln(P_{All})\\\\ 4&amp;=	\\arg\\max_{\\theta}\\ln\\prod_{i=1}^{n} 5 \\left[ 6 (h_{\\theta}(\\mathbf{x}^{(i)}))^{\\mathbf{y}^{(i)}}\\cdot 7 (1-h_{\\theta}(\\mathbf{x}^{(i)}))^{1-\\mathbf{y}^{(i)}} 8 \\right]\\\\ 9&amp;=	\\arg\\max_{\\theta}\\sum_{i=1}^{n} 10	\\left[ 11	\\mathbf{y}^{(i)}\\ln(h_{\\theta}(\\mathbf{x}^{(i)})) + 12	(1-\\mathbf{y}^{(i)})\\ln(1-h_{\\theta}(\\mathbf{x}^{(i)})) 13	\\right]\\\\ 14&amp;=	\\arg\\min_{\\theta} 15	\\left[ 16 -\\sum_{i=1}^{n} 17 \\left[ 18 \\mathbf{y}^{(i)}\\ln(h_{\\theta}(\\mathbf{x}^{(i)})) + 19 (1-\\mathbf{y}^{(i)})\\ln(1-h_{\\theta}(\\mathbf{x}^{(i)})) 20 \\right] 21	\\right]\\\\ 22&amp;=	\\arg\\min_{\\theta}\\mathscr{l}(\\theta) 23\\end{split} L(Î¸)=argâ¡maxâ¡Î¸lnâ¡(PAll)=argâ¡maxâ¡Î¸lnâ¡âˆi=1n[(hÎ¸(x(i)))y(i)â‹…(1âˆ’hÎ¸(x(i)))1âˆ’y(i)]=argâ¡maxâ¡Î¸âˆ‘i=1n[y(i)lnâ¡(hÎ¸(x(i)))+(1âˆ’y(i))lnâ¡(1âˆ’hÎ¸(x(i)))]=argâ¡minâ¡Î¸[âˆ’âˆ‘i=1n[y(i)lnâ¡(hÎ¸(x(i)))+(1âˆ’y(i))lnâ¡(1âˆ’hÎ¸(x(i)))]]=argâ¡minâ¡Î¸l(Î¸) \\begin{split} L(\\theta) &amp;=	\\arg\\max_{\\theta}\\ln(P_{All})\\\\ &amp;=	\\arg\\max_{\\theta}\\ln\\prod_{i=1}^{n} \\left[ (h_{\\theta}(\\mathbf{x}^{(i)}))^{\\mathbf{y}^{(i)}}\\cdot (1-h_{\\theta}(\\mathbf{x}^{(i)}))^{1-\\mathbf{y}^{(i)}} \\right]\\\\ &amp;=	\\arg\\max_{\\theta}\\sum_{i=1}^{n} \\left[ \\mathbf{y}^{(i)}\\ln(h_{\\theta}(\\mathbf{x}^{(i)})) + (1-\\mathbf{y}^{(i)})\\ln(1-h_{\\theta}(\\mathbf{x}^{(i)})) \\right]\\\\ &amp;=	\\arg\\min_{\\theta} \\left[ -\\sum_{i=1}^{n} \\left[ \\mathbf{y}^{(i)}\\ln(h_{\\theta}(\\mathbf{x}^{(i)})) + (1-\\mathbf{y}^{(i)})\\ln(1-h_{\\theta}(\\mathbf{x}^{(i)})) \\right] \\right]\\\\ &amp;=	\\arg\\min_{\\theta}\\mathscr{l}(\\theta) \\end{split} L(Î¸)â€‹=argÎ¸maxâ€‹ln(PAllâ€‹)=argÎ¸maxâ€‹lni=1âˆnâ€‹[(hÎ¸â€‹(x(i)))y(i)â‹…(1âˆ’hÎ¸â€‹(x(i)))1âˆ’y(i)]=argÎ¸maxâ€‹i=1âˆ‘nâ€‹[y(i)ln(hÎ¸â€‹(x(i)))+(1âˆ’y(i))ln(1âˆ’hÎ¸â€‹(x(i)))]=argÎ¸minâ€‹[âˆ’i=1âˆ‘nâ€‹[y(i)ln(hÎ¸â€‹(x(i)))+(1âˆ’y(i))ln(1âˆ’hÎ¸â€‹(x(i)))]]=argÎ¸minâ€‹l(Î¸)â€‹ä¸Šä¾‹ä¸­ï¼Œåœ¨ = å‰æ·»åŠ äº† &amp;ï¼Œå› æ­¤å®ç°ç­‰å·å¯¹é½ï¼›
\\begin{split} \\end{split} è¯­æ³•é»˜è®¤ä¸ºå³å¯¹é½ï¼Œä¹Ÿå°±æ˜¯è¯´å¦‚æœä¸åœ¨ä»»ä½•åœ°æ–¹æ·»åŠ  &amp; ç¬¦å·ï¼Œåˆ™å…¬å¼é»˜è®¤å³ä¾§å¯¹é½ï¼Œä¾‹å¦‚ï¼š
1\\begin{split} 2L(\\theta) 3=	\\arg\\max_{\\theta}\\ln(P_{All})\\\\ 4=	\\arg\\max_{\\theta}\\ln\\prod_{i=1}^{n} 5\\left[ 6(h_{\\theta}(\\mathbf{x}^{(i)}))^{\\mathbf{y}^{(i)}}\\cdot 7(1-h_{\\theta}(\\mathbf{x}^{(i)}))^{1-\\mathbf{y}^{(i)}} 8\\right]\\\\ 9=	\\arg\\max_{\\theta}\\sum_{i=1}^{n} 10\\left[ 11\\mathbf{y}^{(i)}\\ln(h_{\\theta}(\\mathbf{x}^{(i)})) + 12(1-\\mathbf{y}^{(i)})\\ln(1-h_{\\theta}(\\mathbf{x}^{(i)})) 13\\right]\\\\ 14=	\\arg\\min_{\\theta} 15\\left[ 16-\\sum_{i=1}^{n} 17\\left[ 18\\mathbf{y}^{(i)}\\ln(h_{\\theta}(\\mathbf{x}^{(i)})) + 19(1-\\mathbf{y}^{(i)})\\ln(1-h_{\\theta}(\\mathbf{x}^{(i)})) 20\\right] 21\\right]\\\\ 22=	\\arg\\min_{\\theta}\\mathscr{l}(\\theta) 23\\end{split} ä¸Šè¿° LATEX ä»£ç æ²¡æœ‰æ·»åŠ  &amp; ç¬¦å·ï¼Œåˆ™å…¬å¼å³å¯¹é½ï¼š
$$ \\begin{split} L(\\theta) =	\\arg\\max_{\\theta}\\ln(P_{All})\\ =	\\arg\\max_{\\theta}\\ln\\prod_{i=1}^{n} \\left[ (h_{\\theta}(\\mathbf{x}^{(i)}))^{\\mathbf{y}^{(i)}}\\cdot (1-h_{\\theta}(\\mathbf{x}^{(i)}))^{1-\\mathbf{y}^{(i)}} \\right]\\ =	\\arg\\max_{\\theta}\\sum_{i=1}^{n} \\left[ \\mathbf{y}^{(i)}\\ln(h_{\\theta}(\\mathbf{x}^{(i)})) + (1-\\mathbf{y}^{(i)})\\ln(1-h_{\\theta}(\\mathbf{x}^{(i)})) \\right]\\ =	\\arg\\min_{\\theta} \\left[ -\\sum_{i=1}^{n} \\left[ \\mathbf{y}^{(i)}\\ln(h_{\\theta}(\\mathbf{x}^{(i)})) + (1-\\mathbf{y}^{(i)})\\ln(1-h_{\\theta}(\\mathbf{x}^{(i)})) \\right] \\right]\\ =	\\arg\\min_{\\theta}\\mathscr{l}(\\theta) \\end{split}
$$
å¦‚æœå¸Œæœ›å·¦å¯¹é½ï¼Œä¾‹å¦‚
1\\begin{split} 2&amp;\\ln h_{\\theta}(\\mathbf{x}^{(i)}) 3=	\\ln\\frac{1}{1+e^{-\\theta^T \\mathbf{x}^{(i)}}} 4= -\\ln(1+e^{\\theta^T \\mathbf{x}^{(i)}})\\\\ 5&amp;\\ln(1-h_{\\theta}(\\mathbf{x}^{(i)})) 6=	\\ln(1-\\frac{1}{1+e^{-\\theta^T \\mathbf{x}^{(i)}}}) 7= -\\theta^T \\mathbf{x}^{(i)}-\\ln(1+e^{\\theta^T \\mathbf{x}^{(i)}}) 8\\end{split} lnâ¡hÎ¸(x(i))=lnâ¡11+eâˆ’Î¸Tx(i)=âˆ’lnâ¡(1+eÎ¸Tx(i))lnâ¡(1âˆ’hÎ¸(x(i)))=lnâ¡(1âˆ’11+eâˆ’Î¸Tx(i))=âˆ’Î¸Tx(i)âˆ’lnâ¡(1+eÎ¸Tx(i)) \\begin{split} &amp;\\ln h_{\\theta}(\\mathbf{x}^{(i)}) =	\\ln\\frac{1}{1+e^{-\\theta^T \\mathbf{x}^{(i)}}} = -\\ln(1+e^{\\theta^T \\mathbf{x}^{(i)}})\\\\ &amp;\\ln(1-h_{\\theta}(\\mathbf{x}^{(i)})) =	\\ln(1-\\frac{1}{1+e^{-\\theta^T \\mathbf{x}^{(i)}}}) = -\\theta^T \\mathbf{x}^{(i)}-\\ln(1+e^{\\theta^T \\mathbf{x}^{(i)}}) \\end{split} â€‹lnhÎ¸â€‹(x(i))=ln1+eâˆ’Î¸Tx(i)1â€‹=âˆ’ln(1+eÎ¸Tx(i))ln(1âˆ’hÎ¸â€‹(x(i)))=ln(1âˆ’1+eâˆ’Î¸Tx(i)1â€‹)=âˆ’Î¸Tx(i)âˆ’ln(1+eÎ¸Tx(i))â€‹é™¤äº† \\begin{split} \\end{split}ï¼Œä¹Ÿå¯ä»¥ç”¨ \\begin{align} \\end{align}ï¼Œç”¨æ³•ä¸ split ç›¸åŒï¼Œå¯¹é½æ–¹å¼ä¹Ÿç›¸åŒï¼›
åªæœ‰ä¸€ç‚¹ä¸åŒï¼šé‡‡ç”¨ align ç¯å¢ƒä¼šé»˜è®¤ä¸ºæ¯ä¸€æ¡å…¬å¼ç¼–å·ï¼ˆå¦‚ä¸‹ä¾‹ï¼‰ï¼Œsplit åˆ™ä¸ä¼šç¼–å·ã€‚
1\\begin{align} 2&amp;\\ln h_{\\theta}(\\mathbf{x}^{(i)}) 3=	\\ln\\frac{1}{1+e^{-\\theta^T \\mathbf{x}^{(i)}}} 4= -\\ln(1+e^{\\theta^T \\mathbf{x}^{(i)}})\\\\ 5&amp;\\ln(1-h_{\\theta}(\\mathbf{x}^{(i)})) 6=	\\ln(1-\\frac{1}{1+e^{-\\theta^T \\mathbf{x}^{(i)}}}) 7= -\\theta^T \\mathbf{x}^{(i)}-\\ln(1+e^{\\theta^T \\mathbf{x}^{(i)}}) 8\\end{align} lnâ¡hÎ¸(x(i))=lnâ¡11+eâˆ’Î¸Tx(i)=âˆ’lnâ¡(1+eÎ¸Tx(i))lnâ¡(1âˆ’hÎ¸(x(i)))=lnâ¡(1âˆ’11+eâˆ’Î¸Tx(i))=âˆ’Î¸Tx(i)âˆ’lnâ¡(1+eÎ¸Tx(i)) \\begin{align} &amp;\\ln h_{\\theta}(\\mathbf{x}^{(i)}) =	\\ln\\frac{1}{1+e^{-\\theta^T \\mathbf{x}^{(i)}}} = -\\ln(1+e^{\\theta^T \\mathbf{x}^{(i)}})\\\\ &amp;\\ln(1-h_{\\theta}(\\mathbf{x}^{(i)})) =	\\ln(1-\\frac{1}{1+e^{-\\theta^T \\mathbf{x}^{(i)}}}) = -\\theta^T \\mathbf{x}^{(i)}-\\ln(1+e^{\\theta^T \\mathbf{x}^{(i)}}) \\end{align} â€‹lnhÎ¸â€‹(x(i))=ln1+eâˆ’Î¸Tx(i)1â€‹=âˆ’ln(1+eÎ¸Tx(i))ln(1âˆ’hÎ¸â€‹(x(i)))=ln(1âˆ’1+eâˆ’Î¸Tx(i)1â€‹)=âˆ’Î¸Tx(i)âˆ’ln(1+eÎ¸Tx(i))â€‹â€‹ä½†å¯ä»¥åœ¨ align ååŠ ä¸€ä¸ª * å·ï¼Œåˆ™ align ç¯å¢ƒä¹Ÿå¯ä»¥å–æ¶ˆå…¬å¼è‡ªåŠ¨ç¼–å·ï¼Œå¦‚ä¸‹ï¼š (ä¹Ÿå°±æ˜¯è¯´ align* å’Œ split çš„ç”¨æ³•å®Œå…¨ç›¸åŒ)
1\\begin{align*} 2&amp;\\ln h_{\\theta}(\\mathbf{x}^{(i)}) 3=	\\ln\\frac{1}{1+e^{-\\theta^T \\mathbf{x}^{(i)}}} 4	= -\\ln(1+e^{\\theta^T \\mathbf{x}^{(i)}})\\\\ 5&amp;\\ln(1-h_{\\theta}(\\mathbf{x}^{(i)})) 6=	\\ln(1-\\frac{1}{1+e^{-\\theta^T \\mathbf{x}^{(i)}}}) 7	= -\\theta^T \\mathbf{x}^{(i)}-\\ln(1+e^{\\theta^T \\mathbf{x}^{(i)}}) 8\\end{align*} lnâ¡hÎ¸(x(i))=lnâ¡11+eâˆ’Î¸Tx(i)=âˆ’lnâ¡(1+eÎ¸Tx(i))lnâ¡(1âˆ’hÎ¸(x(i)))=lnâ¡(1âˆ’11+eâˆ’Î¸Tx(i))=âˆ’Î¸Tx(i)âˆ’lnâ¡(1+eÎ¸Tx(i)) \\begin{align*} &amp;\\ln h_{\\theta}(\\mathbf{x}^{(i)}) =	\\ln\\frac{1}{1+e^{-\\theta^T \\mathbf{x}^{(i)}}} = -\\ln(1+e^{\\theta^T \\mathbf{x}^{(i)}})\\\\ &amp;\\ln(1-h_{\\theta}(\\mathbf{x}^{(i)})) =	\\ln(1-\\frac{1}{1+e^{-\\theta^T \\mathbf{x}^{(i)}}}) = -\\theta^T \\mathbf{x}^{(i)}-\\ln(1+e^{\\theta^T \\mathbf{x}^{(i)}}) \\end{align*} â€‹lnhÎ¸â€‹(x(i))=ln1+eâˆ’Î¸Tx(i)1â€‹=âˆ’ln(1+eÎ¸Tx(i))ln(1âˆ’hÎ¸â€‹(x(i)))=ln(1âˆ’1+eâˆ’Î¸Tx(i)1â€‹)=âˆ’Î¸Tx(i)âˆ’ln(1+eÎ¸Tx(i))â€‹æ–¹ç¨‹ç»„ ä½¿ç”¨ \\begin{cases} \\end{cases}
ä¾‹å¦‚ï¼š
1\\begin{cases} 2\\begin{split} 3p &amp;= P(y=1|\\mathbf{x})= 4\\frac{1}{1+e^{-\\theta^T\\mathbf{X}}}\\\\ 51-p &amp;= P(y=0|\\mathbf{x})=1-P(y=1|\\mathbf{x})= 6\\frac{1}{1+e^{\\theta^T\\mathbf{X}}} 7\\end{split} 8\\end{cases} {p=P(y=1âˆ£x)=11+eâˆ’Î¸TX1âˆ’p=P(y=0âˆ£x)=1âˆ’P(y=1âˆ£x)=11+eÎ¸TX \\begin{cases} \\begin{split} p &amp;= P(y=1|\\mathbf{x})= \\frac{1}{1+e^{-\\theta^T\\mathbf{X}}}\\\\ 1-p &amp;= P(y=0|\\mathbf{x})=1-P(y=1|\\mathbf{x})= \\frac{1}{1+e^{\\theta^T\\mathbf{X}}} \\end{split} \\end{cases} â©â¨â§â€‹p1âˆ’pâ€‹=P(y=1âˆ£x)=1+eâˆ’Î¸TX1â€‹=P(y=0âˆ£x)=1âˆ’P(y=1âˆ£x)=1+eÎ¸TX1â€‹â€‹â€‹æ³¨æ„ LATEX è¯­æ³•å¯ä»¥åµŒå¥—ä½¿ç”¨ï¼Œä¸Šä¾‹å³ä¸º \\begin{cases} \\end{cases} ä¸‹åµŒå¥—äº† \\begin{split} \\end{split}ã€‚
ä¹Ÿå¯ä»¥å°†å…¬å¼å’Œæ–‡å­—ç»“åˆèµ·æ¥ï¼Œä¾‹å¦‚ï¼š
1\\text{Decision Boundary}= 2\\begin{cases} 3 1\\quad \\text{if }\\ \\hat{y}&gt;0.5\\\\ 4 0\\quad \\text{otherwise} 5\\end{cases} DecisionÂ Boundary={1ifÂ y^&gt;0.50otherwise \\text{Decision Boundary}= \\begin{cases} 1\\quad \\text{if }\\ \\hat{y}&gt;0.5\\\\ 0\\quad \\text{otherwise} \\end{cases} DecisionÂ Boundary={1ifÂ y^â€‹&gt;0.50otherwiseâ€‹æ³¨ï¼š\\quad è¡¨ç¤ºç©ºæ ¼ã€‚
å…¬å¼æ·»åŠ ç¼–å· åœ¨ LaTeX ä¸­ï¼Œå¯ä»¥é€šè¿‡ \\tag{} å‘½ä»¤ä¸ºå…¬å¼è‡ªå®šä¹‰ç¼–å·ã€‚ä»¥ä¸‹æ˜¯å¦‚ä½•åœ¨ LaTeX ä¸­ä¸ºå…¬å¼æ·»åŠ è‡ªå®šä¹‰ç¼–å·çš„ç¤ºä¾‹ï¼š
ç¤ºä¾‹ä»£ç  1% æ— ç¼–å·å…¬å¼ 2 3$$ 4 5\\dot{V}(x) \\leq -k_1 V(x)^{\\frac{m}{n}} - k_2 V(x)^{\\frac{r}{s}} 6 7$$ VË™(x)â‰¤âˆ’k1V(x)mnâˆ’k2V(x)rs \\dot{V}(x) \\leq -k_1 V(x)^{\\frac{m}{n}} - k_2 V(x)^{\\frac{r}{s}} VË™(x)â‰¤âˆ’k1â€‹V(x)nmâ€‹âˆ’k2â€‹V(x)srâ€‹1 2% è‡ªå®šä¹‰ç¼–å·å…¬å¼ 3 4$$ 5 6\\dot{V}(x) \\leq -k_1 V(x)^{\\frac{m}{n}} - k_2 V(x)^{\\frac{r}{s}} \\tag{1.1} 7 8$$ VË™(x)â‰¤âˆ’k1V(x)mnâˆ’k2V(x)rs(1.1) \\dot{V}(x) \\leq -k_1 V(x)^{\\frac{m}{n}} - k_2 V(x)^{\\frac{r}{s}} \\tag{1.1} VË™(x)â‰¤âˆ’k1â€‹V(x)nmâ€‹âˆ’k2â€‹V(x)srâ€‹(1.1) 1 2% å¤šè¡Œå…¬å¼è‡ªå®šä¹‰ç¼–å· 3 4\\begin{align} 5 6\\dot{V}(x) &amp;\\leq -k_1 V(x)^{\\frac{m}{n}} - k_2 V(x)^{\\frac{r}{s}} \\tag{1.2} \\\\ 7 8&amp;\\leq -k_1 V(x)^{\\frac{m}{n}} \\quad \\text{(å¿½ç•¥æ¬¡çº¿æ€§é¡¹)} \\tag{1.3} 9 10\\end{align} 11 12\\end{document} $$ \\begin{align}
\\dot{V}(x) &amp;\\leq -k_1 V(x)^{\\frac{m}{n}} - k_2 V(x)^{\\frac{r}{s}} \\tag{1.2} \\
&amp;\\leq -k_1 V(x)^{\\frac{m}{n}} \\quad \\text{(å¿½ç•¥æ¬¡çº¿æ€§é¡¹)} \\tag{1.3}
\\end{align} $$
è¯´æ˜ æ— ç¼–å·å…¬å¼ï¼š ä½¿ç”¨ $$ ... $$ æˆ– [equation*] ç¯å¢ƒå¯ä»¥åˆ›å»ºæ— ç¼–å·å…¬å¼ã€‚ è‡ªå®šä¹‰ç¼–å·å…¬å¼ï¼š ä½¿ç”¨ \\tag{} å‘½ä»¤å¯ä»¥ä¸ºå…¬å¼æ·»åŠ è‡ªå®šä¹‰ç¼–å·ï¼Œä¾‹å¦‚ \\tag{1.1}ã€‚ å¤šè¡Œå…¬å¼è‡ªå®šä¹‰ç¼–å·ï¼š åœ¨ align ç¯å¢ƒä¸­ï¼Œå¯ä»¥ä¸ºæ¯ä¸€è¡Œå…¬å¼å•ç‹¬æ·»åŠ è‡ªå®šä¹‰ç¼–å·ã€‚ æ³¨æ„äº‹é¡¹ \\tag{} å‘½ä»¤ä¼šè¦†ç›– LaTeX è‡ªåŠ¨ç”Ÿæˆçš„ç¼–å·ã€‚ å¦‚æœéœ€è¦åœ¨å…¬å¼ä¸­å¼•ç”¨è‡ªå®šä¹‰ç¼–å·ï¼Œå¯ä»¥ä½¿ç”¨ \\label{} å’Œ \\[eqref]{} ç»“åˆçš„æ–¹å¼ã€‚ é€šè¿‡è¿™ç§æ–¹å¼ï¼Œå¯ä»¥çµæ´»åœ°ä¸º LaTeX å…¬å¼æ·»åŠ è‡ªå®šä¹‰ç¼–å·ï¼Œæ»¡è¶³ç‰¹å®šæ–‡æ¡£çš„éœ€æ±‚ã€‚
`,url:"https://hugo-dead-simple.netlify.com/blog/latex%E6%95%B0%E5%AD%A6%E5%85%AC%E5%BC%8F%E6%89%8B%E5%86%8C.html"},"https://hugo-dead-simple.netlify.com/program_language/lua/index.html":{title:"luaå­¦ä¹ ç¬”è®°",tags:[],content:" å†…å®¹ luaé¢å‘å¯¹è±¡ èµ„æº è¶…å¿«é€Ÿå­¦ä¹ Lua [[2.ä¸€äº›ä»£ç ]] åœ¨çº¿ç¼–è¾‘å™¨ https://wiki.luatos.com/_static/luatos-emulator/lua.html åœ¨çº¿ç¼–è¾‘å™¨ https://www.jdoodle.com/execute-lua-online ",url:"https://hugo-dead-simple.netlify.com/program_language/lua/index.html"},"https://hugo-dead-simple.netlify.com/program_language/nestjs/index.html":{title:"luaå­¦ä¹ ç¬”è®°",tags:[],content:" å†…å®¹ nestjs è§†é¢‘æ•™ç¨‹ å°æ»¡nestjs ç³»åˆ—æ–‡ç«  ",url:"https://hugo-dead-simple.netlify.com/program_language/nestjs/index.html"},"https://hugo-dead-simple.netlify.com/books/lua/index.html":{title:"luaç¨‹åºè®¾è®¡ç¬¬å››ç‰ˆ",tags:[],content:" èµ„æº è¶…å¿«é€Ÿå­¦ä¹ Lua [[2.ä¸€äº›ä»£ç ]] åœ¨çº¿ç¼–è¾‘å™¨ https://wiki.luatos.com/_static/luatos-emulator/lua.html åœ¨çº¿ç¼–è¾‘å™¨ https://www.jdoodle.com/execute-lua-online ",url:"https://hugo-dead-simple.netlify.com/books/lua/index.html"},"https://hugo-dead-simple.netlify.com/books/%E7%AE%97%E6%B3%95%E6%96%B0%E8%A7%A3-%E5%88%98%E6%96%B0%E5%AE%87/index.html":{title:"ç®—æ³•æ–°è§£-åˆ˜æ–°å®‡ è¯»ä¹¦ç¬”è®°",tags:[],content:"ç›®å½• å‰è¨€ ç¬¬ä¸€ç«  åˆ—è¡¨ ç¬¬äºŒç«  äºŒå‰æœç´¢æ ‘ ",url:"https://hugo-dead-simple.netlify.com/books/%E7%AE%97%E6%B3%95%E6%96%B0%E8%A7%A3-%E5%88%98%E6%96%B0%E5%AE%87/index.html"},"https://hugo-dead-simple.netlify.com/tags/aggregation.html":{title:"Aggregation",tags:[],content:"",url:"https://hugo-dead-simple.netlify.com/tags/aggregation.html"},"https://hugo-dead-simple.netlify.com/tags/css.html":{title:"CSS",tags:[],content:"",url:"https://hugo-dead-simple.netlify.com/tags/css.html"},"https://hugo-dead-simple.netlify.com/typescript/debug.html":{title:"debug",tags:[],content:`æ¥è‡ª: https://www.bilibili.com/video/BV1zT411z7y7/
å®‰è£…typescript ä¸ts-node å†™ä¸€ä¸ªtsçš„è„šæœ¬ 1let a = 1 2a = a+1 3console.log(a) ç‚¹å‡»è¡Œä¸‹æ®µç‚¹ ç‚¹å‡»vscodeä¸Šçš„è°ƒè¯•æŒ‰é’® `,url:"https://hugo-dead-simple.netlify.com/typescript/debug.html"},"https://hugo-dead-simple.netlify.com/tags/exercises.html":{title:"Exercises",tags:[],content:"",url:"https://hugo-dead-simple.netlify.com/tags/exercises.html"},"https://hugo-dead-simple.netlify.com/frontend/index.html":{title:"FrontEnds",tags:[],content:"",url:"https://hugo-dead-simple.netlify.com/frontend/index.html"},"https://hugo-dead-simple.netlify.com/tags/hugo.html":{title:"Hugo",tags:[],content:"",url:"https://hugo-dead-simple.netlify.com/tags/hugo.html"},"https://hugo-dead-simple.netlify.com/tags/javascript.html":{title:"JavaScript",tags:[],content:"",url:"https://hugo-dead-simple.netlify.com/tags/javascript.html"},"https://hugo-dead-simple.netlify.com/tags/mongodb.html":{title:"MongoDB",tags:[],content:"",url:"https://hugo-dead-simple.netlify.com/tags/mongodb.html"},"https://hugo-dead-simple.netlify.com/mongodb/lookup.html":{title:"MongoDB - Lookup æ“ä½œè¯¦è§£",tags:["MongoDB","Aggregation"],content:`FAQ å¦‚æœå®ç°ç±»ä¼¼çš„sqlçš„ join åŠŸèƒ½å‘¢?
æŸ¥çœ‹å®˜æ–¹æ–‡æ¡£
$lookupï¼ˆèšåˆï¼‰â€” MongoDB æ‰‹å†Œ v8.0 ask ask : æˆ‘åœ¨å†™åœ¨mongodbçš„ç›¸å…³å†…å®¹, æœ‰ä¸€ä¸ªuser collection ,è¿˜æœ‰ä¸€ä¸ªcomment collection,commmenté€šè¿‡ userid ä¸user è¿›è¡Œäº†å…³è”,,æˆ‘åœ¨æŸ¥è¯¢comment ,å¦‚ä½•å¾—åˆ°æ¯ä¸ªcomment é‡Œçš„user çš„ç›¸å…³å±æ€§? Answser åœ¨ MongoDB ä¸­ï¼Œå¦‚æœ comment é›†åˆä¸­çš„æ¯ä¸ªæ–‡æ¡£é€šè¿‡ userId å­—æ®µä¸ user é›†åˆä¸­çš„ç”¨æˆ·è¿›è¡Œå…³è”ï¼Œå¹¶ä¸”ä½ å¸Œæœ›åœ¨æŸ¥è¯¢ comment æ—¶è·å–æ¯ä¸ªè¯„è®ºå¯¹åº”çš„ user çš„ç›¸å…³å±æ€§ï¼Œä½ å¯ä»¥ä½¿ç”¨ $lookup èšåˆæ“ä½œæ¥å®ç°è”è¡¨æŸ¥è¯¢ã€‚
ç¤ºä¾‹æ•°æ®ç»“æ„ user é›†åˆ:
1{ 2 &#34;_id&#34;: ObjectId(&#34;user1&#34;), 3 &#34;name&#34;: &#34;Alice&#34;, 4 &#34;email&#34;: &#34;alice@example.com&#34;, 5 &#34;age&#34;: 30 6} comment é›†åˆ:
1{ 2 &#34;_id&#34;: ObjectId(&#34;comment1&#34;), 3 &#34;content&#34;: &#34;This is a comment&#34;, 4 &#34;userId&#34;: ObjectId(&#34;user1&#34;), 5 &#34;timestamp&#34;: ISODate(&#34;2024-12-09T10:00:00Z&#34;) 6} ä½¿ç”¨ $lookup è¿›è¡Œè”è¡¨æŸ¥è¯¢ ä½ å¯ä»¥ä½¿ç”¨èšåˆæ¡†æ¶ï¼ˆaggregate()ï¼‰ç»“åˆ $lookup æ¥è¿æ¥ comment å’Œ user é›†åˆï¼Œå¹¶å°†æ¯ä¸ªè¯„è®ºå¯¹åº”çš„ç”¨æˆ·ä¿¡æ¯åˆå¹¶åˆ°è¯„è®ºæ•°æ®ä¸­ã€‚
èšåˆæŸ¥è¯¢ç¤ºä¾‹ 1db.comment.aggregate([ 2 { 3 $lookup: { 4 from: &#34;user&#34;, // å…³è”çš„é›†åˆæ˜¯ &#34;user&#34; 5 localField: &#34;userId&#34;, // å½“å‰é›†åˆä¸­å…³è”å­—æ®µæ˜¯ &#34;userId&#34; 6 foreignField: &#34;_id&#34;, // å…³è”åˆ° &#34;user&#34; é›†åˆä¸­çš„ &#34;_id&#34; å­—æ®µ 7 as: &#34;userDetails&#34; // ç»“æœä¼šæ”¾å…¥ &#34;userDetails&#34; æ•°ç»„å­—æ®µ 8 } 9 }, 10 { 11 $unwind: &#34;$userDetails&#34; // å°† &#34;userDetails&#34; æ•°ç»„å±•å¼€æˆå•ä¸ªå¯¹è±¡ï¼ˆå¦‚æœæ¯ä¸ªè¯„è®ºåªèƒ½æœ‰ä¸€ä¸ªç”¨æˆ·çš„è¯ï¼‰ 12 } 13]) æŸ¥è¯¢ç»“æœ å‡è®¾ comment é›†åˆæœ‰ä¸€ä¸ªæ–‡æ¡£ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š
1{ 2 &#34;_id&#34;: ObjectId(&#34;comment1&#34;), 3 &#34;content&#34;: &#34;This is a comment&#34;, 4 &#34;userId&#34;: ObjectId(&#34;user1&#34;), 5 &#34;timestamp&#34;: ISODate(&#34;2024-12-09T10:00:00Z&#34;), 6 &#34;userDetails&#34;: { 7 &#34;_id&#34;: ObjectId(&#34;user1&#34;), 8 &#34;name&#34;: &#34;Alice&#34;, 9 &#34;email&#34;: &#34;alice@example.com&#34;, 10 &#34;age&#34;: 30 11 } 12} è§£æè¯´æ˜ $lookup: åœ¨ comment é›†åˆä¸­çš„ userId å­—æ®µå’Œ user é›†åˆä¸­çš„ _id å­—æ®µä¹‹é—´å»ºç«‹è¿æ¥ï¼Œå°†åŒ¹é…åˆ°çš„ç”¨æˆ·ä¿¡æ¯åŠ å…¥åˆ°æ¯ä¸ªè¯„è®ºä¸­ï¼Œå¹¶å­˜å‚¨åœ¨ userDetails å­—æ®µä¸­ã€‚
$unwind: å¦‚æœä½ ç¡®å®šæ¯ä¸ªè¯„è®ºåªæœ‰ä¸€ä¸ªå¯¹åº”çš„ç”¨æˆ·ï¼ˆå³ userId å­—æ®µæŒ‡å‘çš„æ˜¯å”¯ä¸€ç”¨æˆ·ï¼‰ï¼Œä½¿ç”¨ $unwind å°† userDetails æ•°ç»„æ‹†è§£æˆå•ä¸ªå¯¹è±¡ã€‚è¿™æ ·ï¼Œä½ å°±å¯ä»¥ç›´æ¥åœ¨æ¯ä¸ªè¯„è®ºæ–‡æ¡£ä¸­è·å–åˆ°ç”¨æˆ·çš„å±æ€§ã€‚
å¦‚æœä¸€ä¸ªè¯„è®ºå¯èƒ½æœ‰å¤šä¸ªç”¨æˆ·ï¼ˆä¾‹å¦‚è¯„è®ºå¯èƒ½æœ‰å¤šä¸ªä½œè€…ï¼‰ï¼Œä½ å¯ä»¥è·³è¿‡ $unwindï¼Œè¿™æ ·æ¯ä¸ªè¯„è®ºçš„ userDetails ä¼šæ˜¯ä¸€ä¸ªæ•°ç»„ï¼ŒåŒ…å«åŒ¹é…çš„æ‰€æœ‰ç”¨æˆ·ã€‚
å…¶ä»–æ”¹è¿› å¦‚æœä½ åªå…³å¿ƒæŸäº›ç‰¹å®šçš„ç”¨æˆ·å­—æ®µï¼Œå¯ä»¥é€šè¿‡ $project å¯¹è¿”å›çš„å­—æ®µè¿›è¡Œè¿‡æ»¤ï¼Œå‡å°‘æ•°æ®ä¼ è¾“é‡ã€‚ä¾‹å¦‚ï¼š
1db.comment.aggregate([ 2 { 3 $lookup: { 4 from: &#34;user&#34;, 5 localField: &#34;userId&#34;, 6 foreignField: &#34;_id&#34;, 7 as: &#34;userDetails&#34; 8 } 9 }, 10 { 11 $unwind: &#34;$userDetails&#34; 12 }, 13 { 14 $project: { 15 content: 1, // åªä¿ç•™è¯„è®ºçš„å†…å®¹ 16 &#34;userDetails.name&#34;: 1, // åªè¿”å›ç”¨æˆ·çš„åå­— 17 &#34;userDetails.email&#34;: 1 // åªè¿”å›ç”¨æˆ·çš„é‚®ç®± 18 } 19 } 20]) è¿™æ ·ï¼Œç»“æœå°†åªåŒ…å«è¯„è®ºå†…å®¹ä»¥åŠç”¨æˆ·çš„åå­—å’Œé‚®ç®±ã€‚
æ€»ç»“ ä½¿ç”¨ aggregate() æ–¹æ³•ç»“åˆ $lookup å¯ä»¥è½»æ¾åœ°åœ¨æŸ¥è¯¢è¯„è®ºæ—¶è·å–æ¯ä¸ªè¯„è®ºå¯¹åº”ç”¨æˆ·çš„è¯¦ç»†ä¿¡æ¯ã€‚å¦‚æœä½ åªå…³å¿ƒéƒ¨åˆ†ç”¨æˆ·å­—æ®µï¼Œå¯ä»¥ä½¿ç”¨ $project æ¥é™åˆ¶è¿”å›çš„å­—æ®µï¼Œä¼˜åŒ–æŸ¥è¯¢æ•ˆç‡ã€‚
`,url:"https://hugo-dead-simple.netlify.com/mongodb/lookup.html"},"https://hugo-dead-simple.netlify.com/mongodb/find_on_array.html":{title:"MongoDB - åœ¨æ•°ç»„ä¸ŠæŸ¥è¯¢",tags:["MongoDB","Querying"],content:`æŸ¥è¯¢æ•°ç»„ - MongoDB æ‰‹å†Œ v8.0
$neæ“ä½œåœ¨æ•°ç»„çš„æŸ¥è¯¢ä¸æˆ‘æƒ³çš„ä¸ä¸€æ ·
å¦‚æœä½ å¸Œæœ›èƒ½å¤ŸåŒ¹é…æ•°ç»„ä¸­æœ‰éƒ¨åˆ†å…ƒç´ ä¸ &ldquo;red&rdquo; ä¸åŒ¹é…çš„æ–‡æ¡£ï¼Œå¯ä»¥ä½¿ç”¨ $elemMatch æ¥ç²¾ç¡®åŒ¹é…æ•°ç»„ä¸­çš„å•ä¸ªå…ƒç´ ï¼š
1db.newdb.find({ 2 tags: { $elemMatch: { $ne: &#34;red&#34; } } 3}) æŸ¥è¯¢æ•°ç»„å…ƒç´ 
å¤šä¸ªæ¡ä»¶
1const cursor = db.collection(&#39;inventory&#39;).find({ 2 dim_cm: { $gt: 15, $lt: 20 } 3}); æ•°å­¦æè¿°
âˆƒxâˆˆA(x&gt;=15)âˆ§âˆƒxâˆˆA(x&lt;=20) \\exists x \\in A( x&gt;=15) \\land \\exists x \\in A (x &lt;=20) âˆƒxâˆˆA(x&gt;=15)âˆ§âˆƒxâˆˆA(x&lt;=20)1const cursor = db.collection(&#39;inventory&#39;).find({ 2 dim_cm: { $elemMatch: { $gt: 22, $lt: 30 } } 3}); âˆƒxâˆˆA(x&gt;=15âˆ§x&lt;=20) \\exists x \\in A( x&gt;=15 \\land x &lt;=20) âˆƒxâˆˆA(x&gt;=15âˆ§x&lt;=20)1const cursor = db.collection(&#39;inventory&#39;).find({ 2 dim_cm: {$eq:20} 3}); âˆƒxâˆˆA(x=20) \\exists x \\in A( x=20) âˆƒxâˆˆA(x=20)1const cursor = db.collection(&#39;inventory&#39;).find({ 2 dim_cm: {$ne:20} 3}); !!!æ³¨æ„è¿™ä¸ªæŸ¥è¯¢æ˜¯ä¸Šé¢çš„æŸ¥è¯¢çš„åé¢
Â¬âˆƒxâˆˆA(x=20)âˆ€Â¬(x=20)âˆ€(x!=20) \\begin{matrix} \\neg \\exists x \\in A(x = 20) \\\\ \\forall \\neg (x = 20) \\\\ \\forall (x != 20) \\end{matrix} Â¬âˆƒxâˆˆA(x=20)âˆ€Â¬(x=20)âˆ€(x!=20)â€‹`,url:"https://hugo-dead-simple.netlify.com/mongodb/find_on_array.html"},"https://hugo-dead-simple.netlify.com/mongodb/mongodb.html":{title:"MongoDB å­¦ä¹ ç¬”è®°",tags:[],content:`å®‰è£… docker å®‰è£…,æ ¹æ®æ–‡æ¡£æ¥: https://www.mongodb.com/zh-cn/docs/manual/tutorial/install-mongodb-community-with-docker/
å®‰è£…å®Œå,æˆ‘æ ¹æ® https://www.w3resource.com/mongodb-exercises/ åšç»ƒä¹ 
è¿™é‡Œçš„å®¢æˆ·ç«¯é€‰æ‹©äº†mongodb compass: https://www.mongodb.com/try/download/compass
æœ€é‡è¦çš„å°±æ˜¯mongodbçš„å®˜æ–¹æ–‡æ¡£: https://www.mongodb.com/zh-cn/docs/manual/
ä¸€äº›æ¦‚å¿µ 1æ•°æ® --&gt; é›†åˆ-&gt; æ–‡æ¡£ å­¦ä¹ è·¯çº¿ æˆ‘è®¤ä¸ºå­¦ä¹ çš„è·¯çº¿ä¸º
å¢åˆ æ”¹æŸ¥ æ³¨æ„æ•°ç»„ä¸ŠæŸ¥è¯¢çš„åç›´è§‰è¡Œä¸º æ³¨æ„$neåœ¨æ•°ç»„çš„æŸ¥è¯¢é—®é¢˜ èšåˆ ç´¢å¼• `,url:"https://hugo-dead-simple.netlify.com/mongodb/mongodb.html"},"https://hugo-dead-simple.netlify.com/mongodb/exercise.html":{title:"MongoDB ç»ƒä¹  1",tags:["MongoDB","Exercises"],content:`5 Write a MongoDB query to display all the restaurant which is in the borough Bronx. è¿™ä¸ªç®€å•,æœ¬è´¨æ˜¯æŸ¥è¯¢å›ºå®šçš„å€¼
1db[&#34;restaurants&#34;].find({&#39;borough&#39;:&#39;Bronx&#39;}) 8 Write a MongoDB query to find the restaurants who achieved a score more than 90. è®©æˆ‘ä»¬æŸ¥è¯¢ä¸€ä¸ªæ•°ç»„,æ•°ç»„é‡Œé¢æœ‰ä¸€ä¸ªObjectçš„å€¼&gt;=0
1db[&#34;restaurants&#34;].find({&#39;grades.score&#39;: {$gt : 90}}).count() 1db[&#34;restaurants&#34;].find({ &#39;grades&#39; : {$elemMatch : { &#34;score&#34; :{$gt : 90} } } }) è¿™ä¸¤ä¸ªçš„ç»“æœæ˜¯ç­‰ä»·çš„,åªä¸è¿‡ç¬¬äºŒä¸ªç”¨åˆ°äº†æ•°ç»„åŒ¹é…æ“ä½œç¬¦$elemMatch
9 Write a MongoDB query to find the restaurants that achieved a score, more than 80 but less than 100. è¿™ä¸ªé¢˜ç›®çš„æ„æ€æ˜¯: gradesé‡Œå­˜åœ¨ä¸€ä¸ªåˆ†æ•°,è¿™ä¸ªåˆ†æ•°åœ¨80ä¸90ä¹‹é—´
1db[&#34;restaurants&#34;].find({ &#39;grades&#39; : {$elemMatch : { &#34;score&#34; :{$gt : 80,$lt:100} } } }) 10 Write a MongoDB query to find the restaurants which locate in latitude value less than -95.754168. è¿™é‡Œè€ƒå¯Ÿæˆ‘ä»¬å¦‚ä½•æŸ¥è¯¢æ•°ç»„é‡ŒæŸä¸ªä¸‹æ ‡çš„å€¼
1db.restaurants.find({&#34;address.coord.0&#34;:{$lte : -95.754168} }) 11 Write a MongoDB query to find the restaurants that do not prepare any cuisine of &lsquo;American&rsquo; and their grade score more than 70 and latitude less than -65.754168. 1db[&#34;restaurants&#34;].count({cuisine:{$not: {$regex: /.*American.*/ } },grades:{$elemMatch : { &#34;score&#34;:{$gte:70} }} }) è¿™é‡Œè€ƒæŸ¥æˆ‘ä»¬æœ‰å¤šä¸ªæ¡ä»¶,åŒæ—¶æˆç«‹çš„æŸ¥è¯¢
å‘ç°ä¸€ä¸ªé—®é¢˜:
æˆ‘æŸ¥è¯¢äº†æ–‡æ¡£
mongodbåœ¨æ•°ç»„ä¸Šçš„æŸ¥è¯¢ https://www.mongodb.com/zh-cn/docs/manual/tutorial/query-arrays/#specify-multiple-conditions-for-array-elements mongodb - mongo $ne query with an array not working as expected - Stack Overflow $neæ“ä½œåœ¨æ•°ç»„çš„æŸ¥è¯¢ä¸æˆ‘æƒ³çš„ä¸ä¸€æ ·
å¦‚æœä½ å¸Œæœ›èƒ½å¤ŸåŒ¹é…æ•°ç»„ä¸­æœ‰éƒ¨åˆ†å…ƒç´ ä¸ &ldquo;red&rdquo; ä¸åŒ¹é…çš„æ–‡æ¡£ï¼Œå¯ä»¥ä½¿ç”¨ $elemMatch æ¥ç²¾ç¡®åŒ¹é…æ•°ç»„ä¸­çš„å•ä¸ªå…ƒç´ ï¼š
1db.newdb.find({ 2 tags: { $elemMatch: { $ne: &#34;red&#34; } } 3}) è¿™é‡Œå®˜æ–¹ç»™å‡ºçš„ç­”æ¡ˆ
1db.restaurants.find( 2 {$and: 3 [ 4 {&#34;cuisine&#34; : {$ne :&#34;American &#34;}}, 5 {&#34;grades.score&#34; : {$gt : 70}}, 6 {&#34;address.coord&#34; : {$lt : -65.754168}} 7 ] 8 }); 12 Write a MongoDB query to find the restaurants which do not prepare any cuisine of &lsquo;American&rsquo; and achieved a score more than 70 and located in the longitude less than -65.754168. Note : Do this query without using $and operator. å’Œä¸Šä¸€ä¸ªé—®é¢˜çš„é—®é¢˜ä¸€æ ·,åªæ˜¯ä¸è®©æˆ‘ä»¬ä½¿ç”¨$and$ç¬¦å·
1db.restaurants.find( 2 { 3 &#34;cuisine&#34; : {$ne : &#34;American &#34;}, 4 &#34;grades.score&#34; :{$gt: 70}, 5 &#34;address.coord&#34; : {$lt : -65.754168} 6 } 7 ); 13 Write a MongoDB query to find the restaurants which do not prepare any cuisine of &lsquo;American&rsquo; and achieved a grade point &lsquo;A&rsquo; not belongs to the borough Brooklyn. The document must be displayed according to the cuisine in descending order. å‰é¢çš„æ¡ä»¶è¿˜å¥½,è¿™é‡Œåªæ˜¯å¤šäº†ä¸€ä¸ªæ’åºçš„è¦æ±‚
1db.restaurants.find( { 2 &#34;cuisine&#34; : {$ne : &#34;American&#34;}, 3 &#34;grades.grade&#34; :&#34;A&#34;, 4 &#34;borough&#34;: {$ne : &#34;Brooklyn&#34;} 5 } 6 ).sort({&#34;cuisine&#34;:-1}); 14 Write a MongoDB query to find the restaurant Id, name, borough and cuisine for those restaurants which contain &lsquo;Wil&rsquo; as first three letters for its name. æŸ¥è¯¢çš„æ¡ä»¶æ˜¯nameçš„é¦–ä¸ªä¸‰ä¸ªå­—æ¯æ˜¯3ä¸ªWilå­—ç¬¦.
æˆ‘è¿™é‡Œçš„å†™æ³•ä¸å®˜æ–¹ä¸ä¸€æ ·,å› ä¸ºæˆ‘ä¸ç†è§£å®˜æ–¹çš„ç¬¬äºŒä¸ªå‚æ•°,ä¸ºä»€ä¹ˆè¿™æ ·å†™,å› ä¸ºæˆ‘æŸ¥è¯¢çš„nodejs api ä¸æ˜¯è¿™æ ·çš„.
https://mongodb.github.io/node-mongodb-native/6.11/interfaces/FindOptions.html#projection
1db[&#34;restaurants&#34;].find ({name:/AWil/}).projection({name:1,restaurant_id:1,borough:1,cuisine:1}}) ä¸ºä»€ä¹ˆä¼šè¿™æ ·? ,AI å‘Šè¯‰æˆ‘è¿™æ˜¯ä¸€ä¸ªå·®å¼‚!!!
ä½ æå‡ºçš„é—®é¢˜æ¶‰åŠåˆ° MongoDB Node.js Driver çš„ find æ–¹æ³•çš„ç¬¬äºŒä¸ªå‚æ•°ï¼Œå®ƒå®é™…ä¸Šæ˜¯ä¸€ä¸ª é€‰é¡¹å¯¹è±¡ï¼ˆoptionsï¼‰ï¼Œè€Œ æŠ•å½±ï¼ˆprojectionï¼‰ æ˜¯è¯¥é€‰é¡¹å¯¹è±¡ä¸­çš„ä¸€ä¸ªå­—æ®µã€‚è¿™æ˜¯ MongoDB Node.js Driver å’Œ MongoDB Shellï¼ˆmongoshï¼‰ä¹‹é—´çš„ä¸€ä¸ªå·®å¼‚ã€‚
MongoDB Node.js Driver çš„ find æ–¹æ³• æ ¹æ®ä½ æä¾›çš„é“¾æ¥ï¼Œåœ¨ MongoDB çš„ Node.js Driver ç‰ˆæœ¬ 3.6 ä¸­ï¼Œfind æ–¹æ³•çš„ç¬¬äºŒä¸ªå‚æ•° å¿…é¡»æ˜¯ä¸€ä¸ªé€‰é¡¹å¯¹è±¡ï¼Œè¯¥å¯¹è±¡ä¸­å¯ä»¥åŒ…å«å¤šä¸ªé€‰é¡¹ï¼Œä¾‹å¦‚ projection, sort, limit ç­‰ã€‚
find æ–¹æ³•çš„ç­¾åï¼ˆNode.js Driverï¼‰ 1find(filter, options) filter: æŸ¥è¯¢æ¡ä»¶ã€‚ options: é€‰é¡¹å¯¹è±¡ï¼Œå…¶ä¸­åŒ…æ‹¬å¤šä¸ªå¯é€‰çš„å­—æ®µï¼Œä¾‹å¦‚ projection, sort, limit ç­‰ã€‚ æŠ•å½±ï¼ˆProjectionï¼‰åœ¨é€‰é¡¹å¯¹è±¡ä¸­ åœ¨ MongoDB Node.js Driver ä¸­ï¼ŒæŠ•å½±ï¼ˆprojectionï¼‰ æ˜¯é€šè¿‡é€‰é¡¹å¯¹è±¡ä¸­çš„ projection å­—æ®µæ¥æŒ‡å®šçš„ã€‚å› æ­¤ï¼Œç¬¬äºŒä¸ªå‚æ•°çš„å½¢å¼é€šå¸¸æ˜¯ä¸€ä¸ªåŒ…å« projection å­—æ®µçš„å¯¹è±¡ï¼Œè€Œ æŠ•å½±ï¼ˆprojectionï¼‰ æœ¬èº«æ˜¯ä¸€ä¸ªæ–‡æ¡£ï¼Œå®šä¹‰äº†éœ€è¦åŒ…å«æˆ–æ’é™¤çš„å­—æ®µã€‚
ç¤ºä¾‹ä»£ç ï¼š 1const { MongoClient } = require(&#39;mongodb&#39;); 2 3async function queryRestaurants() { 4 const client = new MongoClient(&#39;mongodb://localhost:27017&#39;); 5 await client.connect(); 6 const db = client.db(&#39;test&#39;); // å‡è®¾ä½ çš„æ•°æ®åº“åæ˜¯ &#39;test&#39; 7 const collection = db.collection(&#39;restaurants&#39;); 8 9 // ä½¿ç”¨ find æŸ¥è¯¢å¹¶æŠ•å½± 10 const cursor = collection.find( 11 { name: /^Wil/ }, 12 { 13 projection: { 14 &#34;restaurant_id&#34;: 1, 15 &#34;name&#34;: 1, 16 &#34;borough&#34;: 1, 17 &#34;cuisine&#34;: 1 18 } 19 } 20 ); 21 22 // è·å–æŸ¥è¯¢ç»“æœå¹¶æ‰“å° 23 const results = await cursor.toArray(); 24 console.log(results); 25 26 await client.close(); 27} 28 29queryRestaurants().catch(console.error); ä¸ºä»€ä¹ˆå¿…é¡»ä½¿ç”¨ projection å­—æ®µï¼Ÿ åœ¨ Node.js MongoDB Driver çš„ find æ–¹æ³•ä¸­ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯ä¸€ä¸ª é€‰é¡¹å¯¹è±¡ï¼ˆoptionsï¼‰ï¼Œå› æ­¤ä½ éœ€è¦æ˜ç¡®æŒ‡å®š projection å­—æ®µæ¥è®¾ç½®æŸ¥è¯¢è¿”å›çš„å­—æ®µã€‚è¿™æ˜¯ä¸ MongoDB Shellï¼ˆmongoshï¼‰ çš„å·®å¼‚ï¼Œåè€…å¯ä»¥ç›´æ¥å°†æŠ•å½±æ–‡æ¡£ä½œä¸ºç¬¬äºŒä¸ªå‚æ•°ã€‚
Node.js Driver çš„é€‰é¡¹å¯¹è±¡ç»“æ„ åœ¨ Node.js ä¸­ï¼Œä½ å¯ä»¥ä¼ é€’ä¸€ä¸ªåŒ…å«å¤šä¸ªé€‰é¡¹å­—æ®µçš„å¯¹è±¡ï¼Œä¾‹å¦‚ï¼š
1{ 2 projection: { &#34;restaurant_id&#34;: 1, &#34;name&#34;: 1, &#34;borough&#34;: 1, &#34;cuisine&#34;: 1 }, 3 sort: { name: 1 }, 4 limit: 10 5} projection: æŒ‡å®šè¿”å›çš„å­—æ®µã€‚ sort: æŒ‡å®šæ’åºè§„åˆ™ã€‚ limit: é™åˆ¶è¿”å›çš„æ–‡æ¡£æ•°é‡ã€‚ æ€»ç»“ åœ¨ MongoDB Node.js Driver ä¸­ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯ä¸€ä¸ª é€‰é¡¹å¯¹è±¡ï¼ˆoptionsï¼‰ï¼Œå…¶ä¸­åŒ…å« projection å­—æ®µæ¥æŒ‡å®šæŠ•å½±ã€‚è€Œåœ¨ MongoDB Shellï¼ˆmongoshï¼‰ ä¸­ï¼Œç¬¬äºŒä¸ªå‚æ•°ç›´æ¥æ˜¯ä¸€ä¸ªæŠ•å½±æ–‡æ¡£ï¼Œå¯ä»¥çœç•¥ projection å­—æ®µåã€‚
Node.js Driver ä½¿ç”¨ projectionï¼š 1db.restaurants.find( 2 { name: /^Wil/ }, 3 { projection: { &#34;restaurant_id&#34;: 1, &#34;name&#34;: 1, &#34;borough&#34;: 1, &#34;cuisine&#34;: 1 } } 4); MongoDB Shell ä¸­ç›´æ¥ä¼ é€’æŠ•å½±æ–‡æ¡£ï¼š 1db.restaurants.find( 2 { name: /^Wil/ }, 3 { &#34;restaurant_id&#34;: 1, &#34;name&#34;: 1, &#34;borough&#34;: 1, &#34;cuisine&#34;: 1 } 4); å¥½å§,ç»è¿‡æˆ‘çš„æŸ¥è¯¢,è¿™çœŸçš„æ˜¯ä¸€ä¸ªå·®å¼‚:
https://stackoverflow.com/questions/67090307/mongodb-projection-syntax https://www.mongodb.com/zh-cn/docs/manual/reference/method/db.collection.findOne/ ä¸¤è€…ç¡®å®ä¸ä¸€æ ·.
15 Write a MongoDB query to find the restaurant Id, name, borough and cuisine for those restaurants which contain &lsquo;ces&rsquo; as last three letters for its name. å’Œä¸Šä¸€ä¸ªé—®é¢˜ä¸€æ ·,ä½†æ˜¯è¦æŸ¥è¯¢çš„å€¼æ˜¯æœ€åä¸‰ä¸ªå­—ç¬¦,è¿˜æ˜¯ä½¿ç”¨regex
1db.restaurants.find( 2{name: /ces$/}, 3{ 4&#34;restaurant_id&#34; : 1, 5&#34;name&#34;:1,&#34;borough&#34;:1, 6&#34;cuisine&#34; :1 7} 8); 1db[&#34;restaurants&#34;].find ({name:/ces$/}).projection({name:1, 2restaurant_id:1,borough:1,cuisine:1}) 16 åŒ…å«Reg+æŠ•å½± Write a MongoDB query to find the restaurant Id, name, borough and cuisine for those restaurants which contain &lsquo;Reg&rsquo; as three letters somewhere in its name. æ”¹å˜ä¸€ä¸‹regå°±å¯ä»¥äº†.
1db[&#34;restaurants&#34;].find({name:/Reg/},{name:1}).count() 2db[&#34;restaurants&#34;].find({name:/Reg/},{name:1}).count() 3 4db.restaurants.find( 5{&#34;name&#34;: /.*Reg.*/}, 6{ 7&#34;restaurant_id&#34; : 1, 8&#34;name&#34;:1,&#34;borough&#34;:1, 9&#34;cuisine&#34; :1 10} 11); 17 Write a MongoDB query to find the restaurants which belong to the borough Bronx and prepared either American or Chinese dish. 1db[&#34;restaurants&#34;].find({&#34;cuisine&#34;: {$in :[&#39;Chinese&#39;, &#39;American &#39;]} , 2 &#34;borough&#34;: &#34;Bronx&#34; 3},{&#34;cuisine&#34;:1}).count() 1db.restaurants.find( 2{ 3&#34;borough&#34;: &#34;Bronx&#34; , 4$or : [ 5{ &#34;cuisine&#34; : &#34;American &#34; }, 6{ &#34;cuisine&#34; : &#34;Chinese&#34; } 7] 8} 9); 18 Write a MongoDB query to find the restaurant Id, name, borough and cuisine for those restaurants which belong to the borough Staten Island or Queens or Bronxor Brooklyn.
å’Œæˆ‘çš„ä¸Šä¸€ä¸ªæ‰§è¡Œ$inçš„è¯­æ³•ä¸€æ ·
1db.restaurants.find( 2 {&#34;borough&#34; :{$in :[&#34;Staten Island&#34;,&#34;Queens&#34;,&#34;Bronx&#34;,&#34;Brooklyn&#34;]}}, 3 { 4 &#34;restaurant_id&#34; : 1, 5 &#34;name&#34;:1,&#34;borough&#34;:1, 6 &#34;cuisine&#34; :1 7 } 8 ); 19 Write a MongoDB query to find the restaurant Id, name, borough and cuisine for those restaurants which are not belonging to the borough Staten Island or Queens or Bronxor Brooklyn.
ä»æ•°ç†é€»è¾‘çš„è§’åº¦æ¥çœ‹,aâˆ‰{boroughÂ StatenÂ IslandÂ ,Â QueensÂ ,Â BronxorÂ Brooklyn}a \\notin \\{\\text{borough Staten Island , Queens , Bronxor Brooklyn} \\}aâˆˆ/{boroughÂ StatenÂ IslandÂ ,Â QueensÂ ,Â BronxorÂ Brooklyn} å½“è¿™ä¸ªæ¡ä»¶ä¸ºtrueçš„æ—¶å€™,è¿™é‡Œä½¿ç”¨$ninæ“ä½œ
1db.restaurants.find( 2{&#34;borough&#34; :{$nin :[&#34;Staten Island&#34;,&#34;Queens&#34;,&#34;Bronx&#34;,&#34;Brooklyn&#34;]}}, 3{ 4&#34;restaurant_id&#34; : 1, 5&#34;name&#34;:1,&#34;borough&#34;:1, 6&#34;cuisine&#34; :1 7} 8); 20 Write a MongoDB query to find the restaurant Id, name, borough and cuisine for those restaurants which achieved a score which is not more than 10.
è¿™é‡Œçš„æ ¸å¿ƒå°±åœ¨äº not more than 10 ,æ•°å­¦å†™æ³•
Â¬(grades.score&gt;10)â‡”grades.score&lt;=10 \\neg (grades.score &gt; 10) \\Leftrightarrow grades.score &lt;= 10 Â¬(grades.score&gt;10)â‡”grades.score&lt;=101db[&#34;restaurants&#34;].find({&#34;grades.score&#34;: {$lte: 10}}).count() 2 3db.restaurants.find( {&#34;grades.score&#34; : { $not: {$gt : 10} } }).count() æ©&hellip;&hellip;&hellip;.., ä¸¤è€…ç«Ÿç„¶æ˜¯ä¸ä¸€æ ·çš„.
é¢˜ç›®åº”è¯¥é—®çš„æ˜¯: æ‰€æœ‰çš„åˆ†éƒ½ä¸è¶…è¿‡10.
$lte:10 åº”è¯¥æ˜¯åªè¦æœ‰ä¸€ä¸ª(å­˜åœ¨)&lt;=10 å°±æˆç«‹
é‡åˆ°è¿™ç§äº‹ä»¶,åº”è¯¥é¦–å…ˆæŸ¥æ–‡æ¡£: https://www.mongodb.com/zh-cn/docs/manual/reference/operator/query/not/,ä½†æ–‡æ¡£ä¸Šæ²¡æœ‰è¯´.
find({ &quot;grades.score&quot;: {$gt : 10} }) è¡¨ç¤ºçš„æ„æ€å…¶å®æ˜¯: âˆƒ(x&gt;10)\\exists (x &gt; 10)âˆƒ(x&gt;10)
find({ &quot;grades.score&quot;: {$not :{ $gt : 10} }}) è¡¨ç¤ºçš„æ„æ€å…¶å®æ˜¯: Â¬âˆƒ(x&gt;10)â†’âˆ€(x&lt;=10)\\neg \\exists (x &gt; 10) \\to \\forall (x&lt;=10)Â¬âˆƒ(x&gt;10)â†’âˆ€(x&lt;=10),è¿™æ ·å°±èƒ½ç†è§£äº†
`,url:"https://hugo-dead-simple.netlify.com/mongodb/exercise.html"},"https://hugo-dead-simple.netlify.com/mongodb/exercise2.html":{title:"MongoDB ç»ƒä¹  2",tags:["MongoDB","Exercises"],content:`21 Write a MongoDB query to find the restaurant Id, name, borough and cuisine for those restaurants which prepared dish except &lsquo;American&rsquo; and &lsquo;Chinees&rsquo; or restaurant&rsquo;s name begins with letter &lsquo;Wil&rsquo;.
1db.restaurants.find({ 2 $or : [ 3 {&#34;name&#34;: /^Wil/}, 4 {&#34;cuisine&#34; : { $nin :[&#34;American &#34;,&#34;Chinees&#34;] }} 5 ] 6 }) è¿™ä¸¤ä¸ªå†™æ³•æ˜¯ä¸€æ ·çš„
1db.restaurants.find( 2{$or: [ 3 {name: /^Wil/}, 4 {&#34;$and&#34;: [ 5 {&#34;cuisine&#34; : {$ne :&#34;American &#34;}}, 6 {&#34;cuisine&#34; : {$ne :&#34;Chinees&#34;}} 7 ]} 8]} 9,{&#34;restaurant_id&#34; : 1,&#34;name&#34;:1,&#34;borough&#34;:1,&#34;cuisine&#34; :1} 10); 22 Write a MongoDB query to find the restaurant Id, name, and grades for those restaurants which achieved a grade of &ldquo;A&rdquo; and scored 11 on an ISODate &ldquo;2014-08-11T00:00:00Z&rdquo; among many of survey dates. è¾¾åˆ°äº† grade A ä¸” scored 11. é¦–å…ˆ,æˆ‘ä»¬è¦ç†è§£è¿™é‡Œçš„æ„æ€åˆ°åº•æ˜¯ä»€ä¹ˆæ„æ€?
æœ‰ä¸‰ä¸ªæ¡ä»¶:
æ—¶é—´: ISODate &ldquo;2014-08-11T00:00:00Z åˆ†å€¼: 11 grade: A è¿™é‡Œçš„å…³é”®åœ¨äº,æ•°ç»„gradeså…¶ä¸­çš„ä¸€æ¡æ»¡è¶³è¿™3ä¸ªæ¡ä»¶.é‚£ä¹ˆé‡Œè¿™é‡Œè¦ç”¨åˆ°çš„$elemMatch
1db.restaurants.find({ 2 grades:{ $elemMatch : { grade:&#39;A&#39;,date:ISODate(&#34;2014-08-11T00:00:00Z&#34;), scored: 11}} 3 }) ä½†æ˜¯ç»™å‡ºçš„ç­”æ¡ˆæ˜¯,ç†è§£æˆ‘å†™åœ¨æ³¨é‡Šé‡Œ
1db.restaurants.find( 2 { // è¿™é‡Œæ˜¯and 3 &#34;grades.date&#34;: ISODate(&#34;2014-08-11T00:00:00Z&#34;), // è¿™é‡Œåªè¦æœ‰ä¸€ä¸ªæ•°ç»„çš„å…ƒç´ æˆç«‹ 4 &#34;grades.grade&#34;:&#34;A&#34; , // è¿™é‡Œåªè¦æœ‰ä¸€ä¸ªæ•°ç»„çš„å…ƒç´ æˆç«‹ 5 &#34;grades.score&#34; : 11// è¿™é‡Œåªè¦æœ‰ä¸€ä¸ªæ•°ç»„çš„å…ƒç´ æˆç«‹ 6 }, 7 {&#34;restaurant_id&#34; : 1,&#34;name&#34;:1,&#34;grades&#34;:1} 8 ); è¿™é‡Œæ€ä¹ˆç”¨æ•°å­¦æè¿°: è®¾é›†åˆAä¸ºA = [{},{},{},{}], æ»¡è¶³æ¡ä»¶aâˆˆAâˆ§bâˆˆAâˆ§câˆˆAa \\in A \\land b \\in A \\land c \\in AaâˆˆAâˆ§bâˆˆAâˆ§câˆˆA
23 Write a MongoDB query to find the restaurant Id, name and grades for those restaurants where the 2nd element of grades array contains a grade of &ldquo;A&rdquo; and score 9 on an ISODate &ldquo;2014-08-11T00:00:00Z&rdquo;.
arrayElemAtï¼ˆå¦‚æœä½ éœ€è¦æ˜ç¡®é€‰æ‹©æ•°ç»„ä¸­çš„ç‰¹å®šå…ƒç´ ï¼‰
å¦‚æœä½ æ˜ç¡®åªæƒ³è¦æŸ¥è¯¢æ•°ç»„çš„ç¬¬äºŒä¸ªå…ƒç´ ï¼ŒelemMatch ä¸èƒ½ç›´æ¥åšè¿™ä»¶äº‹ã€‚ä¸è¿‡ï¼Œä½ å¯ä»¥ç»“åˆ $arrayElemAt æ¥é€‰æ‹©æ•°ç»„ä¸­çš„ç¬¬äºŒä¸ªå…ƒç´ è¿›è¡Œæ¡ä»¶åŒ¹é…ï¼š
1db.collection.find({ 2 &#34;$expr&#34;: { 3 &#34;$eq&#34;: [ 4 { &#34;$arrayElemAt&#34;: [&#34;$grades&#34;, 1] }, // è·å–ç¬¬äºŒä¸ªå…ƒç´  5 { &#34;grade&#34;: &#34;A&#34;, &#34;score&#34;: 9, &#34;date&#34;: ISODate(&#34;2014-08-11T00:00:00Z&#34;) } // æ¡ä»¶ 6 ] 7 } 8}) é‚£ä¹ˆè¿˜æ˜¯å®˜æ–¹ç»™çš„ç­”æ¡ˆæ¯”è¾ƒç®€å•:
1db.restaurants.find( 2 { &#34;grades.1.date&#34;: ISODate(&#34;2014-08-11T00:00:00Z&#34;), 3 &#34;grades.1.grade&#34;:&#34;A&#34; , 4 &#34;grades.1.score&#34; : 9 5 }, 6 {&#34;restaurant_id&#34; : 1,&#34;name&#34;:1,&#34;grades&#34;:1} 7 ); 24 Write a MongoDB query to find the restaurant Id, name, address and geographical location for those restaurants where 2nd element of coord array contains a value which is more than 42 and upto 52.
æ²¡æœ‰äº‰è®®
1db.restaurants.find( 2 { 3 &#34;address.coord.1&#34;: {$gt : 42, $lte : 52} 4 }, 5 {&#34;restaurant_id&#34; : 1,&#34;name&#34;:1,&#34;address&#34;:1,&#34;coord&#34;:1} 6 ); 25,26 Write a MongoDB query to arrange the name of the restaurants in ascending order along with all the columns. Write a MongoDB query to arrange the name of the restaurants in descending along with all the columns. å°±æ˜¯æ’åºè€Œå·²
1db.restaurants.find().sort({&#34;name&#34;:1}); 2db.restaurants.find().sort( {&#34;name&#34;:-1}); 27 Write a MongoDB query to arranged the name of the cuisine in ascending order and for that same cuisine borough should be in descending order.
è¿˜æ˜¯æ’åº,ä¸è¿‡åŒæ—¶è¦æ’åºä¸¤ä¸ªå…ƒç´ 
1db.restaurants.find().sort( 2 {&#34;cuisine&#34;:1,&#34;borough&#34; : -1,} 3 ); 28 Write a MongoDB query to know whether all the addresses contains the street or not.
æŸ¥è¯¢å…ƒç´ çš„å­˜åœ¨æ€§
1db.restaurants.find( {&#34;address.street&#34; : { $exists : true } } ); 29 Write a MongoDB query which will select all documents in the restaurants collection where the coord field value is Double.
æŸ¥è¯¢å…ƒç´ çš„ç±»å‹
å¯¹äº field ä¸ºæ•°ç»„çš„æ–‡æ¡£ï¼Œ$type è¿”å›çš„æ–‡æ¡£ä¸­è‡³å°‘æœ‰ä¸€ä¸ªæ•°ç»„å…ƒç´ ä¸ä¼ é€’ç»™ $type çš„ç±»å‹åŒ¹é…ã€‚
å¯¹ $type: &ldquo;array&rdquo; çš„æŸ¥è¯¢ä¼šè¿”å›å­—æ®µæœ¬èº«ä¸ºæ•°ç»„çš„æ–‡æ¡£ã€‚
$type â€” MongoDB æ‰‹å†Œ v8.0
1db.restaurants.find( {&#34;address.coord&#34; : {$type : 1} }); 30 Write a MongoDB query which will select the restaurant Id, name and grades for those restaurants which returns 0 as a remainder after dividing the score by 7.
è¿™é‡Œç”¨åˆ°äº† $mod - MongoDB æ‰‹å†Œ v8.0
1db.restaurants.find( 2 {&#34;grades.score&#34; : 3 {$mod : [7,0]} 4 }, 5 {&#34;restaurant_id&#34; : 1,&#34;name&#34;:1,&#34;grades&#34;:1} 6 ); 31 Write a MongoDB query to find the restaurant name, borough, longitude and attitude and cuisine for those restaurants which contains &lsquo;mon&rsquo; as three letters somewhere in its name.
æ­£åˆ™æŸ¥è¯¢
1db.restaurants.find( 2 { name : 3 { $regex : &#34;mon.*&#34;, $options: &#34;i&#34; } 4 }, 5 { 6 &#34;name&#34;:1, 7 &#34;borough&#34;:1, 8 &#34;address.coord&#34;:1, 9 &#34;cuisine&#34; :1 10 } 11 ); 32 Write a MongoDB query to find the restaurant name, borough, longitude and latitude and cuisine for those restaurants which contain &lsquo;Mad&rsquo; as first three letters of its name.
æ­£åˆ™æŸ¥è¯¢
1db.restaurants.find( 2 { name : 3 { $regex : /^Mad/i, } 4 }, 5 { 6 &#34;name&#34;:1, 7 &#34;borough&#34;:1, 8 &#34;address.coord&#34;:1, 9 &#34;cuisine&#34; :1 10 } 11 ); 33 Write a MongoDB query to find the restaurants that have at least one grade with a score of less than 5.
æ•°ç»„æŸ¥è¯¢
1db.restaurants.find({ &#34;grades.score&#34;: { $lt: 5 } }) 34 Write a MongoDB query to find the restaurants that have at least one grade with a score of less than 5 and that are located in the borough of Manhattan.
æ€ä¹ˆå˜ç®€å•äº†?
1db.restaurants.find({ &#34;grades.score&#34;: { $lt: 5 }, &#34;borough&#34;: &#34;Manhattan&#34; }) 35 Write a MongoDB query to find the restaurants that have at least one grade with a score of less than 5 and that are located in the borough of Manhattan or Brooklyn.
è¿˜æ˜¯ç®€å•
1db.restaurants.find({ 2 $and: [ 3 { 4 $or: [ // å¯ä»¥ç”¨$in 5 {borough: &#34;Manhattan&#34;}, 6 {borough: &#34;Brooklyn&#34;} 7 ] 8 }, 9 { 10 &#34;grades.score&#34;: { $lt: 5 } 11 } 12 ] 13}) 36 Write a MongoDB query to find the restaurants that have at least one grade with a score of less than 5 and that are located in the borough of Manhattan or Brooklyn, and their cuisine is not American.
å®˜æ–¹ç»™çš„è¿™ä¸ªç­”æ¡ˆ,å¯ä»¥ä¸ç”¨æœ€å¤–å±‚çš„$and
1db.restaurants.find({ 2 $and: [ 3{ $or: [{ borough: &#34;Manhattan&#34; }, { borough: &#34;Brooklyn&#34; }] }, 4{ &#34;grades.score&#34;: { $lt: 5 } }, 5{ cuisine: { $ne: &#34;American&#34; } } 6 ] 7}) 37 Write a MongoDB query to find the restaurants that have at least one grade with a score of less than 5 and that are located in the borough of Manhattan or Brooklyn, and their cuisine is not American or Chinese.
è¿™é‡Œç”¨åˆ°äº†ä¸æ˜¯...,ä¹Ÿä¸æ˜¯....è¿™ä¸ªä¹Ÿè¯­æ³•
$nor - MongoDB æ‰‹å†Œ v8.0
é€‰æ‹©æ•°ç»„ä¸­æ‰€æœ‰æŸ¥è¯¢è°“è¯å‡æœªé€šè¿‡çš„æ–‡æ¡£
1$nor :[ expr1 ,expr2...] é‚£ä¹ˆæŸ¥è¯¢çš„æ–‡æ¡£æ»¡è¶³çš„æ¡ä»¶æ˜¯ï¼š
1expr1(doc1) == false and expr2(doc2) == false 38 Write a MongoDB query to find the restaurants that have a grade with a score of 2 and a grade with a score of 6.
grades å«æœ‰2ï¼Œå’Œ6
æˆ‘å†™çš„
1db.restaurants.find({ 2 &#34;grades.score&#34;: 2, 3 &#34;grades.score&#34;: 6, 4 }) æ•ˆæœä¸€æ ·çš„å®˜æ–¹ç­”æ¡ˆã€‚
1db.restaurants.find({ 2 $and: [ 3 {&#34;grades.score&#34;: 2}, 4 {&#34;grades.score&#34;: 6} 5 ] 6}) 39 Write a MongoDB query to find the restaurants that have a grade with a score of 2 and a grade with a score of 6 and are located in the borough of Manhattan.
æ²¡æœ‰ä»€ä¹ˆéš¾åº¦
1db.restaurants.find({ 2 $and: [ 3 {&#34;grades.score&#34;: 2}, 4 {&#34;grades.score&#34;: 6}, 5 {&#34;borough&#34;: &#34;Manhattan&#34;} 6 ] 7}) 40 Write a MongoDB query to find the restaurants that have a grade with a score of 2 and a grade with a score of 6 and are located in the borough of Manhattan or Brooklyn.
1db.restaurants.find({ 2 $and: [ 3 {&#34;grades.score&#34;: 2}, 4 {&#34;grades.score&#34;: 6}, 5 {&#34;borough&#34;: {&#34;$in&#34;: [&#34;Manhattan&#34;, &#34;Brooklyn&#34;]}} 6 ] 7}) `,url:"https://hugo-dead-simple.netlify.com/mongodb/exercise2.html"},"https://hugo-dead-simple.netlify.com/mongodb/exercise3.html":{title:"MongoDB ç»ƒä¹  3",tags:["MongoDB","Exercises"],content:`41 Write a MongoDB query to find the restaurants that have a grade with a score of 2 and a grade with a score of 6 and are located in the borough of Manhattan or Brooklyn, and their cuisine is not American.
æ²¡æœ‰ä»€ä¹ˆéš¾åº¦
1db.restaurants.find({ 2 $and: [ 3 {borough: {$in: [&#34;Manhattan&#34;, &#34;Brooklyn&#34;]}}, 4 {&#34;grades.score&#34;: {$all: [2, 6]}}, 5 {cuisine: {$ne: &#34;American&#34;}} 6 ] 7}) è¿™é‡Œç”¨åˆ°äº†$allè¿ç®—ç¬¦, è¡¨ç¤ºåé¢çš„å€¼[2,6]éƒ½è¦å•ç‹¬åŒæ—¶åŒ¹é…
42 Write a MongoDB query to find the restaurants that have a grade with a score of 2 and a grade with a score of 6 and are located in the borough of Manhattan or Brooklyn, and their cuisine is not American or Chinese.
1db.restaurants.find({ 2 $and: [ 3{ borough: { $in: [&#34;Manhattan&#34;, &#34;Brooklyn&#34;] } }, 4{ cuisine: { $nin: [&#34;American&#34;, &#34;Chinese&#34;] } }, 5{ grades: { $elemMatch: { score: 2 } } }, 6{ grades: { $elemMatch: { score: 6 } } } 7 ] 8}) 43 Write a MongoDB query to find the restaurants that have a grade with a score of 2 or a grade with a score of 6.
1db.restaurants.find({ 2 $or: [ 3{ &#34;grades.score&#34;: 2 }, 4{ &#34;grades.score&#34;: 6 } 5 ] 6}) 44 Write a MongoDB query to find the restaurants that have a grade with a score of 2 or a grade with a score of 6 and are located in the borough of Manhattan.
æ²¡æœ‰ä»€ä¹ˆéš¾åº¦
1db.restaurants.find({ 2 $and: [ 3 { 4 $or: [ 5{ &#34;grades.score&#34;: 2 }, 6{ &#34;grades.score&#34;: 6 } 7 ] 8 }, 9{ &#34;borough&#34;: &#34;Manhattan&#34; } 10 ] 11}) 45 Write a MongoDB query to find the restaurants that have a grade with a score of 2 or a grade with a score of 6 and are located in the borough of Manhattan or Brooklyn.
1db.restaurants.find({ 2 $and: [ 3 { 4 $or: [ 5{ borough: &#34;Manhattan&#34; }, 6{ borough: &#34;Brooklyn&#34; } 7 ] 8 }, 9 { 10 $or: [ 11{ &#34;grades.score&#34;: 2 }, 12{ &#34;grades.score&#34;: 6 } 13 ] 14 } 15 ] 16}) 48 Write a MongoDB query to find the restaurants that have all grades with a score greater than 5.
è¿™ä¸ªæ˜¯æ¯”è¾ƒæœ‰æ„æ€çš„æŸ¥è¯¢: æ‰€æœ‰grade.scoreéƒ½è¦å¤§äº5
æ­£ç¡®çš„æŸ¥è¯¢æ•°ç»„é‡Œçš„å€¼,éƒ½æ˜¯å­˜åœ¨,ç°åœ¨è¦è½¬æˆ\\forall
1db.restaurants.find({ 2 &#34;grades&#34;: { 3 &#34;$not&#34;: { 4 &#34;$elemMatch&#34;: { 5 &#34;score&#34;: { 6 &#34;$lte&#34;: 5 7 } 8 } 9 } 10 } 11}) 49 Write a MongoDB query to find the restaurants that have all grades with a score greater than 5 and are located in the borough of Manhattan.
å¤šä¸ªæ¡ä»¶,å…³é”®å°±åœ¨äºè¿™ä¸ªæ¡ä»¶:æ‰€æœ‰çš„
50 Write a MongoDB query to find the restaurants that have all grades with a score greater than 5 and are located in the borough of Manhattan or Brooklyn.
ä¸éš¾,è¿™é‡Œæœ‰ä¸€ä¸ªæ¡ä»¶,æˆ–è€…
1db.restaurants.find({ 2 &#34;borough&#34;: { 3 &#34;$in&#34;: [&#34;Manhattan&#34;, &#34;Brooklyn&#34;] 4 }, 5 &#34;grades&#34;: { 6 &#34;$not&#34;: { 7 &#34;$elemMatch&#34;: { 8 &#34;score&#34;: { 9 &#34;$lte&#34;: 5 10 } 11 } 12 } 13 } 14}) `,url:"https://hugo-dead-simple.netlify.com/mongodb/exercise3.html"},"https://hugo-dead-simple.netlify.com/mongodb/exercise4.html":{title:"MongoDB ç»ƒä¹  4",tags:["MongoDB","Exercises"],content:`51 Write a MongoDB query to find the average score for each restaurant.
ä¸€ä¸ªæ•°ç»„çš„å¹³å‡å€¼
è¿™é‡Œæˆ‘é‡åˆ°çš„ç¬¬ä¸€ä¸ª aggregate
1db.restaurants.aggregate([{ 2 $unwind: &#34;$grades&#34; 3 }, 4 { 5 $group: { 6 _id: &#34;$name&#34;, 7 avgScore: { 8 $avg: &#34;$grades.score&#34; 9 } 10 } 11 } 12]) è¿™é‡Œgptç»™å‡ºçš„å¤šç§æ±‚å¹³å‡å€¼çš„æ–¹æ³•
åœ¨ MongoDB ä¸­ï¼Œè¦æ±‚æ•°ç»„çš„å¹³å‡å€¼å¯ä»¥ä½¿ç”¨ èšåˆæ¡†æ¶ æ¥å¤„ç†ã€‚MongoDB çš„èšåˆæ¡†æ¶æä¾›äº†å¼ºå¤§çš„æ•°æ®æ“ä½œåŠŸèƒ½ï¼ŒåŒ…æ‹¬è®¡ç®—æ•°ç»„ä¸­å…ƒç´ çš„å¹³å‡å€¼ã€‚å¯ä»¥é€šè¿‡ä»¥ä¸‹å‡ ç§æ–¹å¼æ¥å®ç°ï¼š
å‡è®¾æˆ‘ä»¬æœ‰ä»¥ä¸‹æ–‡æ¡£é›†åˆï¼š 1{ 2 &#34;_id&#34;: 1, 3 &#34;scores&#34;: [90, 80, 70, 85] 4}, 5{ 6 &#34;_id&#34;: 2, 7 &#34;scores&#34;: [60, 75, 85, 90] 8} æ–¹æ³• 1ï¼šä½¿ç”¨ $avg æ“ä½œç¬¦ MongoDB çš„èšåˆæ¡†æ¶å…è®¸åœ¨ç®¡é“ä¸­ä½¿ç”¨ $avg æ“ä½œç¬¦æ¥è®¡ç®—æŸä¸ªæ•°ç»„çš„å¹³å‡å€¼ã€‚ä¸ºäº†è®¡ç®—æ•°ç»„ scores çš„å¹³å‡å€¼ï¼Œæˆ‘ä»¬éœ€è¦å…ˆå°†æ•°ç»„å…ƒç´ å±•å¼€ï¼ˆä½¿ç”¨ $unwindï¼‰ï¼Œç„¶åè®¡ç®—å¹³å‡å€¼ã€‚
èšåˆç®¡é“ç¤ºä¾‹ï¼š 1db.collection.aggregate([ 2 { 3 $project: { 4 averageScore: { $avg: &#34;$scores&#34; } 5 } 6 } 7]) è§£é‡Šï¼š $projectï¼šç”¨äºæŒ‡å®šè¾“å‡ºçš„å­—æ®µï¼Œåœ¨è¿™é‡Œæˆ‘ä»¬æŒ‡å®šäº†ä¸€ä¸ªæ–°å­—æ®µ averageScoreã€‚ $avgï¼šç”¨äºè®¡ç®—æŒ‡å®šå­—æ®µçš„å¹³å‡å€¼ã€‚åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬åº”ç”¨ $avg æ“ä½œç¬¦æ¥è®¡ç®— scores æ•°ç»„çš„å¹³å‡å€¼ã€‚ æ–¹æ³• 2ï¼šä½¿ç”¨ $unwind ä¸ $group æ¥æ±‚å¹³å‡å€¼ å¦‚æœä½ æƒ³æ›´ç»†ç²’åº¦åœ°å¤„ç†æ•°ç»„ä¸­çš„å…ƒç´ ï¼Œå¯ä»¥ä½¿ç”¨ $unwind æ¥å±•å¹³æ•°ç»„ï¼Œç„¶åä½¿ç”¨ $group æ¥æ±‚æ•°ç»„çš„å¹³å‡å€¼ã€‚
èšåˆç®¡é“ç¤ºä¾‹ï¼š 1db.collection.aggregate([ 2 { $unwind: &#34;$scores&#34; }, 3 { $group: { _id: null, averageScore: { $avg: &#34;$scores&#34; } } } 4]) è§£é‡Šï¼š $unwindï¼šå°† scores æ•°ç»„ä¸­çš„æ¯ä¸ªå…ƒç´ å±•å¹³ä¸ºå•ç‹¬çš„æ–‡æ¡£ã€‚æ¯ä¸ªæ–‡æ¡£å°†åŒ…å«ä¸€ä¸ªæ•°ç»„å…ƒç´ ã€‚ $groupï¼šå°†æ‰€æœ‰å±•å¹³åçš„æ–‡æ¡£ç»„åˆåœ¨ä¸€èµ·ï¼Œå¹¶ä½¿ç”¨ $avg æ¥è®¡ç®—è¿™äº›æ–‡æ¡£ä¸­ scores å­—æ®µçš„å¹³å‡å€¼ã€‚ è¿™ä¸ªæ–¹æ³•é€‚ç”¨äºå½“ä½ å¸Œæœ›å¯¹æ•°ç»„ä¸­çš„æ‰€æœ‰å…ƒç´ è¿›è¡Œå¤„ç†å¹¶è®¡ç®—å¹³å‡å€¼çš„æƒ…å†µã€‚
æ–¹æ³• 3ï¼šç›´æ¥è®¡ç®—å­—æ®µçš„å¹³å‡å€¼ å¦‚æœæ•°ç»„å­—æ®µæœ¬èº«å·²ç»åŒ…å«äº†æ‰€æœ‰çš„æ•°å€¼ï¼Œä¸”ä½ åªæƒ³è®¡ç®—è¿™ä¸ªæ•°ç»„å­—æ®µçš„å¹³å‡å€¼ï¼Œè€Œä¸æ˜¯æ•°ç»„ä¸­çš„æ¯ä¸ªå…ƒç´ ï¼Œå¯ä»¥ç›´æ¥åœ¨ aggregate é˜¶æ®µä¸­è®¡ç®—å¹³å‡å€¼ï¼š
ç¤ºä¾‹ï¼š 1db.collection.aggregate([ 2 { 3 $project: { 4 averageScore: { $avg: &#34;$scores&#34; } 5 } 6 } 7]) æ€»ç»“ï¼š $avg ç”¨äºè®¡ç®—ä¸€ä¸ªæ•°å€¼å­—æ®µçš„å¹³å‡å€¼ï¼Œå¯ä»¥ç›´æ¥åœ¨èšåˆç®¡é“ä¸­å¯¹æ•°ç»„å­—æ®µè¿›è¡Œæ“ä½œã€‚ $unwind + $group é€‚ç”¨äºéœ€è¦å°†æ•°ç»„å…ƒç´ åˆ†å¼€å¤„ç†ï¼Œå¹¶æ±‚æ‰€æœ‰å…ƒç´ çš„å¹³å‡å€¼ã€‚ æ ¹æ®éœ€æ±‚é€‰æ‹©é€‚åˆçš„æ–¹æ³•ï¼Œé€šå¸¸æƒ…å†µä¸‹ï¼Œç›´æ¥ä½¿ç”¨ $avg å¯¹æ•°ç»„å­—æ®µæ±‚å¹³å‡å€¼æœ€ä¸ºç®€å•å’Œé«˜æ•ˆã€‚
52 Write a MongoDB query to find the highest score for each restaurant.
è¿™é‡Œç”¨åˆ°äº† $groupé˜¶æ®µçš„$maxæ“ä½œ
1db.restaurants.aggregate([{ 2 $unwind: &#34;$grades&#34; 3 }, 4 { 5 $group: { 6 _id: &#34;$name&#34;, 7 highest_score: { 8 $max: &#34;$grades.score&#34; 9 } 10 } 11 } 12]) 53 Write a MongoDB query to find the lowest score for each restaurant.
å’Œä¸Šä¸€ä¸ªé¢˜ç›®ä¸€æ ·ï¼Œç”¨$min
1db.restaurants.aggregate([{ 2 $unwind: &#34;$grades&#34; 3 }, 4 { 5 $group: { 6 _id: &#34;$name&#34;, 7 lowest_score: { 8 $min: &#34;$grades.score&#34; 9 } 10 } 11 } 12]) 54 Write a MongoDB query to find the count of restaurants in each borough.
ç”¨åˆ°äº†count
1db.restaurants.aggregate([{ 2 $group: { 3 _id: &#34;$borough&#34;, 4 count: { 5 $sum: 1 6 } 7 } 8}]) 55 Write a MongoDB query to find the count of restaurants for each cuisine.
åªæ˜¯ç”¨åˆ°äº†$sum
1db.restaurants.aggregate([{ 2 $group: { 3 _id: &#34;$cuisine&#34;, 4 count: { 5 $sum: 1 6 } 7 } 8}]) 56 å¦‚ä½•æŒ‰ä¸¤ä¸ªå€¼è¿›è¡Œåˆ†ç»„ 1db.restaurants.aggregate([{ 2 $group: { 3 _id: { 4 cuisine: &#34;$cuisine&#34;, 5 borough: &#34;$borough&#34; 6 }, 7 count: { 8 $sum: 1 9 } 10 } 11}]) 57 å¤šé˜¶æ®µé…åˆ Write a MongoDB query to find the count of restaurants that received a grade of &lsquo;A&rsquo; for each cuisine.
å¤šé˜¶æ®µ
unwind match group 1db.restaurants.aggregate([ 2 { 3 $unwind: &#34;$grades&#34; 4 }, 5 { 6 $match: { &#34;grades.grade&#34;: &#34;A&#34; } 7 }, 8 { 9 $group: { 10 _id: &#34;$cuisine&#34;, 11count: { $sum: 1 } 12 } 13 } 14]) 58 åŒä¸Š Write a MongoDB query to find the count of restaurants that received a grade of &lsquo;A&rsquo; for each borough.
1db.restaurants.aggregate([ 2 { 3 $unwind: &#34;$grades&#34; 4 }, 5 { 6 $match: { &#34;grades.grade&#34;: &#34;A&#34; } 7 }, 8 { 9 $group: { 10 _id: &#34;$borough&#34;, 11count: { $sum: 1 } 12 } 13 } 14]) 59 Write a MongoDB query to find the count of restaurants that received a grade of &lsquo;A&rsquo; for each cuisine and borough.
èšåˆç¡®å®èƒ½è¾¾åˆ°
è¿™é‡Œæ²¡æœ‰unwind
1db.restaurants.aggregate([ 2 { 3 $match: { &#34;grades.grade&#34;: &#34;A&#34; } 4 }, 5 { 6 $group: { 7 _id: { cuisine: &#34;$cuisine&#34;, borough: &#34;$borough&#34; }, 8count: { $sum: 1 } 9 } 10 }, 11 { 12 $sort: { count: -1 } 13 } 14]); 60 Write a MongoDB query to find the number of restaurants that have been graded in each month of the year.
é—®ä¸€å¹´ä¸­ï¼Œæ¯ä¸ªæœˆåˆ†è¯„çº§çš„restaurantsåˆ†åˆ«æœ‰å¤šå°‘ä¸ª,é‚£æ˜¾ç„¶è¦$group
1db.restaurants.aggregate([ 2 { 3 $unwind: &#34;$grades&#34; 4 }, 5 { 6 $project: { 7month: { $month: { $toDate: &#34;$grades.date&#34; } }, 8year: { $year: { $toDate: &#34;$grades.date&#34; } } 9 } 10 }, 11 { 12 $group: { 13 _id: { month: &#34;$month&#34;, year: &#34;$year&#34; }, 14count: { $sum: 1 } 15 } 16 }, 17 { 18 $sort: { 19 &#34;_id.year&#34;: 1, 20 &#34;_id.month&#34;: 1 21 } 22 } 23]); 61-66 å¹³å‡åˆ†,æœ€é«˜ä½åˆ† ä¸Šé¢æ±‚è¿‡äº†
67 Write a MongoDB query to find the name and address of the restaurants that received a grade of &lsquo;A&rsquo; on a specific date
æŸ¥è¯¢ä¸€ä¸ªarrayé‡Œæ»¡è¶³ç‰¹å®šæ¡ä»¶çš„ã€‚
1db.restaurants.find( 2 { 3 &#34;grades&#34;: { 4 &#34;$elemMatch&#34;: { 5 &#34;date&#34;: { 6 &#34;$eq&#34;: ISODate(&#34;2013-07-22T00:00:00Z&#34;) 7 }, 8 &#34;grade&#34;: { 9 &#34;$eq&#34;: &#34;A&#34; 10 } 11 } 12 } 13 }, 14 { 15 &#34;name&#34;: 1, 16 &#34;address&#34;: 1, 17 &#34;_id&#34;: 0 18 } 19) 68 Write a MongoDB query to find the name and address of the restaurants that received a grade of &lsquo;B&rsquo; or &lsquo;C&rsquo; on a specific date.
1db.restaurants.find( 2 { 3 &#34;grades&#34;: { 4 $elemMatch: { 5 &#34;date&#34;: ISODate(&#34;2013-04-05&#34;), 6 &#34;grade&#34;: { $in: [ &#34;B&#34;, &#34;C&#34; ] } 7 } 8 } 9 }, 10 { 11 &#34;name&#34;: 1, 12 &#34;address&#34;: 1 13 } 14) 69 Write a MongoDB query to find the name and address of the restaurants that have at least one &lsquo;A&rsquo; grade and one &lsquo;B&rsquo; grade.
å•Šï¼ æŸ¥è¯¢æ•°ç»„é‡Œï¼š è‡³å°‘å«æœ‰ä¸€ä¸ªAï¼Œä¸”è‡³å°‘å«æœ‰ä¸€ä¸ªB ,\\exits A in arr \\and \\exits B in arr
70 Write a MongoDB query to find the name and address of the restaurants that have at least one &lsquo;A&rsquo; grade and no &lsquo;B&rsquo; grades.
one A no B.ä¸¤ä¸ªæ¡ä»¶åŒæ—¶æˆç«‹
no b -&gt; not exits b in Arr -&gt; {$not : { &quot;grades.score&quot; : 'A'}
å’Œæˆ‘æƒ³çš„å·®ä¸å¤š
1db.restaurants.find({ 2 $and: [ 3{ &#34;grades.grade&#34;: &#34;A&#34; }, 4{ &#34;grades.grade&#34;: { $not: { $eq: &#34;B&#34; } } } 5 ] 6}, 7{ name: 1, address: 1, _id: 0 }) 71 Write a MongoDB query to find the name ,address and grades of the restaurants that have at least one &lsquo;A&rsquo; grade and no &lsquo;C&rsquo; grades.
åŒä¸Š
1db.restaurants.find({ 2 $and: [ 3{ &#34;grades.grade&#34;: &#34;A&#34; }, 4{ &#34;grades.grade&#34;: { $not: { $eq: &#34;C&#34; } } } 5 ] 6}, 7{ name: 1, address: 1, &#34;grades.grade&#34;:1, _id: 0 }) 72 Write a MongoDB query to find the name, address, and grades of the restaurants that have at least one &lsquo;A&rsquo; grade, no &lsquo;B&rsquo; grades, and no &lsquo;C&rsquo; grades.
åŒä¸Š
1db.restaurants.find({ 2 $and: [ 3{ &#34;grades.grade&#34;: &#34;A&#34; }, 4{ &#34;grades.grade&#34;: { $not: { $eq: &#34;B&#34; } } }, 5{ &#34;grades.grade&#34;: { $not: { $eq: &#34;C&#34; } } } 6 ] 7}, 8{ name: 1, address: 1, &#34;grades.grade&#34;:1, _id: 0 }) 73 Write a MongoDB query to find the name and address of the restaurants that have the word &lsquo;coffee&rsquo; in their name
æ­£åˆ™
1db.restaurants.find({ name: { $regex: /coffee/i } }, { name: 1, address: 1 }) 74 Write a MongoDB query to find the name and address of the restaurants that have a zipcode that starts with &lsquo;10&rsquo;.
è¿™é‡Œæˆ‘è§‰å¾—å®˜æ–¹ç»™çš„ç­”æ¡ˆä¸å¯¹ã€‚
75 Write a MongoDB query to find the name and address of the restaurants that have a cuisine that starts with the letter &lsquo;B&rsquo;.
1db.restaurants.find( 2	{ &#34;cuisine&#34;: { $regex: /^B/ } }, 3	{ &#34;name&#34;: 1, 4	&#34;address&#34;: 1, 5	&#34;cuisine&#34; : 1, 6	&#34;_id&#34;: 0 } 7) 76 77 æ­£åˆ™ æ²¡æœ‰ä»€ä¹ˆå¥½å†™çš„
78 æ‰¾æœ€å¤§å€¼ï¼Œé‚£å°±éœ€è¦æ’åº
1db.restaurants.aggregate([ 2 {$unwind: &#34;$grades&#34;}, 3 {$group: { 4 _id: &#34;$restaurant_id&#34;, 5avgScore: {$avg: &#34;$grades.score&#34;} 6 }}, 7 {$sort: {avgScore: -1}}, 8 {$limit: 1}, 9 {$project: {_id: 1, avgScore: 1}} 10]) 79 æ‰¾æœ€å¤§çš„å€¼Açš„é‚£äº›restaurantsçš„idï¼Œç”¨åˆ°èšåˆ
1db.restaurants.aggregate([ 2 {$unwind: &#34;$grades&#34;}, 3 {$match: {&#34;grades.grade&#34;: &#34;A&#34;}}, 4 {$group: { 5 _id: &#34;$restaurant_id&#34;, 6count: {$sum: 1} 7 }}, 8 {$sort: {count: -1}}, 9 {$group: { 10 _id: &#34;$count&#34;, 11restaurants: {$push: &#34;$_id&#34;} 12 }}, 13 {$sort: {_id: -1}}, 14 {$limit: 1}, 15 {$project: {restaurants: 1}} 16]) 80 Write a MongoDB query to find the cuisine type that is most likely to receive a &lsquo;C&rsquo; grade.
å“ªä¸ªåŒºåŸŸçš„Cæœ€å¤š,ç”¨åˆ°äº†èšåˆ
1db.restaurants.aggregate([ 2 {$unwind: &#34;$grades&#34;}, 3 {$match: {&#34;grades.grade&#34;: &#34;C&#34;}}, 4 {$group: {_id: &#34;$cuisine&#34;, count: {$sum: 1}}}, 5 {$sort: {count: -1}} 6]) 81 Write a MongoDB query to find the restaurant that has the highest average score for thecuisine &ldquo;Turkish&rdquo;.
èšåˆã€‚
82 Write a MongoDB query to find the restaurants that achieved the highest total score.
è¿ç»­çš„èšåˆ,èšåˆå°±æ˜¯ä¸€ç§ç®¡é“ã€‚
1db.restaurants.aggregate([ 2{ $unwind: &#34;$grades&#34; }, 3{ $group: { 4 _id: &#34;$name&#34;, 5totalScore: { $sum: &#34;$grades.score&#34; } 6 }}, 7{ $sort: { totalScore: -1 } }, 8{ $group: { 9 _id: &#34;$totalScore&#34;, 10restaurants: { $push: &#34;$_id&#34; } 11 }}, 12{ $sort: { _id: -1 } }, 13{ $limit: 1 }, 14{ $unwind: &#34;$restaurants&#34; }, 15{ $group: { 16 _id: &#34;$_id&#34;, 17restaurants: { $push: &#34;$restaurants&#34; } 18 }} 19]) 83 `,url:"https://hugo-dead-simple.netlify.com/mongodb/exercise4.html"},"https://hugo-dead-simple.netlify.com/tags/querying.html":{title:"Querying",tags:[],content:"",url:"https://hugo-dead-simple.netlify.com/tags/querying.html"},"https://hugo-dead-simple.netlify.com/typescript/typeof%E7%9A%84%E4%BD%BF%E7%94%A8.html":{title:"typeofçš„ä½¿ç”¨",tags:[],content:`åœ¨ TypeScript ä¸­ï¼Œtypeof æ˜¯ä¸€ä¸ªéå¸¸å¼ºå¤§çš„è¿ç®—ç¬¦ï¼Œå®ƒæœ‰ä¸¤ä¸ªä¸»è¦ç”¨é€”ï¼šä¸€ç§ç”¨äº è·å–å€¼çš„ç±»å‹ï¼Œå¦ä¸€ç§ç”¨äº è·å–ç±»å‹çš„æ„é€ å‡½æ•°ã€‚ä¸‹é¢æˆ‘ä»¬åˆ†åˆ«è§£é‡Šè¿™ä¸¤ç§ç”¨é€”ï¼Œå¹¶ç»™å‡ºä¸€äº›ç¤ºä¾‹ã€‚
1. typeof ç”¨äºè·å–å€¼çš„ç±»å‹ åœ¨ TypeScript ä¸­ï¼Œtypeof å¯ä»¥ç”¨æ¥è·å–ä¸€ä¸ªå€¼çš„ç±»å‹ã€‚ä½ å¯ä»¥é€šè¿‡ typeof æ¥æ¨æ–­æˆ–æ˜¾å¼åœ°è·å–å˜é‡çš„ç±»å‹ã€‚
ç¤ºä¾‹ï¼šè·å–å€¼çš„ç±»å‹ 1let x = &#34;hello&#34;; 2let y: typeof x; // y çš„ç±»å‹ä¼šè‡ªåŠ¨æ¨æ–­ä¸º string 3 4y = &#34;world&#34;; // æ­£ç¡® 5// y = 42; // é”™è¯¯: ç±»å‹ &#39;number&#39; ä¸èƒ½èµ‹å€¼ç»™ç±»å‹ &#39;string&#39; typeof x ä¼šæ¨æ–­å‡ºå˜é‡ x çš„ç±»å‹ã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œx æ˜¯ä¸€ä¸ª stringï¼Œæ‰€ä»¥ y çš„ç±»å‹ä¹Ÿä¼šè¢«æ¨æ–­ä¸º stringã€‚ ä½ å¯ä»¥å°† typeof ç”¨äºå˜é‡å£°æ˜ï¼Œæˆ–è€…åœ¨ç±»å‹æ³¨è§£ä¸­æŒ‡å®šç±»å‹ã€‚ ç¤ºä¾‹ï¼šè·å–å¯¹è±¡å±æ€§çš„ç±»å‹ 1const person = { name: &#34;Alice&#34;, age: 30 }; 2let nameType: typeof person.name; // nameType çš„ç±»å‹æ˜¯ string 3let ageType: typeof person.age; // ageType çš„ç±»å‹æ˜¯ number è¿™é‡Œï¼Œtypeof person.name ä¼šå¾—åˆ° person.name çš„ç±»å‹ï¼ˆå³ stringï¼‰ï¼Œtypeof person.age ä¼šå¾—åˆ° numberã€‚ 2. typeof ç”¨äºè·å–ç±»å‹ typeof è¿˜å¯ä»¥ç”¨æ¥è·å– ç±»å‹çš„æ„é€ å‡½æ•°ï¼Œç‰¹åˆ«æ˜¯åœ¨ä½ éœ€è¦å¼•ç”¨æŸä¸ªç±»å‹æˆ–ç±»å‹çš„æ„é€ å‡½æ•°æ—¶ã€‚è¿™ä¸ªç”¨é€”é€šå¸¸ä¸ keyof ä¸€èµ·ä½¿ç”¨æ¥é™åˆ¶æŸä¸ªå€¼çš„ç±»å‹ã€‚
ç¤ºä¾‹ï¼šè·å–ç±»çš„æ„é€ å‡½æ•°ç±»å‹ 1class Person { 2 name: string; 3 constructor(name: string) { 4 this.name = name; 5 } 6} 7 8let PersonConstructor: typeof Person; // PersonConstructor çš„ç±»å‹æ˜¯ \`typeof Person\`ï¼Œå³æ„é€ å‡½æ•°ç±»å‹ 9PersonConstructor = Person; // æ­£ç¡® 10// PersonConstructor = String; // é”™è¯¯: ç±»å‹ &#39;typeof String&#39; ä¸å…¼å®¹ç±»å‹ &#39;typeof Person&#39; åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œtypeof Person ä¼šè·å– Person ç±»çš„æ„é€ å‡½æ•°ç±»å‹ï¼Œå³ typeof Person å®é™…ä¸Šæ˜¯ new (name: string) =&gt; Personï¼Œè¡¨ç¤ºå¯ä»¥ç”¨æ¥åˆ›å»º Person å®ä¾‹çš„æ„é€ å‡½æ•°ç±»å‹ã€‚ ç¤ºä¾‹ï¼šé€šè¿‡ typeof å¼•ç”¨ç±»å‹æ„é€ å‡½æ•° 1let x: number = 42; 2let y: typeof x; // y çš„ç±»å‹æ˜¯ number 3y = 123; // æ­£ç¡® 4// y = &#34;hello&#34;; // é”™è¯¯: ç±»å‹ &#39;string&#39; ä¸èƒ½èµ‹å€¼ç»™ç±»å‹ &#39;number&#39; è¿™é‡Œï¼Œtypeof x å–å¾—äº† x çš„ç±»å‹ï¼Œx æ˜¯ number ç±»å‹ï¼Œå› æ­¤ y çš„ç±»å‹ä¹Ÿæ˜¯ numberã€‚ 3. typeof ç”¨äºç±»å‹æ¨æ–­ä¸ç±»å‹ä¿æŠ¤ typeof è¿˜å¯ä»¥ç”¨äºç±»å‹ä¿æŠ¤ï¼Œå³åœ¨ç±»å‹åˆ¤æ–­ä¸­å¸®åŠ©æˆ‘ä»¬æ˜ç¡®å˜é‡çš„ç±»å‹ã€‚è¿™å¯¹äºæŸäº›å¤æ‚çš„ç±»å‹æ£€æŸ¥å¾ˆæœ‰ç”¨ã€‚
ç¤ºä¾‹ï¼štypeof åœ¨ç±»å‹ä¿æŠ¤ä¸­çš„åº”ç”¨ 1function printLength(value: string | string[]) { 2 if (typeof value === &#34;string&#34;) { 3 console.log(value.length); // value æ˜¯ string ç±»å‹ 4 } else { 5 console.log(value.length); // value æ˜¯ string[] ç±»å‹ 6 } 7} 8 9printLength(&#34;Hello&#34;); // è¾“å‡º: 5 10printLength([&#34;a&#34;, &#34;b&#34;, &#34;c&#34;]); // è¾“å‡º: 3 typeof value === &quot;string&quot; ç”¨æ¥åˆ¤æ–­ value æ˜¯å¦æ˜¯ string ç±»å‹ï¼Œå¸®åŠ© TypeScript ç¡®å®šåœ¨ if è¯­å¥å—ä¸­çš„ç±»å‹ã€‚ åŒç†ï¼Œå¯ä»¥ä½¿ç”¨ typeof æ¥åˆ¤æ–­å…¶ä»–åŸºæœ¬ç±»å‹ï¼Œå¦‚ numberã€boolean ç­‰ã€‚ 4. typeof ç”¨äºè”åˆç±»å‹å’Œå­—é¢é‡ç±»å‹çš„æ¨æ–­ typeof ä¹Ÿèƒ½ç”¨æ¥æ¨æ–­å­—é¢é‡ç±»å‹ï¼ˆliteral typesï¼‰ã€‚
ç¤ºä¾‹ï¼šæ¨æ–­å­—é¢é‡ç±»å‹ 1const color = &#34;red&#34;; 2type Color = typeof color; // Color çš„ç±»å‹æ˜¯ &#34;red&#34; 3 4let myColor: Color = &#34;red&#34;; // æ­£ç¡® 5// let anotherColor: Color = &#34;blue&#34;; // é”™è¯¯: ç±»å‹ &#39;&#34;blue&#34;&#39; ä¸èƒ½èµ‹å€¼ç»™ç±»å‹ &#39;&#34;red&#34;&#39; åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œtypeof color ä¼šæ¨æ–­å‡º color å˜é‡çš„å­—é¢é‡ç±»å‹ &quot;red&quot;ï¼Œå› æ­¤ Color ç±»å‹å®é™…ä¸Šæ˜¯ &quot;red&quot;ï¼Œè€Œä¸æ˜¯ stringã€‚ æ€»ç»“ typeof è·å–å€¼çš„ç±»å‹ï¼šä½ å¯ä»¥ç”¨ typeof è·å–ä¸€ä¸ªå˜é‡æˆ–å¯¹è±¡çš„ç±»å‹ï¼Œé€šå¸¸ç”¨äºç±»å‹æ¨æ–­æˆ–åŠ¨æ€ç±»å‹èµ‹å€¼ã€‚ typeof è·å–æ„é€ å‡½æ•°ç±»å‹ï¼šå½“ä½ ä½¿ç”¨ typeof å¯¹ç±»è¿›è¡Œæ“ä½œæ—¶ï¼Œå®ƒä¼šè·å–ç±»çš„æ„é€ å‡½æ•°ç±»å‹ï¼Œå¯ä»¥ç”¨äºå¼•ç”¨ç±»å‹çš„æ„é€ å‡½æ•°ã€‚ ç±»å‹ä¿æŠ¤ï¼štypeof åœ¨ç±»å‹ä¿æŠ¤ä¸­å¯ä»¥å¸®åŠ©ä½ æ ¹æ®å€¼çš„ç±»å‹åšå‡ºåˆ¤æ–­ã€‚ å­—é¢é‡ç±»å‹æ¨æ–­ï¼štypeof å¯ä»¥ç”¨äºæ¨æ–­å˜é‡çš„å­—é¢é‡ç±»å‹ï¼Œä»è€Œå®ç°æ›´ç²¾ç¡®çš„ç±»å‹å®šä¹‰ã€‚ é€šè¿‡ typeofï¼Œä½ å¯ä»¥æ›´çµæ´»åœ°åœ¨ TypeScript ä¸­è¿›è¡Œç±»å‹æ¨æ–­ã€ç±»å‹ä¿æŠ¤å’Œç±»å‹çº¦æŸï¼Œå¢å¼ºä»£ç çš„ç±»å‹å®‰å…¨æ€§å’Œå¯ç»´æŠ¤æ€§ã€‚
`,url:"https://hugo-dead-simple.netlify.com/typescript/typeof%E7%9A%84%E4%BD%BF%E7%94%A8.html"},"https://hugo-dead-simple.netlify.com/typescript/typescript_program.html":{title:"typescript_program",tags:[],content:` æœ¬æ–‡ç”± ç®€æ‚¦ SimpRead è½¬ç ï¼Œ åŸæ–‡åœ°å€ chengjingchao.com
ç¬¬ 1 ç«  å¯¼è¨€ä½¿ç”¨ TypeScript å¼€å‘çš„ç¨‹åºæ›´å®‰å…¨ï¼Œå¸¸è§çš„é”™è¯¯éƒ½èƒ½æ£€æŸ¥å‡ºæ¥ï¼Œå†™å‡ºçš„ä»£ç è¿˜å¯ä»¥ä½œä¸ºæ–‡æ¡£ã€‚
å‘è¡¨äº 2022-01-01 | æ›´æ–°äº: 2022-01-06
ä½¿ç”¨ TypeScript å¼€å‘çš„ç¨‹åºæ›´å®‰å…¨ï¼Œå¸¸è§çš„é”™è¯¯éƒ½èƒ½æ£€æŸ¥å‡ºæ¥ï¼Œå†™å‡ºçš„ä»£ç è¿˜å¯ä»¥ä½œä¸ºæ–‡æ¡£ã€‚
æ›´å®‰å…¨æ˜¯æŒ‡ç±»å‹å®‰å…¨
ç±»å‹å®‰å…¨ï¼šå€ŸåŠ©ç±»å‹é¿å…ç¨‹åºåšæ— æ•ˆçš„äº‹æƒ…ï¼ˆæ— æ•ˆæŒ‡çš„æ˜¯è¿è¡Œæ—¶ç¨‹åºå´©æºƒæˆ–æœªå´©æºƒï¼Œä½†åšçš„äº‹æƒ…æ¯«æ— æ„ä¹‰
ä¸¾ä¸ª ğŸŒ°
æ•°å­—ä¹˜ä»¥ä¸€ä¸ªåˆ—è¡¨
æ¥æ”¶æ•°å­—çš„å‡½æ•°å´ä¼ å…¥äº†å­—ç¬¦ä¸²
è°ƒç”¨å¯¹è±¡ä¸Šä¸å­˜åœ¨çš„æ–¹æ³•
å¯¼å…¥å·²ç»è¢«ç§»é™¤çš„æ¨¡å—
13 + [] // &#34;3&#34; 2 3 4let obj = {} 5obj.foo // undefined 6 7 8function a(b) { 9 return b/2 10} 11a(&#39;z&#39;) // NaN åœ¨åšæ— æ•ˆäº‹æƒ…çš„æ—¶å€™ï¼ŒJavaScript æ²¡æœ‰æŠ›å‡ºå¼‚å¸¸ï¼Œè€Œæ˜¯å°½è‡ªå·±æ‰€èƒ½ï¼Œé¿å…æŠ›å‡ºå¼‚å¸¸ã€‚
è€Œ JavaScript è¿™ç§ç‰¹æ€§è®©ä»£ç ä¸­é”™è¯¯çš„äº§ç”Ÿä¸å‘ç°è„±èŠ‚äº†ã€‚å¯¼è‡´ bug å¾€å¾€æ˜¯ç”±ä»–äººè½¬å‘Šç»™ä½ çš„ã€‚ åˆ°çœŸæ­£è¿è¡Œæ—¶å¯èƒ½æ‰ä¼šå‘ç°é”™è¯¯ã€‚
è€Œ TypeScript ç»™å‡ºé”™è¯¯çš„æ—¶é—´ç‚¹ï¼šåœ¨è¾“å…¥ä»£ç çš„è¿‡ç¨‹ä¸­ï¼Œä»£ç ç¼–è¾‘å™¨ä¼šç»™å‡ºé”™è¯¯æ¶ˆæ¯ï¼Œæ¥æé†’ä½ ã€‚
13 + [] // Error TS2365: Operator &#39;+&#39; cannot be applied to types &#39;3&#39; and &#39;never[]&#39;. 2 3 4let obj = {} 5obj.foo // Error TS2339: Property &#39;foo&#39; does not exist on type &#39;{}&#39; 6 7function (a: number) { 8 return b / 2 9} 10a(&#39;z&#39;) // Error TS2345: Argument of type &#39;&#34;z&#34;&#39; is not assignable to parameter of type &#39;number&#39;. ç¼–è¯‘å™¨ TypeScript ç¼–è¯‘å™¨ï¼ˆTSCï¼‰
é€šå¸¸è¿è¡Œç¨‹åºçš„å¤§è‡´æµç¨‹
æŠŠç¨‹åºè§£æä¸º AST AST ç¼–è¯‘æˆå­—èŠ‚ç  è¿è¡Œæ—¶è®¡ç®—å­—èŠ‚ç  è¿è¡Œç¨‹åºå°±æ˜¯è®©è¿è¡Œæ—¶è®¡ç®—ç”±ç¼–è¯‘å™¨ä»æºç è§£æå¾—æ¥çš„ AST ç”Ÿæˆçš„å­—èŠ‚ç ã€‚
TypeScript çš„ç‰¹æ®Šä¹‹å¤„åœ¨äºï¼Œä¸ç›´æ¥ç¼–è¯‘æˆå­—èŠ‚ç ï¼Œè€Œæ˜¯ç¼–è¯‘æˆ JavaScriptã€‚ç„¶åå†åƒå¾€å¸¸ä¸€æ ·ï¼Œåœ¨æµè§ˆå™¨ / NodeJS ä¸­è¿è¡Œã€‚
TypeScript ç¼–è¯‘å™¨ç”Ÿæˆ AST ä¹‹åï¼ŒçœŸæ­£è¿è¡Œä»£ç ä¹‹å‰ä¼šå¯¹ä»£ç åšç±»å‹æ£€æŸ¥ã€‚
ç±»å‹æ£€æŸ¥å™¨ï¼šæ£€æŸ¥ä»£ç æ˜¯å¦ç¬¦åˆå®‰å…¨è¦æ±‚çš„ç‰¹æ®Šç¨‹åº
ç¼–è¯‘å’Œè¿è¡Œ TypeScript (1-3 ç”± TSC æ“ä½œï¼Œ4-6 ç”±æµè§ˆå™¨ / NodeJS æ“ä½œ)
TypeScript æºç  -&gt; TypeScript AST
ç±»å‹æ£€æŸ¥å™¨æ£€æŸ¥ AST
TypeScript AST -&gt; JavaScript æºç 
JavaScript æºç  -&gt; JavaScript AST
AST -&gt; å­—èŠ‚ç 
è¿è¡Œæ—¶è®¡ç®—å­—èŠ‚ç 
ç±»å‹åªåœ¨ç±»å‹æ£€æŸ¥è¿™ä¸€æ­¥ä½¿ç”¨ï¼ŒTSC æŠŠ TS ç¼–è¯‘æˆ JS æ—¶ï¼Œä¸ä¼šè€ƒè™‘ç±»å‹ã€‚å¯ä»¥ç¡®ä¿å¯ä»¥éšæ„æ”¹åŠ¨ã€æ›´æ–°å’Œæ”¹è¿›ç¨‹åºä¸­çš„ç±»å‹ï¼Œè€Œæ— éœ€æ‹…å¿ƒä¼šç ´ååº”ç”¨çš„åŠŸèƒ½ã€‚
ç±»å‹ç³»ç»Ÿ ç±»å‹ç³»ç»Ÿï¼šç±»å‹æ£€æŸ¥å™¨ä¸ºç¨‹åºåˆ†é…ç±»å‹æ—¶ä½¿ç”¨çš„ä¸€ç³»åˆ—è§„åˆ™
ä¸€èˆ¬æ¥è¯´ï¼Œç±»å‹ç³»ç»Ÿæœ‰ä¸¤ç§ï¼Œå„æœ‰åˆ©å¼Š
é€šè¿‡æ˜¾å¼å¥æ³•å‘Šè¯‰ç¼–è¯‘å™¨æ‰€æœ‰å€¼çš„ç±»å‹ è‡ªåŠ¨æ¨å¯¼å€¼çš„ç±»å‹ JavaScript åœ¨è¿è¡Œæ—¶æ¨å¯¼ç±»å‹ TypeScript èº«å…¼ä¸¤ç§ç±»å‹ç³»ç»Ÿï¼Œå¯ä»¥æ˜¾å¼æ³¨è§£ç±»å‹ï¼Œä¹Ÿå¯ä»¥è‡ªåŠ¨æ¨å¯¼å¤šæ•°ç±»å‹ã€‚
æ˜¾ç¤ºå£°æ˜ç±»å‹éœ€è¦ä½¿ç”¨æ³¨è§£ã€‚æ³¨è§£çš„å½¢å¼ value: typeï¼Œå°±åƒæ˜¯å‘Šè¯‰ç±»å‹æ£€æŸ¥å™¨ï¼Œâ€œå˜¿ï¼Œçœ‹åˆ°è¿™ä¸ª value äº†å—ï¼Ÿå®ƒçš„ç±»å‹æ˜¯ typeã€‚â€
1// æ˜¾ç¤ºæ³¨è§£ 2let a: number = 1 3let b: string = &#39;hello&#39; 4let c: boolean[] = [true, false] 5 6// è‡ªåŠ¨æ¨å¯¼ 7let a = 1; 8let b = &#39;hello&#39; 9let c = [true, false] TypeScript VS JavaScript ç±»å‹ç³»ç»Ÿç‰¹æ€§JavaScriptTypeScriptç±»å‹æ˜¯å¦‚ä½•ç»‘å®šçš„ï¼ŸåŠ¨æ€é™æ€æ˜¯å¦è‡ªåŠ¨è½¬æ¢ç±»å‹ï¼Ÿæ˜¯å¦ï¼ˆå¤šæ•°æ—¶å€™ï¼‰ä½•æ—¶æ£€æŸ¥ç±»å‹ï¼Ÿè¿è¡Œæ—¶ç¼–è¯‘æ—¶ä½•æ—¶æŠ¥å‘Šé”™è¯¯ï¼Ÿè¿è¡Œæ—¶ï¼ˆå¤šæ•°æ—¶å€™ï¼‰ç¼–è¯‘æ—¶ï¼ˆå¤šæ•°æ—¶å€™ï¼‰ TypeScript èƒ½åšçš„æ˜¯æŠŠçº¯ JavaScript ä»£ç ä¸­é‚£äº›è¿è¡Œæ—¶æ„ˆå‘å’Œç±»å‹ç›¸å…³çš„é”™è¯¯æå‰åˆ°ç¼–è¯‘æ—¶æŠ¥å‘Šã€‚åœ¨ä»£ç ç¼–è¾‘å™¨ä¸­æ˜¾ç¤ºï¼Œè¾“å…¥ä»£ç åç«‹å³å°±æœ‰åé¦ˆã€‚
ç±»å‹æ˜¯å¦‚ä½•ç»‘å®šçš„ï¼Ÿ JavaScript åŠ¨æ€ç»‘å®šç±»å‹ï¼Œå¿…é¡»è¿è¡Œç¨‹åºæ‰èƒ½çŸ¥é“ç±»å‹ã€‚ TypeScript æ¸è¿›å¼ç±»å‹è¯­è¨€ï¼Œåœ¨ç¼–è¯‘æ—¶çŸ¥é“æ‰€æœ‰ç±»å‹
ç±»å‹ï¼šä¸€ç³»åˆ—å€¼åŠå¯¹å…¶æ‰§è¡Œçš„æ“ä½œ
example
ç±»å‹åŒ…å«çš„å€¼å¯ä»¥æ‰§è¡Œçš„æ“ä½œbooleantrueã€false||ã€&&ã€!numberæ‰€æœ‰æ•°å­—+ã€-ã€*ã€/ã€%ã€&&ã€? .toFixed()ã€.toString()stringæ‰€æœ‰å­—ç¬¦ä¸²+ã€||ã€&& .concat()ã€.toUpperCase() å¯¹ T ç±»å‹çš„å€¼æ¥è¯´ï¼Œæˆ‘ä»¬ä¸ä»…çŸ¥é“å€¼çš„ç±»å‹æ˜¯ Tï¼Œè¿˜çŸ¥é“å¯ä»¥ / ä¸å¯ä»¥å¯¹è¯¥å€¼åšä»€ä¹ˆæ“ä½œã€‚ ç±»å‹æ£€æŸ¥å™¨é€šè¿‡ä½¿ç”¨çš„ç±»å‹å’Œå…·ä½“ç”¨æ³•åˆ¤æ–­æ˜¯å¦æœ‰æ•ˆã€‚
TypeScript çš„ç±»å‹å±‚æ¬¡ç»“æ„ ç±»å‹æœ¯è¯­ ç±»å‹æ³¨è§£ï¼ˆå¯ä»¥ç†è§£ä¸ºæŸç§ç•Œé™
1function squareOf(n: number) { 2 return n * n; 3} 4squareOf(2); // 4 ç±»å‹æµ…è°ˆ any åœ¨ TypeScript ä¸­ï¼Œç¼–è¯‘æ—¶ä¸€åˆ‡éƒ½è¦æœ‰ç±»å‹ï¼Œå¦‚æœä½ å’Œ TypeScriptï¼ˆç±»å‹æ£€æŸ¥å™¨ï¼‰æ— æ³•ç¡®è®¤ç±»å‹æ˜¯ä»€ä¹ˆï¼Œé»˜è®¤ä¸º anyã€‚è¿™æ˜¯å…œåº•ç±»å‹ï¼Œåº”è¯¥å°½é‡é¿å…ä½¿ç”¨ã€‚
ç±»å‹çš„å®šä¹‰ï¼ˆä¸€ç³»åˆ—å€¼åŠå¯ä»¥å¯¹å…¶æ‰§è¡Œçš„æ“ä½œï¼‰any åŒ…å«æ‰€æœ‰å€¼ï¼Œè€Œä¸”å¯ä»¥å¯¹å…¶åšä»€ä¹ˆæ“ä½œã€‚any ç±»å‹çš„å€¼å°±åƒå¸¸è§„çš„ JavaScript ä¸€æ ·ï¼Œç±»å‹æ£€æŸ¥å™¨å®Œå…¨å‘æŒ¥ä¸äº†ä½œç”¨ã€‚
ä½¿ç”¨ any éœ€è¦æ˜¾ç¤ºæ³¨è§£ã€‚
tsconfig.json noImplicitAny: true;
noImplicitAny éš¶å±äº TSC çš„ strict æ ‡å¿—å®¶æ—ï¼Œ
unknown unknown ä¸ any ç±»ä¼¼ï¼Œä¹Ÿè¡¨ç¤ºä»»ä½•å€¼ã€‚ä½†æ˜¯ TypeScript ä¼šè¦æ±‚ä½ åœ¨åšæ£€æŸ¥ï¼Œç»†åŒ–ç±»å‹ã€‚
ç±»å‹åŒ…å«çš„å€¼å¯ä»¥æ‰§è¡Œçš„æ“ä½œunknown==ã€===ã€||ã€&amp;&amp;ã€?ã€!ã€typeofã€instance of 1// example 2let a: unknown = 30; // unknown 3let b = a === 123; // boolean 4let c = a + 10; // Error TS 2571: Object is of type &#39;unknown&#39; 5if (typeof a === &#39;number&#39;) { 6 let d = a + 10; // number 7} unknown çš„ç”¨æ³•
TypeScript ä¸ä¼šæŠŠä»»ä½•å€¼æ¨å¯¼ä¸º unknown ç±»å‹ï¼Œå¿…é¡»æ˜¾ç¤ºæ³¨è§£ï¼ˆaï¼‰ unknown ç±»å‹çš„å€¼å¯ä»¥æ¯”è¾ƒï¼ˆbï¼‰ æ‰§è¡Œæ“ä½œæ—¶ä¸èƒ½å‡å®š unknown ç±»å‹çš„å€¼ä¸ºæŸç§ç‰¹å®šç±»å‹ï¼ˆcï¼‰ï¼Œå¿…é¡»å…ˆå‘ TypeScript è¯æ˜ä¸€ä¸ªå€¼ç¡®å®æ˜¯æŸä¸ªç±»å‹ï¼ˆdï¼‰ boolean ç±»å‹åŒ…å«çš„å€¼å¯ä»¥æ‰§è¡Œçš„æ“ä½œbooleantrueã€false==ã€===ã€||ã€&amp;&amp;ã€? 1// example 2let a = true // boolean 3let b = false // boolean 4const c = true // true 5let d: boolean = true // boolean 6let e: true = true // true 7let f: true = false // Error TS2322: Type &#39;false&#39; is not assignable to type &#39;true&#39;. TypeScript æ¨å¯¼å‡ºå€¼çš„ç±»å‹ä¸º booleanï¼ˆa å’Œ bï¼‰ ä½¿ç”¨ constï¼Œè®© TypeScript æ¨å¯¼å‡ºå€¼ä¸ºæŸä¸ªå…·ä½“çš„å¸ƒå°”å€¼ï¼ˆcï¼‰ æ˜¾å¼æ³¨è§£ï¼Œå£°æ˜å€¼çš„ç±»å‹ä¸º booleanï¼ˆdï¼‰ æ˜¾å¼æ³¨è§£ï¼Œå£°æ˜å€¼ä¸ºæŸä¸ªå…·ä½“çš„å¸ƒå°”å€¼ï¼ˆe å’Œ fï¼‰ã€‚æŠŠç±»å‹è®¾å®šä¸ºæŸä¸ªå€¼ï¼Œå°±é™åˆ¶äº† e å’Œ f åœ¨æ‰€æœ‰å¸ƒå°”å€¼ä¸­åªèƒ½å–æŒ‡å®šçš„é‚£ä¸ªå€¼ã€‚è¿™ç§ç‰¹æ€§è¢«ç§°ä¸ºç±»å‹å­—é¢é‡ã€‚ ç±»å‹å­—é¢é‡â€”â€”ä»…è¡¨ç¤ºä¸€ä¸ªå€¼çš„ç±»å‹
å˜é‡ e f æ˜¯ä½¿ç”¨ç±»å‹å­—é¢é‡æ˜¾ç¤ºæ³¨è§£äº†å˜é‡ï¼Œå˜é‡ c åˆ™æ˜¯ç”± TypeScript æ¨å¯¼å‡ºä¸€ä¸ªå­—é¢é‡ç±»å‹ï¼Œå› ä¸ºä½¿ç”¨çš„æ˜¯ constã€‚ const å£°æ˜çš„åŸºæœ¬ç±»å‹çš„å€¼ï¼Œèµ‹å€¼ä¹‹åæ— æ³•ä¿®æ”¹ï¼Œå› æ­¤ TypeScript æ¨å¯¼å‡ºçš„æ˜¯èŒƒå›´æœ€çª„çš„ç±»å‹ï¼Œæ‰€ä»¥ TypeScript æ¨å¯¼å‡ºçš„ c çš„ç±»å‹ä¸º trueï¼Œè€Œä¸æ˜¯ booleanã€‚
number ç±»å‹åŒ…å«çš„å€¼å¯ä»¥æ‰§è¡Œçš„æ“ä½œnumberæ•´æ•°ã€æµ®ç‚¹æ•°ã€æ­£æ•°ã€è´Ÿæ•°ã€Infinityã€NaN ç­‰ç®—æœ¯è¿ç®— æ¯”è¾ƒ 1// example 2let a = 1234 // number 3let b = Infinity * 0.1 // number 4const c = 5678 // 5678 5let d = a &lt; b // boolean 6let e: number = 100 // number 7let f: 26.218 = 26.218 // 26.218 8let g: 26.218 = 10 // Error TS2322: Type &#39;10&#39; is not assignable to type &#39;26.218&#39; TypeScript æ¨å¯¼å‡ºå€¼çš„ç±»å‹ä¸º numberï¼ˆa å’Œ bï¼‰ ä½¿ç”¨ constï¼Œè®© TypeScript æ¨å¯¼å‡ºå€¼ä¸ºæŸä¸ªå…·ä½“çš„æ•°å­—ï¼ˆcï¼‰ æ˜¾å¼æ³¨è§£ï¼Œå£°æ˜å€¼çš„ç±»å‹ä¸º numberï¼ˆeï¼‰ æ˜¾å¼æ³¨è§£ï¼Œå£°æ˜å€¼ä¸ºæŸä¸ªå…·ä½“çš„æ•°å­—ï¼ˆf å’Œ gï¼‰ tipsï¼šå¤„ç†è¾ƒé•¿çš„æ•°å­—æ—¶å¯ä»¥ä½¿ç”¨æ•°å­—åˆ†éš”ç¬¦ã€‚
1let oneMillion = 1_000_ 000 // ç­‰åŒäº 1000000 2let twoMillion: 2_000_000 = 2_000_000 bigint æ˜¯ JavaScript å’Œ TypeScript æ–°å¼•å…¥çš„ç±»å‹ï¼Œåœ¨å¤„ç†è¾ƒå¤§çš„æ•´æ•°æ—¶ï¼Œä¸ç”¨å†æ‹…å¿ƒèˆå…¥è¯¯å·®ã€‚
number ç±»å‹è¡¨ç¤ºçš„æ•´æ•°æœ€å¤§ä¸º 253ï¼Œbigint å¯ä»¥è¡¨ç¤ºä»»æ„å¤§çš„æ•´æ•°ã€‚
ç±»å‹åŒ…å«çš„å€¼å¯ä»¥æ‰§è¡Œçš„æ“ä½œbigintæ‰€æœ‰ BigInt æ•°ç®—æœ¯è¿ç®— æ¯”è¾ƒ 1// example 2let a = 1234n // bigint 3const b = 5678n // 5678n 4let c = a + b // bigint 5let d = a &lt; 1235 // boolean 6let e = 88.5n // Error TS1353: A bigint literal must be an integer. 7let f: bigint = 100n // bigint 8let g: 100n = 100n // 100n 9let h: bigint = 100 // Error TS2322: Type &#39;100&#39; is not assignable ty type &#39;bigint&#39;. ä¸ boolean å’Œ number ä¸€æ ·ï¼Œå£°æ˜ bigint ç±»å‹ä¹Ÿæœ‰å››ç§æ–¹å¼ã€‚å°½é‡è®© TypeScript è‡ªåŠ¨æ¨å¯¼ã€‚
string ç±»å‹åŒ…å«çš„å€¼å¯ä»¥æ‰§è¡Œçš„æ“ä½œstringæ‰€æœ‰å­—ç¬¦ä¸²å­—ç¬¦ä¸²å¯ä»¥è¿›è¡Œçš„æ“ä½œ ä¾‹å¦‚ +ã€.slice() 1// example 2let a = &#39;hello&#39; // string 3let b = &#39;billy&#39; // string 4const c = &#39;!&#39; // ! 5let d = a + &#39; &#39; + b + c // string 6let e: string = &#39;zoom&#39; // string 7let f: &#39;john&#39; = &#39;john&#39; // john 8let g: &#39;john&#39; = &#39;zoe&#39; // Error TS2322: Type &#39;zoe&#39; is not assignable to type &#39;john&#39; åŒæ ·ä¹Ÿæ˜¯å°½é‡è®© TypeScript è‡ªåŠ¨æ¨å¯¼ string ç±»å‹ã€‚
symbol symbol ç»å¸¸ç”¨äºä»£æ›¿å¯¹è±¡å’Œæ˜ å°„çš„å­—ç¬¦ä¸²å¥ï¼Œé˜²æ­¢è¢«æ„å¤–è®¾ç½®ã€‚ symbol çš„ç±»å‹å°±æ˜¯ symbolï¼Œæ¯ä¸€ä¸ª symbol éƒ½æ˜¯å”¯ä¸€çš„ï¼Œä¸ä¸å…¶ä»–ä»»ä½•ç¬¦å·ç›¸ç­‰ï¼Œå³ä¾¿å†ä½¿ç”¨ç›¸åŒçš„åç§°åˆ›å»ºä¸€ä¸ª symbol ä¹Ÿæ˜¯å¦‚æ­¤ã€‚
1// example 2let a = Symbol(&#39;a&#39;) // symbol 3let b: symbol = Symbol(&#39;b&#39;) // symbol 4let c = a === b // boolean 5let d = a + &#39;x&#39; // Error TS2469: The &#39;+&#39; operator cannot be applied to type &#39;symbol&#39;. 1// example 2const e = Symbol(&#39;e&#39;) // unique symbol 3const f: unique symbol = Symbol(&#39;f&#39;) // unique symbol 4let g: unique symbol = Symbol(&#39;f&#39;) // Error TS1332: A variable whose type is a &#39;unique symbol&#39; type must be &#39;const&#39;. 5let h = e === e // boolean 6let i = e === f // Error TS2367: This condition will always return &#39;false&#39; since the type &#39;unique symbol&#39; and &#39;unique symbol&#39; have no overlap. åˆ›å»º symbol çš„æ–¹å¼
ä½¿ç”¨ constï¼ŒTypeScript ä¼šæ¨å¯¼ä¸º unique symbol ç±»å‹ã€‚ æ˜¾å¼æ³¨è§£ const å˜é‡çš„ç±»å‹ä¸º unique symbol unique symbol ç±»å‹çš„å€¼å§‹ç»ˆä¸è‡ªèº«ç›¸ç­‰ TypeScript åœ¨ç¼–è¯‘æ—¶çŸ¥é“ä¸€ä¸ª unique symbol ç»å¯¹ä¸ä¼šä¸å¦ä¸€ä¸ª unique symbol ç›¸ç­‰ unique symbol ä¸å…¶ä»–å­—é¢é‡ç±»å‹å…¶å®æ˜¯ä¸€æ ·çš„ã€‚
å¯¹è±¡ TypeScript çš„å¯¹è±¡ç±»å‹è¡¨ç¤ºå¯¹è±¡çš„ç»“æ„ã€‚
ç»“æ„åŒ–ç±»å‹â€“ä¸€ç§ç¼–ç¨‹è®¾è®¡é£æ ¼ï¼Œåªå…³å¿ƒå¯¹è±¡æœ‰å“ªäº›å±æ€§ï¼Œè€Œä¸ç®¡å±æ€§ä½¿ç”¨ä»€ä¹ˆåç§°ï¼ˆåä¹‰åŒ–ç±»å‹ï¼‰ã€‚åœ¨æŸäº›è¯­è¨€ä¸­ä¹Ÿå«é¸­å­ç±»å‹ï¼ˆå³ä¸ä»¥è²Œå–äººï¼‰
1// example 2let b: object = { 3 b: &#39;x&#39; 4} 5a.b // Error TS2339: Property &#39;b&#39; does not exist on type &#39;object&#39;. object åªèƒ½è¡¨ç¤ºè¯¥å€¼æ˜¯ä¸€ä¸ª JavaScript å¯¹è±¡ï¼ˆè€Œä¸”ä¸æ˜¯ nullï¼‰
1// å¯¹è±¡å­—é¢é‡ 2 3// è‡ªåŠ¨æ¨å¯¼ 4let a = { 5 b: &#39;x&#39; 6} 7 8// or 9let a: { b: string } = { 10 b: &#39;x&#39; 11} å¯¹è±¡å­—é¢é‡å¥æ³•çš„æ„æ€æ˜¯ï¼Œâ€œè¿™ä¸ªä¸œè¥¿çš„ç»“æ„æ˜¯è¿™æ ·è¿‡çš„ã€‚â€
ä½¿ç”¨ const å£°æ˜å¯¹è±¡ä¸ä¼šå¯¼è‡´ TypeScript æŠŠæ¨å¯¼çš„ç±»å‹ç¼©çª„ã€‚ä¸ä¸Šé¢çš„åŸºæœ¬ç±»å‹ä¸åŒã€‚è¿™æ˜¯å› ä¸º JavaScript å¯¹è±¡æ˜¯å¯å˜çš„ï¼Œæ‰€ä»¥åœ¨ TypeScript çœ‹æ¥ï¼Œåˆ›å»ºå¯¹è±¡ä¹‹åä½ å¯èƒ½ä¼šæ›´æ–°å¯¹è±¡çš„å­—æ®µã€‚
1let a: { b: number } 2b = {} // Error TS2741: Property &#39;b&#39; is missing in type &#39;{}&#39; but required in type &#39;{b: number}&#39;. 3 4b = { 5 a: 1, 6 b: 2 7} // Error TS2322: Type &#39;{b: number; c: number}&#39; is not assignable to type &#39;{b: number}&#39;. Object literal may only specify known properties, and &#39;c&#39; does not exist in type &#39;{b: number}&#39;. é»˜è®¤æƒ…å†µä¸‹ï¼ŒTypeScript å¯¹å¯¹è±¡çš„å±æ€§è¦æ±‚ååˆ†ä¸¥æ ¼ã€‚å¦‚æœå£°æ˜å¯¹è±¡æœ‰ä¸ªç±»å‹ä¸º number çš„å±æ€§ bï¼ŒTypeScript å°†é¢„æœŸå¯¹è±¡æœ‰ä¸”åªæœ‰è¿™ä¸ªå±æ€§ã€‚ç¼ºå°‘æˆ–è€…å¤šäº†ï¼ŒTypeScript éƒ½ä¼šæŠ¥é”™ã€‚
1let a: { 2 b: number 3 c?: string // å¯èƒ½æœ‰ä¸ªç±»å‹ä¸º string çš„å±æ€§ cã€‚å…¶å€¼å¯ä»¥ä¸º undefined 4 readonly firstName: string // ä¸ºå­—æ®µèµ‹åˆå§‹å€¼åæ— æ³•ä¿®æ”¹ã€‚ç±»ä¼¼äºä½¿ç”¨ const å£°æ˜å¯¹è±¡çš„å±æ€§ 5 [key: number]: boolean // å¯èƒ½æœ‰ä»»æ„å¤šä¸ªæ•°å­—å±æ€§ï¼Œå…¶å€¼ä¸ºå¸ƒå°”å€¼ 6} [key: T]: U å¥æ³•ç§°ä¸ºç´¢å¼•ç­¾åï¼Œé€šè¿‡è¿™ç§æ–¹å¼å‘Šè¯‰ TypeScriptï¼ŒæŒ‡å®šçš„å¯¹è±¡å¯èƒ½æœ‰æ›´å¤šçš„ keyã€‚è¿™ç§å¥æ³•çš„æ„æ€æ˜¯ï¼Œâ€œåœ¨è¿™ä¸ªå¯¹è±¡ä¸­ï¼Œç±»å‹ä¸º T çš„å¥å¯¹åº”çš„å€¼ä¸º U ç±»å‹ã€‚â€
ç´¢å¼•ç­¾å key çš„ç±»å‹ T å¿…é¡»å¯èµ‹å€¼ç»™ number æˆ– stringã€‚ï¼ˆJavaScript å¯¹è±¡çš„å¥ä¸ºå­—ç¬¦ä¸²ï¼›æ•°ç»„æ˜¯ç‰¹æ®Šçš„å¯¹è±¡ï¼Œå¥ä¸ºæ•°å­—ã€‚ï¼‰ key çš„åç§°å¯ä»¥æ˜¯ä»»æ„è¯ï¼Œä¸ä¸€å®šéçš„ç”¨ key å¯¹è±¡å­—é¢é‡è¡¨ç¤ºæ³•æœ‰ä¸€ä¸ªç‰¹ä¾‹ï¼šç©ºå¯¹è±¡ç±»å‹ {}ã€‚é™¤ null å’Œ undefined ä¹‹å¤–çš„ä»»ä½•ç±»å‹éƒ½å¯ä»¥èµ‹å€¼ç»™ç©ºå¯¹è±¡ç±»å‹ï¼Œåº”è¯¥å°½é‡é¿å…ä½¿ç”¨ã€‚
åœ¨ TypeScript ä¸­å£°æ˜å¯¹è±¡ç±»å‹æœ‰å››ç§æ–¹å¼
å¯¹è±¡å­—é¢é‡è¡¨ç¤ºæ³• {a: string}ï¼Œä¹Ÿç§°å¯¹è±¡ç»“æ„ ç©ºå¯¹è±¡å­—é¢é‡è¡¨ç¤ºæ³• {}ã€‚é¿å…ä½¿ç”¨ object ç±»å‹ã€‚å¦‚æœéœ€è¦ä¸ªå¯¹è±¡ï¼Œå½“å¯¹è¿™ä¸ªå¯¹è±¡çš„å­—æ®µæ²¡æœ‰è¦æ±‚ï¼Œä½¿ç”¨è¿™ç§æ–¹å¼ã€‚ Objectã€‚é¿å…ä½¿ç”¨ å¯¹ä¸€ä¸ªå€¼ï¼Œåœ¨ç±»å‹å…è®¸çš„æƒ…å†µä¸‹ï¼Œå¯ä»¥å¯¹å…¶æ‰§è¡Œç‰¹å®šçš„æ“ä½œã€‚å…¶å®åœ¨ç±»å‹è‡ªèº«ä¸Šä¹Ÿå¯ä»¥æ‰§è¡Œä¸€äº›æ“ä½œã€‚
ç±»å‹åˆ«å
1type Age = number 2 3type Person = { 4 name: string 5 age: Age 6} 7 8let driver: Person = { 9 name: &#39;Jack&#39; 10 age: 18 11} ç±»å‹åˆ«åé‡‡ç”¨å—çº§ä½œç”¨åŸŸã€‚åœ¨åŒä¸€ä½œç”¨äºä¸­ä¸èƒ½é‡å¤å£°æ˜ç›¸åŒç±»å‹ã€‚
å¹¶é›†å’Œäº¤é›†
1type Cat = { name: string, purrs: boolean } 2type Dog ={ name: string, barks: boolean, wags: boolean } 3 4type CatOrDogOrBoth = Cat | Dog // å¹¶é›† 5type CatAndDog = Cat &amp; Dog // äº¤é›† 6 7// CatOrDogOrBoth å¯ä»¥æ˜¯ Cat ç±»å‹çš„å€¼ï¼Œå¯ä»¥æ˜¯ Dog ç±»å‹çš„å€¼ï¼Œè¿˜å¯ä»¥äºŒè€…å…¼å…·ã€‚ 8// Cat 9let a: CatOrDogOrBoth = { 10 name: &#39;Bonkers&#39;, 11 purrs: true 12} 13 14// Dog 15a = { 16 name: &#39;Domino&#39;, 17 barks: true, 18 wags: true 19} 20 21// äºŒè€…å…¼å…· 22a = { 23 name: &#39;Donkers&#39;, 24 barsk: true, 25 purrs: true, 26 wags: true 27} 28 29// CatAndDot 30let b: CatAndDog = { 31 name: &#39;Domino&#39;, 32 barks: true, 33 purrs: true, 34 wags: true 35} å¹¶é›†é€šå¸¸æ›´å¸¸ç”¨
å‡½æ•°è¿”å›å€¼å¯èƒ½æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œä¹Ÿå¯èƒ½æ˜¯ nullã€‚string | null æ··åˆç±»å‹çš„æ•°ç»„ æ•°ç»„
1let a = [1, 2, 3] // number[] 2let b = [&#39;a&#39;, &#39;b&#39;] // string[] 3let c: string[] = [&#39;a&#39;] // string[] 4let d = [1, &#39;a&#39;] // (number | string)[] 5const e = [2, &#39;b&#39;] // (number | string)[] 6let f = [&#39;red&#39;] // string[] 7 8f.push(&#39;blue&#39;) 9f.push(true) // Error TS2345: Argument of type &#39;true&#39; is not assignable to parameter of type &#39;string&#39;. 10 11let g = [] // any[] 12g.push(1) // number[] 13g.push(&#39;red&#39;) // (number | string)[] 14 15let h: number[] = [] // number[] 16h.push(1) // number[] 17h.push(&#39;red&#39;) // Error TS2345: Argument of type &#39;&#34;red&#34;&#39; is not assignable to parameter of type &#39;number&#39;. TypeScript æ”¯æŒä¸¤ç§æ³¨è§£æ•°ç»„ç±»å‹çš„å¥æ³•
T[] Array ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œæ•°ç»„åº”è¯¥ä¿æŒåŒè´¨ã€‚
å…ƒç¥–
array çš„å­ç±»å‹ï¼Œé•¿åº¦å›ºå®šï¼Œå„ç´¢å¼•ä½ä¸Šçš„å€¼å…·æœ‰å›ºå®šçš„å·²çŸ¥ç±»å‹ã€‚
å£°æ˜å…ƒç»„æ—¶å¿…é¡»æ˜¾å¼æ³¨è§£ç±»å‹ã€‚
1let a: [number] = 1 2let b: [string, string, number] = [&#39;jack&#39;, &#39;boy&#39;, 1963] 3b = [&#39;tom&#39;, &#39;boy&#39;, &#39;li&#39;, 1926] // Error TS2322: Type &#39;string&#39; is not assignable to type &#39;number&#39;. å…ƒç»„ä¹Ÿæ”¯æŒå¯é€‰å…ƒç´ 
1let trainFares: [number, number?][] = [ 2 [3.75], 3 [8.25, 7.70], 4 [10.60], 5] 6 7// ç­‰ä»·äº 8let moreTrainFares: ([number, number] | [number])[] = [ 9 // ... 10] å…ƒç»„ä¹Ÿæ”¯æŒå‰©ä½™å…ƒç´ ï¼Œå³ä¸ºå…ƒç»„å®šä¹‰æœ€å°é•¿åº¦
1// å­—ç¬¦ä¸²åˆ—è¡¨ï¼Œè‡³å°‘æœ‰ä¸€ä¸ªå…ƒç´  2let friends: [string, ...string[]] = [&#39;Sara&#39;, &#39;Tali&#39;, &#39;Chloe&#39;, &#39;Claire&#39;] 3 4// å…ƒç´ ç±»å‹ä¸åŒçš„åˆ—è¡¨ 5let list: [number, boolean, ...string[]] = [1, false, &#39;a&#39;, &#39;b&#39;, &#39;c&#39;] åªè¯»æ•°ç»„å’Œå…ƒç¥–
1let as: readonly number[] = [1, 2, 3] // readonly number[] 2let bs: readonly number[] = as.concat(4) // readonly number[] 3let three = bs[2] // number 4as[4] = 5 // Error TS2542: Index signature in type &#39;readonly number[]&#39; only permits reading. 5as.push(6) // Error TS2339: Property &#39;push&#39; does not exist on type &#39;readonly number[]&#39;. 6 7// Readonly å’Œ ReadonlyArray å¥æ³• 8type A = readonly string[] // readonly string[] 9type B = ReadonlyArray&lt;string&gt; // readonly string[] 10type C = Readonly&lt;string[]&gt; // readonly string[] 11 12type D = readonly [number, string] // readonly [number, string] 13type E = Readonly&lt;[number, string]&gt; // readonly [number, string] nullã€undefinedã€void å’Œ never | ç±»å‹ | å«ä¹‰ | | â€” | â€” | | null | ç¼ºå°‘å€¼ | | undefined | å°šæœªèµ‹å€¼çš„å˜é‡ | | void | æ²¡æœ‰ return è¯­å¥çš„å‡½æ•° | | never | æ°¸ä¸è¿”å›çš„å‡½æ•° |
1// è¿”å› never çš„å‡½æ•° 2function d() { 3 throw TypeError(&#39;I always error&#39;) 4} 5 6function e() { 7 while (true) { 8 doSomething() 9 } 10} never æ˜¯æ‰€æœ‰ç±»å‹çš„å­ç±»å‹ï¼Œå¯ä»¥èµ‹å€¼ç»™å…¶ä»–ä»»ä½•ç±»å‹ã€‚
æšä¸¾
æšä¸¾çš„ä½œç”¨æ˜¯åˆ—ä¸¾ç±»å‹ä¸­åŒ…å«çš„å„ä¸ªå€¼ã€‚æ˜¯ä¸€ç§æ— åºæ•°æ®ç»“æ„ï¼ŒæŠŠé”®æ˜ å°„åˆ°å€¼ä¸Šã€‚
æšä¸¾å¯ä»¥ç†è§£ä¸ºç¼–è¯‘æ—¶é”®å›ºå®šçš„å¯¹è±¡ï¼Œè®¿é—®é”®æ—¶ï¼ŒTypeScript å°†æ£€æŸ¥æŒ‡å®šçš„é”®æ˜¯å¦å­˜åœ¨ã€‚
æšä¸¾åˆ†ä¸ºä¸¤ç§
å­—ç¬¦ä¸²åˆ°å­—ç¬¦ä¸²ä¹‹é—´çš„æ˜ å°„ å­—ç¬¦ä¸²åˆ°æ•°å­—ä¹‹é—´çš„æ˜ å°„ 1enum Language { 2 English, 3 Spaish, 4 Russian 5} æŒ‰çº¦å®šï¼Œæšä¸¾åç§°ä¸ºå¤§å†™å•æ•°å½¢å¼ã€‚æšä¸¾ä¸­çš„é”®ä¹Ÿå¤§å†™ã€‚
TypeScript å¯ä»¥è‡ªåŠ¨ä¸ºæšä¸¾ä¸­çš„å„ä¸ªæˆå‘˜æ¨å¯¼å¯¹åº”çš„æ•°å­—ï¼Œä¹Ÿå¯ä»¥æ‰‹åŠ¨è®¾ç½®ã€‚
1enum Language { 2 English = 0, 3 Spanish = 1, 4 Russian = 2 5} æšä¸¾ä¸­çš„å€¼è®¿é—®æ–¹å¼å’Œå¯¹è±¡ä¸€æ ·
1let myFirstLanguage = Language.Russian 2let mySecondLanguage = Language[&#39;English&#39;] ä¸€ä¸ªæšä¸¾å¯ä»¥åˆ†æˆå‡ æ¬¡å£°æ˜ï¼ŒTypeScript å°†è‡ªåŠ¨æŠŠå„éƒ¨åˆ†åˆå¹¶åœ¨ä¸€èµ·
1enum Language { 2 English = 0, 3 Spanish = 1, 4} 5 6enum Language { 7 Russian = 2 8} meiju
å°ç»“ ç±»å‹å­ç±»å‹booleanBoolean å­—é¢é‡bigintBigInt å­—é¢é‡numberNumber å­—é¢é‡stringString å­—é¢é‡symbolunique symbolobjectObject å­—é¢é‡æ•°ç»„å…ƒç»„enumconst enum å£°æ˜å’Œè°ƒç”¨å‡½æ•° åœ¨ JavaScript ä¸­ï¼Œå‡½æ•°æ˜¯ä¸€ç­‰å¯¹è±¡ã€‚è¿™æ„å‘³ç€ï¼Œå¯ä»¥å‘å¯¹è±¡é‚£æ ·ä½¿ç”¨å‡½æ•°
å¯ä»¥èµ‹å€¼ç»™å˜é‡ å¯ä»¥ä½œä¸ºå‚æ•°ä¼ ç»™å…¶ä»–å‡½æ•° å¯ä»¥ä½œä¸ºå‡½æ•°çš„è¿”å›å€¼ å¯ä»¥èµ‹å€¼ç»™å¯¹è±¡å’ŒåŸå‹ å¯ä»¥èµ‹äºˆå±æ€§ å¯ä»¥è¯»å–å±æ€§ TypeScript é€šå¸¸ä¼šæ˜¾ç¤ºæ³¨è§£å‡½æ•°çš„å‚æ•°
1function add(a: number, b: number) { 2 return a + b 3} è¿”å›ç±»å‹èƒ½æ¨å¯¼å‡ºæ¥ï¼Œä¸è¿‡ä¹Ÿå¯ä»¥æ˜¾ç¤ºæ³¨è§£
1function add(a: number, b: number): number { 2 return a + b 3} TypeScript ä¸­å£°æ˜å‡½æ•°
1// å…·åå‡½æ•° 2function greet(name: string) { 3 return &#39;hello &#39; + name 4} 5 6// å‡½æ•°è¡¨è¾¾å¼ 7let greet2 = function(name: string) { 8 retunr &#39;hello &#39; + name 9} 10 11// ç®­å¤´å‡½æ•°è¡¨è¾¾å¼ 12let greet3 = (name: string) =&gt; { 13 return &#39;hello &#39; + name 14} 15 16// ç®­å¤´å‡½æ•°è¡¨è¾¾å¼ç®€å†™ 17let greet4 = (name: string) =&gt; &#39;hello &#39; + name 18 19// å‡½æ•°æ„é€ æ–¹æ³• 20let greet5 = new Function(&#39;name&#39;, &#39;return &#34;hello &#34; + name&#39;) é™¤äº†å‡½æ•°æ„é€ æ–¹æ³•ï¼Œå…¶ä»–å‡ ç§å¥æ³•åœ¨ TypeScript ä¸­éƒ½å¯ä»¥æ”¾å¿ƒä½¿ç”¨ï¼Œèƒ½å¤Ÿä¿è¯ç±»å‹å®‰å…¨ã€‚é€šå¸¸éœ€è¦æ³¨è§£å‚æ•°çš„ç±»å‹ï¼Œè€Œè¿”å›ç±»å‹ä¸è¦æ±‚å¿…é¡»æ³¨è§£ã€‚ åœ¨è°ƒç”¨å‡½æ•°æ—¶ï¼ŒTypeScript å°†æ£€æŸ¥ä¼ å…¥çš„å®å‚æ˜¯å¦äºå‡½æ•°å½¢å‚ç±»å‹å…¼å®¹ã€‚
å¯é€‰å‚æ•°å’Œé»˜è®¤å‚æ•° å¯é€‰å‚æ•°å¿…é¡»åœ¨æœ«å°¾
1function log(message: string, userId?: string) { 2 let time = new Date().toLocaleTimeString() 3 console.log(time, message, userId || &#39;Not signed in&#39;) 4} 5 6log(&#39;Page loded&#39;) 7log(&#39;User signed in&#39;, &#39;da763be&#39;) 8 9// é»˜è®¤å€¼å‚æ•°ï¼ˆç±»ä¼¼å¯é€‰å‚æ•°åŠŸèƒ½ 10function log(message: string, userId = &#39;Not signed in&#39;) { // userId ä¼šè‡ªåŠ¨æ¨å¯¼ç±»å‹ 11 let time = new Date().toLocaleTimeString() 12 console.log(time, message, userId) 13} 14 15// æ˜¾å¼æ³¨è§£é»˜è®¤å‚æ•°ç±»å‹ 16type Context = { 17 appId?: string 18 userId?: string 19} 20 21function log(message: string, context: Context = {}) { 22 let time = new Date().toLocaleTimeString() 23 console.log(time, message, context.userId) 24} é»˜è®¤å‚æ•°æ›´å¸¸ç”¨ï¼Œé»˜è®¤å‚æ•°å¯ä»¥è‡ªåŠ¨ç±»å‹æ¨å¯¼ã€‚
å¤šæ€ ä¸Šé¢éƒ½æ˜¯è®²çš„å…·ä½“ç±»å‹çš„ç”¨æ³•å’Œç”¨é€”
boolean string Date[] {a: number} | {b: string} (numbers: number[]) =&gt; number ä½¿ç”¨å…·ä½“ç±»å‹çš„å‰ææ˜¯ç±»å‹å·²çŸ¥
å¦‚æœäº‹å…ˆä¸çŸ¥é“éœ€è¦ä»€ä¹ˆç±»å‹ ä¸æƒ³é™åˆ¶å‡½æ•°åªèƒ½æ¥å—æŸä¸ªç±»å‹
1// example 2function filter(array, f) { 3 let result = [] 4 for (let i = 0; i &lt; array.length; i++) { 5 let item = array[i] 6 if (f(item)) { 7 result.push(item) 8 } 9 } 10 return result 11} 12 13filtre([1, 2, 3, 4], (item) =&gt; item &lt; 3) // [1, 2] ä¾‹å­ä¸­ï¼Œæ•°ç»„å…ƒç´ çš„ç±»å‹å¯ä»¥ä¸º numberï¼Œä¸è¿‡ filter å‡½æ•°çš„ä½œç”¨åº”è¯¥æ›´ä¸€èˆ¬ï¼Œå¯ä»¥ç­›é€‰æ•°å­—æ•°ç»„ã€å­—ç¬¦ä¸²æ•°å­—ã€å¯¹è±¡æ•°ç»„ç­‰ã€‚ ä¸‹é¢é€šè¿‡é‡è½½æè¿°ä¸‹å‡½æ•°ç­¾å
1type Filter = { 2 (array: number[], f: (item: number) =&gt; boolean): number[] 3 (array: string[], f: (item: string) =&gt; boolean): string[] 4} 5 6// åŠ ä¸Šå¯¹è±¡ç±»å‹ 7type Filter = { 8 (array: number[], f: (item: number) =&gt; boolean): number[] 9 (array: object[], f: (item: object) =&gt; boolean): object[] 10} object æ— æ³•æè¿°å¯¹è±¡çš„ç»“æ„ï¼Œè®¿é—®æ•°ç»„ä¸­å…ƒç´ å±æ€§å°±ä¼šæŠ¥é”™ã€‚ ä¸ºäº†è§£å†³è¿™ç§é—®é¢˜ï¼Œå°±æœ‰äº†æ³›å½¢å‚æ•°
æ³›å‹å‚æ•°â€”â€”åœ¨ç±»å‹å±‚é¢æ–½åŠ çº¦æŸçš„å ä½ç±»å‹ï¼Œä¹Ÿç§°å¤šæ€ç±»å‹å‚æ•°ï¼Œç®€ç§°æ³›å½¢
1// example 2type Filter = { 3 &lt;T&gt;(array: T[], f: (item: T): boolean): T[] 4} è¿™ä¹ˆåšçš„æ„æ€æ˜¯ Filter ä½¿ç”¨äº†ä¸€ä¸ªæ³›å½¢å‚æ•° Tï¼Œäº‹å…ˆä¸çŸ¥é“å…·ä½“ç±»å‹æ˜¯ä»€ä¹ˆï¼Œè°ƒç”¨çš„æ—¶å€™æ ¹æ®ä¼ å…¥çš„å‚æ•°æ¨å¯¼ T çš„ç±»å‹ã€‚
çŸ¥è¯†ç‚¹
æ³›å½¢ä½¿ç”¨å°–æ‹¬å·å£°æ˜ï¼Œå¯ä»¥æŠŠå°–æ‹¬å·ç†è§£ä¸º type å…³é”®å­—ï¼Œåªä¸è¿‡å£°æ˜çš„æ˜¯æ³›å½¢ã€‚ å°–æ‹¬å·ä½ç½®é™åˆ¶æ³›å½¢ä½œç”¨åŸŸå°–æ‹¬å·ä¸­å¯ä»¥å£°æ˜ä»»æ„å¤šä¸ªä»¥é€—å·åˆ†éš” T å°±æ˜¯ä¸€ä¸ªç±»å‹åç§°ï¼ˆç±»ä¼¼å˜é‡åç§°ï¼‰ï¼Œå¯ä»¥ä½¿ç”¨ä»»æ„åç§°ï¼Œé€šå¸¸ä¼šä½¿ç”¨ T U V W æ³›å½¢å¯ä»¥ç†è§£ä¸ºä¸€ç§çº¦æŸï¼ŒæŠŠæ³›å½¢ T æ‰€åœ¨ä½ç½®çš„ç±»å‹çº¦æŸä¸º T ç±»å‹ ä»€ä¹ˆæ—¶å€™ç»‘å®šæ³›å‹ å£°æ˜æ³›å½¢çš„ä½ç½®ä¸ä»…é™å®šæ³›å½¢ä½œç”¨åŸŸï¼Œè¿˜å†³å®šä»€ä¹ˆæ—¶å€™ä¸ºæ³›å½¢ç»‘å®šå…·ä½“çš„å€¼
1// 1 åœ¨è°ƒç”¨ç­¾åä¸­å£°æ˜ 2type Filter = { 3 &lt;T&gt;(array: T[], f: (item: T): boolean): T[] 4} 5// è°ƒç”¨å‡½æ•°æ—¶ä¸º T ç»‘å®šå…·ä½“ç±»å‹ 6let filter: Filter = (array, f) =&gt; { 7 // ... 8} 9 10 11// 2 åœ¨ç±»å‹åˆ«å Filter ä¸­ 12type Filter&lt;T&gt; = { 13 (array: T[], f: (item: T): boolean): T[] 14} 15// ä½¿ç”¨ Filter æ—¶æ˜¾å¼ç»‘å®šå…·ä½“ç±»å‹ 16let filter: Filter&lt;number&gt; = (array, f) =&gt; { 17 // ... 18} å¯ä»¥åœ¨ä»€ä¹ˆåœ°æ–¹å£°æ˜æ³›å½¢ 1// 1 2type Filter = { 3 &lt;T&gt;(array: T[], f: (item: T): boolean): T[] 4} 5 6// 2 7type Filter&lt;T&gt; = { 8 (array: T[], f: (item: T): boolean): T[] 9} 10 11// 3 1 çš„ç®€å†™ 12type Filter = &lt;T&gt;(array: T[], f: (item: T): boolean): T[] 13 14// 4 2 çš„ç®€å†™ 15type Filter&lt;T&gt;( = array: T[], f: (item: T): boolean): T[] 16 17// 5 å…·åå‡½æ•°è°ƒç”¨ç­¾åï¼Œæ¯æ¬¡è°ƒç”¨ filter æ—¶ç»‘å®šä¸¾è…¿ç±»å‹ 18function filter&lt;T&gt;(array: T[], f: (item: T) =&gt; boolean): T[] { 19 // ... 20} æ³›å½¢åˆ«å æ³›å½¢çº¦æŸ `,url:"https://hugo-dead-simple.netlify.com/typescript/typescript_program.html"},"https://hugo-dead-simple.netlify.com/tags/web%E5%BC%80%E5%8F%91.html":{title:"Webå¼€å‘",tags:[],content:"",url:"https://hugo-dead-simple.netlify.com/tags/web%E5%BC%80%E5%8F%91.html"},"https://hugo-dead-simple.netlify.com/frontend/switch_light_drak_theme.html":{title:"å®Œç¾å®ç° Hugo åšå®¢æš—é»‘æ¨¡å¼åˆ‡æ¢ï¼šä»åŸç†åˆ°å®è·µ",tags:["Hugo","Webå¼€å‘","JavaScript","CSS"],content:`åœ¨å½“ä»Šçš„ç”¨æˆ·ä½“éªŒè®¾è®¡ä¸­ï¼Œæä¾›æš—é»‘æ¨¡å¼ï¼ˆDark Modeï¼‰å‡ ä¹å·²æˆä¸ºæ ‡é…ã€‚å®ƒä¸ä»…èƒ½å‡å°‘çœ¼éƒ¨ç–²åŠ³ï¼Œåœ¨ä½å…‰ç¯å¢ƒä¸‹ä¹Ÿæ›´åŠ èˆ’é€‚ã€‚æœ¬æ–‡å°†è¯¦ç»†è®°å½•å¦‚ä½•ä¸ºä¸€ä¸ª Hugo ç½‘ç«™ï¼ˆå®é™…ä¸Šé€‚ç”¨äºä»»ä½•é™æ€ç½‘ç«™ï¼‰æ·»åŠ ä¸€ä¸ªåŠŸèƒ½å®Œå–„ã€ä½“éªŒæµç•…çš„ä¸»é¢˜åˆ‡æ¢å™¨ã€‚
æˆ‘ä»¬å°†è§£å†³ä¸€ä¸ªå¸¸è§ç—›ç‚¹ï¼šé¡µé¢åˆ·æ–°æ—¶çš„â€œé—ªçƒâ€é—®é¢˜ï¼Œå¹¶æœ€ç»ˆå®ç°ä¸€ä¸ªå ªç§°å®Œç¾çš„è§£å†³æ–¹æ¡ˆã€‚
æœ€ç»ˆæ•ˆæœ ä¸€ä¸ªä½äºå¯¼èˆªæ çš„æŒ‰é’®ï¼Œç”¨äºåœ¨æµ…è‰²ï¼ˆLightï¼‰å’Œæ·±è‰²ï¼ˆDarkï¼‰ä¸»é¢˜é—´åˆ‡æ¢ã€‚ ç”¨æˆ·çš„é€‰æ‹©ä¼šè¢«æµè§ˆå™¨è®°ä½ï¼Œä¸‹æ¬¡è®¿é—®æ—¶è‡ªåŠ¨åº”ç”¨ã€‚ å¦‚æœç”¨æˆ·é¦–æ¬¡è®¿é—®ï¼Œåˆ™ä¼šæ ¹æ®å…¶æ“ä½œç³»ç»Ÿçš„åå¥½è‡ªåŠ¨é€‰æ‹©ä¸»é¢˜ã€‚ æœ€é‡è¦çš„ï¼šé¡µé¢åœ¨åŠ è½½å’Œåˆ·æ–°æ—¶ç»ä¸ä¼šå‡ºç°æ¼äººçš„é¢œè‰²é—ªçƒã€‚ æ ¸å¿ƒå®ç°åŸç† æˆ‘ä»¬çš„ä¸»é¢˜åˆ‡æ¢åŠŸèƒ½ä¸»è¦ä¾èµ–ä¸¤å¤§ç°ä»£ Web æŠ€æœ¯çš„ç»“åˆï¼š
CSS è‡ªå®šä¹‰å±æ€§ (CSS Variables) é€šè¿‡ JavaScript æ“ä½œ HTML æ ‡ç­¾çš„ data-* å±æ€§ åŸºæœ¬æ€è·¯æ˜¯ï¼šæˆ‘ä»¬åœ¨ CSS ä¸­å®šä¹‰ä¸¤å¥—é¢œè‰²å˜é‡ï¼Œä¸€å¥—ç”¨äºæµ…è‰²ä¸»é¢˜ï¼Œå¦ä¸€å¥—ç”¨äºæ·±è‰²ä¸»é¢˜ã€‚ç„¶åï¼Œé€šè¿‡ JavaScript åŠ¨æ€åœ°åœ¨ &lt;html&gt; æ ¹å…ƒç´ ä¸Šåˆ‡æ¢ä¸€ä¸ª data-theme å±æ€§ï¼ˆä¾‹å¦‚ï¼Œdata-theme=&quot;light&quot; æˆ– data-theme=&quot;dark&quot;ï¼‰ã€‚CSS ä¼šæ ¹æ®è¿™ä¸ªå±æ€§çš„å€¼ï¼Œè‡ªåŠ¨åº”ç”¨å¯¹åº”çš„é¢œè‰²å˜é‡é›†ï¼Œä»è€Œå®ç°æ•´ä¸ªç½‘ç«™çš„é¢œè‰²åˆ‡æ¢ã€‚
1/* åŸºç¡€/æµ…è‰²ä¸»é¢˜å˜é‡ */ 2:root { 3 --background: #ffffff; 4 --text: #000000; 5 --link: #3366cc; 6 /* ... å…¶ä»–é¢œè‰²å˜é‡ */ 7} 8 9/* æ·±è‰²ä¸»é¢˜å˜é‡ */ 10[data-theme=&#39;dark&#39;] { 11 --background: #1b1b1b; 12 --text: #d8d8d8; 13 --link: #88a9e9; 14 /* ... å…¶ä»–é¢œè‰²å˜é‡ */ 15} 16 17/* åœ¨ç»„ä»¶ä¸­ä½¿ç”¨å˜é‡ */ 18body { 19 background-color: var(--background); 20 color: var(--text); 21} 22 23a { 24 color: var(--link); 25} è¿™ç§æ–¹æ³•çš„ä¼˜åŠ¿åœ¨äºï¼Œæˆ‘ä»¬æ— éœ€åŠ è½½ä¸åŒçš„ CSS æ–‡ä»¶ï¼Œåªéœ€æ”¹å˜ä¸€ä¸ªå±æ€§ï¼Œå°±èƒ½é«˜æ•ˆåœ°é‡ç»˜æ•´ä¸ªé¡µé¢çš„é¢œè‰²ï¼Œéå¸¸çµæ´»ä¸”æ€§èƒ½ä¼˜ç§€ã€‚
æ¼äººçš„â€œé—ªçƒâ€é—®é¢˜åŠè§£å†³æ–¹æ¡ˆ å¾ˆå¤šä¸»é¢˜åˆ‡æ¢æ–¹æ¡ˆéƒ½å­˜åœ¨ä¸€ä¸ªé€šç—…ï¼šå½“ç”¨æˆ·é€‰æ‹©æ·±è‰²æ¨¡å¼å¹¶åˆ·æ–°é¡µé¢æ—¶ï¼Œé¡µé¢ä¼šå…ˆä»¥é»˜è®¤çš„æµ…è‰²æ¨¡å¼çŸ­æš‚æ˜¾ç¤ºï¼Œç„¶åâ€œé—ªçƒâ€ä¸€ä¸‹å†å˜æˆæ·±è‰²ã€‚
é—ªçƒåŸå› ï¼šè¿™æ˜¯å› ä¸ºè´Ÿè´£åˆ‡æ¢ä¸»é¢˜çš„ JavaScript è„šæœ¬é€šå¸¸æ”¾åœ¨ &lt;body&gt; åº•éƒ¨åŠ è½½ã€‚æµè§ˆå™¨ä¼šå…ˆæŒ‰ç…§ CSS çš„é»˜è®¤è®¾ç½®ï¼ˆé€šå¸¸æ˜¯æµ…è‰²ä¸»é¢˜ï¼‰æ¸²æŸ“é¡µé¢ï¼Œç­‰ JS åŠ è½½å¹¶æ‰§è¡Œåï¼Œæ‰æŠŠä¸»é¢˜åˆ‡æ¢è¿‡æ¥ï¼Œè¿™ä¸ªè¿‡ç¨‹å°±é€ æˆäº†é—ªçƒã€‚
è§£å†³æ–¹æ¡ˆï¼šç­”æ¡ˆæ˜¯åœ¨æµè§ˆå™¨æ¸²æŸ“ &lt;body&gt; ä¹‹å‰å°±ç¡®å®šå¥½ä¸»é¢˜ã€‚æˆ‘ä»¬å°†ä¸€å°æ®µå…³é”®çš„ JavaScript ä»£ç ä½œä¸ºå†…è”è„šæœ¬ç›´æ¥æ”¾åœ¨ &lt;head&gt; æ ‡ç­¾ä¸­ã€‚
è¿™æ®µè„šæœ¬çš„ä»»åŠ¡éå¸¸çº¯ç²¹ï¼š
æ£€æŸ¥ localStorage ä¸­æ˜¯å¦æœ‰ç”¨æˆ·ä¹‹å‰ä¿å­˜çš„ä¸»é¢˜åå¥½ã€‚ å¦‚æœæ²¡æœ‰ï¼Œåˆ™æ£€æŸ¥ç”¨æˆ·çš„æ“ä½œç³»ç»Ÿæ˜¯å¦åå¥½æ·±è‰²æ¨¡å¼ã€‚ æ ¹æ®ç»“æœï¼Œç«‹å³åœ¨ &lt;html&gt; æ ‡ç­¾ä¸Šè®¾ç½® data-theme å±æ€§ã€‚ å› ä¸ºè¿™æ®µè„šæœ¬åœ¨ &lt;head&gt; ä¸­ï¼Œå®ƒä¼šæ¯”é¡µé¢çš„ä»»ä½•å¯è§å…ƒç´ ï¼ˆ&lt;body&gt; å†…çš„å†…å®¹ï¼‰éƒ½å…ˆæ‰§è¡Œï¼Œä»è€Œç¡®ä¿äº†æµè§ˆå™¨åœ¨â€œç¬¬ä¸€å¸§â€æ¸²æŸ“æ—¶å°±ä½¿ç”¨äº†æ­£ç¡®çš„ä¸»é¢˜ï¼Œå½»åº•æ¶ˆé™¤äº†é—ªçƒã€‚
åˆ†æ­¥å®ç°æŒ‡å— ç¬¬ 1 æ­¥ï¼šåœ¨ header.html ä¸­æ·»åŠ æ ¸å¿ƒè„šæœ¬å’Œåˆ‡æ¢æŒ‰é’® é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦å°†å®ç°æ— é—ªçƒåˆ‡æ¢çš„æ ¸å¿ƒè„šæœ¬å’ŒæŒ‰é’®æ·»åŠ åˆ°ä¸»é¢˜çš„ header.html ä¸­ã€‚
1// filepath: layouts/partials/header.html 2 3&lt;head&gt; 4 {{/* ... å…¶ä»– head å†…å®¹ ... */}} 5 6 {{/* æ ¸å¿ƒï¼šé˜²æ­¢é—ªçƒçš„å†…è”è„šæœ¬ */}} 7 &lt;script&gt; 8 // åœ¨é¡µé¢åŠ è½½æˆ–åˆ‡æ¢ä¸»é¢˜æ—¶ï¼Œæ­¤è„šæœ¬åº”å†…è”åœ¨ &lt;head&gt; ä¸­ä»¥é¿å… FOUC (Flash of Unstyled Content) 9 (function() { 10 const theme = localStorage.getItem(&#39;theme&#39;) || (window.matchMedia(&#39;(prefers-color-scheme: dark)&#39;).matches ? &#39;dark&#39; : &#39;light&#39;); 11 document.documentElement.setAttribute(&#39;data-theme&#39;, theme); 12 })(); 13 &lt;/script&gt; 14 15 {{/* ... å…¶ä»– head å†…å®¹ï¼Œå¦‚ CSS é“¾æ¥ç­‰ ... */}} 16&lt;/head&gt; 17 18&lt;body&gt; 19 &lt;nav&gt; 20 &lt;ul class=&#34;menu&#34;&gt; 21 {{/* ... å…¶ä»–èœå•é¡¹ ... */}} 22 &lt;li&gt;&lt;a href=&#34;/posts&#34;&gt;æ–‡ç« &lt;/a&gt;&lt;/li&gt; 23 {{/* ä¸»é¢˜åˆ‡æ¢æŒ‰é’® */}} 24 &lt;li&gt;&lt;button id=&#34;theme-switcher&#34; class=&#34;menu-link&#34; type=&#34;button&#34;&gt;ğŸŒ—&lt;/button&gt;&lt;/li&gt; 25 &lt;/ul&gt; 26 &lt;/nav&gt; 27 {{/* ... */}} ç¬¬ 2 æ­¥ï¼šåˆ›å»ºå¤„ç†æŒ‰é’®äº¤äº’çš„ JavaScript æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªå•ç‹¬çš„ JS æ–‡ä»¶æ¥å¤„ç†æŒ‰é’®çš„ç‚¹å‡»äº‹ä»¶ã€‚è¿™ä¸ªè„šæœ¬å¯ä»¥æ”¾åœ¨ &lt;body&gt; åº•éƒ¨åŠ è½½ï¼Œå› ä¸ºå®ƒä¸è´Ÿè´£åˆå§‹ä¸»é¢˜çš„è®¾å®šï¼Œåªè´Ÿè´£å“åº”ç”¨æˆ·æ“ä½œã€‚
1// filepath: static/js/theme-switcher.js 2 3(function() { 4 const themeSwitcher = document.getElementById(&#39;theme-switcher&#39;); 5 if (!themeSwitcher) { 6 return; 7 } 8 9 // é¡µé¢åŠ è½½æ—¶ï¼Œæ ¹æ®å½“å‰ä¸»é¢˜è®¾ç½®æŒ‰é’®å›¾æ ‡ 10 let currentTheme = document.documentElement.getAttribute(&#39;data-theme&#39;); 11 themeSwitcher.textContent = currentTheme === &#39;dark&#39; ? &#39;â˜€ï¸&#39; : &#39;ğŸŒ—&#39;; 12 13 // ç›‘å¬æŒ‰é’®ç‚¹å‡»äº‹ä»¶ 14 themeSwitcher.addEventListener(&#39;click&#39;, () =&gt; { 15 // åˆ‡æ¢ä¸»é¢˜ 16 currentTheme = document.documentElement.getAttribute(&#39;data-theme&#39;) === &#39;dark&#39; ? &#39;light&#39; : &#39;dark&#39;; 17 document.documentElement.setAttribute(&#39;data-theme&#39;, currentTheme); 18 19 // å°†ç”¨æˆ·çš„é€‰æ‹©å­˜å…¥ localStorage 20 localStorage.setItem(&#39;theme&#39;, currentTheme); 21 22 // æ›´æ–°æŒ‰é’®å›¾æ ‡ 23 themeSwitcher.textContent = currentTheme === &#39;dark&#39; ? &#39;â˜€ï¸&#39; : &#39;ğŸŒ—&#39;; 24 }); 25})(); åˆ«å¿˜äº†åœ¨ footer_scripts.html æˆ–ç±»ä¼¼çš„åœ°æ–¹å¼•å…¥è¿™ä¸ªè„šæœ¬ï¼š &lt;script src=&quot;{{ &quot;js/theme-switcher.js&quot; | relURL }}&quot;&gt;&lt;/script&gt;
ç¬¬ 3 æ­¥ï¼šé…ç½® CSS é¢œè‰²å˜é‡ æœ€åï¼Œä¹Ÿæ˜¯æœ€å…³é”®çš„ä¸€æ­¥ï¼Œæ˜¯é…ç½®å¥½æˆ‘ä»¬çš„ CSS æ–‡ä»¶ï¼Œè®©å®ƒèƒ½å¤Ÿå“åº” data-theme å±æ€§çš„å˜åŒ–ã€‚
1/* filepath: assets/css/main.css */ 2 3/* é»˜è®¤/æµ…è‰²ä¸»é¢˜å˜é‡ */ 4:root { 5 --background: #ffffff; 6 --text: black; 7 --link: #3366cc; 8 --card-background: #f9f9f9; 9 /* ... æ›´å¤šé¢œè‰² */ 10} 11 12/* å½“ data-theme=&#39;light&#39; æ—¶åº”ç”¨çš„å˜é‡ï¼ˆå¯é€‰ï¼Œç”¨äºæ˜ç¡®æŒ‡å®šï¼‰ */ 13[data-theme=&#39;light&#39;] { 14 --background: #ffffff; 15 --text: black; 16 --link: #3366cc; 17 --card-background: #f9f9f9; 18 /* ... */ 19} 20 21/* å½“ data-theme=&#39;dark&#39; æ—¶åº”ç”¨çš„å˜é‡ */ 22[data-theme=&#39;dark&#39;] { 23 --background: #1b1b1b; 24 --text: #d8d8d8; 25 --link: #88a9e9; 26 --card-background: #272727; 27 /* ... æ›´å¤šé¢œè‰² */ 28} 29 30/* ... ä¹‹åçš„ CSS è§„åˆ™å…¨éƒ¨ä½¿ç”¨ var() æ¥å¼•ç”¨é¢œè‰² ... */ 31body { 32 background-color: var(--background); 33 color: var(--text); 34} 35 36.subcategory-card { 37 background-color: var(--card-background); 38} æ€»ç»“ é€šè¿‡å°†ä¸»é¢˜å†³ç­–é€»è¾‘å‰ç½®åˆ° &lt;head&gt; å¹¶ç»“åˆ CSS å˜é‡ï¼Œæˆ‘ä»¬æ„å»ºäº†ä¸€ä¸ªå¥å£®ã€é«˜æ•ˆä¸”ç”¨æˆ·ä½“éªŒæä½³çš„ä¸»é¢˜åˆ‡æ¢ç³»ç»Ÿã€‚è¿™ä¸ªæ–¹æ¡ˆä¸ä»…è§£å†³äº†æ¼äººçš„â€œé—ªçƒâ€é—®é¢˜ï¼Œå…¶æ¨¡å—åŒ–çš„ç»“æ„ä¹Ÿä½¿å¾—æœªæ¥çš„æ ·å¼ç»´æŠ¤å’Œæ‰©å±•å˜å¾—å¼‚å¸¸ç®€å•ã€‚å¸Œæœ›è¿™ç¯‡æ–‡ç« èƒ½å¯¹ä½ æœ‰æ‰€å¸®åŠ©ï¼
data-theme è‡ªå®šä¹‰å±æ€§åŸç† 1:root { 2Â --complimentary: #815205; 3Â --text: black; 4Â --code: black; 5Â --accent-color: #00aaff; 6Â --accent-color-light: rgba(0, 170, 255, 0.1); 7Â --card-background: #cccccc5f; 8Â --card-background-hover: #6e6b6bff; 9Â --card-text-color: #100101ff; 10Â --shadow-color: rgba(0, 0, 0, 0.1); 11Â --text-dim: #444; 12Â --link: #3366cc; 13Â --link-visited: #795cb2; 14Â --code-background: #f3f5f7; 15Â --code-border: #eaecf0; 16Â --code-border: transparent; 17Â --code-hl: #e6e6e6; 18Â --border-general: #cccfd4; 19Â --table-th: #e1e5ea; 20Â --table-tr: #edeff2; 21Â --toc-background: #f9f9f9; 22Â --toc-border: #aaa; 23Â --output-background: #d5dbe3; 24Â --output-foreground: #805105; 25} 26 27[data-theme=&#39;light&#39;] { 28Â --background: #ffffff; 29} 30 31[data-theme=&#39;dark&#39;] { 32Â --background: #1b1b1b; 33Â --text: #d8d8d8; 34Â --code: #cbcbcb; 35Â --accent-color: #00aaff; 36Â --accent-color-light: rgba(0, 170, 255, 0.2); 37Â --card-background: #272727; 38Â --card-background-hover: #444; 39Â --card-text-color: #d8d8d8; 40Â --shadow-color: rgba(0, 0, 0, 0.3); 41Â --text-dim: #a7a7a7; 42Â --link: #88a9e9; 43Â --link-visited: #a390ca; 44Â --code-background: #272727; 45Â --code-border: transparent; 46Â --code-hl: #5a5a5a; 47Â --border-general: #495057; 48Â --table-th: #414141; 49Â --table-tr: #343434; 50Â --toc-background: #343434; 51Â --toc-border: #495057; 52Â --output-background: #020202; 53} å‘æˆ‘è§£é‡Šä¸Šé¢çš„ä»£ç ,å¹¶å‘æˆ‘è§£é‡Š data-themeçš„åŸç†
å½“ç„¶ï¼Œæˆ‘å¾ˆä¹æ„ä¸ºä½ è§£é‡Šè¿™æ®µä»£ç ä»¥åŠ data-theme çš„å·¥ä½œåŸç†ã€‚
ç®€å•æ¥è¯´ï¼Œè¿™æ®µ CSS ä»£ç ä½¿ç”¨ CSS å˜é‡ï¼ˆä¹Ÿå«è‡ªå®šä¹‰å±æ€§ï¼‰å’Œ data- å±æ€§æ¥åˆ›å»ºä¸€å¥—çµæ´»çš„ä¸»é¢˜ç³»ç»Ÿï¼Œå¯ä»¥è½»æ¾åœ°åœ¨æµ…è‰²æ¨¡å¼ (light mode) å’Œæ·±è‰²æ¨¡å¼ (dark mode) ä¹‹é—´åˆ‡æ¢ã€‚
ä»£ç è§£æ è¿™æ®µä»£ç ä¸»è¦åˆ†ä¸ºä¸‰ä¸ªéƒ¨åˆ†ï¼š
1. :root â€” å…¨å±€é»˜è®¤å˜é‡ 1:root { 2Â --complimentary: #815205; 3Â --text: black; 4 /* ... å…¶ä»–å˜é‡ ... */ 5} :root é€‰æ‹©å™¨ï¼šè¿™ä¸ªé€‰æ‹©å™¨æŒ‡å‘æ–‡æ¡£çš„æ ¹å…ƒç´ ï¼Œåœ¨ HTML ä¸­å°±æ˜¯ &lt;html&gt; æ ‡ç­¾ã€‚åœ¨è¿™é‡Œå®šä¹‰çš„å˜é‡æ˜¯å…¨å±€çš„ï¼Œå¯ä»¥åœ¨æ•´ä¸ªé¡µé¢çš„ä»»ä½•åœ°æ–¹ä½¿ç”¨ã€‚ CSS å˜é‡ (Custom Properties)ï¼šä»¥ -- å¼€å¤´çš„éƒ½æ˜¯ CSS å˜é‡ã€‚ä½ å¯ä»¥æŠŠå®ƒä»¬çœ‹ä½œæ˜¯å€¼çš„â€œå ä½ç¬¦â€ã€‚ä¾‹å¦‚ï¼Œ--text: black; å®šä¹‰äº†ä¸€ä¸ªåä¸º text çš„å˜é‡ï¼Œå®ƒçš„å€¼æ˜¯é»‘è‰²ã€‚ ä½œç”¨ï¼šè¿™ä¸ªéƒ¨åˆ†å®šä¹‰äº†ç½‘ç«™çš„é»˜è®¤ä¸»é¢˜ï¼Œæˆ–è€…è¯´æ˜¯â€œåŸºç¡€â€é¢œè‰²ã€‚å½“æ²¡æœ‰æŒ‡å®šç‰¹å®šä¸»é¢˜æ—¶ï¼Œç½‘ç«™å°±ä¼šä½¿ç”¨è¿™äº›é¢œè‰²ã€‚ 2. [data-theme='light'] â€” æµ…è‰²ä¸»é¢˜ 1[data-theme=&#39;light&#39;] { 2Â --background: #ffffff; 3} [data-theme='light']ï¼šè¿™æ˜¯ä¸€ä¸ªå±æ€§é€‰æ‹©å™¨ã€‚å®ƒçš„æ„æ€æ˜¯ï¼šâ€œé€‰æ‹©ä»»ä½•å¸¦æœ‰ data-theme å±æ€§å¹¶ä¸”è¯¥å±æ€§çš„å€¼ä¸º light çš„å…ƒç´ â€ã€‚ ä½œç”¨ï¼šå½“ &lt;html&gt; æˆ– &lt;body&gt; æ ‡ç­¾è¢«è®¾ç½®ä¸º &lt;html data-theme=&quot;light&quot;&gt; æ—¶ï¼Œè¿™ä¸ªè§„åˆ™å°±ä¼šç”Ÿæ•ˆã€‚å®ƒå®šä¹‰äº†æµ…è‰²ä¸»é¢˜ä¸‹çš„ç‰¹å®šå˜é‡ã€‚åœ¨è¿™é‡Œï¼Œå®ƒåªå®šä¹‰äº† --background ä¸ºç™½è‰² (#ffffff)ã€‚å…¶ä»–æ²¡æœ‰è¢«é‡æ–°å®šä¹‰çš„å˜é‡ï¼ˆå¦‚ --textï¼‰ä¼šç»§ç»­ä½¿ç”¨ :root ä¸­çš„é»˜è®¤å€¼ã€‚ 3. [data-theme='dark'] â€” æ·±è‰²ä¸»é¢˜ 1[data-theme=&#39;dark&#39;] { 2Â --background: #1b1b1b; 3Â --text: #d8d8d8; 4 /* ... å…¶ä»–å˜é‡ ... */ 5} [data-theme='dark']ï¼šä¸ä¸Šé¢ç±»ä¼¼ï¼Œè¿™ä¸ªå±æ€§é€‰æ‹©å™¨ä¼šåŒ¹é… &lt;html data-theme=&quot;dark&quot;&gt; è¿™æ ·çš„å…ƒç´ ã€‚ ä½œç”¨ï¼šå½“ç½‘ç«™åˆ‡æ¢åˆ°æ·±è‰²æ¨¡å¼æ—¶ï¼Œè¿™ä¸ªè§„åˆ™ä¼šç”Ÿæ•ˆã€‚å®ƒä¼šè¦†ç›– :root ä¸­å®šä¹‰çš„è®¸å¤šå˜é‡ï¼Œå°†å®ƒä»¬æ›¿æ¢ä¸ºé€‚åˆåœ¨æ·±è‰²èƒŒæ™¯ä¸‹æ˜¾ç¤ºçš„é¢œè‰²å€¼ï¼ˆä¾‹å¦‚ï¼ŒèƒŒæ™¯å˜ä¸ºæ·±ç°è‰²ï¼Œæ–‡å­—å˜ä¸ºæµ…ç°è‰²ï¼‰ã€‚ data-theme çš„å·¥ä½œåŸç† data-theme æ˜¯ä¸€ä¸ªè‡ªå®šä¹‰æ•°æ®å±æ€§ (Custom Data Attribute)ã€‚è¿™æ˜¯ HTML5 çš„ä¸€ä¸ªå¾ˆæ£’çš„åŠŸèƒ½ï¼Œå…è®¸ä½ å°†è‡ªå®šä¹‰çš„æ•°æ®å­˜å‚¨åœ¨ HTML å…ƒç´ ä¸Šï¼Œè€Œä¸ä¼šå½±å“å…¶æ ·å¼å’Œè¡Œä¸ºã€‚
å®ƒçš„å·¥ä½œåŸç†å°±åƒä¸€ä¸ªçŠ¶æ€å¼€å…³ ğŸš¦ï¼Œå…·ä½“æ­¥éª¤å¦‚ä¸‹ï¼š
å®šä¹‰æ ·å¼ï¼šå°±åƒä½ ä¸Šé¢æä¾›çš„ CSS ä»£ç ä¸€æ ·ï¼Œæˆ‘ä»¬ä¸ºä¸åŒçš„ data-theme å€¼ï¼ˆå¦‚ light å’Œ darkï¼‰å®šä¹‰ä¸åŒçš„ CSS å˜é‡ã€‚
è®¾ç½®åˆå§‹çŠ¶æ€ï¼šåœ¨ HTML çš„æ ¹å…ƒç´ ï¼ˆé€šå¸¸æ˜¯ &lt;html&gt;ï¼‰ä¸Šè®¾ç½®ä¸€ä¸ªåˆå§‹ä¸»é¢˜ã€‚
1&lt;html data-theme=&#34;light&#34;&gt; 2 &lt;/html&gt; å½“é¡µé¢åŠ è½½æ—¶ï¼Œæµè§ˆå™¨çœ‹åˆ° data-theme=&quot;light&quot;ï¼Œäºæ˜¯ [data-theme='light'] çš„ CSS è§„åˆ™è¢«åº”ç”¨ï¼Œé¡µé¢æ˜¾ç¤ºä¸ºæµ…è‰²ä¸»é¢˜ã€‚
ä½¿ç”¨å˜é‡ï¼šåœ¨ä½ çš„å…¶ä»– CSS æ–‡ä»¶ä¸­ï¼Œä½ ä¸ä¼šç›´æ¥ä½¿ç”¨é¢œè‰²ä»£ç ï¼Œè€Œæ˜¯ä½¿ç”¨ var() å‡½æ•°æ¥è°ƒç”¨è¿™äº›å˜é‡ã€‚
1body { 2 background-color: var(--background); /* ä½¿ç”¨ --background å˜é‡ */ 3 color: var(--text); /* ä½¿ç”¨ --text å˜é‡ */ 4} 5 6a { 7 color: var(--link); /* ä½¿ç”¨ --link å˜é‡ */ 8} è¿™æ ·åšçš„å¥½å¤„æ˜¯ï¼Œä½ åªéœ€è¦æ”¹å˜å˜é‡çš„å€¼ï¼Œæ‰€æœ‰ä½¿ç”¨è¯¥å˜é‡çš„å…ƒç´ çš„æ ·å¼éƒ½ä¼šè‡ªåŠ¨æ›´æ–°ã€‚
ç”¨ JavaScript åˆ‡æ¢ä¸»é¢˜ï¼šå½“ç”¨æˆ·ç‚¹å‡»ä¸€ä¸ªâ€œåˆ‡æ¢ä¸»é¢˜â€æŒ‰é’®æ—¶ï¼Œä½ ä¼šç”¨ JavaScript æ¥æ”¹å˜ &lt;html&gt; æ ‡ç­¾ä¸Š data-theme å±æ€§çš„å€¼ã€‚
1// è·å– &lt;html&gt; å…ƒç´  2const htmlElement = document.documentElement; 3 4// å‡è®¾å½“å‰æ˜¯ &#39;light&#39;ï¼Œæˆ‘ä»¬è¦åˆ‡æ¢åˆ° &#39;dark&#39; 5htmlElement.setAttribute(&#39;data-theme&#39;, &#39;dark&#39;); åˆ‡æ¢ç¬é—´å‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ
å½“ JavaScript å°† data-theme çš„å€¼ä» 'light' æ”¹ä¸º 'dark' æ—¶ï¼Œæµè§ˆå™¨ä¼šç«‹å³é‡æ–°è®¡ç®—æ ·å¼ï¼š
ä¹‹å‰åŒ¹é…çš„ CSS è§„åˆ™ [data-theme='light'] ä¸å†ç”Ÿæ•ˆã€‚ æ–°çš„ CSS è§„åˆ™ [data-theme='dark'] å¼€å§‹ç”Ÿæ•ˆã€‚ æ‰€æœ‰ CSS å˜é‡ï¼ˆ--background, --text ç­‰ï¼‰çš„å€¼è¢«ç«‹åˆ»æ›´æ–°ä¸ºæ·±è‰²ä¸»é¢˜çš„å€¼ã€‚ æ‰€æœ‰ä½¿ç”¨äº† var() å‡½æ•°çš„å…ƒç´ ï¼ˆæ¯”å¦‚ bodyï¼‰çš„æ ·å¼éƒ½ä¼šè‡ªåŠ¨é‡æ–°æ¸²æŸ“ï¼Œé¡µé¢ç¬é—´å°±ä»æµ…è‰²æ¨¡å¼å˜æˆäº†æ·±è‰²æ¨¡å¼ï¼Œæ— éœ€åˆ·æ–°é¡µé¢ã€‚ æ€»ç»“ æ€»è€Œè¨€ä¹‹ï¼Œè¿™ç§æ–¹æ³•é€šè¿‡ CSS å˜é‡å°†è®¾è®¡ç³»ç»Ÿçš„é¢œè‰²é›†ä¸­ç®¡ç†ï¼Œç„¶ååˆ©ç”¨ data-theme å±æ€§ä½œä¸ºå¼€å…³ï¼Œæœ€åé€šè¿‡ JavaScript æ¥â€œæ‹¨åŠ¨â€è¿™ä¸ªå¼€å…³ï¼Œä»è€Œå®ç°äº†ä¸€ç§éå¸¸ç°ä»£åŒ–ã€é«˜æ•ˆä¸”æ˜“äºç»´æŠ¤çš„ç½‘ç«™ä¸»é¢˜åˆ‡æ¢æ–¹æ¡ˆã€‚
`,url:"https://hugo-dead-simple.netlify.com/frontend/switch_light_drak_theme.html"},"https://hugo-dead-simple.netlify.com/typescript/%E5%AF%B9%E8%B1%A1%E5%AD%97%E9%9D%A2%E9%87%8F.html":{title:"å¯¹è±¡å­—é¢é‡",tags:[],content:`åœ¨ TypeScript ä¸­ï¼Œå¯¹è±¡å­—é¢é‡ï¼ˆObject Literalï¼‰æ˜¯é€šè¿‡èŠ±æ‹¬å· {} æ¥åˆ›å»ºä¸€ä¸ªå¯¹è±¡ï¼Œå¹¶å¯ä»¥ç›´æ¥ä¸ºå…¶æ·»åŠ å±æ€§å’Œå€¼ã€‚è¿™ä¸ JavaScript ä¸­çš„å¯¹è±¡å­—é¢é‡ä½¿ç”¨æ–¹å¼ç±»ä¼¼ï¼Œä½† TypeScript ä¸ºå¯¹è±¡å­—é¢é‡æä¾›äº†ç±»å‹ç³»ç»Ÿï¼Œå¯ä»¥é€šè¿‡ç±»å‹æ³¨è§£æ¥é™åˆ¶å¯¹è±¡çš„ç»“æ„ã€‚
1. åŸºæœ¬çš„å¯¹è±¡å­—é¢é‡ å¯¹è±¡å­—é¢é‡ç”¨äºåˆ›å»ºä¸€ä¸ªæ–°çš„å¯¹è±¡ï¼Œå¯ä»¥ç›´æ¥æŒ‡å®šå…¶å±æ€§å’Œå€¼ï¼š
1const person = { 2 name: &#34;Alice&#34;, 3 age: 30 4}; è¿™é‡Œ person æ˜¯ä¸€ä¸ªå¯¹è±¡å­—é¢é‡ï¼ŒåŒ…å«äº†ä¸¤ä¸ªå±æ€§ï¼šname å’Œ ageã€‚
2. ä½¿ç”¨ç±»å‹æ³¨è§£æŒ‡å®šå¯¹è±¡å­—é¢é‡çš„ç±»å‹ TypeScript å…è®¸ä½ ä¸ºå¯¹è±¡å­—é¢é‡æŒ‡å®šç±»å‹ï¼Œä»è€Œé™åˆ¶å¯¹è±¡çš„å±æ€§å’Œç±»å‹ã€‚è¿™ä½¿å¾—ä»£ç æ›´åŠ å®‰å…¨ï¼Œèƒ½å¤Ÿé˜²æ­¢é”™è¯¯çš„å±æ€§èµ‹å€¼ã€‚
ç¤ºä¾‹ï¼šä½¿ç”¨ type æˆ– interface å®šä¹‰å¯¹è±¡ç±»å‹ 1interface Person { 2 name: string; 3 age: number; 4} 5 6const person: Person = { 7 name: &#34;Alice&#34;, 8 age: 30 9}; åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼ŒPerson æ˜¯ä¸€ä¸ªæ¥å£ï¼ˆinterfaceï¼‰ï¼Œå®ƒå®šä¹‰äº† name å’Œ age å±æ€§çš„ç±»å‹ã€‚ç„¶åæˆ‘ä»¬é€šè¿‡ç±»å‹æ³¨è§£ const person: Person æ¥ç¡®ä¿ person å¯¹è±¡ç¬¦åˆè¿™ä¸ªç±»å‹ã€‚
ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨ type æ¥å®šä¹‰ç±»å‹ï¼š
1type Person = { 2 name: string; 3 age: number; 4}; 5 6const person: Person = { 7 name: &#34;Alice&#34;, 8 age: 30 9}; 3. åœ¨å¯¹è±¡å­—é¢é‡ä¸­ä½¿ç”¨å¯é€‰å±æ€§ åœ¨å¯¹è±¡å­—é¢é‡ä¸­ï¼Œä½ å¯ä»¥å®šä¹‰å¯é€‰å±æ€§ï¼Œé€šè¿‡åœ¨å±æ€§ååæ·»åŠ  ? æ¥å®ç°ã€‚
1interface Person { 2 name: string; 3 age: number; 4 address?: string; // å¯é€‰å±æ€§ 5} 6 7const person: Person = { 8 name: &#34;Alice&#34;, 9 age: 30 10 // address æ˜¯å¯é€‰çš„ï¼Œå¯ä»¥ä¸æä¾› 11}; åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œaddress å±æ€§æ˜¯å¯é€‰çš„ï¼Œå› æ­¤ä½ å¯ä»¥åœ¨åˆ›å»º person å¯¹è±¡æ—¶ä¸æä¾›è¯¥å±æ€§ã€‚
4. åªè¯»å±æ€§ TypeScript è¿˜å…è®¸ä½ ä¸ºå¯¹è±¡å­—é¢é‡å®šä¹‰åªè¯»å±æ€§ï¼Œè¿™æ„å‘³ç€è¿™äº›å±æ€§çš„å€¼åœ¨åˆå§‹åŒ–åä¸èƒ½è¢«ä¿®æ”¹ã€‚å¯ä»¥ä½¿ç”¨ readonly ä¿®é¥°ç¬¦æ¥å®ç°ã€‚
1interface Person { 2 readonly name: string; 3 readonly age: number; 4} 5 6const person: Person = { 7 name: &#34;Alice&#34;, 8 age: 30 9}; 10 11// person.name = &#34;Bob&#34;; // è¿™æ˜¯ä¸å…è®¸çš„ï¼Œä¼šæŠ¥é”™ åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œname å’Œ age æ˜¯åªè¯»çš„ï¼Œå› æ­¤ä½ ä¸èƒ½ä¿®æ”¹å®ƒä»¬çš„å€¼ã€‚
5. å¯¹è±¡å­—é¢é‡ä¸å‡½æ•°ç±»å‹ ä½ è¿˜å¯ä»¥å°†æ–¹æ³•ä½œä¸ºå¯¹è±¡å­—é¢é‡çš„ä¸€éƒ¨åˆ†æ¥ä½¿ç”¨ã€‚å‡½æ•°ç±»å‹å¯ä»¥åœ¨å¯¹è±¡å­—é¢é‡ä¸­ç›´æ¥å®šä¹‰ã€‚
1interface Person { 2 name: string; 3 greet: () =&gt; void; // greet æ˜¯ä¸€ä¸ªå‡½æ•° 4} 5 6const person: Person = { 7 name: &#34;Alice&#34;, 8 greet: () =&gt; { 9 console.log(\`Hello, my name is \${person.name}\`); 10 } 11}; 12 13person.greet(); // è¾“å‡ºï¼šHello, my name is Alice 6. ä½¿ç”¨ç´¢å¼•ç­¾å ç´¢å¼•ç­¾åå…è®¸å¯¹è±¡å­—é¢é‡å…·æœ‰ä»»æ„æ•°é‡çš„å±æ€§ï¼Œå¹¶ä¸”è¿™äº›å±æ€§çš„ç±»å‹æ˜¯é¢„å®šä¹‰çš„ã€‚é€šè¿‡ index signatureï¼Œä½ å¯ä»¥æŒ‡å®šå¯¹è±¡å¯ä»¥æœ‰ä»»æ„æ•°é‡çš„é”®ï¼Œå¹¶é™åˆ¶é”®å€¼çš„ç±»å‹ã€‚
1interface Dictionary { 2 [key: string]: number; // é”®æ˜¯ string ç±»å‹ï¼Œå€¼æ˜¯ number ç±»å‹ 3} 4 5const myDictionary: Dictionary = { 6 apple: 10, 7 banana: 20 8}; 9 10console.log(myDictionary.apple); // è¾“å‡ºï¼š10 åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼ŒDictionary æ¥å£å®šä¹‰äº†ä¸€ä¸ªç´¢å¼•ç­¾åï¼Œå…è®¸ä»»ä½•å­—ç¬¦ä¸²é”®ï¼Œä¸”è¿™äº›é”®å¯¹åº”çš„å€¼éƒ½å¿…é¡»æ˜¯ number ç±»å‹ã€‚
7. ä½¿ç”¨ç±»å‹æ¨æ–­ TypeScript ä¼šè‡ªåŠ¨æ¨æ–­å­—é¢é‡å¯¹è±¡çš„ç±»å‹ã€‚å¦‚æœä½ æ²¡æœ‰æ˜¾å¼åœ°ä¸ºå¯¹è±¡æŒ‡å®šç±»å‹ï¼ŒTypeScript ä¼šæ ¹æ®å¯¹è±¡çš„ç»“æ„è‡ªåŠ¨æ¨æ–­ç±»å‹ã€‚
1const person = { 2 name: &#34;Alice&#34;, 3 age: 30 4}; // TypeScript æ¨æ–­ person çš„ç±»å‹ä¸º { name: string; age: number; } 5 6person.name = &#34;Bob&#34;; // å…è®¸ä¿®æ”¹ 7// person.name = 100; // é”™è¯¯ï¼Œå› ä¸º name åº”è¯¥æ˜¯ string ç±»å‹ 8. ç¦æ­¢é¢å¤–çš„å±æ€§ æœ‰æ—¶ï¼Œä½ å¸Œæœ›å¯¹è±¡å­—é¢é‡åªèƒ½åŒ…å«æŸäº›ç‰¹å®šçš„å±æ€§ï¼Œç¦æ­¢æ·»åŠ ä»»ä½•é¢å¤–çš„å±æ€§ã€‚å¯ä»¥ä½¿ç”¨ exact ç±»å‹æ¥å®ç°è¿™ä¸€ç‚¹ï¼ˆé€šè¿‡ as const æ¥ç¡®ä¿å­—é¢é‡ç±»å‹çš„ç²¾ç¡®æ€§ï¼‰ã€‚
1const person = { 2 name: &#34;Alice&#34;, 3 age: 30 4} as const; // ä½¿ç”¨ &#39;as const&#39; æ¥ç¡®ä¿å±æ€§æ˜¯åªè¯»çš„å¹¶ä¸”ç²¾ç¡®åŒ¹é… 5 6// person.name = &#34;Bob&#34;; // é”™è¯¯ï¼Œå› ä¸º &#39;name&#39; æ˜¯åªè¯»çš„ï¼Œä¸èƒ½ä¿®æ”¹ 7// person.address = &#34;NY&#34;; // é”™è¯¯ï¼Œå› ä¸º \`address\` å±æ€§å¹¶ä¸åœ¨å¯¹è±¡å­—é¢é‡ä¸­ æ€»ç»“ å¯¹è±¡å­—é¢é‡ æ˜¯é€šè¿‡ {} åˆ›å»ºçš„æ™®é€š JavaScript å¯¹è±¡ï¼Œåœ¨ TypeScript ä¸­å¯ä»¥é€šè¿‡ç±»å‹æ³¨è§£æ¥æŒ‡å®šå…¶ç»“æ„ã€‚ ä½ å¯ä»¥ä½¿ç”¨ interface æˆ– type æ¥å®šä¹‰å¯¹è±¡çš„ç»“æ„ï¼Œç¡®ä¿å¯¹è±¡ç¬¦åˆæŸç§é¢„æœŸçš„å½¢çŠ¶ã€‚ TypeScript è¿˜æ”¯æŒå¯é€‰å±æ€§ã€åªè¯»å±æ€§ã€ç´¢å¼•ç­¾åã€æ–¹æ³•ç­‰åŠŸèƒ½ã€‚ TypeScript ä¼šè‡ªåŠ¨æ¨æ–­å¯¹è±¡å­—é¢é‡çš„ç±»å‹ï¼Œå¦‚æœä½ ä¸æä¾›ç±»å‹æ³¨è§£ã€‚ é€šè¿‡è¿™äº›æ–¹å¼ï¼Œä½ å¯ä»¥åœ¨ TypeScript ä¸­åˆ›å»ºçµæ´»ã€ç±»å‹å®‰å…¨çš„å¯¹è±¡å­—é¢é‡ã€‚
`,url:"https://hugo-dead-simple.netlify.com/typescript/%E5%AF%B9%E8%B1%A1%E5%AD%97%E9%9D%A2%E9%87%8F.html"},"https://hugo-dead-simple.netlify.com/typescript/%E7%90%86%E8%A7%A3%E7%B1%BB%E5%A3%B0%E6%98%8E%E5%80%BC%E4%B8%8E%E7%B1%BB%E5%9E%8B.html":{title:"ç†è§£ç±»å£°æ˜å€¼ä¸ç±»å‹",tags:[],content:`è¿™æ®µä»£ç æ¶‰åŠåˆ°äº† TypeScript ä¸­ç±»çš„æ„é€ å‡½æ•°ã€å®ä¾‹å¯¹è±¡ã€ç±»å‹ç­‰æ¦‚å¿µã€‚è®©æˆ‘ä»¬é€æ­¥è§£ææ¯ä¸ªéƒ¨åˆ†ï¼Œç‰¹åˆ«æ˜¯ console.log(C.a) æŠ¥é”™çš„åŸå› ã€‚
ä»£ç è§£æ 1class C { 2 a = &#34;123&#34;; // ç±»å®ä¾‹å±æ€§ 3} 4 5let c: C = new C(); // åˆ›å»º C ç±»çš„ä¸€ä¸ªå®ä¾‹ 6 7console.log(c); // è¾“å‡º: C { a: &#39;123&#39; } 8console.log(C); // è¾“å‡º: [Function: C]ï¼ŒC æ˜¯æ„é€ å‡½æ•° 9// console.log(C.a); // æŠ¥é”™ï¼šProperty &#39;a&#39; does not exist on type &#39;C&#39;. 10console.log(c.a); // è¾“å‡º: 123 11console.log(c instanceof C); // è¾“å‡º: true 1. console.log(C) è¾“å‡ºçš„æ˜¯æ„é€ å‡½æ•° 1console.log(C); // è¾“å‡º: [Function: C] C æ˜¯ä¸€ä¸ªç±»ï¼Œç±»çš„æœ¬è´¨åœ¨ JavaScript ä¸­æ˜¯ä¸€ä¸ªæ„é€ å‡½æ•°ã€‚C æœ¬èº«æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œç”¨æ¥åˆ›å»º C ç±»çš„å®ä¾‹ã€‚ å½“ä½ æ‰“å° C æ—¶ï¼Œè¾“å‡ºçš„æ˜¯ç±»çš„æ„é€ å‡½æ•°ã€‚æ¢å¥è¯è¯´ï¼ŒC æ˜¯ä¸€ä¸ª æ„é€ å‡½æ•°ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªå¯¹è±¡å®ä¾‹æˆ–ç±»çš„ å®ä¾‹ç±»å‹ã€‚ 2. console.log(C.a) æŠ¥é”™çš„åŸå›  1// console.log(C.a); // æŠ¥é”™ï¼šProperty &#39;a&#39; does not exist on type &#39;C&#39;. åœ¨ç±»å®šä¹‰ class C { a = &quot;123&quot;; } ä¸­ï¼Œa æ˜¯ä¸€ä¸ª å®ä¾‹å±æ€§ï¼Œè€Œä¸æ˜¯ ç±»å±æ€§ã€‚ ä¹Ÿå°±æ˜¯è¯´ï¼Œa å±äºç±»çš„å®ä¾‹ï¼ˆä¾‹å¦‚é€šè¿‡ new C() åˆ›å»ºçš„ c å®ä¾‹ï¼‰ï¼Œå¹¶ä¸”åœ¨æ„é€ å‡½æ•°ä¸­åˆå§‹åŒ–ã€‚ å› æ­¤ï¼ŒC ä½œä¸ºæ„é€ å‡½æ•°å¹¶ä¸ç›´æ¥åŒ…å« a å±æ€§ï¼Œa åªèƒ½é€šè¿‡ç±»çš„ å®ä¾‹å¯¹è±¡ è®¿é—®ã€‚ console.log(C.a) ä¼šå¯¼è‡´æŠ¥é”™ï¼Œå› ä¸º a å¹¶ä¸æ˜¯ C è¿™ä¸ªç±»æœ¬èº«çš„å±æ€§ï¼Œè€Œæ˜¯å®ä¾‹çš„å±æ€§ã€‚ 3. console.log(c.a) æ­£å¸¸è¾“å‡º 123 1console.log(c.a); // è¾“å‡º: 123 c æ˜¯ C ç±»çš„ä¸€ä¸ªå®ä¾‹å¯¹è±¡ï¼Œc.a æ˜¯è®¿é—® C ç±»å®ä¾‹ä¸Šçš„å±æ€§ aã€‚ ç”±äº a æ˜¯å®ä¾‹å±æ€§ï¼Œæ‰€ä»¥ä½ å¯ä»¥é€šè¿‡ c.a æ­£å¸¸è®¿é—®åˆ°å€¼ &quot;123&quot;ã€‚ 4. console.log(c instanceof C) è¾“å‡º true 1console.log(c instanceof C); // è¾“å‡º: true instanceof è¿ç®—ç¬¦ç”¨äºæ£€æŸ¥å¯¹è±¡æ˜¯å¦æ˜¯æŸä¸ªç±»çš„å®ä¾‹ã€‚ c instanceof C è¿”å› trueï¼Œè¯´æ˜ c ç¡®å®æ˜¯ C ç±»çš„å®ä¾‹ã€‚instanceof ä¼šæ£€æŸ¥ c æ˜¯å¦æ˜¯é€šè¿‡ C æ„é€ å‡½æ•°åˆ›å»ºçš„å¯¹è±¡ï¼Œæˆ–è€…æ˜¯å¦ä½äº C çš„åŸå‹é“¾ä¸Šã€‚ æ€»ç»“ C æ˜¯æ„é€ å‡½æ•°ï¼šç±» C åœ¨ TypeScript å’Œ JavaScript ä¸­æœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªæ„é€ å‡½æ•°ã€‚é€šè¿‡ new C() åˆ›å»ºçš„å¯¹è±¡æ‰æ˜¯ C ç±»çš„å®ä¾‹ã€‚ å®ä¾‹å±æ€§ vs. ç±»å±æ€§ï¼ša æ˜¯ç±»çš„å®ä¾‹å±æ€§ï¼Œå› æ­¤åªèƒ½é€šè¿‡ç±»çš„å®ä¾‹æ¥è®¿é—®ï¼›è€Œ C æ˜¯ç±»æœ¬èº«çš„æ„é€ å‡½æ•°ï¼Œä¸åŒ…å«å®ä¾‹å±æ€§ aã€‚ instanceof è¿ç®—ç¬¦ï¼šc instanceof C æ£€æŸ¥å¯¹è±¡ c æ˜¯å¦æ˜¯ C ç±»çš„å®ä¾‹ï¼Œè¿”å› true è¡¨ç¤º c æ˜¯é€šè¿‡ C æ„é€ å‡½æ•°åˆ›å»ºçš„ã€‚ æ‰€ä»¥ï¼Œé”™è¯¯çš„æ ¹æºæ˜¯å°† C ç±»æœ¬èº«è¯¯è®¤ä¸ºæ˜¯å®ä¾‹å¯¹è±¡ï¼Œè¯•å›¾ç›´æ¥è®¿é—® aã€‚è€Œå®é™… a æ˜¯ C ç±»å®ä¾‹çš„å±æ€§ï¼Œå¿…é¡»é€šè¿‡å®ä¾‹å¯¹è±¡ï¼ˆå¦‚ c.aï¼‰æ¥è®¿é—®ã€‚
`,url:"https://hugo-dead-simple.netlify.com/typescript/%E7%90%86%E8%A7%A3%E7%B1%BB%E5%A3%B0%E6%98%8E%E5%80%BC%E4%B8%8E%E7%B1%BB%E5%9E%8B.html"},"https://hugo-dead-simple.netlify.com/typescript/src/decorator.html":{title:"è£…é¥°å™¨",tags:[],content:`è£…é¥°å™¨ï¼ˆDecoratorï¼‰æ˜¯ä¸€ç§è¯­æ³•ç»“æ„ï¼Œç”¨æ¥åœ¨å®šä¹‰æ—¶ä¿®æ”¹ç±»ï¼ˆclassï¼‰çš„è¡Œä¸ºã€‚
æˆ‘çš„ç»“æ„
è£…é¥°å™¨æ˜¯ä¸€ä¸ªå‡½æ•°,æœ¬è´¨æ˜¯å¯¹ç±»è¿›è¡Œä¿®æ”¹(Decorator),ç„¶åå¾—åˆ°ä¸€ä¸ªæ–°çš„ç±»,ä½¿è¿™ä¸ªç±»,æœ‰æ–°çš„åŠŸèƒ½.
index
è¦ä½¿ç”¨è¿™ä¸ªä»£ç ,éœ€è¦é…ç½®tsconfig.json
1&#34;experimentalDecorators&#34;: true, /* Enable experimental support for legacy experimental decorators. */ `,url:"https://hugo-dead-simple.netlify.com/typescript/src/decorator.html"},"https://hugo-dead-simple.netlify.com/blog/newnew.html":{title:"Newnew",tags:[],content:`test git action webhook
`,url:"https://hugo-dead-simple.netlify.com/blog/newnew.html"},"https://hugo-dead-simple.netlify.com/blog/hugo%E8%87%AA%E5%8A%A8%E5%8F%91%E5%B8%83.html":{title:"Hugoè‡ªåŠ¨å‘å¸ƒ",tags:[],content:`è‡ªåŠ¨deploy blog åˆ°github å‚è€ƒ
https://letere-gzj.github.io/hugo-stack/p/hugo/custom-blog/#3-github%E9%83%A8%E7%BD%B2 å¯¹åº”çš„è§†é¢‘æ•™ç¨‹: https://www.bilibili.com/video/BV1bovfeaEtQ å¦ä¸€ä¸ª å¯ä»¥ å‘å¸ƒblogåˆ°vpsæœåŠ¡å™¨ ä¸‹é¢æ˜¯æ–°å¦å¤–ä¸€ä¸ªblog
æœ¬æ–‡ç”± ç®€æ‚¦ SimpRead è½¬ç ï¼Œ åŸæ–‡åœ°å€ blog.wjhwjhn.com
èƒŒæ™¯ æˆ‘ä¸€ç›´è®¡åˆ’è¿ç§»æˆ‘çš„åšå®¢ï¼Œä¸€æ–¹é¢æ˜¯è®¤ä¸ºä¹‹å‰ä¸»é¢˜çš„ä»£ç å±•ç¤ºèƒ½åŠ›ä¸å¼ºï¼Œæ–‡ç« çš„ä¿¡æ¯å¯†åº¦ä½ï¼Œä¸é€‚å®œäºæŠ€æœ¯å†…å®¹çš„å±•ç¤ºï¼›å¦ä¸€æ–¹é¢ï¼Œæˆ‘æ›¾è®¤ä¸ºæä¸ºå®‰å…¨çš„ Typechoï¼Œåœ¨ 2023 å¹´ 6 æœˆçˆ†å‡ºäº† XSS æ¼æ´ï¼Œè¿™åŠ å‰§äº†æˆ‘è¿ç§»çš„ç´§è¿«æ€§ã€‚
æ³¨æ„
æœ¬æ–‡æœ€åæ›´æ–°äº 2024-02-13ï¼Œæ–‡ä¸­å†…å®¹å¯èƒ½å·²è¿‡æ—¶ã€‚
èƒŒæ™¯ æˆ‘ä¸€ç›´è®¡åˆ’è¿ç§»æˆ‘çš„åšå®¢ï¼Œä¸€æ–¹é¢æ˜¯è®¤ä¸ºä¹‹å‰ä¸»é¢˜çš„ä»£ç å±•ç¤ºèƒ½åŠ›ä¸å¼ºï¼Œæ–‡ç« çš„ä¿¡æ¯å¯†åº¦ä½ï¼Œä¸é€‚å®œäºæŠ€æœ¯å†…å®¹çš„å±•ç¤ºï¼›å¦ä¸€æ–¹é¢ï¼Œæˆ‘æ›¾è®¤ä¸ºæä¸ºå®‰å…¨çš„ Typechoï¼Œåœ¨ 2023 å¹´ 6 æœˆçˆ†å‡ºäº† XSS æ¼æ´ï¼Œè¿™åŠ å‰§äº†æˆ‘è¿ç§»çš„ç´§è¿«æ€§ã€‚é‰´äºæ­¤ï¼Œæˆ‘æ—©å°±è½¬å‘ä¸€æ¬¾æ—¢ç¾è§‚åˆå®ç”¨çš„é™æ€åšå®¢å¹³å°â€”â€”æˆ‘é€‰æ‹©äº† Hugoï¼Œå¹¶é€‰ç”¨äº† FixIt ä¸»é¢˜ã€‚æ°é€¢è¿‡å¹´ï¼Œæˆ‘æ‹¥æœ‰äº†è®¸å¤šç¢ç‰‡åŒ–çš„æ—¶é—´ï¼Œè¿™æˆä¸ºäº†æˆ‘è¿ç§»åšå®¢çš„ç»ä½³æ—¶æœºã€‚
é—®é¢˜å’Œè§£å†³æ–¹æ¡ˆ åœ¨è¿ç§»åšå®¢çš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘é‡åˆ°äº†ä¸€ç³»åˆ—é—®é¢˜ã€‚ä¸ºäº†å¸®åŠ©åŒæ ·é¢å¯¹è¿™äº›æŒ‘æˆ˜çš„è¯»è€…ï¼Œæˆ‘åœ¨ä¸‹é¢è¯¦ç»†è®°å½•äº†æˆ‘æ‰€é¢ä¸´çš„é—®é¢˜ä»¥åŠæˆ‘é‡‡å–çš„è§£å†³æªæ–½ï¼Œå¸Œæœ›è¿™äº›ç»éªŒèƒ½ä¸ºæ‚¨æä¾›å®é™…çš„å¸®åŠ©å’ŒæŒ‡å¼•ã€‚
è­¦å‘Š
åœ¨è¿ç§»ä¹‹å‰ï¼Œè¯·åŠ¡å¿…å¤‡ä»½åŸæœ‰åšå®¢çš„æ–‡ä»¶å’Œæ•°æ®åº“æ•°æ®ï¼Œä»¥é˜²æ„å¤–å‘ç”Ÿã€‚
æ–‡ç« è¿ç§» æ–‡ç« å†…å®¹ï¼šæ–‡ç« å†…å®¹å‚¨å­˜åœ¨ typecho_contents è¡¨çš„ text å­—æ®µä¸­ï¼Œæå–æ¯”è¾ƒå®¹æ˜“ï¼Œåªéœ€è¦å»é™¤ &lt;!--markdown--&gt; æ ‡è®°å³å¯ï¼ŒåŸå…ˆç¼–å†™æ–‡ç« æ—¶å°±ä½¿ç”¨çš„æ˜¯ markdownï¼Œæ‰€ä»¥ç›´æ¥åˆ›å»ºæ–‡ä»¶å³å¯ï¼Œä¸è¿‡åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ä¹Ÿé‡åˆ°äº†ä¸å°‘é—®é¢˜ åœ¨æˆ‘åˆšå»ºç«‹è¿™ä¸ªåšå®¢æ—¶ï¼Œå› ä¸ºå¯¹ markdown è¯­æ³•çš„ä¸ç†Ÿæ‚‰ï¼Œå¯¼è‡´ä»¥å‰çš„å¾ˆå¤šæ–‡ç« ä½¿ç”¨äº† markdown çš„æ–¹è¨€ã€‚è¿™äº›æ–‡ç« ï¼Œåœ¨ Typecho ä¸­æ˜¾ç¤ºæ­£å¸¸ï¼Œä½†æ˜¯åœ¨ Hugo ä¸­å°±å‡ºç°äº†æ’ç‰ˆé”™è¯¯ï¼Œå¥½åœ¨æœ‰é—®é¢˜çš„æ–‡ç« ä¸æ˜¯å¾ˆå¤šï¼Œè¿™é‡Œæ‰‹åŠ¨ç¼–è¾‘äº†ä¸€ä¸‹ï¼› åœ¨ Hugo ä¸­ï¼Œæ–‡ç« çš„å…ƒä¿¡æ¯ï¼ˆæ–‡ç« åˆ›å»ºæ—¶é—´ã€æ–‡ç« ç±»åˆ«ã€æ–‡ç« æ ‡é¢˜ç­‰â€¦ï¼‰éƒ½å†…åµŒæ–‡ç« å¼€å¤´çš„ yaml å…ƒä¿¡æ¯ä¸­ï¼Œè¿™äº›ä¿¡æ¯éœ€è¦ä» Typecho çš„æ•°æ®åº“ä¸­æå–å¹¶ç”Ÿæˆï¼Œä¾‹å¦‚ typecho_contents è¡¨çš„ created ã€modified ã€title å­—æ®µï¼› åŸå…ˆçš„ Typecho çš„ typecho_contents è¡¨çš„ status å­—æ®µï¼Œå¦‚æœæ˜¯é public çš„æ–‡ç« ï¼Œåˆ™è®¾ç½® hiddenFromHomePage: trueã€hiddenFromSearch: trueã€hiddenFromRss: trueã€hiddenFromRelated: true ä»¥åŠ password: {password} å¯†ç å­—æ®µï¼Œç”±ä¸»é¢˜è¿›è¡ŒåŠ å¯†å¤„ç†ã€‚ åŸåšå®¢é“¾æ¥è·³è½¬ é—®é¢˜ï¼šåŸåšå®¢çš„é“¾æ¥æ˜¯ä½¿ç”¨ /archives/{cid}/ è¿™ç§å½¢å¼çš„ï¼Œè€Œæ–°åšå®¢çš„é“¾æ¥æ˜¯ä½¿ç”¨ /posts/{name} è¿™ç§å½¢å¼çš„ï¼› è§£å†³æ–¹æ¡ˆï¼šåˆ©ç”¨æ–‡ç« å…ƒä¿¡æ¯ä¸­çš„ aliases å­—æ®µæ¥ç”Ÿæˆä¸€ä¸ªé¢å¤–çš„åˆ«åé“¾æ¥ã€‚ è¯„è®ºå’Œé˜…è¯»é‡è¿ç§» ä½¿ç”¨äº† Twikoo çš„è¯„è®ºç³»ç»Ÿï¼Œå¹¶è§£å†³äº†é“¾æ¥è½¬æ¢é—®é¢˜
Twikoo çš„è¯„è®ºç³»ç»Ÿè¿è¡Œåœ¨ docker è®¾å¤‡ä¸­ï¼Œå¹¶ä¸”æ˜ å°„åˆ° 8099 ç«¯å£ã€‚ä¸ºäº†å®‰å…¨æ€§ï¼Œæˆ‘ä½¿ç”¨ ufw å°†æ­¤ç«¯å£è®¾ç½®ä¸º denyï¼Œä½†å‘ç°æ— æ•ˆï¼Œåœ¨ xianyu çš„å¸®åŠ©ä¸‹ (Orz)ï¼Œä½¿ç”¨äº† ufw-dockerï¼Œå¹¶æˆåŠŸè§£å†³ï¼› å› ä¸º Twikoo åŸç”Ÿåªæ”¯æŒä½¿ç”¨ httpï¼Œè€Œæˆ‘çš„åšå®¢ä½¿ç”¨çš„æ˜¯ httpsï¼Œå¯¼è‡´ twikoo è¢« blockã€‚è¿™é‡Œä½¿ç”¨äº†åå‘ä»£ç†æ¥è§£å†³ï¼Œè®¾ç½®äº† https://blog.wjhwjhn.com/twikoo ä»£ç†åˆ° http://localhost:8099 ï¼› é˜…è¯»é‡æ˜¯æˆ‘åœ¨æ•°æ®åº“ä¸­æ–°å¢çš„ viewsNum å­—æ®µï¼Œæˆ‘è¿›è¡Œäº†å¯¼å‡ºç”Ÿæˆï¼Œå¹¶è½¬åŒ–ä¸º Twikoo çš„æ•°æ®æ ¼å¼ï¼› åœ¨è¯„è®ºå’Œé˜…è¯»é‡ä¸­éœ€è¦æä¾›æ–‡ç« çš„åœ°å€å’Œæ ‡é¢˜ï¼Œè€Œåœ¨æ•°æ®åº“ä¸­çš„éƒ½æ˜¯å…ˆå‰çš„åœ°å€å’Œæ ‡é¢˜ã€‚è¿™é‡Œç¼–å†™äº† Python è„šæœ¬ï¼Œé€»è¾‘å¦‚ä¸‹ åœ¨æ–°ç‰ˆåšå®¢ä¸­ï¼Œå»è®¿é—®åŸæ¥çš„è·¯å¾„ä¸‹è®¿é—® html æ–‡ä»¶ï¼ˆé€šè¿‡ aliases å­—æ®µç”Ÿæˆçš„è·³è½¬æ–‡ä»¶ï¼‰ï¼Œå¹¶ä½¿ç”¨æ­£åˆ™ï¼ˆmeta http-equiv=&quot;refresh&quot; content=&quot;0; url=http://[^/]+(/[^&quot;]+)&quot;ï¼‰å–å‡ºæ›´æ–°åçš„åœ°å€ã€‚ å‰å¾€æ–°ç‰ˆåšå®¢çš„åœ°å€ä¸‹ä½¿ç”¨æ­£åˆ™ï¼ˆ&lt;title&gt;([^&lt;]+)&lt;/title&gt;ï¼‰å–å‡ºæ ‡é¢˜ã€‚ å›¾ç‰‡é“¾æ¥ä¿®å¤ è®© ChatGPT ç¼–å†™æ­£åˆ™ï¼Œæå–å‡ºå›¾ç‰‡é“¾æ¥ï¼Œä»åŸæ¥çš„å›¾ç‰‡é“¾æ¥ä¸­ä¸‹è½½åˆ°æœ¬åœ°ï¼Œå¹¶æ›¿æ¢åŸæœ‰é“¾æ¥
å‘ç°ä»¥å‰æœ‰éƒ¨åˆ†æ—§æ–‡ç« çš„å›¾ç‰‡ä½¿ç”¨çš„æ˜¯ httpï¼Œå¯¼è‡´å›¾ç‰‡æ— æ³•è®¿é—®ï¼Œç¼–å†™äº† SQL è¯­å¥è¿›è¡Œäº†æ›¿æ¢ UPDATE typecho_contents SET text = REPLACE(text, 'http://blog.wjhwjhn', 'https://blog.wjhwjhn');ã€‚ å‘ç°ä»¥å‰æœ‰éƒ¨åˆ†å›¾ç‰‡æ— æ³•è®¿é—®åˆ°ï¼šä¹‹å‰æœ‰è¿‡ä¸€æ®µæ—¶é—´çš„åšå®¢æ–‡ç« ç¼–å†™æ˜¯åœ¨çŸ³å¢¨ä¸Šçš„ï¼Œè€ŒçŸ³å¢¨çš„å¯¼å‡º markdown åŠŸèƒ½ä¹Ÿç»è¿‡ä¸¤æ¬¡çš„è½¬å˜ æˆ‘æœ€æ—©æ¥è§¦çš„æ—¶å€™ï¼ŒçŸ³å¢¨çš„å¯¼å‡ºåŠŸèƒ½æ˜¯å¯ä»¥ç›´æ¥å¯¼å‡ºæ–‡ç« å†…çš„å›¾ç‰‡çš„ï¼Œå¹¶ä¸”ä½¿ç”¨äº†çŸ³å¢¨çš„å›¾ç‰‡å‚¨å­˜æœåŠ¡é“¾æ¥ï¼› ä¼°è®¡åæ¥çŸ³å¢¨å‘ç°ç›—é“¾çš„äººè¿‡å¤šï¼Œäºæ˜¯å¯¹è®¿é—®æ¥æºåšäº†æ£€æµ‹ï¼Œå¯¼è‡´äº†æˆ‘å½“æ—¶æœ‰å¤§é‡çš„åšå®¢å›¾ç‰‡æ— æ³•è®¿é—®ã€‚æˆ‘ç¼–å†™äº†ä¸€ä¸ªæ’ä»¶ï¼Œåœ¨å¯¼å…¥æ—¶å¯¹æ–‡ç« å†…å¤–é“¾å›¾ç‰‡è¿›è¡Œæ£€æµ‹ï¼Œå¦‚æœå­˜åœ¨å¤–é“¾å›¾ç‰‡ï¼Œåˆ™ä¸‹è½½åˆ°æœ¬åœ°å¹¶æ›¿æ¢é“¾æ¥ï¼Œå…·ä½“å†…å®¹æŸ¥çœ‹ åšå®¢å¤–é“¾å›¾ç‰‡å·²æ¢å¤ è¿™ç¯‡æ–‡ç« ï¼› å†åé¢æ–‡ç« å†…å›¾ç‰‡ä½¿ç”¨ base64 è¿›è¡Œç¼–ç åµŒå…¥åœ¨ markdown æ–‡ä»¶ä¸­ï¼Œä½†å¦‚æœå›¾ç‰‡è¿‡å¤§ï¼Œmarkdown æ–‡ä»¶è¿‡å¤§ï¼Œç”šè‡³æ— æ³•åœ¨ Typecho ä¸­å‚¨å­˜ã€‚å› æ­¤æˆ‘ä¹Ÿå°±ä¸ç”¨çŸ³å¢¨å†™æ–‡ç« äº†ï¼Œé€šå¸¸ä¼šåœ¨æœ¬åœ° (ä½¿ç”¨æœ¬åœ°å›¾åºŠ) å†™å¥½æ–‡ç« ï¼Œç„¶åé€šè¿‡æ’ä»¶è‡ªåŠ¨ä¸‹è½½å›¾åºŠå›¾ç‰‡å¹¶ä¿®æ­£åˆ°æœ¬åœ°é“¾æ¥ï¼› æ’ä»¶çš„é²æ£’æ€§ä¸ä½³ï¼Œå­˜åœ¨ä¸‹è½½å¤±è´¥çš„æƒ…å†µï¼Œä¸è¿‡å¥½åœ¨ä¸‹è½½å¤±è´¥çš„æƒ…å†µä¸å¤šï¼Œæˆ‘æ‰‹åŠ¨è¡¥äº†å‡ å¼ å›¾ç‰‡å°±è§£å†³äº†ã€‚ markdown å†…å›¾ç‰‡é“¾æ¥æå–ï¼Œä¸€èˆ¬åˆ†ä¸ºä¸¤ç§å½¢å¼ï¼Œéƒ½æ˜¯ä½¿ç”¨æ­£åˆ™æ¥åŒ¹é… ç›´æ¥åµŒå…¥çš„å›¾ç‰‡![{text}]({url})ï¼ŒåŒ¹é…æ­£åˆ™ï¼š!\\[.*?\\]\\((.*?)\\)ï¼› åœ¨æ–‡ç« åº•éƒ¨ä½¿ç”¨ [{id}]:{url} å®šä¹‰äº†ä¸€ä¸ªè„šæ³¨æˆ–å¼•ç”¨é“¾æ¥ï¼Œåœ¨ä½¿ç”¨æ—¶ä½¿ç”¨ ![{text}][{id}] æ¥å¼•ç”¨ï¼ŒåŒ¹é…æ­£åˆ™ï¼š\\[\\d+\\]:\\s*(.*?)\\s*(?=&quot;#|$)ã€‚ GitHub Action è­¦å‘Š
ä¸ºç¡®ä¿ä¸æ‚¨çš„æœåŠ¡å™¨é…ç½®ã€ä»“åº“è·¯å¾„å’Œç‰¹å®šéœ€æ±‚ç›¸åŒ¹é…ï¼Œè¯·é€‚å½“ä¿®æ”¹ä»¥ä¸‹ä»£ç æ®µã€‚é¿å…ç›´æ¥å¤åˆ¶ç²˜è´´ï¼Œä»¥é¢„é˜²æ½œåœ¨çš„å…¼å®¹æ€§é—®é¢˜æˆ–é…ç½®é”™è¯¯ã€‚
åœ¨è¿‡å»çš„åšå®¢ä¸­ï¼Œå‘å¸ƒæ–‡ç« ä»…éœ€åœ¨åå°ç¼–è¾‘åç›´æ¥å‘é€ï¼Œä¾¿å¯ç«‹å³åœ¨é¡µé¢ä¸Šçœ‹åˆ°æ•ˆæœã€‚ç„¶è€Œï¼Œè‡ªä»è½¬æ¢åˆ°é™æ€åšå®¢å¹³å°åï¼ŒåŸæœ¬ç®€æ´çš„å‘å¸ƒæµç¨‹å˜å¾—å¤æ‚ã€‚ç»è¿‡å‚è€ƒä¼—å¤šæ–‡ç« ä¸èµ„æ–™ï¼Œæˆ‘ç›®å‰é‡‡ç”¨äº† GitHub Action æ¥ç®€åŒ–è¿™ä¸€æµç¨‹ã€‚
æ–°å¢æ–‡ç« æµç¨‹ åœ¨æœ¬åœ°æ“ä½œ Hugo æ–°å¢æ–‡ç« ï¼Œå¹¶ä½¿ç”¨ git è¿›è¡Œç®¡ç†ï¼Œå¹¶ push åˆ° GitHub ä¸Šï¼› GitHub Action æ£€æµ‹åˆ° push å¹¶è‡ªåŠ¨æ‰§è¡Œç¼–è¯‘ï¼Œç¼–è¯‘åçš„é¡µé¢ç»“æœå­˜æ”¾åœ¨ gh-pages åˆ†æ”¯ä¸­ï¼› ç¼–è¯‘å®Œæ¯•åï¼ŒGitHub Action ä½¿ç”¨ Webhook é€šçŸ¥åšå®¢æœåŠ¡å™¨æ¥ GitHub ä¸Šæ‹‰å– gh-pages çš„åšå®¢æ•°æ®ã€‚ å› ä¸ºæˆ‘çš„ GitHub ä»“åº“æ˜¯ç§æœ‰çš„ï¼Œæ‰€ä»¥è¿˜éœ€è¦æŠŠåšå®¢æœåŠ¡å™¨çš„ SSH keys æ·»åŠ åˆ° GitHubï¼Œæ‰èƒ½å¤Ÿæ‹‰å–ç§æœ‰ä»“åº“ã€‚
GitHub Action ä»£ç æµç¨‹ é…ç½®è§£è¯»
å½“ master åˆ†æ”¯è¢« push æ—¶è‡ªåŠ¨æ‰§è¡Œï¼› è¿è¡Œåœ¨ Ubuntu-22.04 çš„ç¯å¢ƒä¸Šï¼› ä½¿ç”¨ Hugo æœ€æ–°æ‰©å±•ç‰ˆå¯¹åšå®¢æºæ–‡ä»¶è¿›è¡Œç¼–è¯‘ï¼› å°†ç¼–è¯‘åçš„ public æ–‡ä»¶å¤¹éƒ¨ç½²åˆ° gh-pages åˆ†æ”¯ä¸Šï¼› é€šè¿‡ Webhook æ¥é€šçŸ¥åšå®¢æœåŠ¡å™¨æ¥åŒæ­¥æœ€æ–°çš„é™æ€é¡µé¢æ•°æ®ã€‚ 1name: GitHub Pages 2 3on: 4 push: 5 branches: 6 - master # Set a branch to deploy 7 pull_request: 8 9jobs: 10 deploy: 11 runs-on: ubuntu-22.04 12 concurrency: 13 group: \${{ github.workflow }}-\${{ github.ref }} 14 steps: 15 - uses: actions/checkout@v4 16 with: 17 submodules: true # Fetch Hugo themes (true OR recursive) 18 fetch-depth: 0 # Fetch all history for .GitInfo and .Lastmod 19 20 - name: Setup Hugo 21 uses: peaceiris/actions-hugo@v2 22 with: 23 hugo-version: &#39;latest&#39; 24 extended: true 25 26 - name: Build 27 run: hugo --minify 28 29 - name: Deploy 30 uses: peaceiris/actions-gh-pages@v3 31 if: github.ref == &#39;refs/heads/master&#39; 32 with: 33 github_token: \${{ secrets.GH_TOKEN }} 34 publish_dir: ./public 35 36 - name: Update Blog Server 37 uses: distributhor/workflow-webhook@v1 38 env: 39 webhook_url: \${{ secrets.WEBHOOK_URL }} 40 webhook_secret: \${{ secrets.WEBHOOK_SECRET }} å®é™…æ•ˆæœå±•ç¤º
Webhook æ‰§è¡Œè„šæœ¬ 1#!/bin/bash 2 3# Start of the script 4echo &#34;$(date &#34;+%Y-%m-%d %H:%M:%S&#34;) Run&#34; 5 6# Define variables 7gitPath=&#34;/www/wwwroot/newblog&#34; 8gitSSH=&#34;git@github.com:wjhwjhn/blog.git&#34; 9 10echo &#34;Web site path: $gitPath&#34; 11 12# Check if the directory exists 13if [ -d &#34;$gitPath&#34; ]; then 14 # Attempt to enter the directory 15 cd &#34;$gitPath&#34; || { echo &#34;Failed to enter directory $gitPath&#34;; exit 1; } 16 17 echo &#34;------&#34; 18 # Check if .git needs to be cloned 19 if [ ! -d &#34;.git&#34; ]; then 20 echo &#34;Cloning git into this directory&#34; 21 if git clone -b gh-pages &#34;$gitSSH&#34; gittemp &amp;&amp; mv gittemp/.git . &amp;&amp; rm -rf gittemp; then 22 echo &#34;Clone successful&#34; 23 else 24 echo &#34;Clone failed&#34; 25 exit 1 26 fi 27 fi 28 29 # Update the git repository 30 if git reset --hard gh-pages &amp;&amp; git pull; then 31 echo &#34;Update successful&#34; 32 else 33 echo &#34;Update failed&#34; 34 exit 1 35 fi 36 37 # Change ownership 38 chown -R www:www &#34;$gitPath&#34; 39 echo &#34;Finish&#34; 40else 41 echo &#34;The project path does not exist&#34; 42 echo &#34;Finish&#34; 43fi Typora å›¾ç‰‡è®¾ç½® Typora æ”¯æŒä¾¿æ·åœ°åœ¨æœ¬åœ°ä¿å­˜æ–‡ä»¶ã€‚ä½†æ˜¯å¦‚æœè®¾ç½®ä¸å½“ï¼Œå®ƒå¯èƒ½æ— æ³•å…¼å®¹ Hugo çš„å›¾ç‰‡å­˜å‚¨æ–¹å¼ï¼Œè¿™é‡Œå¯¹ Typora çš„é…ç½®åšäº†ä»¥ä¸‹è°ƒæ•´
æ ¼å¼ -&gt; å›¾åƒ -&gt; è®¾ç½®å›¾ç‰‡æ ¹ç›®å½•ï¼Œè®¾ç½®ç›®å½•ä¸º Hugo æºæ–‡ä»¶ä¸‹çš„ static æ–‡ä»¶å¤¹
åå¥½è®¾ç½® -&gt; å›¾åƒ -&gt; æ’å…¥å›¾ç‰‡å¤„è®¾ç½®è·¯å¾„ä¸º Hugo æºæ–‡ä»¶ä¸‹çš„ static\\images\\ æ–‡ä»¶å¤¹
è®¾ç½®å®Œæ¯•åï¼Œåœ¨ Typora ä¸­ Ctrl + V ç²˜è´´å›¾ç‰‡å°±ä¼šè‡ªåŠ¨ä»¥ /images/xxx.png çš„é“¾æ¥å‘ˆç°ï¼Œå¹¶æŠŠå›¾ç‰‡ä¿å­˜åœ¨ static\\images\\ æ–‡ä»¶å¤¹ï¼Œè¿™ä¸ªå›¾ç‰‡é“¾æ¥å½¢å¼åœ¨ Typora ä¸­å’Œ Hugo åšå®¢ä¸­éƒ½å¯ä»¥æ­£å¸¸æµè§ˆã€‚
æ€»ç»“ æ­¤æ¬¡è¿ç§»å†æ—¶ä¸‰å¤©ï¼Œè¿‡ç¨‹ä¸­è™½ç„¶é‡åˆ°äº†ä¸å°‘æŒ‘æˆ˜ï¼Œä½†ä¹Ÿæ”¶è·é¢‡ä¸°ã€‚é€šè¿‡æå‡ºé—®é¢˜ã€æ„æ€è§£å†³æ–¹æ¡ˆï¼Œä»¥åŠè¿ç”¨ç¼–ç¨‹æŠ€æœ¯è§£å†³å®é™…é—®é¢˜çš„è¿‡ç¨‹ï¼Œä¸ºæˆ‘å¸¦æ¥äº†æå¤§çš„æ»¡è¶³æ„Ÿã€‚
å››å¹´å‰ï¼Œæˆ‘å»ºç«‹äº†è¿™ä¸ªåšå®¢ï¼Œé‚£æ—¶å¯¹ Linux çš„æ“ä½œæ„Ÿåˆ°æåº¦ç•æƒ§ï¼Œæˆ‘çš„ç†è§£ä¹Ÿä»…é™äºä¹¦æœ¬çŸ¥è¯†ã€‚åœ¨è¿‡å»çš„å››å¹´ä¸­ï¼Œæˆ‘å¯¹ Linuxï¼ˆå°¤å…¶æ˜¯ Ubuntuï¼‰çš„äº†è§£å’Œç†Ÿæ‚‰ç¨‹åº¦æœ‰äº†æ˜¾è‘—æé«˜ï¼Œé€æ¸ä½“ä¼šåˆ°äº†ç±» Unix ç³»ç»Ÿçš„ç‹¬ç‰¹é­…åŠ›ã€‚ä¸æ­¤åŒæ—¶ï¼Œæˆ‘çš„äº‘æœåŠ¡å™¨ä¹Ÿä»æœ€åˆä»¥ Windows ç³»ç»Ÿä¸ºä¸»ã€Linux ç³»ç»Ÿä¸ºè¾…ï¼Œè½¬å˜ä¸ºå…¨é¢é‡‡ç”¨ Linux ç³»ç»Ÿã€‚
ç°åœ¨ï¼Œå›é¡¾èµ·æˆ‘å½“åˆé…ç½®çš„æœåŠ¡å™¨ï¼Œæˆ‘æ„è¯†åˆ°äº†è®¸å¤šå®‰å…¨ä¸Šçš„ç–æ¼ï¼ŒåŒæ ·ï¼Œé‡æ–°å®¡è§†æˆ‘æ—©æœŸçš„æ–‡ç« æ—¶ï¼Œæˆ‘ä¹Ÿæ„è¯†åˆ°äº†å½“æ—¶çš„è§†é‡å±€é™å’Œæ€ç»´çš„ç¨šå«©ã€‚æˆ‘ç›¸ä¿¡ï¼Œå››å¹´åçš„è‡ªå·±å†å›çœ‹ä»Šæ—¥æ‰€åšï¼Œå¯èƒ½ä¼šå¯¹æŸäº›å†³å®šæ„Ÿåˆ°å¯ç¬‘æˆ–æœ‰æ‰€é—æ†¾ã€‚ç„¶è€Œï¼Œæˆ‘è®¤ä¸ºè¿™æ­£ä½“ç°äº†äººç”Ÿçš„ä¸€ç¯â€”â€”æŒç»­å­¦ä¹ ï¼Œå›æœ›è¿‡å¾€ï¼Œå¯¹æ›¾ç»çš„è‡ªå·±ä¼šå¿ƒä¸€ç¬‘ã€‚
`,url:"https://hugo-dead-simple.netlify.com/blog/hugo%E8%87%AA%E5%8A%A8%E5%8F%91%E5%B8%83.html"},"https://hugo-dead-simple.netlify.com/posts/my-first-post.html":{title:"My First Post",tags:[],content:`hdsdf
`,url:"https://hugo-dead-simple.netlify.com/posts/my-first-post.html"},"https://hugo-dead-simple.netlify.com/posts/index.html":{title:"Posts",tags:[],content:"",url:"https://hugo-dead-simple.netlify.com/posts/index.html"},"https://hugo-dead-simple.netlify.com/blog/helloworld.html":{title:"Helloworld",tags:[],content:`hello world write by Rainboy
`,url:"https://hugo-dead-simple.netlify.com/blog/helloworld.html"},"https://hugo-dead-simple.netlify.com/books/%E7%AE%97%E6%B3%95%E7%AB%9E%E8%B5%9B%E8%BF%9B%E9%98%B6%E6%8C%87%E5%8D%97/chapter_1.html":{title:"ç¬¬ä¸€ç«  0x00 åŸºæœ¬ç®—æ³•",tags:[],content:`0x01 ä½è¿ç®— a^b æ ‡å‡†å¿«é€Ÿå¹‚å–ä½™ 64ä½æ•´æ•°ä¹˜æ³• 1018Ã—101810^{18} \\times 10^{18}1018Ã—1018 å¤§æ•°ç›¸ä¹˜ï¼Œè¶…è¿‡èŒƒå›´ï¼Œæ˜¯1å°±åŠ ï¼Œbaseå¢å¢ æœ€çŸ­Hamiltonè·¯å¾„: é›†åˆï¼ŒçŠ¶å‹DP èµ·åºŠå›°éš¾ç»¼åˆç—‡ é€šè¿‡æš´åŠ›éªŒè¯ ä¸ç¬¦åˆ äº¤æ¢å¾‹ åˆ©ç”¨ä½è¿ç®—çš„æ€§è´¨: ç¬¬kkkä½ç½®çš„çš„è¿ç®—ä¸ä¼šå½±å“å…¶å®ƒä½ æ—¶é—´32Ã—2Ã—10532 \\times 2 \\times 10 ^532Ã—2Ã—105 0x02 é€’æ¨ä¸é€’å½’ 01åºåˆ—: å­é›†æšä¸¾
æ’åˆ—,å…¨æ’åˆ— Strange Towers of Hanoi Sumdiv ? Fractal Streets ? 0x03 å‰ç¼€å’Œä¸å·®åˆ† å‰ç¼€å’Œä¸å·®åˆ†ä¸€å¯¹äº’é€†æ˜ å°„,å¯¹åº”çš„åºåˆ—ä¸€ä¸€å¯¹åº” ä»»ä½•åœ¨åŸåºåˆ—ä¸Šçš„åŒºé—´æ“ä½œéƒ½å¯ä»¥è½¬æˆå‰ç¼€å’Œåºåˆ—(subseqsub seqsubseq)çš„ä¸€å¯¹å•ç‚¹æ“ä½œ åº”ç”¨ å¤šä¸ªåŒºé—´ï¼Œå¤šä¸ªç‚¹ ,æŸä¸ªåŒºé—´æ˜¯å¦å«æœ‰ç‚¹ 0x05 äºŒåˆ† äºŒåˆ†å¸¸ç”¨åº”ç”¨ ç¬¬ä¸€ä¸ª/æœ€åä¸€ä¸ªå…ƒç´ xå‡ºç°çš„ä½ç½® æŸä¸ªå…ƒç´ çš„æ•°é‡ ä¸åœ¨åŒºé—´ä¸­çš„ç‚¹ï¼š å¤šä¸ªåŒºé—´ï¼Œå¤šä¸ªç‚¹ï¼Œåˆ¤æ–­æŸä¸€ä¸ªç‚¹æ˜¯å¦åœ¨ä»»ä¸€åŒºé—´é‡Œ æ–¹æ³•: äºŒåˆ†è¿‡æ»¤å‡ºli&lt;dotl_i &lt; dotliâ€‹&lt;dotçš„åŒºé—´,max_right(i)=maxâ¡1â‰¤jâ‰¤i{rj}&gt;dotmax\\_right(i) = \\max_{1 \\le j \\le i} \\{r_j\\} &gt; dot max_right(i)=max1â‰¤jâ‰¤iâ€‹{rjâ€‹}&gt;dot è¡¨æ˜ç‚¹ dotdotdotåœ¨æŸä¸€ä¸ªåŒºé—´å†… Best Cow Fences Ã—1000\\times 1000Ã—1000ç„¶åè¾“å‡º,è¯´æ˜ä¿ç•™ä¸‰ä½ç²¾åº¦,é‚£ä¹ˆç­”æ¡ˆä¸æ˜¯ç²¾ç¡®ç®—å‡ºæ¥çš„,æ˜¯é€¼è¿‘çš„,èƒ½é€¼è¿‘çš„ç®—æ³•: å®æ•°äºŒåˆ† P,Qå…¬å…±æ¡ä»¶( &gt;=L ) è‹¥P: aåºåˆ—çš„æœ€å¤§å¹³å‡æ•°æ˜¯ave åˆ™Q: béœ€è¦ maxsum_subseq = 0 P =&gt; Q P1: aåºåˆ—çš„æœ€å¤§å¹³å‡æ•°æ˜¯ave,ä¸” x &lt; ave,Q1: b( [bi | bi = ai-x ]). maxsum_subseq &gt; 0: P1â‡’Q1P1 \\Rightarrow Q1P1â‡’Q1 åˆ©ç”¨DPå•è°ƒæ€§(æ»‘åŠ¨çª—å£,è½¬ç§»åŒºé—´åªåŠ ) : å­˜åœ¨O(n)çš„ç®—æ³•æ±‚å‡ºæœ€å¤§(&gt;=L)çš„æœ€å¤§å­—æ®µå’Œ æ€»ç»“:äºŒåˆ†ç­”æ¡ˆ: æœ€å¤§å­æ®µå’Œ(båºåˆ—)ä¸ æœ€å¤§å­—æ®µå¹³å‡æ•°(aåºåˆ—)ç›´æ¥çš„å…³ç³»: maxsubseqb&gt;0â‡’max_ave(seqa)&lt;xmax_subseq b &gt; 0 \\Rightarrow max\\_ave(seq a) &lt; xmaxsâ€‹ubseqb&gt;0â‡’max_ave(seqa)&lt;x ,[biâˆ£bi=aiâˆ’x][b_i | b_i = a_i - x][biâ€‹âˆ£biâ€‹=aiâ€‹âˆ’x] Innovative Business TODO
0x05 æ’åº é¢˜ç›®Cinema äºŒç»´å…ƒç»„å¤§å°æ¯”è¾ƒ, éœ€è¦ç¦»æ•£åŒ–(O(logn)O(logn)O(logn)),å†æ¥æ‰«ä¸€éO(n)O(n)O(n)
é¢˜ç›®è´§ä»“é€‰å€ è¯æ˜: åˆ›å»ºç‚¹x,ä½¿å¾—xåˆ°æ•°è½´ä¸Šå…¶å®ƒçš„è·ç¦»å’Œæœ€å°
è¯æ˜: é€’å½’,æ•°å­¦å½’çº³
a---b ä¸¤ä¸ªçš„ç‚¹æ—¶ç­”æ¡ˆé›†åˆä¸º[a,b][a,b][a,b],åˆ†ç±»è®¨è®º a--b--c--d,4ä¸ªç‚¹æ—¶,æœ€å¤–å±‚çš„a,bç­”æ¡ˆ(è´¡çŒ®)[a,b][a,b][a,b],å½“ä¿è¯æœ€ç»ˆç­”æ¡ˆansâˆˆ[a,b]ans \\in [a,b]ansâˆˆ[a,b]æ—¶,å°±å˜æˆäº†ä¸¤ä¸ªç‚¹b--cçš„å­é—®é¢˜,ä¸”[b,c]âŠ‚[a,b][b,c] \\subset [a,b][b,c]âŠ‚[a,b](è´ªå¿ƒ: å†³ç­–åŒ…å®¹æ€§) å¥‡æ•°ä¸ªç‚¹,å¯ä»¥æŠŠä¸­é—´çš„é‚£ä¸ªç‚¹å½“æˆ:ä¸¤ä¸ªé‡åˆçš„ç‚¹,äºæ˜¯å¥‡æ•°å˜æˆå¶æ•°. ä¸ƒå¤•ç¥­ å‰æé¢˜ç›®:
å¤šä¸ªå‡åˆ†çº¸ç‰Œ: luogu P1031 T565389 ç¯å½¢ P2125 P2512 è¯æ˜: å¯æ‹†æ€§: æœ€ä¼˜ç­”æ¡ˆä¸å¯èƒ½æˆç¯(å­˜åœ¨ç›¸é‚»ä¸¤ä¸ªäºº,ä¸ä¼ é€’) 1TODO `,url:"https://hugo-dead-simple.netlify.com/books/%E7%AE%97%E6%B3%95%E7%AB%9E%E8%B5%9B%E8%BF%9B%E9%98%B6%E6%8C%87%E5%8D%97/chapter_1.html"},"https://hugo-dead-simple.netlify.com/books/group_theory/1.2-%E7%BE%A4%E7%9A%84%E6%A6%82%E5%BF%B5.html":{title:"1.2-ç¾¤çš„æ¦‚å¿µ",tags:[],content:`ä»€ä¹ˆæ˜¯ä»£æ•°è¿ç®—ï¼Ÿ
ä»€ä¹ˆæ˜¯ç¾¤: åœ¨ç¾¤Gä¸Šçš„äºŒå…ƒè¿ç®— â‹…\\cdotâ‹… æ»¡è¶³
G0G0G0 : â‹…\\cdotâ‹… æ˜¯ä¸€ä¸ªä»£æ•°è¿ç®— G1G1G1 G2G2G2 G3G3G3 `,url:"https://hugo-dead-simple.netlify.com/books/group_theory/1.2-%E7%BE%A4%E7%9A%84%E6%A6%82%E5%BF%B5.html"},"https://hugo-dead-simple.netlify.com/books/group_theory/1%E7%AD%89%E4%BB%B7%E5%85%B3%E7%B3%BB%E4%B8%8E%E9%9B%86%E5%90%88%E7%9A%84%E5%88%86%E7%B1%BB.html":{title:"1 ç­‰ä»·å…³ç³»ä¸é›†åˆçš„åˆ†ç±»",tags:[],content:`å¯¹åº”è§†é¢‘çš„ p1-p6
å®šä¹‰äºŒå…ƒå…³ç³»RRR
äºŒå…ƒå…³ç³»æ˜¯é›†åˆä¸­å…ƒç´ ä¹‹é—´çš„æŸç§è”ç³»ã€‚å¯¹äºé›†åˆAAAï¼Œå¦‚æœa,bâˆˆAa, b \\in Aa,bâˆˆAï¼Œæˆ‘ä»¬è¯´aaaä¸bbbæœ‰å…³ç³»RRRï¼Œè®°ä½œaRbaRbaRbã€‚
å¯¹äºé›†åˆä¸­çš„ä»»æ„ä¸¤ä¸ªå…ƒç´ ï¼Œaaa ä¸ bbb,æ€»æ˜¯èƒ½åˆ¤æ–­ä»–ä»¬æ˜¯å¦æ»¡è¶³æ¡ä»¶RRR
ç­‰ä»·å…³ç³»
åèº«æ€§ï¼šâˆ€aâ†’aRa\\forall a \\to aRaâˆ€aâ†’aRa
å¯¹ç§°æ€§ï¼šaRbâ‡’bRaaRb \\Rightarrow bRaaRbâ‡’bRa
ä¼ é€’æ€§ï¼šaRbâˆ§bRcâ‡’aRcaRb \\land bRc \\Rightarrow aRcaRbâˆ§bRcâ‡’aRc
ç­‰ä»·ç±»
å®šä¹‰ï¼š[a][a][a]è¡¨ç¤ºæ‰€æœ‰ä¸aaaç­‰ä»·çš„å…ƒç´ çš„é›†åˆ
ç­‰ä»·ç±»æ˜¯æ»¡è¶³ä»¥ä¸‹æ¡ä»¶çš„é›†åˆï¼šä»»æ„ä¸¤ä¸ªå…ƒç´ aaaå’Œbbbéƒ½å±äºåŒä¸€ä¸ªç­‰ä»·ç±»å½“ä¸”ä»…å½“aRbaRbaRb
å…¬å¼å®šä¹‰ï¼š[a]={xâˆˆSâˆ£xRa}[a]= \\{ x \\in S | xRa \\}[a]={xâˆˆSâˆ£xRa}
ç±»åœ¨è¿™é‡Œçš„æ„æ€ä¸ºï¼š&ldquo;ç‰©ä»¥ç¾¤åˆ†&rdquo;, åˆ†ç±»çš„æ„æ€ï¼Œç­‰ä»·ç±»å°±æ˜¯æŠŠæ»¡è¶³ç­‰ä»·å…³ç³»çš„å…ƒç´ å½’ä¸ºä¸€ç±»ã€‚
å•†é›†ï¼šSSSçš„å…¨ä½“ç­‰ä»·ç±»æ„æˆçš„é›†åˆï¼Œé›†åˆSSSåœ¨ç­‰ä»·å…³ç³»ä¸‹çš„å•†é›†è®°ä½œS/âˆ¼S / \\simS/âˆ¼
é›†åˆçš„åˆ†ç±»
åˆ†ç±»çš„å®šä¹‰: é›†åˆ s æ˜¯ä»–çš„æŸäº›ä¸¤ä¸¤ä¸ç›¸äº¤çš„éç©ºå­é›†çš„å¹¶,è¿™äº›éç©ºé›†ï¼Œä½•å°±æ˜¯ s çš„åˆ†ç±»
å…¶ä¸­æ¯ä¸€ä¸ªå­é›†ç§°ä¸ºä¸€ä¸ªç±»
å®šä¹‰ï¼šSSSæ˜¯ä¸€ä¸ªé›†åˆï¼Œå¦‚æœå­˜åœ¨ä¸€ä¸ªç­‰ä»·å…³ç³»RRRä½¿å¾—SSSçš„æ‰€æœ‰å…ƒç´ éƒ½å¯ä»¥åˆ’åˆ†ä¸ºç­‰ä»·ç±»ï¼Œåˆ™ç§°SSSä¸ºRRRçš„åˆ†ç±»
å¦‚æœéç©ºé›†åˆSSSæ˜¯å®ƒçš„æŸäº›ä¸¤ä¸¤ä¸ç›¸äº¤çš„éç©ºå­é›†çš„å¹¶ï¼Œåˆ™ç§°è¿™äº›å­é›†ä¸ºé›†åˆSSSçš„ä¸€ç§åˆ†ç±» ( partition ) , å…¶ä¸­æ¯ä¸ªå­é›†ç§°ä¸ºé›†åˆSSSçš„ä¸€ä¸ªç±» ( class )
é›†åˆçš„åˆ†ç±»å¿…é¡»æ»¡è¶³ä¸é‡ä¸æ¼çš„åŸåˆ™
è‹¥é›†åˆSSSçš„å­é›†æ—{Siâˆ£iâˆˆI}\\{S_i | i \\in I\\}{Siâ€‹âˆ£iâˆˆI}æ„æˆäº† S çš„ä¸€ç§åˆ†ç±»å½“ä¸”ä»…å½“
S=â‹ƒiâˆˆISiS = \\bigcup_{i \\in I} S_iS=â‹ƒiâˆˆIâ€‹Siâ€‹ Siâˆ©Sj=âˆ…S_i \\cap S_j = \\varnothingSiâ€‹âˆ©Sjâ€‹=âˆ…( i.e., SiS_iSiâ€‹ and SjS_jSjâ€‹ are pairwise disjoint ) é›†åˆSSSçš„ä»»ä½•ä¸€ç§ç­‰ä»·å…³ç³»éƒ½ç¡®å®šäº†SSSçš„ä¸€ç§åˆ†ç±»ã€‚
ä¾‹é¢˜ ä¾‹ 5 aRbâ‡”mâˆ£aâˆ’b,âˆ€a,bâˆˆZ(1) aRb \\Leftrightarrow m \\mid a - b , \\forall a,b \\in \\mathbb{Z} \\tag 1 aRbâ‡”mâˆ£aâˆ’b,âˆ€a,bâˆˆZ(1)è¯æ˜ 1 å¼æ˜¯ç­‰ä»·å…³ç³»ã€‚ä¹Ÿå°±æ˜¯è¯æ˜mâˆ£aâˆ’bm | a -b mâˆ£aâˆ’bæ˜¯ç­‰ä»·å…³ç³»ã€‚
å…¬å¼çš„å«ä¹‰è§£é‡Šï¼šm æ˜¯ a ä¸ b å·®çš„å› å­ï¼Œåˆ™è¯´æ˜ a,b å¯¹äº m åŒä½™ã€‚è¿™ä¸¤è€…æ˜¯ç­‰ä»·çš„ã€‚
ä¸‹é¢è¯æ˜è¿™ä¸¤è€…æ˜¯ç­‰ä»·å…³ç³»ã€‚
è®¾ A:aâ‰¡b(modâ€‰m)a \\equiv b ( \\mod m )aâ‰¡b(modm), B: mâˆ£aâˆ’bm \\mid a-bmâˆ£aâˆ’b.
Aâ†’BA \\to BAâ†’B, æŠŠ a,b å†™æˆå¸¦ä½™æ•°é™¤æ³•çš„å½¢å¼ã€‚
a=k1Ã—m+rb=k2Ã—m+raâˆ’b=m(k1âˆ’k2)â†’mâˆ£aâˆ’b a = k_1 \\times m + r \\\\ b = k_2 \\times m + r \\\\ a - b = m ( k_1 - k_2 ) \\to m \\mid a - b a=k1â€‹Ã—m+rb=k2â€‹Ã—m+raâˆ’b=m(k1â€‹âˆ’k2â€‹)â†’mâˆ£aâˆ’bå¿…è¦æ€§è¯æ˜å®Œæ¯•ï¼Œè¯æ˜å……åˆ†æ€§ã€‚
mâˆ£aâˆ’bâ†’aâˆ’b=kÃ—mâ†’a=b+kÃ—mâ†’amodâ€‰m=(b+kÃ—m)modâ€‰mâ†’amodâ€‰m=bmodâ€‰m m \\mid a - b \\\\ \\to a -b = k \\times m \\\\ \\to a = b + k \\times m \\\\ \\to a \\mod m = ( b+k \\times m ) \\mod m \\\\ \\to a \\mod m = b \\mod m mâˆ£aâˆ’bâ†’aâˆ’b=kÃ—mâ†’a=b+kÃ—mâ†’amodm=(b+kÃ—m)modmâ†’amodm=bmodmqed;
è¯æ˜è‡ªåæ€§ï¼š
aRaâ‡”mâˆ£aâˆ’a aRa \\Leftrightarrow m \\mid a - a aRaâ‡”mâˆ£aâˆ’aæ˜¾ç„¶æˆç«‹ã€‚
è¯æ˜å¯¹ç§°æ€§ï¼š
æ ¹æ® mâˆ£xâ†’mâˆ£âˆ’x m \\mid x \\to m \\mid -x mâˆ£xâ†’mâˆ£âˆ’xé‚£ä¹ˆ
mâˆ£aâˆ’bâ†’mâˆ£âˆ’(aâˆ’b)â†’mâˆ£bâˆ’a m \\mid a - b \\to m \\mid - ( a - b ) \\to m \\mid b - a mâˆ£aâˆ’bâ†’mâˆ£âˆ’(aâˆ’b)â†’mâˆ£bâˆ’aè¯æ˜ä¼ é€’æ€§ï¼š
mâˆ£aâˆ’bâˆ§mâˆ£bâˆ’câ†’mâˆ£aâˆ’cm | a - b \\land m| b - c \\to m | a - cmâˆ£aâˆ’bâˆ§mâˆ£bâˆ’câ†’mâˆ£aâˆ’c
a=k1Ã—m+rb=k2Ã—m+rc=k3Ã—m+râ†’aâˆ’c=k1Ã—m+râˆ’k3Ã—mâˆ’râ†’mâˆ£aâˆ’c a = k_1 \\times m + r \\\\ b = k_2 \\times m + r \\\\ c = k_3 \\times m + r \\\\ \\to a - c = k_1 \\times m + r - k_3 \\times m - r\\\\ \\to m \\mid a - c a=k1â€‹Ã—m+rb=k2â€‹Ã—m+rc=k3â€‹Ã—m+râ†’aâˆ’c=k1â€‹Ã—m+râˆ’k3â€‹Ã—mâˆ’râ†’mâˆ£aâˆ’cè¯æ˜å®Œæ¯•
è¯´æ˜åŒä½™æ˜¯ä¸€ç§ç­‰ä»·å…³ç³».
ä¹¦ä¸Šåˆå®šä¹‰äº†ä»€ä¹ˆå«åšåŒä½™å‰©ä½™ç±»ã€‚
ä¾‹ 9 è¿™ä¸ªè§ä¹¦ã€‚
è¯¾åé¢˜ç›® ä¹ é¢˜ 1. è¯•åˆ†åˆ«ä¸¾å‡ºæ»¡è¶³ä¸‹åˆ—æ¡ä»¶çš„å…³ç³»ï¼š ( 1 ) æœ‰å¯¹ç§°æ€§ï¼Œä¼ é€’æ€§ï¼Œä½†æ— åèº«æ€§ï¼› ( 2 ) æœ‰åèº«æ€§ï¼Œä¼ é€’æ€§ï¼Œä½†æ— å¯¹ç§°æ€§ï¼› ( 3 ) æœ‰åèº«æ€§ï¼Œå¯¹ç§°æ€§ï¼Œä½†æ— ä¼ é€’æ€§ã€‚ è§£ï¼šè®¾é›†åˆS={a,b,c}S = \\{a,b,c\\}S={a,b,c}
( 1 ) ,R={(a,b),(b,a),(a,a),b,b}R = \\{( a,b ) , ( b,a ) , ( a,a ) ,{b,b}\\}R={(a,b),(b,a),(a,a),b,b}, å› ä¸ºæ²¡æœ‰(c,c)( c,c )(c,c)æ‰€ä»¥ä¸æ»¡è¶³åèº«æ€§ã€‚ ( 2 ) ,R={(a,a),(b,b),(c,c),(a,b)}R = \\{( a,a ) , ( b,b ) , ( c,c ) , ( a,b ) \\}R={(a,a),(b,b),(c,c),(a,b)}, å› ä¸ºæ²¡æœ‰(b,a)( b,a )(b,a)æ‰€ä»¥ä¸æ»¡è¶³å¯¹ç§°æ€§ã€‚ ( 3 ) ,R={(a,a),(b,b),(c,c),(a,b),(b,a),(c,a),(c,b)}R = \\{( a,a ) , ( b,b ) , ( c,c ) , ( a,b ) , ( b,a ) , ( c,a ) , ( c,b ) \\}R={(a,a),(b,b),(c,c),(a,b),(b,a),(c,a),(c,b)}, å› ä¸ºæ²¡æœ‰(a,c)( a,c )(a,c)æ‰€ä»¥ä¸æ»¡è¶³ä¼ é€’æ€§ã€‚ ä¹ é¢˜ 2. æ‰¾å‡ºä¸‹é¢è¯æ˜ä¸­çš„é”™è¯¯ï¼š æœ‰äººæ–­è¨€ï¼Œè‹¥ S çš„å…³ç³» R æœ‰å¯¹ç§°æ€§å’Œä¼ é€’æ€§ï¼Œåˆ™å¿…æœ‰åèº«æ€§ã€‚è¿™æ™¨å›  å› ä¸ºï¼Œå¯¹ä»»æ„çš„ aâˆˆS, ç”±å¯¹ç§°æ€§ï¼Œå¦‚æœ aRb, åˆ™ bRa. å†ç”±ä¼ é€’æ€§ï¼Œå¾— aRa, æ‰€ä»¥ R æœ‰åèº«æ€§ã€‚
å…³é”®åœ¨äºaâˆˆSa \\in SaâˆˆSï¼Œä½†å¦‚æœaaaå°±æ²¡æœ‰è‡ªå·±çš„å…³ç³»å‘¢ï¼Ÿä¾‹å¦‚ä¹ é¢˜ 1 çš„ ( 1 ) , å°±æ²¡æœ‰ c çš„å…³ç³»ï¼Œæ‰€ä»¥ä¸èƒ½è¯´ R æœ‰åèº«æ€§ã€‚å› ä¸ºä¸ä¸€å®šæœ‰cRbcRbcRbè¿™ä¸ªå…³ç³»ã€‚
ä¹ é¢˜ 4 è®¾ Ï•\\phiÏ• æ˜¯é›†åˆ AAA åˆ° BBB çš„æ˜ å°„ï¼Œa,bâˆˆAa,b\\in Aa,bâˆˆA, è§„å®šå…³ç³» &ldquo;âˆ¼\\simâˆ¼&rdquo;: aâˆ¼bâ€…âŸºâ€…Ï•(a)=Ï•(b)a\\sim b\\iff\\phi ( a ) =\\phi ( b ) aâˆ¼bâŸºÏ•(a)=Ï•(b)è¯æ˜ :âˆ¼: \\sim:âˆ¼ æ˜¯ AAA çš„ä¸€ä¸ªç­‰ä»·å…³ç³»ï¼Œå¹¶æ±‚å…¶ç­‰ä»·ç±»
å¦‚ä½•æ±‚ç­‰ä»·ç±»å‘¢ï¼Ÿå…¶å®è¿™é‡Œæ˜¯é—®æˆ‘ä»¬ç­‰ä»·ç±»çš„æ•°å­¦æè¿°,æˆ‘ä»¬åªè¦æŒ‰ç…§ç­‰ä»·ç±»çš„å®šä¹‰æ¥å†™å°±å¯ä»¥äº†:
A/âˆ¼={[a]âˆ£aâˆˆA}A/\\sim=\\{[a] \\mid a\\in A\\}A/âˆ¼={[a]âˆ£aâˆˆA}å®ƒçš„å«ä¹‰æ˜¯ï¼š
å¯¹äºä¸€ä¸ªé›†åˆ A å’Œåœ¨å…¶ä¸Šå®šä¹‰çš„ç­‰ä»·å…³ç³» ~ï¼ŒA çš„å•†é›† A/~ æ˜¯ä¸€ä¸ªç”± A ä¸­æ‰€æœ‰å…ƒç´ çš„ç­‰ä»·ç±» [a] ç»„æˆçš„æ–°é›†åˆã€‚
ç®€å•æ¥è¯´ï¼Œå°±æ˜¯å°†é›†åˆ A æŒ‰ç…§ç­‰ä»·å…³ç³» ~ è¿›è¡Œåˆ’åˆ†ï¼Œæ¯ä¸ªåˆ’åˆ†å‡ºçš„å­é›†ï¼ˆå³ä¸€ä¸ªç­‰ä»·ç±»ï¼‰éƒ½ä½œä¸ºå•†é›† A/~ ä¸­çš„ä¸€ä¸ªå…ƒç´ ã€‚
[a]={xâˆˆAâˆ£Ï•(x)=Ï•(a)} [a] = \\{ x \\in A \\mid \\phi(x) = \\phi(a) \\} [a]={xâˆˆAâˆ£Ï•(x)=Ï•(a)}`,url:"https://hugo-dead-simple.netlify.com/books/group_theory/1%E7%AD%89%E4%BB%B7%E5%85%B3%E7%B3%BB%E4%B8%8E%E9%9B%86%E5%90%88%E7%9A%84%E5%88%86%E7%B1%BB.html"},"https://hugo-dead-simple.netlify.com/typescript/preverseconstenums.html":{title:"preserveConstEnumsç¼–è¯‘å™¨é€‰é¡¹",tags:["typescript"],content:`preserveConstEnums æ˜¯ TypeScript ç¼–è¯‘å™¨é€‰é¡¹ä¹‹ä¸€ï¼Œä½œç”¨æ˜¯æ§åˆ¶ TypeScript ç¼–è¯‘è¿‡ç¨‹ä¸­æ˜¯å¦ä¿ç•™ const enum çš„å¸¸é‡å€¼ã€‚
è¯¦ç»†ä½œç”¨ï¼š å½“ä½ åœ¨ TypeScript ä¸­ä½¿ç”¨ const enum æ—¶ï¼Œå®ƒä»¬ä¼šåœ¨ç¼–è¯‘æ—¶è¢«å†…è”å±•å¼€ä¸ºå¸¸é‡å€¼ï¼Œè€Œä¸ä¼šç”Ÿæˆå•ç‹¬çš„æšä¸¾ä»£ç ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼ŒTypeScript ä¼šå°† const enum ç¼–è¯‘ä¸ºå¸¸é‡å€¼ï¼Œè€Œä¸ä¼šç”Ÿæˆä»»ä½•æšä¸¾ç›¸å…³çš„ JavaScript ä»£ç ã€‚
å¦‚æœä½ å¯ç”¨ preserveConstEnumsï¼ŒTypeScript ç¼–è¯‘å™¨å°†ä¸ä¼šå†…è” const enumï¼Œè€Œæ˜¯ä¿ç•™è¿™äº›æšä¸¾ï¼Œå¹¶ç”Ÿæˆç›¸åº”çš„ JavaScript ä»£ç ã€‚è¿™æ ·ï¼Œç¼–è¯‘åçš„ä»£ç å°†åŒ…å«æšä¸¾çš„å®é™…å®šä¹‰ï¼Œè€Œä¸æ˜¯ç›´æ¥æ›¿æ¢ä¸ºå¸¸é‡å€¼ã€‚
ä½¿ç”¨åœºæ™¯ï¼š preserveConstEnums: true: å¦‚æœä½ å¸Œæœ› const enum åœ¨ç¼–è¯‘åä¾ç„¶ä¿ç•™ä¸ºæšä¸¾å®šä¹‰ï¼ˆè€Œä¸æ˜¯è¢«å†…è”å±•å¼€ä¸ºå¸¸é‡å€¼ï¼‰ï¼Œå¯ä»¥å¼€å¯è¿™ä¸ªé€‰é¡¹ã€‚ preserveConstEnums: falseï¼ˆé»˜è®¤å€¼ï¼‰ï¼šä¼šç›´æ¥å†…è” const enum çš„å€¼ï¼Œç”Ÿæˆçš„ JavaScript ä»£ç ä¸­ä¸ä¼šåŒ…å«æšä¸¾ç±»å‹å®šä¹‰ã€‚ ç¤ºä¾‹ï¼š 1. preserveConstEnums: false (é»˜è®¤) TypeScript ç¼–è¯‘å™¨å°†å†…è” const enumï¼š
1const enum Color { 2 Red = 1, 3 Green = 2, 4 Blue = 3 5} 6 7let c = Color.Green; // ç¼–è¯‘åç›´æ¥æ›¿æ¢æˆ 2 ç¼–è¯‘åçš„ JavaScript ä»£ç ï¼š
1var c = 2; 2. preserveConstEnums: true å¦‚æœå¯ç”¨ preserveConstEnumsï¼Œç¼–è¯‘åçš„ä»£ç ä¼šä¿ç•™æšä¸¾å®šä¹‰ï¼š
1const enum Color { 2 Red = 1, 3 Green = 2, 4 Blue = 3 5} 6 7let c = Color.Green; ç¼–è¯‘åçš„ JavaScript ä»£ç ï¼š
1var Color; 2(function (Color) { 3 Color[Color[&#34;Red&#34;] = 1] = &#34;Red&#34;; 4 Color[Color[&#34;Green&#34;] = 2] = &#34;Green&#34;; 5 Color[Color[&#34;Blue&#34;] = 3] = &#34;Blue&#34;; 6})(Color || (Color = {})); 7var c = Color.Green; æ€»ç»“ï¼š preserveConstEnums: true ä¿ç•™ const enum çš„å®šä¹‰åœ¨è¾“å‡ºçš„ JavaScript ä»£ç ä¸­ï¼Œè€Œä¸æ˜¯å°†å…¶å†…è”æˆå¸¸é‡å€¼ã€‚ preserveConstEnums: falseï¼ˆé»˜è®¤ï¼‰åˆ™ä¼šå°† const enum çš„æˆå‘˜å†…è”ä¸ºå¸¸é‡å€¼ï¼Œç”Ÿæˆçš„ JavaScript ä»£ç ä¼šæ›´ç®€æ´ã€‚ `,url:"https://hugo-dead-simple.netlify.com/typescript/preverseconstenums.html"},"https://hugo-dead-simple.netlify.com/typescript/src/readme.html":{title:"typescript",tags:["typescript"],content:`å®‰è£… 1yarn global add typescript ts-node æ•°æ®ç±»å‹ string boolean number void ç”¨åœ¨æ²¡æœ‰è¿”å›å€¼çš„å‡½æ•°,å…¶å®ƒå¯ä»¥ç”¨,ä½†ä¸èƒ½èµ‹å€¼ 1function alerme():void { 2 alert(&#39;my name is tom&#39;); 3} null,undefined,æ˜¯æ‰€æœ‰ç±»å‹çš„å­ç±»å‹,å¯ä»¥èµ‹å€¼ç»™å…¶å®ƒç±»å‹,è€Œ void ç±»å‹çš„å˜é‡ä¸èƒ½èµ‹å€¼ç»™ number ç±»å‹çš„å˜é‡ï¼š 1let num:number = null å¯¹è±¡ç±»å‹ 1const xiaoJieJie : { 2 name:string, 3 age:number 4} = { 5 name:&#39;hel&#39;, 6 age:19 7} //1 æ™®é€š 8 9const xiaoJjiejieS :string [] = [&#39;1&#39;,&#39;dajiao&#39;,&#39;liuyaing&#39;]; // 2 .æ•°ç»„ 10 11class Person{} 12const dajiao: Person = new Person() //3 ç±»ç±»å‹ 13 14const jianXiaoJjieJie: () =&gt; string = () =&gt; {return &#34;dajiao&#34;}; //å‡½æ•°å¯¹è±¡ç±»å‹ ç±»å‹æ³¨è§£ ä¸ ç±»å‹æ¨æ–­ type annotation type inference å·¥ä½œä½¿ç”¨çš„åŸåˆ™
å¦‚æœTSèƒ½å¤Ÿè‡ªåŠ¨åˆ†æå˜é‡ç±»å‹,æˆ‘ä»¬å°±ä»€ä¹ˆä¹Ÿä¸éœ€è¦åšäº† å¦‚æœTSæ— æ³•åˆ†æå˜é‡ç±»å‹çš„è¯,æˆ‘ä»¬å°±éœ€è¦ä½¿ç”¨ç±»å‹æ³¨è§£äº† 05 å‡½æ•°å‚æ•°å’Œè¿”å›ç±»å‹çš„æ³¨è§£ 1&lt;%- include(&#34;demo/demo5.ts&#34;) %&gt; 06æ•°ç»„ç±»å‹çš„å®šä¹‰ ç±»å‹åˆ«å 1&lt;%- include(&#34;demo/demo6.ts&#34;) %&gt; 07 å…ƒç»„çš„ä½¿ç”¨ 1&lt;%- include(&#34;demo/demo7.ts&#34;) %&gt; å…ƒç»„ç°åœ¨ç”¨çš„å°‘äº†,å› ä¸ºå¯ä»¥ç”¨å¯¹è±¡çš„å½¢å¼æ¥ä»£æ›¿
08 09 interface æ¥å£ 1&lt;%- include(&#34;demo/demo8.ts&#34;) %&gt; 1&lt;%- include(&#34;demo/demo9.ts&#34;) %&gt; [propname:string] : any; å†…éƒ¨çº¦æŸäº†ä¸€ä¸ªå‡½æ•°say():string; æ¥å£çº¦æŸä¸€ä¸ªç±»class xiaojiejie implements Gril æ¥å£çš„æ‹“å±•interface Teacher extends Girl{} ç›¸å½“äºç»§æ‰¿ ç¬¦åˆå­æ¥å£çš„å¯¹è±¡ä¹Ÿç¬¦åˆçˆ¶æ¥å£ 10 ç±»çš„æ¦‚å¿µå’Œä½¿ç”¨ å®šä¹‰ ç»§æ‰¿ é‡å†™ super è°ƒç”¨çˆ¶ç±»ä¸­çš„æ–¹æ³• 1&lt;%- include(&#34;demo/demo10.ts&#34;) %&gt; ç±»çš„è®¿é—®ç±»å‹ private å†…éƒ¨ç”¨,å¤–éƒ¨ä¸èƒ½ç”¨ protected å†…éƒ¨ç”¨,å¤–éƒ¨ä¸èƒ½ç”¨,ç»§æ‰¿å¯ä»¥ç”¨ public é»˜è®¤æ˜¯public éƒ½å¯ä»¥ç”¨ ç±»çš„å†…éƒ¨ä¸å¤–éƒ¨
1&lt;%- include(&#34;demo/demo11.ts&#34;) %&gt; 12 ç±»çš„æ„é€ å‡½æ•° 1&lt;%- include(&#34;demo/demo12.ts&#34;) %&gt; 13 ç±»çš„getter setter static åªè¯» 1&lt;%- include(&#34;demo/demo13.ts&#34;) %&gt; 14 æŠ½è±¡ç±» å«æœ‰æŠ½è±¡æ–¹æ³•çš„ç±»å«åšæŠ½è±¡ç±» ç»§æ‰¿æŠ½è±¡ç±»çš„ç±»å¿…é¡»å®ç°æŠ½è±¡æ–¹æ³• 1&lt;%- include(&#34;demo/demo14.ts&#34;) %&gt; 15 16 17 tsconfig.json é…ç½®æ–‡ä»¶ tsc -init ç”Ÿæˆ tsc ä¸åŠ åå­—,ä¼šè°ƒç”¨tsconfig.json &ldquo;include&rdquo;:[&ldquo;demo.ts&rdquo;], å¯ä»¥æ˜¯ç›®å½•åŠæ–‡ä»¶,å¯ä»¥æ­£åˆ™,å¯ä»¥glob &ldquo;exclude&rdquo;:[&ldquo;demo.ts&rdquo;], å¯ä»¥æ’é™¤include é‡Œæ–‡ä»¶ &ldquo;files&rdquo;:[&ldquo;demo.ts&rdquo;], å’Œincludeä¸€æ ·,ä½†åªèƒ½æ˜¯æ–‡ä»¶,ä¸ä¼šè¢«excludeæ’é™¤ compileOptions
strict ä¸¥æ ¼ts noImplicitAny å……è®¸ä½ çš„æ³¨è§£ç±»å‹anyä¸ç”¨ç‰¹æ„æ ‡æ˜ strictNullChecks ä¸å……è®¸æœ‰nullå€¼å‡ºç° ts-node ä¹Ÿä¼šç”¨tsconfig.json rootdir æºä»£ç æ ¹ç›®å½• outDir ç¼–è¯‘è¾“å‡ºçš„æ–‡ä»¶ sourceMap ç”Ÿæˆ.mapæ–‡ä»¶ debugç”¨ noUnsedLocal ä¸èƒ½å‡ºç°æ²¡æœ‰ä½¿ç”¨çš„æœ¬åœ°å˜é‡ 18 ç±»å‹ä¿æŠ¤ä¸è”åˆç±»å‹ ä¸å•ä¸€çš„ç±»å‹ number | boolean åªæœ‰åœ¨è”åˆç±»å‹çš„æ—¶å€™éœ€è¦ ç±»å‹ä¿æŠ¤ ç±»å‹æ–­è¨€ person as Waiter skill in person typeof person ==='string' first instanceof NumberOBJ instanceof åªèƒ½ç”¨åœ¨ç±»ä¸Š 1&lt;%- include(&#34;demo/demo18.cpp&#34;) %&gt; 19 enum ç±»å‹ typescript ç‹¬æœ‰ 1&lt;%- include(&#34;demo/demo19.cpp&#34;) %&gt; enum å¯ä»¥åæŸ¥ log(Status[1]) 20 æ³›å‹ 1&lt;%- include(&#34;demo/demo20.cpp&#34;) %&gt; 21 ç±»ä¸­ä½¿ç”¨æ³›å‹ 1 2 - æ³›å‹åœ¨ç±»ä¸­çš„ä½¿ç”¨ \`class C&lt;T&gt;\` 3 4ä¸ºäº†çº¦æŸä¼ å…¥çš„å‚æ•° 5 6 - æ³›å‹ç»§æ‰¿ 7 - æ³›å‹çº¦æŸ 8 9&lt;%- include(&#34;demo/demo21.cpp&#34;) %&gt; 10 11## 22 23 å‘½åç©ºé—´ 12 13åœ¨æµè§ˆå™¨ä¸­è¿è¡Œä¸çœ‹æ•ˆæœ 14 15 - vscode -&gt; file -&gt; openFloder 16 - vscode-&gt;terminal \`npm init\` 17 - \`tsc -init\` 18 - \`mkdir src &amp;&amp; mkdir build &amp;&amp; touch index.html\` 19 20 - å‘½åç©ºé—´å¯ä»¥åµŒå¥— namespace fater { namespace child { } }
1 2tsconfig.json 3 - outFile -&gt;ç”Ÿæˆä¸€ä¸ªå•ç‹¬çš„æ–‡ä»¶ 4 - moduble coomjs -&gt;&#39;amd&#39; 5 6## 24 import 7 8éœ€è¦å¼•ç”¨ require.js æ¥ä½¿ç”¨ amd çš„æ¨¡å— require([&ldquo;page&rdquo;],function(){ })
1 2## 25 parcel yarn add &ndash;dev parcel
1 2## 26 ts ä½¿ç”¨jquery yarn add @types/jquery
1 2or declare var $:any;
1 2## èµ„æ–™ 3 4 - [ruanä¸€å³° es6]() 5 - [TypeScript å…¥é—¨æ•™ç¨‹](https://ts.xcatliu.com/) 6 - [TypeScript Handbookï¼ˆä¸­æ–‡ç‰ˆï¼‰](https://zhongsp.gitbooks.io/typescript-handbook/content/) 7 - [æŠ€æœ¯èƒ–-TypeScript ä»å…¥é—¨åˆ°ç²¾é€šå›¾æ–‡è§†é¢‘æ•™ç¨‹-å…è´¹æ•™ç¨‹](http://jspang.com/detailed?id=63) `,url:"https://hugo-dead-simple.netlify.com/typescript/src/readme.html"},"https://hugo-dead-simple.netlify.com/tags/typescript.html":{title:"Typescript",tags:[],content:"",url:"https://hugo-dead-simple.netlify.com/tags/typescript.html"},"https://hugo-dead-simple.netlify.com/typescript/object_object.html":{title:"TypeScript ä¸­çš„ object å’Œ Object çš„åŒºåˆ«",tags:["typescript"],content:"åœ¨ TypeScript ä¸­ï¼Œobject å’Œ Object è™½ç„¶çœ‹èµ·æ¥ç›¸ä¼¼ï¼Œä½†å®ƒä»¬æœ‰ç€ä¸åŒçš„å«ä¹‰å’Œç”¨é€”ã€‚\n1. objectï¼ˆå°å†™ï¼‰ object æ˜¯ä¸€ä¸ª ç±»å‹ï¼Œè¡¨ç¤ºä»»ä½•éåŸå§‹ç±»å‹çš„å€¼ã€‚åŸå§‹ç±»å‹åŒ…æ‹¬ï¼šnumberã€stringã€booleanã€symbolã€null å’Œ undefinedã€‚æ¢å¥è¯è¯´ï¼Œobject ç±»å‹æ˜¯æŒ‡ é™¤åŸå§‹ç±»å‹ä¹‹å¤–çš„æ‰€æœ‰ç±»å‹ã€‚\nç‰¹ç‚¹ï¼š object ç±»å‹è¡¨ç¤ºçš„å€¼å¿…é¡»æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼ˆå³éåŸå§‹å€¼ï¼‰ï¼Œä½†ä¸é™å®šå¯¹è±¡çš„ç»“æ„ï¼ˆå±æ€§å’Œæ–¹æ³•ï¼‰ã€‚ å®ƒå¹¶ä¸ç­‰åŒäº Object æ„é€ å‡½æ•°çš„ç±»å‹ã€‚ ä¸èƒ½ç›´æ¥è®¿é—®å¯¹è±¡çš„å±æ€§æˆ–æ–¹æ³•ï¼Œé™¤éå°†å…¶ç±»å‹è¿›ä¸€æ­¥ç»†åŒ–ã€‚ ç¤ºä¾‹ï¼š 1let obj: object; 2 3obj = { name: &#34;Alice&#34; }; // åˆæ³• 4obj = [1, 2, 3]; // åˆæ³• 5obj = () =&gt; {}; // åˆæ³• 6 7obj = 42; // é”™è¯¯ï¼šç±»å‹ &#39;number&#39; ä¸èƒ½èµ‹å€¼ç»™ç±»å‹ &#39;object&#39; 8obj = &#34;hello&#34;; // é”™è¯¯ï¼šç±»å‹ &#39;string&#39; ä¸èƒ½èµ‹å€¼ç»™ç±»å‹ &#39;object&#39; object ç±»å‹é™åˆ¶äº†åªèƒ½æ˜¯â€œéåŸå§‹ç±»å‹â€çš„å€¼ï¼Œä½†æ˜¯å®ƒå¹¶ä¸å…³å¿ƒå…·ä½“æ˜¯ä»€ä¹ˆç±»å‹ï¼ˆä¾‹å¦‚æ˜¯æ•°ç»„ã€å‡½æ•°è¿˜æ˜¯æ™®é€šå¯¹è±¡ï¼‰ã€‚å› æ­¤ï¼Œä½ ä¸èƒ½ç›´æ¥è®¿é—®å¯¹è±¡çš„å±æ€§ï¼Œé™¤éä½ è¿›ä¸€æ­¥æŒ‡å®šå¯¹è±¡çš„ç»“æ„æˆ–ç±»å‹ã€‚\n2. Objectï¼ˆå¤§å†™ï¼‰ Object æ˜¯ JavaScript ä¸­çš„å†…ç½®æ„é€ å‡½æ•°ï¼Œç”¨æ¥åˆ›å»ºå¯¹è±¡å®ä¾‹ã€‚åœ¨ TypeScript ä¸­ï¼ŒObject è¡¨ç¤ºæ‰€æœ‰é null çš„ç±»å‹ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå®ƒæ˜¯æ‰€æœ‰ç±»å‹çš„è¶…é›†ï¼Œé™¤äº† null å’Œ undefinedã€‚\nç‰¹ç‚¹ï¼š Object ç±»å‹è¡¨ç¤º æ‰€æœ‰å¯¹è±¡ç±»å‹ï¼ŒåŒ…æ‹¬åŸå§‹ç±»å‹ï¼ˆstringã€number ç­‰ï¼‰ä»¥å¤–çš„æ‰€æœ‰ç±»å‹ã€‚ å®ƒæ˜¯ JavaScript ä¸­æ‰€æœ‰å¯¹è±¡çš„çˆ¶ç±»ï¼Œç”šè‡³å¯ä»¥ç”¨äºè¡¨ç¤ºåŸå§‹ç±»å‹ï¼ˆä¸è¿‡é€šå¸¸ä¸è¿™ä¹ˆåšï¼‰ã€‚ ç¤ºä¾‹ï¼š 1let obj: Object; 2 3obj = { name: &#34;Alice&#34; }; // åˆæ³• 4obj = [1, 2, 3]; // åˆæ³• 5obj = &#34;hello&#34;; // åˆæ³•ï¼ˆå°½ç®¡é€šå¸¸ä¸è¿™ä¹ˆåšï¼‰ 6obj = 42; // åˆæ³•ï¼ˆ`number` ä¹Ÿæ˜¯ `Object` ç±»å‹çš„ä¸€éƒ¨åˆ†ï¼‰ 7 8obj = null; // é”™è¯¯ï¼š`null` ä¸èƒ½èµ‹å€¼ç»™ `Object` Object ç±»å‹å®é™…ä¸ŠåŒ…å«äº† æ‰€æœ‰ç±»å‹ï¼Œé™¤ null å’Œ undefined ä¹‹å¤–ã€‚\n3. åŒºåˆ«æ€»ç»“ ç‰¹æ€§ object Object è¡¨ç¤ºçš„å†…å®¹ ä»»ä½•éåŸå§‹ç±»å‹ï¼ˆä¸åŒ…æ‹¬ number, string, boolean, symbol, null, undefinedï¼‰ æ‰€æœ‰ç±»å‹ï¼ˆåŒ…æ‹¬ number, string, boolean, symbol, é™¤ null å’Œ undefinedï¼‰ æ˜¯å¦å…è®¸åŸå§‹ç±»å‹ ä¸å…è®¸åŸå§‹ç±»å‹ï¼ˆåªèƒ½æ˜¯å¯¹è±¡ï¼‰ å…è®¸åŸå§‹ç±»å‹ï¼ˆåŒ…æ‹¬ number, string, boolean, symbol ç­‰ï¼‰ è®¿é—®å±æ€§ ä¸èƒ½ç›´æ¥è®¿é—®å±æ€§ï¼Œéœ€è¦è¿›ä¸€æ­¥ç»†åŒ–ç±»å‹ å…è®¸è®¿é—®å±æ€§ï¼Œå®é™…ä¸Šæ˜¯ Object ç±»å‹çš„è¶…é›† å¸¸è§ç”¨é€” ç”¨äºé™å®šæŸä¸ªå€¼æ˜¯å¯¹è±¡ç±»å‹ï¼ˆè€Œä¸æ˜¯åŸå§‹å€¼ï¼‰ è¡¨ç¤ºæ‰€æœ‰ç±»å‹ï¼ˆä½†ä¸åŒ…æ‹¬ null å’Œ undefinedï¼‰ 4. è¿›ä¸€æ­¥çš„ç¤ºä¾‹ï¼š object ç¤ºä¾‹ï¼š 1let obj: object; 2 3obj = { name: &#34;Alice&#34; }; // åˆæ³• 4obj = [1, 2, 3]; // åˆæ³• 5obj = () =&gt; {}; // åˆæ³• 6 7// ä¸‹é¢çš„ç±»å‹ä¼šæŠ¥é”™ï¼Œå› ä¸º `object` ç±»å‹ä¸å…è®¸åŸå§‹ç±»å‹ 8obj = 42; // é”™è¯¯ 9obj = &#34;hello&#34;; // é”™è¯¯ 10obj = true; // é”™è¯¯ Object ç¤ºä¾‹ï¼š 1let obj: Object; 2 3obj = { name: &#34;Alice&#34; }; // åˆæ³• 4obj = [1, 2, 3]; // åˆæ³• 5obj = &#34;hello&#34;; // åˆæ³• 6obj = 42; // åˆæ³• 7 8// `null` ä¸èƒ½èµ‹å€¼ç»™ `Object` ç±»å‹ 9obj = null; // é”™è¯¯ 5. æ€»ç»“ object æ˜¯ä¸€ä¸ªç±»å‹ï¼Œè¡¨ç¤ºéåŸå§‹ç±»å‹ï¼ˆå³æ’é™¤ number, string, boolean, symbol, null å’Œ undefinedï¼‰ã€‚å®ƒä¸èƒ½ç›´æ¥ç”¨äºè®¿é—®å¯¹è±¡çš„å±æ€§ã€‚ Object æ˜¯ JavaScript ä¸­çš„æ„é€ å‡½æ•°ï¼Œå®ƒæ˜¯æ‰€æœ‰ç±»å‹çš„è¶…é›†ï¼Œé™¤äº† null å’Œ undefinedï¼Œå®ƒå…è®¸è¡¨ç¤ºä»»ä½•ç±»å‹ï¼ŒåŒ…æ‹¬åŸå§‹ç±»å‹ï¼ˆå¦‚ stringã€number ç­‰ï¼‰ã€‚ åœ¨ TypeScript ä¸­ï¼Œå»ºè®®å°½é‡ä½¿ç”¨ object æ¥è¡¨ç¤ºå¯¹è±¡ç±»å‹ï¼Œé¿å…ä½¿ç”¨ Objectï¼Œé™¤éä½ ç¡®å®éœ€è¦ä¸€ä¸ªæ›´å®½æ³›çš„ç±»å‹ï¼ˆè¡¨ç¤ºæ‰€æœ‰é null/undefined çš„å€¼ï¼‰ã€‚\n",url:"https://hugo-dead-simple.netlify.com/typescript/object_object.html"},"https://hugo-dead-simple.netlify.com/typescript/index.html":{title:"typescript å­¦ä¹ ç¬”è®°",tags:["typescript"],content:" é¦–é¡µ å¦‚ä½•è°ƒè¯• ç¬”è®°:tsç¼–ç¨‹ å¯¹è±¡å­—é¢é‡çš„ä½¿ç”¨ TypeScript ä¸­çš„ object å’Œ Object çš„åŒºåˆ« preserveConstEnumsç¼–è¯‘å™¨é€‰é¡¹ è£…é¥°å™¨ ",url:"https://hugo-dead-simple.netlify.com/typescript/index.html"},"https://hugo-dead-simple.netlify.com/typescript/readme.html":{title:"typescript å­¦ä¹ ç¬”è®°",tags:["typescript"],content:`èµ„æ–™ TypeScript Tutorial é˜®ä¸€å³° es6 é˜®ä¸€å³° TypeScript æ•™ç¨‹ TypeScript Handbook - The TypeScript Handbook TypeScript å…¥é—¨æ•™ç¨‹ TypeScript Handbookï¼ˆä¸­æ–‡ç‰ˆï¼‰ ç°ä»£TypeScripté«˜çº§æ•™ç¨‹- - linwu-hi - åšå®¢å›­ å®‰è£… 1yarn global add typescript ts-node æ•°æ®ç±»å‹ string boolean number void ç”¨åœ¨æ²¡æœ‰è¿”å›å€¼çš„å‡½æ•°,å…¶å®ƒå¯ä»¥ç”¨,ä½†ä¸èƒ½èµ‹å€¼ 1function alerme():void { 2 alert(&#39;my name is tom&#39;); 3} null,undefined,æ˜¯æ‰€æœ‰ç±»å‹çš„å­ç±»å‹,å¯ä»¥èµ‹å€¼ç»™å…¶å®ƒç±»å‹,è€Œ void ç±»å‹çš„å˜é‡ä¸èƒ½èµ‹å€¼ç»™ number ç±»å‹çš„å˜é‡ï¼š 1 let num:number = null å¯¹è±¡ç±»å‹ 1const xiaoJieJie : { 2 name:string, 3 age:number 4} = { 5 name:&#39;hel&#39;, 6 age:19 7} //1 æ™®é€š 8 9const xiaoJjiejieS :string [] = [&#39;1&#39;,&#39;dajiao&#39;,&#39;liuyaing&#39;]; // 2 .æ•°ç»„ 10 11class Person{} 12const dajiao: Person = new Person() //3 ç±»ç±»å‹ 13 14const jianXiaoJjieJie: () =&gt; string = () =&gt; {return &#34;dajiao&#34;}; //å‡½æ•°å¯¹è±¡ç±»å‹ è„šæ‰‹æ¶ æ¢äº†ä¸€ä¸ªè„šæ‰‹æ¶ GitHub - xddqnodejs-typescript-modern-starter Minimal and modern starter template to develop a Node.js project leveraging Typescript
ç±»å‹æ³¨è§£ ä¸ ç±»å‹æ¨æ–­ type annotation type inference å·¥ä½œä½¿ç”¨çš„åŸåˆ™
å¦‚æœTSèƒ½å¤Ÿè‡ªåŠ¨åˆ†æå˜é‡ç±»å‹,æˆ‘ä»¬å°±ä»€ä¹ˆä¹Ÿä¸éœ€è¦åšäº† å¦‚æœTSæ— æ³•åˆ†æå˜é‡ç±»å‹çš„è¯,æˆ‘ä»¬å°±éœ€è¦ä½¿ç”¨ç±»å‹æ³¨è§£äº† 05 å‡½æ•°å‚æ•°å’Œè¿”å›ç±»å‹çš„æ³¨è§£ demo5
06æ•°ç»„ç±»å‹çš„å®šä¹‰ ç±»å‹åˆ«å demo/demo6.ts
07 å…ƒç»„çš„ä½¿ç”¨ demo/demo7.ts
å…ƒç»„ç°åœ¨ç”¨çš„å°‘äº†,å› ä¸ºå¯ä»¥ç”¨å¯¹è±¡çš„å½¢å¼æ¥ä»£æ›¿
08 09 interface æ¥å£ demo/demo8.ts
demo/demo9.ts
[propname:string] : any; å†…éƒ¨çº¦æŸäº†ä¸€ä¸ªå‡½æ•°say():string; æ¥å£çº¦æŸä¸€ä¸ªç±»class xiaojiejie implements Gril æ¥å£çš„æ‹“å±•interface Teacher extends Girl{} ç›¸å½“äºç»§æ‰¿ ç¬¦åˆå­æ¥å£çš„å¯¹è±¡ä¹Ÿç¬¦åˆçˆ¶æ¥å£ 10 ç±»çš„æ¦‚å¿µå’Œä½¿ç”¨ å®šä¹‰ ç»§æ‰¿ é‡å†™ super è°ƒç”¨çˆ¶ç±»ä¸­çš„æ–¹æ³• demo/demo10.ts
ç±»çš„è®¿é—®ç±»å‹ private å†…éƒ¨ç”¨,å¤–éƒ¨ä¸èƒ½ç”¨ protected å†…éƒ¨ç”¨,å¤–éƒ¨ä¸èƒ½ç”¨,ç»§æ‰¿å¯ä»¥ç”¨ public é»˜è®¤æ˜¯public éƒ½å¯ä»¥ç”¨ ç±»çš„å†…éƒ¨ä¸å¤–éƒ¨
demo/demo11.ts
12 ç±»çš„æ„é€ å‡½æ•° demo/demo12.ts
13 ç±»çš„getter setter static åªè¯» demo/demo13.ts
14 æŠ½è±¡ç±» å«æœ‰æŠ½è±¡æ–¹æ³•çš„ç±»å«åšæŠ½è±¡ç±» ç»§æ‰¿æŠ½è±¡ç±»çš„ç±»å¿…é¡»å®ç°æŠ½è±¡æ–¹æ³• demo/demo14.ts
15 16 17 tsconfig.json é…ç½®æ–‡ä»¶ tsc -init ç”Ÿæˆ tsc ä¸åŠ åå­—,ä¼šè°ƒç”¨tsconfig.json &ldquo;include&rdquo;:[&ldquo;demo.ts&rdquo;], å¯ä»¥æ˜¯ç›®å½•åŠæ–‡ä»¶,å¯ä»¥æ­£åˆ™,å¯ä»¥glob &ldquo;exclude&rdquo;:[&ldquo;demo.ts&rdquo;], å¯ä»¥æ’é™¤include é‡Œæ–‡ä»¶ &ldquo;files&rdquo;:[&ldquo;demo.ts&rdquo;], å’Œincludeä¸€æ ·,ä½†åªèƒ½æ˜¯æ–‡ä»¶,ä¸ä¼šè¢«excludeæ’é™¤ compileOptions
strict ä¸¥æ ¼ts noImplicitAny å……è®¸ä½ çš„æ³¨è§£ç±»å‹anyä¸ç”¨ç‰¹æ„æ ‡æ˜ strictNullChecks ä¸å……è®¸æœ‰nullå€¼å‡ºç° ts-node ä¹Ÿä¼šç”¨tsconfig.json rootdir æºä»£ç æ ¹ç›®å½• outDir ç¼–è¯‘è¾“å‡ºçš„æ–‡ä»¶ sourceMap ç”Ÿæˆ.mapæ–‡ä»¶ debugç”¨ noUnsedLocal ä¸èƒ½å‡ºç°æ²¡æœ‰ä½¿ç”¨çš„æœ¬åœ°å˜é‡ 18 ç±»å‹ä¿æŠ¤ä¸è”åˆç±»å‹ ä¸å•ä¸€çš„ç±»å‹ number | boolean åªæœ‰åœ¨è”åˆç±»å‹çš„æ—¶å€™éœ€è¦ ç±»å‹ä¿æŠ¤ ç±»å‹æ–­è¨€ person as Waiter skill in person typeof person ==='string' first instanceof NumberOBJ instanceof åªèƒ½ç”¨åœ¨ç±»ä¸Š demo/demo18.ts
19 enum ç±»å‹ typescript ç‹¬æœ‰ demo/demo19.ts
enum å¯ä»¥åæŸ¥ log(Status[1]) 20 æ³›å‹ demo/demo20.ts
21 ç±»ä¸­ä½¿ç”¨æ³›å‹ æ³›å‹åœ¨ç±»ä¸­çš„ä½¿ç”¨ class C&lt;T&gt; ä¸ºäº†çº¦æŸä¼ å…¥çš„å‚æ•°
æ³›å‹ç»§æ‰¿ æ³›å‹çº¦æŸ demo/demo21.ts
22 23 å‘½åç©ºé—´ åœ¨æµè§ˆå™¨ä¸­è¿è¡Œä¸çœ‹æ•ˆæœ
vscode -&gt; file -&gt; openFloder
vscode-&gt;terminal npm init
tsc -init
mkdir src &amp;&amp; mkdir build &amp;&amp; touch index.html
å‘½åç©ºé—´å¯ä»¥åµŒå¥—
1namespace fater { 2 namespace child { 3 } 4} tsconfig.json
outFile -&gt;ç”Ÿæˆä¸€ä¸ªå•ç‹¬çš„æ–‡ä»¶ moduble coomjs -&gt;&lsquo;amd&rsquo; 24 import éœ€è¦å¼•ç”¨ require.js æ¥ä½¿ç”¨ amd çš„æ¨¡å—
1require([&#34;page&#34;],function(){ 2}) 25 parcel 1yarn add --dev parcel 26 ts ä½¿ç”¨jquery 1yarn add @types/jquery or
1declare var $:any; `,url:"https://hugo-dead-simple.netlify.com/typescript/readme.html"},"https://hugo-dead-simple.netlify.com/linux_tcp_program/index.html":{title:"linuxç½‘ç»œç¼–ç¨‹å­¦ä¹ ç¬”è®°",tags:[],content:`è¯´æ˜ æˆ‘çš„å­¦ä¹ è¿‡ç¨‹
1åŸºç¡€çš„socketç¼–ç¨‹ -&gt; -&gt; çº¿ç¨‹ç¼–ç¨‹ -&gt; muduoåº“å­¦ä¹  Linuxç½‘ç»œç¼–ç¨‹è§†é¢‘æ•™ç¨‹ å­¦ä¹ è‡ª
https://github.com/834810071/NetworkProgramming https://www.bilibili.com/video/av33813135/ æˆ‘ä¸»è¦çš„å­¦ä¹ ç›®æ ‡:
å›ºå®šä½ socket ç¼–ç¨‹çš„åŸºç¡€çŸ¥è¯†
å¦‚ä½•ä½¿ç”¨ è¿›ç¨‹ ç¼–ç¨‹
å¦‚ä½•ä½¿ç”¨ thread ç¼–ç¨‹
p1 è®²è§£äº†,ç½‘ç»œæ¨¡å‹,ç†è§£äº†å››å±‚çš„æ¨¡å‹
linuxç½‘ç»œç¼–ç¨‹
tcpipåŸºç¡€ p1-p5 socketç¼–ç¨‹ p6 TCP/IP ç½‘ç»œç¼–ç¨‹ tcpipç½‘ç»œç¼–ç¨‹ chapter_1 chapter_2 chapter_3 chapter_4 chapter_5 chapter_7 chapter_8 chapter_9 chapter_10 muduo ç½‘ç»œåº“ muduoåº“çš„å®ç°: https://github.com/EricPengShuai/muduo
muduo ç½‘ç»œåº“ chapter_1 chapter_2 `,url:"https://hugo-dead-simple.netlify.com/linux_tcp_program/index.html"},"https://hugo-dead-simple.netlify.com/blog/%E6%B1%87%E7%BC%96%E7%9B%B8%E5%85%B3%E7%9F%A5%E8%AF%86.html":{title:"",tags:[],content:`ret ä¸ ret 10ä¹‹é—´çš„åŒºåˆ«
å½“ç„¶å¯ä»¥ã€‚ret å’Œ ret 10 éƒ½æ˜¯å‡½æ•°è¿”å›æŒ‡ä»¤ï¼Œä½†å®ƒä»¬ä¹‹é—´æœ‰ä¸€ä¸ªéå¸¸é‡è¦ä¸”æ ¹æœ¬çš„åŒºåˆ«ã€‚
æœ€æ ¸å¿ƒçš„åŒºåˆ«åœ¨äºç”±è°æ¥è´Ÿè´£æ¸…ç†å‡½æ•°è°ƒç”¨æ—¶å‹å…¥æ ˆçš„å‚æ•°ã€‚
ret (å¸¸è§„è¿”å›) åŠ¨ä½œï¼š
ä»æ ˆé¡¶å¼¹å‡ºä¸€ä¸ªåœ°å€ï¼Œæ”¾å…¥æŒ‡ä»¤æŒ‡é’ˆå¯„å­˜å™¨ (EIP æˆ– RIP) ä¸­ã€‚ CPU è·³è½¬åˆ°è¯¥åœ°å€ç»§ç»­æ‰§è¡Œã€‚ å‚æ•°æ¸…ç†ï¼š ret æŒ‡ä»¤æœ¬èº«ä¸è´Ÿè´£æ¸…ç†è°ƒç”¨è€…å‹å…¥æ ˆçš„å‚æ•°ã€‚å®ƒå‡å®š**è°ƒç”¨è€…ï¼ˆCallerï¼‰**ä¼šåœ¨å‡½æ•°è¿”å›åè‡ªå·±æ¸…ç†æ ˆã€‚
å¯¹åº”çš„è°ƒç”¨çº¦å®šï¼š è¿™ç§æ–¹å¼é€šå¸¸ä¸ __cdecl è°ƒç”¨çº¦å®šç›¸å…³ï¼Œè¿™æ˜¯ C å’Œ C++ è¯­è¨€é»˜è®¤çš„è°ƒç”¨çº¦å®šã€‚
ç¤ºä¾‹ï¼š
1; ----- è°ƒç”¨è€…çš„ä»£ç  (Caller) ----- 2push arg2 ; å‹å…¥ç¬¬2ä¸ªå‚æ•° (4å­—èŠ‚) 3push arg1 ; å‹å…¥ç¬¬1ä¸ªå‚æ•° (4å­—èŠ‚) 4call MyFunction ; è°ƒç”¨å‡½æ•° 5add esp, 8 ; &lt;--- ç”±è°ƒç”¨è€…è´Ÿè´£æ¸…ç† 2 * 4 = 8 å­—èŠ‚çš„å‚æ•° 6 7; ----- è¢«è°ƒç”¨å‡½æ•° MyFunction çš„ä»£ç  (Callee) ----- 8MyFunction: 9 ; ... å‡½æ•°ä½“ ... 10 ret ; &lt;--- ç®€å•è¿”å›ï¼Œä¸å…³å¿ƒå‚æ•° ä¼˜ç‚¹ï¼š å› ä¸ºå®ƒä¸å…³å¿ƒå‚æ•°æ•°é‡ï¼Œæ‰€ä»¥æ”¯æŒå¯å˜å‚æ•°å‡½æ•°ï¼Œæ¯”å¦‚ printf(format, ...)ã€‚è¢«è°ƒç”¨çš„ printf å‡½æ•°ä¸çŸ¥é“æœ‰å¤šå°‘ä¸ªå‚æ•°ï¼Œæ‰€ä»¥å®ƒæ— æ³•æ¸…ç†ï¼Œå¿…é¡»ç”±è°ƒç”¨è€…æ¥å®Œæˆã€‚
ret 10 (å¸¦å‚æ•°æ¸…ç†çš„è¿”å›) 10 çš„å«ä¹‰ï¼š è¿™é‡Œçš„ 10 æ˜¯åå…­è¿›åˆ¶çš„ 10hï¼Œä»£è¡¨åè¿›åˆ¶çš„ 16ã€‚å®ƒæŒ‡ç¤ºäº†è¦æ¸…ç†çš„å­—èŠ‚æ•°ã€‚
åŠ¨ä½œï¼š
ä»æ ˆé¡¶å¼¹å‡ºä¸€ä¸ªåœ°å€ï¼Œæ”¾å…¥æŒ‡ä»¤æŒ‡é’ˆå¯„å­˜å™¨ (EIP æˆ– RIP) ä¸­ã€‚ CPU è·³è½¬åˆ°è¯¥åœ°å€ç»§ç»­æ‰§è¡Œã€‚ åœ¨è·³è½¬åï¼ŒCPU ä¼šè‡ªåŠ¨å°†æ ˆé¡¶æŒ‡é’ˆ ESP çš„å€¼å¢åŠ  16 å­—èŠ‚ï¼ˆç›¸å½“äºæ‰§è¡Œäº† add esp, 16ï¼‰ã€‚ å‚æ•°æ¸…ç†ï¼š ret 10 æŒ‡ä»¤åœ¨è¿”å›çš„åŒæ—¶ï¼Œä¹Ÿæ¸…ç†äº†æ ˆä¸Šçš„å‚æ•°ã€‚å®ƒå‡å®šè¢«è°ƒç”¨è€…ï¼ˆCalleeï¼‰ï¼Œä¹Ÿå°±æ˜¯è¿™ä¸ªå‡½æ•°è‡ªå·±ï¼Œè´Ÿè´£æ¸…ç†æ ˆã€‚16 å­—èŠ‚é€šå¸¸æ„å‘³ç€ 4 ä¸ªå‚æ•°ï¼ˆæ¯ä¸ªå‚æ•°4å­—èŠ‚ï¼‰ã€‚
å¯¹åº”çš„è°ƒç”¨çº¦å®šï¼š è¿™ç§æ–¹å¼é€šå¸¸ä¸ __stdcall è°ƒç”¨çº¦å®šç›¸å…³ï¼ŒWindows API å‡½æ•°å¹¿æ³›ä½¿ç”¨æ­¤çº¦å®šã€‚
ç¤ºä¾‹ï¼š
1; ----- è°ƒç”¨è€…çš„ä»£ç  (Caller) ----- 2push arg4 ; å‹å…¥ç¬¬4ä¸ªå‚æ•° 3push arg3 ; å‹å…¥ç¬¬3ä¸ªå‚æ•° 4push arg2 ; å‹å…¥ç¬¬2ä¸ªå‚æ•° 5push arg1 ; å‹å…¥ç¬¬1ä¸ªå‚æ•° 6call MyFunction ; è°ƒç”¨å‡½æ•° 7 ; &lt;--- è°ƒç”¨è€…åœ¨è¿™é‡Œä»€ä¹ˆéƒ½ä¸ç”¨åšï¼ 8 9; ----- è¢«è°ƒç”¨å‡½æ•° MyFunction çš„ä»£ç  (Callee) ----- 10MyFunction: 11 ; ... å‡½æ•°ä½“ ... 12 ret 10 ; &lt;--- è¿”å›ï¼Œå¹¶æ¸…ç† 4 * 4 = 16 å­—èŠ‚çš„å‚æ•° ä¼˜ç‚¹ï¼š ä»£ç å¯ä»¥æ›´ç´§å‡‘ä¸€äº›ï¼Œå› ä¸ºæ¸…ç†æ ˆçš„æŒ‡ä»¤ (add esp, ...) åªéœ€è¦åœ¨å‡½æ•°å†…éƒ¨å‡ºç°ä¸€æ¬¡ï¼Œè€Œä¸æ˜¯åœ¨æ¯ä¸ªè°ƒç”¨å®ƒçš„åœ°æ–¹éƒ½å‡ºç°ä¸€æ¬¡ã€‚
æ€»ç»“å¯¹æ¯” ç‰¹æ€§ ret ret 10 å‚æ•°æ¸…ç†è€… è°ƒç”¨è€… (Caller) è¢«è°ƒç”¨è€… (Callee) æŒ‡ä»¤åŠ¨ä½œ å¼¹å‡ºè¿”å›åœ°å€å¹¶è·³è½¬ å¼¹å‡ºè¿”å›åœ°å€ã€è·³è½¬ï¼Œå¹¶ç»™ ESP åŠ ä¸Šä¸€ä¸ªç«‹å³æ•° å¸¸è§è°ƒç”¨çº¦å®š __cdecl __stdcall æ˜¯å¦æ”¯æŒå¯å˜å‚æ•° æ˜¯ å¦ï¼ˆå› ä¸ºæ¸…ç†çš„å­—èŠ‚æ•°æ˜¯å›ºå®šçš„ï¼‰ å¸¸è§ç”¨é€” C/C++ é»˜è®¤å‡½æ•° Windows API å‡½æ•° ä¸ºä»€ä¹ˆè¿™ä¸ªåŒºåˆ«å¾ˆé‡è¦ï¼Ÿ å¦‚æœä¸€ä¸ªå‡½æ•°æ˜¯æŒ‰ __stdcall ç¼–è¯‘çš„ï¼ˆä½¿ç”¨ ret 10ï¼‰ï¼Œè€Œè°ƒç”¨è€…å´æŒ‰ __cdecl çš„æ–¹å¼å»è°ƒç”¨å®ƒï¼ˆåœ¨ call ä¹‹åå°è¯•è‡ªå·±æ¸…ç†å‚æ•°ï¼‰ï¼Œå°±ä¼šå¯¼è‡´æ ˆè¢«æ¸…ç†ä¸¤æ¬¡ï¼Œä»è€Œç ´åæ ˆçš„å¹³è¡¡ï¼Œå¼•å‘ç¨‹åºå´©æºƒã€‚å› æ­¤ï¼Œåœ¨è¿›è¡Œæ··åˆè¯­è¨€ç¼–ç¨‹æˆ–è°ƒç”¨å¤–éƒ¨åº“æ—¶ï¼Œæ­£ç¡®åŒ¹é…è°ƒç”¨çº¦å®šè‡³å…³é‡è¦ã€‚
`,url:"https://hugo-dead-simple.netlify.com/blog/%E6%B1%87%E7%BC%96%E7%9B%B8%E5%85%B3%E7%9F%A5%E8%AF%86.html"},"https://hugo-dead-simple.netlify.com/books/lua/chapter_1.html":{title:"",tags:[],content:" hello world 1print(&#34;hello world&#34;) 2-- lua hello.lua é˜¶ä¹˜ 1function fact(n) 2	if n == 0 then 3	return 1 4	else 5	return n * fact(n-1); 6	end 7end 8-- read number to a 9a=io.read(&#34;*n&#34;) 10print(fact(a)) å¯ä»¥ä½¿ç”¨interpreter modeæ¥è¿è¡Œä»£ç  æ‰§è¡Œå®ŒæŒ‡å®šçš„ä»£ç åè¿›å…¥REPLæ¨¡å¼ï¼Œlua -i pro å¤šè¡Œæ³¨é‡Š 1--[[ 2This is a multi-line comment 3]] å•è¡Œæ³¨é‡Š 1-- This is a single-line comment é»˜è®¤çš„å˜é‡æ˜¯å…¨å±€å˜é‡ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨ï¼Œä¹Ÿå¯ä»¥é€šè¿‡localå…³é”®å­—å£°æ˜å±€éƒ¨å˜é‡ ç±»å‹:typeå‡½æ•°å¯ä»¥ç”¨æ¥è·å–å˜é‡çš„ç±»å‹ nilï¼šnil æ•°å­—ï¼šnumber å­—ç¬¦ä¸²ï¼šstring å¸ƒå°”å€¼ï¼šboolean è¡¨ï¼štable å‡½æ•°ï¼šfunction çº¿ç¨‹ï¼šthread userdataï¼šuserdata åç¨‹ï¼šcoroutine 1---ç»ƒä¹ 1.1 è¿è¡Œé˜¶ä¹˜çš„å®ä¾‹å¹¶è§‚å¯Ÿï¼Œå¦‚æœè¾“å…¥çš„æ˜¯è´Ÿæ•°ï¼Œç¨‹åºä¼šå‡ºç°ä»€ä¹ˆé—®é¢˜?è¯•ç€ä¿®æ”¹ä»£ç æ¥è§£å†³é—®é¢˜ 2-- è¾“å…¥è´Ÿæ•°ç¨‹åºä¼šæ— é™é€’å½’è‡³æ ˆæº¢å‡º 3-- ä¿®æ”¹ 4local function fact(n) 5 if n &lt; 0 then 6 print(&#34;invalid n&#34;) 7 return 8 end 9 if n == 0 then 10 return 1 11 else 12 return n * fact(n - 1) 13 end 14end 15 16--fact(-1) 17 18---ç»ƒä¹ 1.2 åˆ†åˆ«ä½¿ç”¨ -i å‚æ•°å’Œ dofile åŠ è½½è„šæœ¬å¹¶è¿è¡Œtwiceç¤ºä¾‹ï¼Œä½ æ›´å–œæ¬¢å“ªç§æ–¹å¼? (æ³¨æ„æ˜¯-i ä¸æ˜¯-l ä¸­æ–‡ç‰ˆå°åˆ·æœ‰é”™è¯¯) 19-- ç¬¬ä¸€ç§ 20-- lua.exe -i chapter01/chapter01.lua 21-- -&gt;twice(2) 22 23-- ç¬¬äºŒç§ 24-- ç›´æ¥è¿è¡Œlua.exe 25-- -&gt;dofile(&#34;chapter01/chapter01.lua&#34;) 26-- -&gt;twice(2) 27 28function twice(x) 29 return 2.0 * x 30end 31 32---ç»ƒä¹ 1.3 ä½ èƒ½å¦åˆ—ä¸¾å‡ºå…¶ä»–ä½¿ç”¨ &#34;--&#34; ä½œä¸ºæ³¨é‡Šçš„è¯­è¨€ 33-- AppleScript 34 35---ç»ƒä¹ 1.4 ä»¥ä¸‹å­—ç¬¦ä¸²ä¸­å“ªäº›æ˜¯æœ‰æ•ˆçš„æ ‡è¯†ç¬¦ 36local ___ = &#34;valid&#34; 37local _end = &#34;valid&#34; 38local End = &#34;valid&#34; 39--local end = &#34;invalid&#34; 40--local until? = &#34;invalid&#34; 41--local nil = &#34;invalid&#34; 42local NULL = &#34;valid&#34; 43--one-step = &#34;invalid&#34; 44 45---ç»ƒä¹ 1.5 è¡¨è¾¾å¼ type(nil) == nil çš„å€¼æ˜¯ä»€ä¹ˆ?ï¼ˆä½ å¯ä»¥è¿è¡Œä»£ç æ¥æ£€æŸ¥ä¸‹ç­”æ¡ˆï¼‰ä½ èƒ½è§£é‡Šä¸‹åŸå› å—? 46print(type(nil) == nil ) --false typeå‡½æ•°å°† nil è½¬ä¸ºäº† &#34;nil&#34; å­—ç¬¦ä¸² 47 48---ç»ƒä¹ 1.6 åœ¨ä¸ä½¿ç”¨å‡½æ•°typeçš„æƒ…å†µä¸‹ï¼Œä½ å¦‚ä½•æ£€æŸ¥ä¸€ä¸ªå€¼æ˜¯å¦ä¸ºbooleanç±»å‹? 49 50local function isBool(value) 51 return value == true or value == false 52end 53 54print(isBool(false)) 55print(isBool(true)) 56print(isBool(1)) 57print(isBool(nil)) 58print(isBool(&#34;true&#34;)) 59print(isBool(&#34;false&#34;)) 60 61---ç»ƒä¹ 1.7 è€ƒè™‘å¦‚ä¸‹çš„è¡¨è¾¾å¼ã€‚å…¶ä¸­çš„æ‹¬å·æ˜¯å¦æ˜¯å¿…éœ€çš„? ä½ æ˜¯å¦æ¨èåœ¨è¿™ä¸ªè¡¨è¾¾å¼ä¸­ä½¿ç”¨æ‹¬å· 62--ä¸æ˜¯å¿…éœ€çš„ã€‚ æ¨èè¿˜æ˜¯ç”¨æ‹¬å·ï¼Œå¢å¼ºå¯è¯»æ€§ 63local x,y,z = true,true,false 64if x and y and (not z) or (( not y) and x) then 65 print(&#34;success1&#34;) 66end 67if x and y and not z or not y and x then 68 print(&#34;success2&#34;) 69end 70 71x,y,z = true,false,false 72if x and y and (not z) or (( not y) and x) then 73 print(&#34;success3&#34;) 74end 75if x and y and not z or not y and x then 76 print(&#34;success4&#34;) 77end 78 79 80---ç»ƒä¹ 1.8 è¯·ç¼–å†™ä¸€ä¸ªå¯ä»¥æ‰“å°å‡ºè„šæœ¬è‡ªèº«åç§°çš„ç¨‹åº(äº‹å…ˆä¸çŸ¥é“è„šæœ¬è‡ªèº«åå­—) 81if arg and arg[0] then 82 print(arg[0]) 83end ",url:"https://hugo-dead-simple.netlify.com/books/lua/chapter_1.html"},"https://hugo-dead-simple.netlify.com/books/%E5%BE%AE%E7%A7%AF%E5%88%86/index.html":{title:"",tags:[],content:`hugo-fro
`,url:"https://hugo-dead-simple.netlify.com/books/%E5%BE%AE%E7%A7%AF%E5%88%86/index.html"},"https://hugo-dead-simple.netlify.com/linux_tcp_program/1.html":{title:"",tags:[],content:`p4 tcp åŸºäºå­—èŠ‚æµ æ— è¾¹ç•Œçš„å­—èŠ‚æµ,éœ€è¦å¯¹æ•°æ®è¿›è¡Œåˆ†å‰² ç²˜åŒ…é—®é¢˜,è§£å†³æ–¹æ³•: å‘é€æ–¹: å‘é€æ•°æ®å‰,å…ˆå°†æ•°æ®åŒ…çš„é•¿åº¦ä¿¡æ¯å‘é€ç»™å¯¹æ–¹ æ¥æ”¶æ–¹: æ¥æ”¶åˆ°æ•°æ®åŒ…é•¿åº¦ä¿¡æ¯å,æ ¹æ®é•¿åº¦ä¿¡æ¯,å°†æ•°æ®åŒ…æ‹†åˆ†ä¸ºå¤šä¸ªæ•°æ®åŒ…è¿›è¡Œå¤„ç† é¢å‘è¿æ¥çš„ tcp åè®®,éœ€è¦å»ºç«‹è¿æ¥,æ–­å¼€è¿æ¥,ä¿è¯æ•°æ®ä¼ è¾“çš„å¯é æ€§ ç¼“å†²ä¼ è¾“
tcpæŠ¥æ–‡æ ¼å¼
ç´§æ€¥æŒ‡é’ˆ: ç´§æ€¥æ•°æ®æŒ‡é’ˆ,åªæœ‰ç´§æ€¥æ•°æ®æ‰ä¼šä½¿ç”¨ç´§æ€¥æŒ‡é’ˆ,ç´§æ€¥æ•°æ®æ˜¯æŒ‡éœ€è¦ç«‹å³ä¼ è¾“çš„æ•°æ® é€‰é¡¹å­—æ®µ: é€‰é¡¹å­—æ®µ,å¯ä»¥æºå¸¦ä¸€äº›æ§åˆ¶ä¿¡æ¯,å¦‚çª—å£å¤§å°,æœ€å¤§æŠ¥æ–‡æ®µé•¿åº¦,æ—¶é—´æˆ³ç­‰ tcpä¸‰æ¬¡æ¡æ‰‹
ç¬¬ä¸€æ¬¡æ¡æ‰‹: å®¢æˆ·ç«¯å‘é€ SYN æŠ¥æ–‡,æœåŠ¡å™¨æ”¶åˆ°å,å‘é€ SYN+ACK æŠ¥æ–‡,å®¢æˆ·ç«¯æ”¶åˆ°å,å‘é€ ACK æŠ¥æ–‡ ç¬¬äºŒæ¬¡æ¡æ‰‹: å®¢æˆ·ç«¯å‘é€ ACK æŠ¥æ–‡,æœåŠ¡å™¨æ”¶åˆ°å,å‘é€ ACK æŠ¥æ–‡ ç¬¬ä¸‰æ¬¡æ¡æ‰‹: å®¢æˆ·ç«¯å‘é€ ACK æŠ¥æ–‡,æœåŠ¡å™¨æ”¶åˆ°å,è¿æ¥å»ºç«‹å®Œæˆ tcpå››æ¬¡æŒ¥æ‰‹
ç¬¬ä¸€æ¬¡æŒ¥æ‰‹: å®¢æˆ·ç«¯å‘é€ FIN æŠ¥æ–‡,æœåŠ¡å™¨æ”¶åˆ°å,å‘é€ ACK æŠ¥æ–‡,å®¢æˆ·ç«¯æ”¶åˆ°å,è¿›å…¥ TIME-WAIT çŠ¶æ€ ç¬¬äºŒæ¬¡æŒ¥æ‰‹: æœåŠ¡å™¨å‘é€ FIN æŠ¥æ–‡,å®¢æˆ·ç«¯æ”¶åˆ°å,å‘é€ ACK æŠ¥æ–‡,æœåŠ¡å™¨æ”¶åˆ°å,è¿›å…¥ CLOSED çŠ¶æ€ ç¬¬ä¸‰æ¬¡æŒ¥æ‰‹: æœåŠ¡å™¨å‘é€ ACK æŠ¥æ–‡,å®¢æˆ·ç«¯æ”¶åˆ°å,è¿›å…¥ CLOSED çŠ¶æ€ ç¬¬å››æ¬¡æŒ¥æ‰‹: å®¢æˆ·ç«¯å‘é€ ACK æŠ¥æ–‡,æœåŠ¡å™¨æ”¶åˆ°å,è¿›å…¥ CLOSED çŠ¶æ€ tcpæ‹¥å¡æ§åˆ¶
æ…¢å¯åŠ¨: å¼€å§‹æ—¶,å‘é€æ–¹çš„å‘é€é€Ÿç‡è¾ƒä½,é€æ¸å¢å¤§,ä»¥ä¾¿é€¼è¿‘ç½‘ç»œçš„å®é™…é€Ÿç‡ æ‹¥å¡é¿å…: ç½‘ç»œæ‹¥å¡æ—¶,å‘é€æ–¹çš„å‘é€é€Ÿç‡é™ä½,ä»¥é˜²æ­¢ç½‘ç»œè¿‡è½½ å¿«é€Ÿé‡ä¼ : æ¥æ”¶æ–¹æ”¶åˆ°é‡å¤çš„ ACK æŠ¥æ–‡,è®¤ä¸ºæ˜¯ä¸¢åŒ…,ç«‹å³é‡ä¼ ä¸¢å¤±çš„æŠ¥æ–‡æ®µ è¶…æ—¶é‡ä¼ : å‘é€æ–¹åœ¨ä¸€æ®µæ—¶é—´å†…æ²¡æœ‰æ”¶åˆ° ACK æŠ¥æ–‡,è®¤ä¸ºæŠ¥æ–‡ä¸¢å¤±,é‡æ–°å‘é€ å¿«é€Ÿæ¢å¤: å½“ç½‘ç»œæ‹¥å¡ç¨‹åº¦å‡ç¼“æ—¶,å‘é€æ–¹çš„å‘é€é€Ÿç‡å¢åŠ ,ä»¥ä¾¿å‡è½»ç½‘ç»œæ‹¥å¡ æ»‘åŠ¨çª—å£åè®®
å‘é€æ–¹ç»´æŠ¤ä¸€ä¸ªçª—å£,æŒ‡ç¤ºè‡ªå·±å¯ä»¥å‘é€çš„æŠ¥æ–‡æ®µæ•°é‡ æ¥æ”¶æ–¹ç»´æŠ¤ä¸€ä¸ªçª—å£,æŒ‡ç¤ºè‡ªå·±å¯ä»¥æ¥æ”¶çš„æŠ¥æ–‡æ®µæ•°é‡ å‘é€æ–¹æ ¹æ®æ¥æ”¶æ–¹çš„åé¦ˆ,è°ƒæ•´çª—å£çš„å¤§å°,ä»¥ä¾¿åœ¨ç½‘ç»œæ‹¥å¡æ—¶,å‡å°‘å‘é€æŠ¥æ–‡æ®µçš„æ•°é‡ æ¥æ”¶æ–¹æ ¹æ®å‘é€æ–¹çš„åé¦ˆ,è°ƒæ•´çª—å£çš„å¤§å°,ä»¥ä¾¿åœ¨ç½‘ç»œæ‹¥å¡æ—¶,å‡å°‘æ¥æ”¶æŠ¥æ–‡æ®µçš„æ•°é‡ `,url:"https://hugo-dead-simple.netlify.com/linux_tcp_program/1.html"},"https://hugo-dead-simple.netlify.com/linux_tcp_program/2.html":{title:"",tags:[],content:`å­¦ä¹ ç›®æ ‡ 1mindmap 2 root((å­¦ä¹ ç›®æ ‡)) 3 1.ä»€ä¹ˆæ˜¯socket 4 2.IPv4å¥—æ¥å£åœ°å€ç»“æ„ 5 3.ç½‘ç»ˆå­—èŠ‚åº 6 4.å­—èŠ‚åºè½¬æ¢å‡½æ•° 7 5.åœ°å€è½¬æ¢å‡½æ•° 8 6.å¥—æ¥å­—ç±»å‹ 1. ä»€ä¹ˆæ˜¯socket socketå¯ä»¥çœ‹æˆæ˜¯ç”¨æˆ·è¿›ç¨‹ä¸å†…æ ¸ç½‘ç»œåè®®æ ˆçš„ ç¼–ç¨‹æ¥å£ socketä¸ä»…å¯ä»¥ç”¨äºæœ¬æœºçš„è¿›ç¨‹é—´é€šä¿¡ï¼Œè¿˜å¯ä»¥ ç”¨äºç½‘ç»œä¸Šä¸åŒä¸»æœºçš„è¿›ç¨‹é—´é€šä¿¡ æˆ‘çš„ç†è§£: socketå°±æ˜¯å¯¹å‰é¢å­¦ä¹ çš„tcp/ipçš„ä»£ç å°è£…,ä½†æ˜¯ä½äºç³»ç»Ÿçš„å†…æ ¸,ä¹Ÿå°±æ˜¯è¯´æä¾›ç»™ç”¨æˆ·çš„ä¸€ç»„API,ç”¨äºç½‘ç»œé€šä¿¡.
Warning socket è¿™é‡Œç†è§£æˆ&quot;æ’åº§&quot;
1mindmap 2 root((socketéœ€è¦çš„å±æ€§)) 3 åœ°å€: sockaddr_in 4 sin_addr 5 sin_port 6 sin_family ipv4 socket åœ°å€ç»“æ„ä½“ ipv4 socketåœ°å€ç»“æ„ä½“,åœ¨å¤´æ–‡ä»¶netinet/in.hä¸­å®šä¹‰ã€‚ sockaddr_inç»“æ„ä½“å®šä¹‰å¦‚ä¸‹ï¼š
ä½¿ç”¨man 7 ipå‘½ä»¤æŸ¥çœ‹sockaddr_inç»“æ„ä½“çš„å®šä¹‰ï¼š
1struct sockaddr_in { 2 sa_family_t sin_family; // åœ°å€æ—ï¼Œipv4 å°±æ˜¯AF_INET 3 in_port_t sin_port; // ç«¯å£å· 4 struct in_addr sin_addr; // IPåœ°å€ 5 char sin_zero[8]; // æœªä½¿ç”¨,æ³¨æ„è¿™ä¸ªåœ¨man 7 ipä¸­æ²¡æœ‰è¯´æ˜ 6 //æš—ç¤ºç¨‹åºå‘˜ä¸éœ€è¦çŸ¥é“è¿™ä¸ª?? 7 //å½“æˆä¸Šé¢çš„æ™®é€šçš„æ¥ç”¨? 8}; sin_familyå­—æ®µè¡¨ç¤ºåœ°å€æ—,socketåœ¨è®¾è®¡çš„æ—¶å€™è¿˜å¯ä»¥ç”¨äºå…¶å®ƒçš„åè®®,ä¸ä»…æ˜¯tcp/ip,æ¯”å¦‚è¿˜æœ‰unixåŸŸï¼Œå¯¹äºIPv4åœ°å€ï¼Œè¯¥å€¼ä¸ºAF_INETã€‚ sin_portå­—æ®µè¡¨ç¤ºç«¯å£å·ï¼Œä½¿ç”¨ç½‘ç»œå­—èŠ‚åºï¼ˆbig-endianï¼‰å­˜å‚¨ã€‚ sin_addrå­—æ®µè¡¨ç¤ºIPåœ°å€ï¼Œä½¿ç”¨struct in_addrç»“æ„ä½“è¡¨ç¤ºã€‚ struct in_addrç»“æ„ä½“å®šä¹‰å¦‚ä¸‹ï¼š
1struct in_addr { 2 uint32_t s_addr; // IPåœ°å€ï¼Œä½¿ç”¨ç½‘ç»œå­—èŠ‚åºå­˜å‚¨ 3}; s_addrå­—æ®µè¡¨ç¤ºIPåœ°å€ï¼Œä½¿ç”¨ç½‘ç»œå­—èŠ‚åºå­˜å‚¨ã€‚ ç–‘é—®1 Note åˆ°è¿™é‡Œå°±æœ‰ä¸€ä¸ªç–‘é—®,socketaddr_inç»“æ„ä½“å…·ä½“çš„å®šä¹‰æ˜¯ä»€ä¹ˆå‘¢?åé¢æœ‰æ²¡æœ‰char sin_zero[8];å­—æ®µå‘¢?é€šè¿‡ä¸‹é¢çš„ä»£ç æ¥éªŒè¯
1{{#include ./code/size_ofsockaddr_in.c}} è¾“å‡ºçš„ç»“æœæ˜¯ï¼š16,
1size bytes of sockaddr_in 16 2size bytes of sin_family 2 3size bytes of sin_port 2 4size bytes of sin_addr 4 ç»“æœç¡®å®æ˜¯å°‘8
é€šç”¨å¥—æ¥å­—åœ°å€ç»“æ„ä½“sockaddr å®šä¹‰å¦‚ä¸‹ï¼š
å®ƒé€‚ç”¨äºä»»ä½•åœ°å€åè®®,
1struct sockaddr { 2 sa_family_t sa_family; // åœ°å€æ— 3 char sa_data[14]; // åœ°å€æ•°æ®ï¼Œé•¿åº¦å–å†³äºåœ°å€æ— 4}; sa_familyå­—æ®µè¡¨ç¤ºåœ°å€æ—ã€‚ sa_dataå­—æ®µè¡¨ç¤ºåœ°å€æ•°æ®ï¼Œé•¿åº¦å–å†³äºåœ°å€æ—ã€‚ 1#include &lt;stdio.h&gt; 2#include &lt;netinet/in.h&gt; 3 4int main(int argc, char const *argv[]) 5{ 6 struct sockaddr_in addr1; 7 struct sockaddr addr2; 8 9 printf(&#34;sizof(sockaddr_in) = %ld\\n&#34;, sizeof(addr1)); 10 printf(&#34;sizof(sockaddr) = %ld\\n&#34;, sizeof(addr2)); 11 12 // æœ€åè¾“å‡ºçš„ç»“æœæ˜¯ï¼š 13 // sizof(sockaddr_in) = 16 14 // sizof(sockaddr) = 16 15 // è¯´æ˜sockaddr_inå’Œsockaddrçš„å¤§å°æ˜¯ç›¸åŒçš„ï¼Œéƒ½æ˜¯16å­—èŠ‚ã€‚ 16 17 return 0; 18} åœ¨é€šå¸¸çš„ç½‘ç»œç¼–ç¨‹ä¸­,æˆ‘ä»¬å…ˆå¡«å†™sockaddr_inç»“æ„ä½“,ç„¶åå†æŠŠå®ƒè½¬æ¢æˆé€šç”¨çš„sockaddrç»“æ„ä½“.
ç½‘ç»œå­—èŠ‚åº ç½‘ç»œå­—èŠ‚åº å­—èŠ‚åºåˆ†ä¸ºï¼š
å¤§ç«¯å­—èŠ‚åºï¼ˆBig-endianï¼‰ å°ç«¯å­—èŠ‚åºï¼ˆLittle-endianï¼‰ ç½‘ç»œå­—èŠ‚åºï¼ˆNetwork Byte Orderï¼‰æ˜¯æŒ‡æ•°æ®çš„é«˜ä½å­—èŠ‚ä¿å­˜åœ¨å†…å­˜çš„ä½åœ°å€ä¸­ï¼Œè€Œæ•°æ®çš„ä½ä½å­—èŠ‚ä¿å­˜åœ¨å†…å­˜çš„é«˜åœ°å€ä¸­ã€‚å°±æ˜¯å¤§ç«¯å­—èŠ‚åº.
åœ¨TCP/IPåè®®ä¸­ï¼Œæ‰€æœ‰é•¿åº¦å­—æ®µå’Œæ•°å­—éƒ½é‡‡ç”¨ç½‘ç»œå­—èŠ‚åºã€‚ä¾‹å¦‚ï¼Œåœ¨TCPæŠ¥æ–‡å¤´éƒ¨çš„æºç«¯å£å­—æ®µä¸­ï¼Œç«¯å£å·çš„é«˜ä½å­—èŠ‚ä¿å­˜åœ¨å†…å­˜çš„ä½åœ°å€ä¸­ï¼Œè€Œç«¯å£å·çš„ä½ä½å­—èŠ‚ä¿å­˜åœ¨å†…å­˜çš„é«˜åœ°å€ä¸­ã€‚
`,url:"https://hugo-dead-simple.netlify.com/linux_tcp_program/2.html"},"https://hugo-dead-simple.netlify.com/linux_tcp_program/muduo/chapter1.html":{title:"",tags:[],content:`çº¿ç¨‹å®‰å…¨çš„å¯¹è±¡ç”Ÿå‘½å‘¨æœŸç®¡ç† åœ¨å¤šçº¿ç§çš„æƒ…å†µä¸‹,ç¼–å†™ä¸€ä¸ªçº¿ç¨‹å®‰å…¨çš„ç±»å°¤ä¸ºå›°éš¾.è¿™é‡Œæƒ³è¦ä½¿ç”¨share_ptræ¥å®Œå…¨è¿™äº›é—®é¢˜.
1.1.2 MutexLockä¸MutexLockGuard
è¿™æ˜¯ä¸€ä¸ªç®€å•çš„èµ„æºç±»ï¼Œç”¨RAII(RAIIå…¨ç§°æ˜¯â€œResource Acquisition is Initializationâ€ï¼Œç›´è¯‘è¿‡æ¥æ˜¯â€œèµ„æºè·å–å³åˆå§‹åŒ–â€,ä¹Ÿå°±æ˜¯è¯´åœ¨æ„é€ å‡½æ•°ä¸­ç”³è¯·åˆ†é…èµ„æºï¼Œåœ¨ææ„å‡½æ•°ä¸­é‡Šæ”¾èµ„æº)æ‰‹æ³•å°è£…äº’æ–¥å™¨çš„åˆ›å»ºä¸é”€æ¯ã€‚åœ¨Linuxä¸‹æ˜¯pthread_mutex_tï¼Œé»˜è®¤æ˜¯ä¸å¯é‡å…¥çš„ï¼ˆ&amp;2.1.1ï¼‰ã€‚MutexLockä¸€èˆ¬æ˜¯åˆ«çš„classçš„æ•°æ®æˆå‘˜ã€‚
MutexLockGuardå°è£…ä¸´ç•ŒåŒºçš„è¿›å…¥å’Œé€€å‡ºï¼Œå³åŠ é”å’Œè§£é”ã€‚MutexLockGuardä¸€èˆ¬æ˜¯ä¸ªæ ˆä¸Šçš„å¯¹è±¡ï¼Œå®ƒçš„ä½œç”¨åŸŸåˆšå¥½ç­‰äºä¸´ç•ŒåŒºåŸŸã€‚
è¿™ä¸¤ä¸ªclasséƒ½ä¸å…è®¸æ‹·è´æ„é€ å’Œèµ‹å€¼ï¼Œä½¿ç”¨åŸåˆ™è§&amp;2.1ã€‚
1.1.3 ä¸€ä¸ªçº¿ç¨‹å®‰å…¨çš„Counterç¤ºä¾‹
è¿™é‡Œä½¿ç”¨äº†ç¥å¥‡çš„mutableå…³é”®å­—.
ä¸‹é¢æ˜¯ç›¸å…³çš„å†…å®¹.
å…³é”®å­—mutable å…³é”®å­—const ä¹¦ä¸Šçš„counterç±»,åœ¨å¯¹è±¡é”€æ¯çš„æ—¶å€™ä¼šæœ‰race caondition
1.2 å¯¹è±¡çš„åˆ›å»ºå¾ˆç®€å•
å¯¹è±¡çš„æ„é€ è¦åšåˆ°çº¿ç¨‹å®‰å…¨,å”¯ä¸€çš„è¦æ±‚å°±æ˜¯åœ¨æ„é€ æœŸé—´ä¸è¦æ³„æ¼thisæŒ‡é’ˆ.
1.3 é”€æ¯å¤ªéš¾
æˆå‘˜å‡½æ•°ç”¨æ¥ä¿æŠ¤ä¸´ç•ŒåŒºçš„äº’æ–¥å™¨æœ¬èº«å¿…é¡»æ˜¯æœ‰æ•ˆçš„ã€‚è€Œææ„å‡½ æ•°ç ´åäº†è¿™ä¸€å‡è®¾ï¼Œå®ƒä¼šæŠŠmutexæˆå‘˜å˜é‡é”€æ¯æ‰ã€‚æ‚²å‰§å•Š
1.3.2 ä½œä¸ºæ•°æ®æˆå‘˜çš„ mutex ä¸èƒ½ä¿æŠ¤ææ„
åŸå§‹æŒ‡é’ˆæœ‰å„ç§é—®é¢˜
1.4 çº¿ç¨‹å®‰å…¨çš„ Observer æœ‰å¤šéš¾
ä¸€ä¸ªObservableç±»,å®ƒæŒæœ‰å¦ä¸€ä¸ªObserverçš„æŒ‡é’ˆ,åœ¨ä½¿ç”¨è¿™ä¸ªæŒ‡é’ˆObserver * -&gt; updateæ—¶,å¦‚ä½•ä¿è¯Observeræ˜¯å­˜åœ¨çš„å‘¢?
åœ¨Observerææ„æ—¶è°ƒç”¨unregister(),è¿™ä¹Ÿä¸è¡Œ,ä¸¤ä¸ªçº¿ç¨‹A,BåŒæ—¶åœ¨è®¿é—®. Aåœ¨ææ„,Bçš„update,ä¼šäº§ç”ŸæœªçŸ¥æƒ…å†µ.
1.4.1 çº¿ç¨‹å®‰å…¨çš„ Observer æœ‰å¤šéš¾
1.4.2 çº¿ç¨‹å®‰å…¨çš„ Observer æœ‰å¤šéš¾
1.6 ç¥å™¨shared_ptr/weak_ptr
1.8 åº”ç”¨åˆ° Observer ä¸Š
æ—¢ç„¶é€šè¿‡ weak_ptr èƒ½æ¢æŸ¥å¯¹è±¡çš„ç”Ÿæ­»ï¼Œé‚£ä¹ˆ Observer æ¨¡å¼çš„ç«æ€æ¡ä»¶å°±å¾ˆå®¹æ˜“è§£å†³ï¼Œåªè¦è®© Observable ä¿å­˜ weak_ptr å³å¯
å¦‚ä½•æ”¹æˆshared_ptr,åˆ™å¯¹åº”çš„å¯¹è±¡ä¼šä¸€ç›´å­˜åœ¨.
1.9 å†è®º shared_ptr çš„çº¿ç¨‹å®‰å…¨
ä½†æ˜¯ shared_ptr æœ¬èº«ä¸æ˜¯100% çº¿ç¨‹å®‰å…¨çš„ã€‚å®ƒçš„å¼•ç”¨è®¡æ•°æœ¬èº«æ˜¯å®‰å…¨ä¸”æ— é”çš„ï¼Œä½†å¯¹è±¡çš„è¯»å†™åˆ™ä¸æ˜¯
`,url:"https://hugo-dead-simple.netlify.com/linux_tcp_program/muduo/chapter1.html"},"https://hugo-dead-simple.netlify.com/linux_tcp_program/muduo/chapter2.html":{title:"",tags:[],content:`1ï¼ é¦–è¦åŸåˆ™æ˜¯å°½é‡æœ€ä½é™åº¦åœ°å…±äº«å¯¹è±¡ï¼Œ å‡å°‘éœ€è¦åŒæ­¥çš„åœºåˆã€‚ ä¸€ä¸ªå¯¹è±¡èƒ½ä¸æš´éœ²ç»™åˆ«çš„çº¿ç¨‹å°±ä¸è¦æš´éœ²ï¼› å¦‚æœè¦æš´éœ²ï¼Œ ä¼˜å…ˆè€ƒè™‘ immutableå¯¹è±¡ï¼› å®åœ¨ä¸è¡Œæ‰æš´éœ²å¯ä¿®æ”¹çš„å¯¹è±¡ï¼Œ å¹¶ç”¨åŒæ­¥æªæ–½æ¥å……åˆ† ä¿æŠ¤å®ƒã€‚ 2ï¼ å…¶æ¬¡æ˜¯ä½¿ç”¨é«˜çº§çš„å¹¶å‘ç¼–ç¨‹æ„ä»¶ï¼Œ å¦‚TaskQueueã€ ProducerConsumer Queueã€ CountDownLatchç­‰ç­‰ã€‚ 3ï¼ æœ€åä¸å¾—å·²å¿…é¡»ä½¿ç”¨åº•å±‚åŒæ­¥åŸè¯­ï¼ˆprimitivesï¼‰ æ—¶ï¼Œ åªç”¨éé€’ å½’çš„äº’æ–¥å™¨å’Œæ¡ä»¶å˜é‡ï¼Œ æ…ç”¨è¯»å†™é”ï¼Œ ä¸è¦ç”¨ä¿¡å·é‡ã€‚ 4ï¼ é™¤äº†ä½¿ç”¨atomicæ•´æ•°ä¹‹å¤–ï¼Œ ä¸è‡ªå·±ç¼–å†™lock-freeä»£ç 3ï¼Œ ä¹Ÿä¸è¦ ç”¨â€œå†…æ ¸çº§â€åŒæ­¥åŸè¯­45ã€‚ ä¸å‡­ç©ºçŒœæµ‹â€œå“ªç§åšæ³•æ€§èƒ½ä¼šæ›´å¥½â€ï¼Œ æ¯”å¦‚spin lock vs. mutexã€‚
`,url:"https://hugo-dead-simple.netlify.com/linux_tcp_program/muduo/chapter2.html"},"https://hugo-dead-simple.netlify.com/linux_tcp_program/muduo/frame.html":{title:"",tags:[],content:`channel -&gt; eventloop &lt;- poller
eventloop åˆ°åº•åšäº†ä»€ä¹ˆå‘¢?
`,url:"https://hugo-dead-simple.netlify.com/linux_tcp_program/muduo/frame.html"},"https://hugo-dead-simple.netlify.com/linux_tcp_program/muduo/readme.html":{title:"",tags:[],content:`æˆ‘å‰é¢å·²ç»çœ‹å®Œäº† TCPIPç½‘ç»œç¼–ç¨‹è¿™æœ¬ä¹¦.
muduo å­¦ä¹ ç¬”è®° 834810071/muduo_study åŸºäº ã€é«˜çº§ã€‘æ‰‹å†™C++ Muduoç½‘ç»œåº“é¡¹ç›®-æŒæ¡é«˜æ€§èƒ½ç½‘ç»œåº“å®ç°åŸç† ä»£ç  GitHub - ShangyizhouA-Tiny-Network-Library ä½¿ç”¨ C++ 11 é‡æ„é™ˆç¡•çš„ muduo åº“ï¼Œå»é™¤ boost ä¾èµ–ã€‚å†…éƒ¨å®ç°æœ‰ HTTP æœåŠ¡å™¨ï¼Œå¯æ”¯æŒ GET è¯·æ±‚ã€‚ å¯ä»¥å‚è€ƒè¿™ä¸ªé¡¹ç›®,çœ‹å®ƒæ˜¯å¦‚æœå®ç°ç”¨æˆ·çš„æ³¨å†Œä¸ç™»å½•çš„ chenshuo/documents æœ‰ppt https://github.com/iceCream1997/muduo_server_learn S1mpleBugmuduo_cpp11 C++11ç‰ˆæœ¬muduoç½‘ç»œåº“ é™¤å»äº†å¯¹booståº“çš„ä¾èµ– è¿˜æœ‰è§†é¢‘æ•™ç¨‹ ç»“åˆæˆ‘è‡ªå·±å†™çš„ä¸€äº›c++çš„ç¬”è®° https://cpphub.roj.ac.cn å½“ç„¶è¿˜æœ‰æˆ‘ä»¬çš„cppreference æ‰‹å†Œ Hansimovlinux-server ã€ŠLinux é«˜æ€§èƒ½æœåŠ¡å™¨ç¼–ç¨‹ã€‹å’Œã€ŠLinuxå¤šçº¿ç¨‹æœåŠ¡ç«¯ç¼–ç¨‹ï¼šä½¿ç”¨muduo C++ç½‘ç»œåº“ã€‹çš„ç¬”è®°å’Œæºç ï¼Œä»¥åŠä¸¤ä¸ªè½»é‡çº§æœåŠ¡å™¨çš„é¡¹ç›®ä»£ç  ä¹Ÿæ¯”è¾ƒæœ‰ç”¨ raichen/LinuxServerCodes: Linuxé«˜æ€§èƒ½æœåŠ¡å™¨ç¼–ç¨‹æºç  https://github.com/raichen/LinuxServerCodes chenshuo/muduo: Event-driven network library for multi-threaded Linux server in C++11 https://github.com/chenshuo/muduo qinguoyi/TinyWebServer: Linuxä¸‹C++è½»é‡çº§WebæœåŠ¡å™¨ https://github.com/qinguoyi/TinyWebServer linyacool/WebServer: A C++ High Performance Web Server https://github.com/linyacool/WebServer ä½¿ç”¨å·¥å…·Webbenchï¼Œè¿›è¡Œæµ‹è¯• å…¶å®ƒå¯ä»¥å‚è€ƒçš„åº“ Frees0u1smuduoChatServer åŸºäºMuduoç²¾ç®€å®ç°çš„Smuduo,åœ¨ä¿ç•™åŸæœ‰åŠŸèƒ½å’Œç‰¹æ€§(äº‹ä»¶é©±åŠ¨çš„Reactoræ¨¡å¼ï¼Œéé˜»å¡IO)çš„åŸºç¡€ä¸Šï¼Œç§»é™¤booståº“ä¾èµ–ï¼Œå¤§é‡ä½¿ç”¨C++11æ–°ç‰¹æ€§. `,url:"https://hugo-dead-simple.netlify.com/linux_tcp_program/muduo/readme.html"},"https://hugo-dead-simple.netlify.com/linux_tcp_program/my_test/%E7%90%86%E8%A7%A3.html":{title:"",tags:[],content:`åœ¨ä½ çš„ C++ ä»£ç ä¸­ï¼Œå½“æ‰§è¡Œ cv.wait(lk); æ—¶ï¼Œlk é”ï¼ˆå³ std::unique_lock å¯¹è±¡ï¼‰ä¼šè¢«è‡ªåŠ¨é‡Šæ”¾ã€‚ è¯¦ç»†è§£é‡Š
1.cv.wait(lk); çš„ä½œç”¨:
2.cv.wait(lk); è¿™ä¸ªè°ƒç”¨ä¼šä½¿å½“å‰çº¿ç¨‹åœ¨æ¡ä»¶å˜é‡ cv ä¸Šç­‰å¾…ï¼ŒåŒæ—¶ä¼šè§£é”ä¸ lk å…³è”çš„äº’æ–¥é” mã€‚è¿™æ„å‘³ç€å…¶ä»–çº¿ç¨‹å¯ä»¥è·å–è¯¥äº’æ–¥é”ï¼Œå¹¶å¯¹å…±äº«æ•°æ®è¿›è¡Œä¿®æ”¹ã€‚
3.é”çš„é‡Šæ”¾ä¸å†è·å–:
4.å½“æ¡ä»¶å˜é‡ cv é€šçŸ¥ï¼ˆnotify_one æˆ– notify_allï¼‰æ—¶ï¼Œçº¿ç¨‹ä¼šè¢«å”¤é†’ï¼Œé‡æ–°è·å¾— m äº’æ–¥é”ï¼Œä¹‹åæ‰ä¼šç»§ç»­æ‰§è¡Œã€‚wait çš„è¿”å›æ—¶æœºé€šå¸¸æ˜¯åœ¨è¢«é€šçŸ¥åï¼Œè¿™æ—¶ä¼šé‡æ–°è·å¾—é”ã€‚
5.å®ç°åŸç†:
6.åœ¨ cv.wait(lk); çš„å®ç°ä¸­ï¼Œè°ƒç”¨ä¼šæ‰§è¡Œä»¥ä¸‹æ­¥éª¤ï¼š 7.é‡Šæ”¾ lkï¼ˆå³é‡Šæ”¾äº’æ–¥é”ï¼‰ã€‚ 8.å°†çº¿ç¨‹ç½®äºç­‰å¾…çŠ¶æ€ï¼ˆæŒ‚èµ·ï¼‰ã€‚ 9.ç­‰å¾…é€šçŸ¥åï¼Œå†é‡æ–°è·å–äº’æ–¥é”ã€‚
æ€»ç»“ å› æ­¤ï¼Œåœ¨ cv.wait(lk); è°ƒç”¨æ—¶ï¼Œlk å¯¹åº”çš„äº’æ–¥é”ä¼šè¢«é‡Šæ”¾ï¼Œå…è®¸å…¶ä»–çº¿ç¨‹åœ¨æ­¤æœŸé—´æ‰§è¡Œä¸´ç•ŒåŒºä»£ç ã€‚å½“æ¡ä»¶å˜é‡å‘å‡ºé€šçŸ¥åï¼Œç­‰å¾…çš„çº¿ç¨‹ä¼šé‡æ–°è·å¾—é”å¹¶ç»§ç»­æ‰§è¡Œã€‚è¿™æ˜¯æ¡ä»¶å˜é‡å®ç°çº¿ç¨‹åŒæ­¥çš„æ ¸å¿ƒæœºåˆ¶ã€‚
`,url:"https://hugo-dead-simple.netlify.com/linux_tcp_program/my_test/%E7%90%86%E8%A7%A3.html"},"https://hugo-dead-simple.netlify.com/linux_tcp_program/tcpip%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/chapter_1.html":{title:"",tags:[],content:`ç¬¬ä¸€ç«  ç†è§£ç½‘ç»œç¼–ç¨‹å’Œsocket ![INFO] ç½‘ç»œç¼–ç¨‹å°±æ˜¯ç¼–å†™ç¨‹åºä½¿ç”¨ä¸¤å°è¿ç½‘çš„è®¡ç®—æœºç›¸äº’äº¤æ¢æ•°æ®.
è¿™å°±æ˜¯æ•´ä¸ªç½‘ç»œç¼–ç¨‹çš„å…¨éƒ¨å†…å®¹.æˆ‘è§‰å¾—ä¸éœ€è¦å»è¯¦ç»†çš„ç†è§£TCP/IPçš„ç»†èŠ‚.
ä¸‹é¢æˆ‘æŒ‰æˆ‘çš„ç†è§£è¿™ä¸€ç« çš„å†…å®¹.
å¦‚æœæˆ‘ä»¬æƒ³åˆ°åœ¨ç”µè„‘ä¸Šåˆ›å»ºä¸€ä¸ªserverç«¯çš„è½¯ä»¶,ç”¨æ¥æ¥æ”¶å…¶å®ƒç”µè„‘ä¸Šå¦ä¸€ä¸ªç¨‹åºé€šè¿‡ç½‘ç»œå‘æ¥çš„ä¿¡æ¯,åº”è¯¥å¦‚ä½•åšå‘¢? åº”è¯¥æŒ‰ä¸‹é¢çš„æµç¨‹æ¥åš
1--- 2title: server socket åˆ›å»ºæµç¨‹ 3--- 4flowchart TD 5 step_1[1.åˆ›å»ºsocket,API:socket] 6 step_2[2.ç»‘å®šç«¯å£ä¸ip: bind] 7 step_3[3.å¼€å¯ç›‘å¬ listen] 8 step_4[4.æ¥å—äº§ç”Ÿçš„socket: accept ] 9 step_1 --&gt; step_2 --&gt; step_3 --&gt; step_4; ç¬¬ä¸€æ­¥åˆ›å»º socket(æ’åº§) å¦‚æœæˆ‘ä»¬å®¶é‡Œéœ€è¦ç½‘ç»œé€šä¿¡,é¦–å…ˆè¦æœ‰ä¸€ä¸ªç½‘ç»œé¢æ¿(ç½‘ç»œæ’åº§)ç”¨æ¥è¿æ¥ç½‘ç»œ,ç„¶åæ‰èƒ½é€šä¿¡. åŒæ ·æˆ‘ä»¬ä¹Ÿéœ€è¦å…ˆåˆ›å»ºä¸€ä¸ªsocket,è¿™ä¸ªsocketçš„ä½œç”¨å°±æ˜¯ç”¨äºåé¢çš„ç½‘ç»œè¿æ¥.
1int socket(int domain,int type,int protocal) å…·ä½“å‚æ•°çš„å«ä¹‰ä¸ç†è§£è§ä¸€ä¸‹ç« èŠ‚
ç¬¬äºŒæ­¥ bindå‡½æ•° é€šè¿‡ç¬¬ä¸€æ­¥æˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªsocket(æ’åº§),é‚£ä¹ˆåº”è¯¥æŠŠå®ƒæ”¾åœ¨å“ªé‡Œå‘¢? å…¶å®å°±æ˜¯æ ¹æ®å“ªäº›ä¿¡æ¯å¯ä»¥æ‰¾åˆ°è¿™ä¸ªsocket.
ä¿¡æ¯é¦–å…ˆè¦èƒ½å‘é€ç»™ç”µè„‘,ä¹Ÿå°±æ˜¯éœ€è¦çŸ¥é“ç”µè„‘çš„IP,ä¸€ä¸ªç”µè„‘å¯ä»¥æœ‰å¤šä¸ªIP. æ¯”å¦‚è¿™ä¸ªç”µè„‘å°±æœ‰ä¸¤ä¸ªç½‘å£,(å•ç½‘å£ä¹Ÿå¯ä»¥æœ‰å¤šIP)
å¯ä»¥æƒ³åƒåˆ°ä¸€ä¸ªç”µè„‘ä¸Šèƒ½è¿›è¡Œç½‘ç»œé€šä¿¡çš„è½¯ä»¶æœ‰å¤šä¸ª,é‚£ä¹ˆå°±æœ‰å¾ˆå¤šä¸ªsocket. ç”µè„‘ä¸ºäº†å’Œå¤–éƒ¨é€šä¿¡,åˆ›å»ºäº†ç«¯å£è¿™ä¸ªæ¦‚å¿µ.
ä½ å¯ä»¥æŠŠç«¯å£æƒ³åƒæˆç”µè„‘ä¸€ä¸ªä¸€ä¸ªå­”æ´,æ¯ä¸€ä¸ªæ•°æ®é€šè¿‡è¿™ä¸ªå­”æ´å‘æµå…¥è¿›ç”µè„‘,å¦‚ä½•ä½ çš„socket&quot;å®‰è£…&quot;åœ¨è¿™ä¸ªç«¯å£ä¸Š,é‚£ä¹ˆå°±å¯ä»¥æ¥æ”¶åˆ°è¿™ä¸ªæ•°æ®äº†.
ç„¶åè¿™ä¸ªsocketå’Œè¿˜éœ€è¦å’ŒæŸä¸€ç«¯å£ç»‘å®šåœ¨ä¸€èµ·.
1#include &lt;sys/socket.h&gt; 2int bind(int sockfd,struct sockaddr_in * myaddr,socklen_t addrlen) ç¬¬ä¸‰æ­¥: æ¿€æ´»ç›‘å¬,listen ç°åœ¨æˆ‘ä»¬æœ‰äº†ä¸€ä¸ªsocket,å¹¶æŠŠå®ƒæ”¾åˆ°äº†åˆé€‚çš„ä½ç½®(bind),æ¥ä¸‹å°±èƒ½é€šä¿¡äº†å—? ä¸èƒ½,è¿˜éœ€è¦å¯ç”¨,æ¿€æ´»å®ƒ,å°±åƒå®¶é‡Œå¼„äº†ç½‘ç»œé¢æ¿,ç½‘çº¿,è¿˜éœ€è¦ç½‘ç»œå…¬å¸ç»™æˆ‘ä»¬å¼€é€šç½‘ç»œæƒé™.
1int listen(int sockfd,int backlog) listençš„å…¶å®æ˜¯åœ¨socketåˆ›å»ºä¸€ä¸ªç›‘å¬é˜Ÿåˆ—,é˜Ÿåˆ—å¤§å°ä¸ºbacklog,æ¯ä¸€ä¸ªclientè¯·æ±‚è¿æ¥å,å°±ä¼šåŠ å…¥åˆ°é˜Ÿåˆ—é‡Œ,ç­‰å¾…å¤„ç†
ç¬¬å››æ­¥: accept,å¤„ç†è¿æ¥è¯·æ±‚ 1int accept(int sockfd,struct sockaddr * addr ,socklen_t * addrlen); ä¸Šä¸€æ­¥,å¯ä»¥æ¥æ”¶è¿æ¥,ç„¶ååŠ å…¥åˆ°é˜Ÿåˆ—é‡Œ,ä½†æ˜¯è¿˜éœ€è¦å¯¹è¿™äº›é˜Ÿåˆ—é‡Œçš„å†…å®¹è¿›è¡Œå¤„ç†.
acceptçš„ä½œç”¨,ä»é˜Ÿåˆ—å–å‡ºä¸€ä¸ªè¿æ¥æ•°æ®,ç„¶ååˆ›å»ºä¸€ä¸ªsocket.ä½ å¯èƒ½ä¼šé—®,ä¸ºä»€ä¹ˆåˆåˆ›å»ºäº†ä¸€ä¸ªsocket,åŸæ¥ä¸æ˜¯æœ‰ä¸€ä¸ªå—?
é¦–å…ˆæˆ‘ä»¬è¦æ˜ç¡®çš„çŸ¥é“ä¸€ä¸ªæ¦‚å¿µ,ä¸¤ä¸ªsocketä¸€åœ¨ä¸€èµ·æ‰èƒ½è¿›è¡Œé€šä¿¡,æˆ–è€…è¯´é€šä¿¡çš„ä¸¤ä¸ªç”µè„‘ä¹‹é—´å„æœ‰ä¸€ä¸ªsocket,ä¸å…è®¸ä¸€socketå¯¹åº”å¤šä¸ªsocket.
ç¬¬ä¸€ä¸ªsocket,æˆ‘ä»¬çš„æˆä¸ºsocket,æˆ‘ä»¬ç§°ä¸ºserver socket,å®ƒåœ¨åŒä¸€æ—¶åˆ»ä¸ä¸€ä¸ªclient socketè¿›è¡Œè¿æ¥,ç„¶åæ¥æ”¶åˆ°å¿…è¦çš„ä¿¡æ¯ä¹‹å.æ ¹æ®è¿™äº›ä¿¡æ¯äº§ç”Ÿä¸€ä¸ªsocket A.è¿™ä¸ªæ–°çš„socket Aå·²ååªä¸è¿™ä¸ªclient socketè¿›è¡Œé€šä¿¡.
è¿™ä¸ªè¿‡ç¨‹æˆ‘ä»¬ç§°ä¸ºaccept
serverç«¯ä»£ç  1{{#include code/1-hello_world_server.c}} ç¼–è¯‘
1gcc -g -o server 1-hello_world_server.c æµ‹è¯•
1netcat -v 127.0.0.1 8989 ç»“æœ
1â netcat -v 127.0.0.1 8989 2localhost [127.0.0.1] 8989 (sunwebadmins) open 3Hello World!% clientç«¯ä»£ç  clientå®ç°æ¯”è¾ƒç®€å•
åˆ›å»ºsocket è°ƒç”¨connect,ä¸server socketè¿›è¡Œè¿æ¥ å‘é€æ•°æ® æ¥æ”¶è¿”å›çš„æ•°æ® ç»“æŸclient socket 1{{#include code/1-hello_world_client.c}} è¿è¡Œç»“æœ
1â ./1-hello_world_client.out 2Message from server: Hello World! inet_addr å‡½æ•° inet_addr æ˜¯ä¸€ä¸ªç”¨äºå°† IPv4 åœ°å€ä»ç‚¹åˆ†åè¿›åˆ¶å­—ç¬¦ä¸²è¡¨ç¤ºè½¬æ¢ä¸ºç½‘ç»œå­—èŠ‚åºçš„ 32 ä½äºŒè¿›åˆ¶å€¼çš„å‡½æ•°ã€‚å®ƒåœ¨ Linux å’Œå…¶ä»–ç±» Unix ç³»ç»Ÿçš„ç½‘ç»œç¼–ç¨‹ä¸­å¹¿æ³›ä½¿ç”¨ã€‚
man 3 inet_addr
å‡½æ•°åŸå‹ï¼š
1#include &lt;arpa/inet.h&gt; 2in_addr_t inet_addr(const char *cp); å‚æ•°ï¼š
cpï¼šä»¥ç‚¹åˆ†åè¿›åˆ¶æ ¼å¼è¡¨ç¤ºçš„ IPv4 åœ°å€å­—ç¬¦ä¸²ï¼Œä¾‹å¦‚ &ldquo;192.168.0.1&rdquo;ã€‚ è¿”å›å€¼ï¼š
æˆåŠŸæ—¶ï¼Œè¿”å›è½¬æ¢åçš„ 32 ä½ç½‘ç»œå­—èŠ‚åºçš„ IPv4 åœ°å€ã€‚ å¤±è´¥æ—¶ï¼Œè¿”å› INADDR_NONEï¼ˆé€šå¸¸ä¸º -1ï¼‰ã€‚ inet_addr å‡½æ•°å°†ç‚¹åˆ†åè¿›åˆ¶æ ¼å¼çš„ IPv4 åœ°å€å­—ç¬¦ä¸²è½¬æ¢ä¸ºç½‘ç»œå­—èŠ‚åºçš„ 32 ä½äºŒè¿›åˆ¶å€¼ã€‚å®ƒæ‰§è¡Œä»¥ä¸‹æ­¥éª¤ï¼š
å°†ç‚¹åˆ†åè¿›åˆ¶çš„ IPv4 åœ°å€å­—ç¬¦ä¸²æŒ‰ç…§ç‚¹å·åˆ†éš”ç¬¦åˆ†å‰²ä¸ºå››ä¸ªéƒ¨åˆ†ï¼Œæ¯ä¸ªéƒ¨åˆ†è¡¨ç¤ºä¸€ä¸ªå­—èŠ‚ã€‚ å°†æ¯ä¸ªéƒ¨åˆ†è½¬æ¢ä¸ºå¯¹åº”çš„æ•´æ•°å€¼ï¼ˆ0-255ï¼‰ã€‚ å°†å››ä¸ªå­—èŠ‚ç»„åˆæˆä¸€ä¸ª 32 ä½çš„äºŒè¿›åˆ¶å€¼ï¼Œå¹¶æŒ‰ç…§ç½‘ç»œå­—èŠ‚åºæ’åˆ—ã€‚ ä¾‹å¦‚ï¼Œå¯¹äº IP åœ°å€ &ldquo;192.168.0.1&rdquo;ï¼Œinet_addr å‡½æ•°å°†è¿”å›ä¸€ä¸ª 32 ä½çš„æ•´æ•°å€¼ 0x0100A8C0ï¼ˆç½‘ç»œå­—èŠ‚åºï¼‰ã€‚
ä½¿ç”¨ç¤ºä¾‹ï¼š
1#include &lt;stdio.h&gt; 2#include &lt;arpa/inet.h&gt; 3 4int main() { 5 const char *ip_str = &#34;192.168.0.1&#34;; 6 in_addr_t ip_addr = inet_addr(ip_str); 7 8 if (ip_addr == INADDR_NONE) { 9 printf(&#34;æ— æ•ˆçš„ IP åœ°å€\\n&#34;); 10 } else { 11 printf(&#34;IP åœ°å€çš„ç½‘ç»œå­—èŠ‚åºè¡¨ç¤º: 0x%08X\\n&#34;, ip_addr); 12 } 13 14 return 0; 15} è¾“å‡ºï¼š
1IP åœ°å€çš„ç½‘ç»œå­—èŠ‚åºè¡¨ç¤º: 0x0100A8C0 éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œinet_addr å‡½æ•°åªæ”¯æŒ IPv4 åœ°å€çš„è½¬æ¢ï¼Œå¯¹äº IPv6 åœ°å€ï¼Œéœ€è¦ä½¿ç”¨ inet_pton å‡½æ•°è¿›è¡Œè½¬æ¢ã€‚
å¦å¤–ï¼Œç”±äº inet_addr å‡½æ•°ä¸èƒ½å¤„ç†æ ¼å¼é”™è¯¯çš„ IP åœ°å€å­—ç¬¦ä¸²ï¼Œå› æ­¤åœ¨å®é™…ä½¿ç”¨ä¸­ï¼Œé€šå¸¸æ¨èä½¿ç”¨æ›´åŠ å¥å£®å’Œé€šç”¨çš„ inet_pton å‡½æ•°æ¥è¿›è¡Œ IP åœ°å€çš„è½¬æ¢ã€‚
linuxçš„æ–‡ä»¶æ“ä½œ æ¯ä¸€ä¸ªç¨‹åºéƒ½æœ‰å¤šä¸ªæ–‡ä»¶æè¿°ç¬¦,ä» 0 åˆ° 1023ï¼Œè¿™äº›0,1,2æ–‡ä»¶æè¿°ç¬¦è¢«ç§°ä¸ºæ ‡å‡†è¾“å…¥ã€æ ‡å‡†è¾“å‡ºã€æ ‡å‡†é”™è¯¯ã€‚
è¿™ä¸ªæ–‡ä»¶æè¿°ç¬¦æ˜¯ç”±linuxç³»ç»Ÿç»´æŠ¤çš„.
1int open(const char *pathname, int flags); 2int close(int fd); 3ssize_t read(int fd, void *buf, size_t count); 4ssize_t write(int fd, const void *buf, size_t count); `,url:"https://hugo-dead-simple.netlify.com/linux_tcp_program/tcpip%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/chapter_1.html"},"https://hugo-dead-simple.netlify.com/linux_tcp_program/tcpip%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/chapter_10.html":{title:"",tags:[],content:`ä¸ºäº†åŠ å¤§æœåŠ¡å™¨åŒæ—¶å¤„ç†ç”¨æˆ·çš„è¿æ¥,æœ‰æ•ˆçš„åˆ©ç”¨CPU
å¤šè¿›ç¨‹æœåŠ¡å™¨: åˆ›å»ºå¤šä¸ªè¿›ç¨‹æä¾›æœåŠ¡ å¤šè·¯å¤ç”¨: æ†ç»‘å¹¶ç»Ÿä¸€ç®¡ç†IOå¯¹è±¡æä¾›æœåŠ¡ å¤šçº¿ç¨‹: ç”Ÿæˆä¸å®¢æˆ·çŸ­ç­‰é‡åŒ–çš„çº¿ç¨‹æä¾›æœåŠ¡ 10.1 è¿›ç¨‹æ¦‚å¿µåŠå¼•ç”¨ ç†è§£è¿›ç¨‹ è¿›ç¨‹çš„å®šä¹‰å¦‚ä¸‹ï¼šå ç”¨å†…å­˜ç©ºé—´çš„æ­£åœ¨è¿è¡Œçš„ç¨‹åº
è¿›ç¨‹ID åœ¨è¯´è¿›ç¨‹åˆ›å»ºæ–¹æ³•ä¹‹å‰ï¼Œå…ˆè¦ç®€è¦è¯´æ˜è¿›ç¨‹ IDã€‚æ— è®ºè¿›ç¨‹æ˜¯å¦‚ä½•åˆ›å»ºçš„ï¼Œæ‰€æœ‰çš„è¿›ç¨‹éƒ½ä¼šè¢«æ“ä½œç³»ç»Ÿåˆ†é…ä¸€ä¸ª IDã€‚æ­¤ ID è¢«ç§°ä¸ºã€Œè¿›ç¨‹IDã€ï¼Œå…¶å€¼ä¸ºå¤§äº 2 çš„æ•´æ•°ã€‚1 è¦åˆ†é…ç»™æ“ä½œç³»ç»Ÿå¯åŠ¨åçš„ï¼ˆç”¨äºååŠ©æ“ä½œç³»ç»Ÿï¼‰é¦–ä¸ªè¿›ç¨‹ï¼Œå› æ­¤ç”¨æˆ·æ— æ³•å¾—åˆ° ID å€¼ä¸º 1 ã€‚æ¥ä¸‹æ¥è§‚å¯Ÿåœ¨ Linux ä¸­è¿è¡Œçš„è¿›ç¨‹ã€‚
forkåˆ›å»ºè¿›ç¨‹ åˆ›å»ºè¿›ç¨‹çš„æ–¹å¼å¾ˆå¤šï¼Œæ­¤å¤„åªä»‹ç»ç”¨äºåˆ›å»ºå¤šè¿›ç¨‹æœåŠ¡ç«¯çš„ fork å‡½æ•°ã€‚
1#include &lt;unistd.h&gt; 2pid_t fork(void); 3// æˆåŠŸæ—¶è¿”å›è¿›ç¨‹ID,å¤±è´¥æ—¶è¿”å› -1 fork å‡½æ•°å°†åˆ›å»ºè°ƒç”¨çš„è¿›ç¨‹å‰¯æœ¬ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå¹¶éæ ¹æ®å®Œå…¨ä¸åŒçš„ç¨‹åºåˆ›å»ºè¿›ç¨‹ï¼Œè€Œæ˜¯å¤åˆ¶æ­£åœ¨è¿è¡Œçš„ã€è°ƒç”¨ fork å‡½æ•°çš„è¿›ç¨‹ã€‚å¦å¤–ï¼Œä¸¤ä¸ªè¿›ç¨‹éƒ½æ‰§è¡Œ fork å‡½æ•°è°ƒç”¨åçš„è¯­å¥ï¼ˆå‡†ç¡®çš„è¯´æ˜¯åœ¨ fork å‡½æ•°è¿”å›åï¼‰ã€‚ä½†å› ä¸ºæ˜¯é€šè¿‡åŒä¸€ä¸ªè¿›ç¨‹ã€å¤åˆ¶ç›¸åŒçš„å†…å­˜ç©ºé—´ï¼Œä¹‹åçš„ç¨‹åºæµè¦æ ¹æ® fork å‡½æ•°çš„è¿”å›å€¼åŠ ä»¥åŒºåˆ†ã€‚å³åˆ©ç”¨ fork å‡½æ•°çš„å¦‚ä¸‹ç‰¹ç‚¹åŒºåˆ†ç¨‹åºæ‰§è¡Œæµç¨‹ã€‚
çˆ¶è¿›ç¨‹ï¼šfork å‡½æ•°è¿”å›å­è¿›ç¨‹ ID å­è¿›ç¨‹ï¼šfork å‡½æ•°è¿”å› 0 æ­¤å¤„ï¼Œã€Œçˆ¶è¿›ç¨‹ã€ï¼ˆParent Processï¼‰æŒ‡åŸè¿›ç¨‹ï¼Œå³è°ƒç”¨ fork å‡½æ•°çš„ä¸»ä½“ï¼Œè€Œã€Œå­è¿›ç¨‹ã€ï¼ˆChild Processï¼‰æ˜¯é€šè¿‡çˆ¶è¿›ç¨‹è°ƒç”¨ fork å‡½æ•°å¤åˆ¶å‡ºçš„è¿›ç¨‹ã€‚æ¥ä¸‹æ¥æ˜¯è°ƒç”¨ fork å‡½æ•°åçš„ç¨‹åºè¿è¡Œæµç¨‹ã€‚å¦‚å›¾æ‰€ç¤ºï¼š
ä»å›¾ä¸­å¯ä»¥çœ‹å‡ºï¼Œçˆ¶è¿›ç¨‹è°ƒç”¨ fork å‡½æ•°çš„åŒæ—¶å¤åˆ¶å‡ºå­è¿›ç¨‹ï¼Œå¹¶åˆ†åˆ«å¾—åˆ° fork å‡½æ•°çš„è¿”å›å€¼ã€‚ä½†å¤åˆ¶å‰ï¼Œçˆ¶è¿›ç¨‹å°†å…¨å±€å˜é‡ gval å¢åŠ åˆ° 11,å°†å±€éƒ¨å˜é‡ lval çš„å€¼å¢åŠ åˆ° 25ï¼Œå› æ­¤åœ¨è¿™ç§çŠ¶æ€ä¸‹å®Œæˆè¿›ç¨‹å¤åˆ¶ã€‚å¤åˆ¶å®Œæˆåæ ¹æ® fork å‡½æ•°çš„è¿”å›ç±»å‹åŒºåˆ†çˆ¶å­è¿›ç¨‹ã€‚çˆ¶è¿›ç¨‹çš„ lval çš„å€¼å¢åŠ  1 ï¼Œä½†è¿™ä¸ä¼šå½±å“å­è¿›ç¨‹çš„ lval å€¼ã€‚åŒæ ·å­è¿›ç¨‹å°† gval çš„å€¼å¢åŠ  1 ä¹Ÿä¸ä¼šå½±å“åˆ°çˆ¶è¿›ç¨‹çš„ gval ã€‚å› ä¸º fork å‡½æ•°è°ƒç”¨ååˆ†æˆäº†å®Œå…¨ä¸åŒçš„è¿›ç¨‹ï¼Œåªæ˜¯äºŒè€…å…±äº«åŒä¸€æ®µä»£ç è€Œå·²ã€‚æ¥ä¸‹æ¥ç»™å‡ºä¸€ä¸ªä¾‹å­ï¼š
1#include &lt;stdio.h&gt; 2#include &lt;unistd.h&gt; 3int gval = 10; 4int main(int argc, char *argv[]) 5{ 6 pid_t pid; 7 int lval = 20; 8 gval++, lval += 5; 9 pid = fork(); 10 if (pid == 0) 11 gval += 2, lval += 2; 12 else 13 gval -= 2, lval -= 2; 14 if (pid == 0) 15 printf(&#34;Child Proc: [%d,%d] \\n&#34;, gval, lval); 16 else 17 printf(&#34;Parent Proc: [%d,%d] \\n&#34;, gval, lval); 18 return 0; 19} 10.2 è¿›ç¨‹ä¸åƒµå°¸è¿›ç¨‹ æ–‡ä»¶æ“ä½œä¸­ï¼Œå…³é—­æ–‡ä»¶å’Œæ‰“å¼€æ–‡ä»¶åŒç­‰é‡è¦ã€‚åŒæ ·ï¼Œè¿›ç¨‹é”€æ¯å’Œè¿›ç¨‹åˆ›å»ºä¹ŸåŒç­‰é‡è¦ã€‚å¦‚æœæœªè®¤çœŸå¯¹å¾…è¿›ç¨‹é”€æ¯ï¼Œä»–ä»¬å°†å˜æˆåƒµå°¸è¿›ç¨‹ã€‚
è¿›ç¨‹çš„å·¥ä½œå®Œæˆåï¼ˆæ‰§è¡Œå®Œ main å‡½æ•°ä¸­çš„ç¨‹åºåï¼‰åº”è¢«é”€æ¯ï¼Œä½†æœ‰æ—¶è¿™äº›è¿›ç¨‹å°†å˜æˆåƒµå°¸è¿›ç¨‹ï¼Œå ç”¨ç³»ç»Ÿä¸­çš„é‡è¦èµ„æºã€‚è¿™ç§çŠ¶æ€ä¸‹çš„è¿›ç¨‹ç§°ä½œã€Œåƒµå°¸è¿›ç¨‹ã€ï¼Œè¿™ä¹Ÿæ˜¯ç»™ç³»ç»Ÿå¸¦æ¥è´Ÿæ‹…çš„åŸå› ä¹‹ä¸€ã€‚
åƒµå°¸è¿›ç¨‹æ˜¯å½“å­è¿›ç¨‹æ¯”çˆ¶è¿›ç¨‹å…ˆç»“æŸï¼Œè€Œçˆ¶è¿›ç¨‹åˆæ²¡æœ‰å›æ”¶å­è¿›ç¨‹ï¼Œé‡Šæ”¾å­è¿›ç¨‹å ç”¨çš„èµ„æºï¼Œæ­¤æ—¶å­è¿›ç¨‹å°†æˆä¸ºä¸€ä¸ªåƒµå°¸è¿›ç¨‹ã€‚å¦‚æœçˆ¶è¿›ç¨‹å…ˆé€€å‡º ï¼Œå­è¿›ç¨‹è¢«initæ¥ç®¡ï¼Œå­è¿›ç¨‹é€€å‡ºåinitä¼šå›æ”¶å…¶å ç”¨çš„ç›¸å…³èµ„æº
UNIXå‘½ä»¤psåˆ—å‡ºçš„è¿›ç¨‹çš„çŠ¶æ€ï¼ˆ&ldquo;STAT&rdquo;ï¼‰æ æ ‡ç¤ºä¸º &ldquo;Z&quot;åˆ™ä¸ºåƒµå°¸è¿›ç¨‹ã€‚[1]
æ”¶å‰²åƒµå°¸è¿›ç¨‹çš„æ–¹æ³•æ˜¯é€šè¿‡killå‘½ä»¤æ‰‹å·¥å‘å…¶çˆ¶è¿›ç¨‹å‘é€SIGCHLDä¿¡å·ã€‚å¦‚æœå…¶çˆ¶è¿›ç¨‹ä»ç„¶æ‹’ç»æ”¶å‰²åƒµå°¸è¿›ç¨‹ï¼Œåˆ™ç»ˆæ­¢çˆ¶è¿›ç¨‹ï¼Œä½¿å¾—initè¿›ç¨‹æ”¶å…»åƒµå°¸è¿›ç¨‹ã€‚initè¿›ç¨‹å‘¨æœŸæ‰§è¡Œwaitç³»ç»Ÿè°ƒç”¨æ”¶å‰²å…¶æ”¶å…»çš„æ‰€æœ‰åƒµå°¸è¿›ç¨‹ã€‚
äº§ç”Ÿåƒµå°¸è¿›ç¨‹çš„åŸå›  äº§ç”Ÿåƒµå°¸è¿›ç¨‹çš„åŸå› æ˜¯: å½“å­è¿›ç¨‹ç»“æŸæ—¶,æ“ä½œç³»ç»Ÿä¸ä¼šä¸»åŠ¨å°†å­è¿›ç¨‹çš„é€€å‡ºçŠ¶æ€ä¼ é€’ç»™çˆ¶è¿›ç¨‹ ã€‚åªæœ‰çˆ¶è¿›ç¨‹ä¸»åŠ¨è¯·æ±‚è·å–å­è¿›ç¨‹çš„é€€å‡ºçŠ¶æ€, æ“ä½œç³»ç»Ÿæ‰ä¼šå°†å…¶ä¼ é€’ã€‚å¦‚æœçˆ¶è¿›ç¨‹æ²¡æœ‰ä¸»åŠ¨è¦æ±‚è·å–å­è¿›ç¨‹çš„é€€å‡ºçŠ¶æ€,æ“ä½œç³»ç»Ÿå°†ä¸€ç›´ä¿å­˜å­è¿›ç¨‹çš„é€€å‡ºçŠ¶æ€,å¯¼è‡´å­è¿›ç¨‹é•¿æ—¶é—´å¤„äºåƒµå°¸è¿›ç¨‹çŠ¶æ€ã€‚å› æ­¤,ä¸ºäº†åŠæ—¶å›æ”¶å­è¿›ç¨‹,çˆ¶è¿›ç¨‹åº”è¯¥ä¸»åŠ¨è·å–å­è¿›ç¨‹çš„é€€å‡ºçŠ¶æ€ã€‚
zombie.c
1{{#include chapter_10/zombie.c }} é”€æ¯åƒµå°¸ waitå‡½æ•° çˆ¶è¿›ç¨‹åº”è¯¥ä¸»åŠ¨è¯·æ±‚è·å–å­è¿›ç¨‹çš„è¿”å›å€¼ä»¥é”€æ¯å­è¿›ç¨‹ã€‚ä½¿ç”¨ wait å‡½æ•°æ¥è·å–å­è¿›ç¨‹çš„ç»ˆæ­¢çŠ¶æ€ï¼Œé€šè¿‡å® WIFEXITED å’Œ WEXITSTATUS æ¥åˆ†ç¦»å’Œå¤„ç†å­è¿›ç¨‹çš„è¿”å›å€¼ã€‚
{{#include chapter_10/wait.c }}
é”€æ¯åƒµå°¸ waitpidå‡½æ•° wait å‡½æ•°ä¼šå¼•èµ·ç¨‹åºé˜»å¡ï¼Œè¿˜å¯ä»¥è€ƒè™‘è°ƒç”¨ waitpid å‡½æ•°ã€‚è¿™æ˜¯é˜²æ­¢åƒµå°¸è¿›ç¨‹çš„ç¬¬äºŒç§æ–¹æ³•ï¼Œä¹Ÿæ˜¯é˜²æ­¢é˜»å¡çš„æ–¹æ³•ã€‚
1#include &lt;sys/wait.h&gt; 2pid_t waitpid(pid_t pid, int *statloc, int options); 3/* 4æˆåŠŸæ—¶è¿”å›ç»ˆæ­¢çš„å­è¿›ç¨‹ID æˆ– 0 ï¼Œå¤±è´¥æ—¶è¿”å› -1 5pid: ç­‰å¾…ç»ˆæ­¢çš„ç›®æ ‡å­è¿›ç¨‹çš„ID,è‹¥ä¼  -1ï¼Œåˆ™ä¸ wait å‡½æ•°ç›¸åŒï¼Œå¯ä»¥ç­‰å¾…ä»»æ„å­è¿›ç¨‹ç»ˆæ­¢ 6statloc: ä¸ wait å‡½æ•°çš„ statloc å‚æ•°å…·æœ‰ç›¸åŒå«ä¹‰ 7options: ä¼ é€’å¤´æ–‡ä»¶ sys/wait.h å£°æ˜çš„å¸¸é‡ WNOHANG ,å³ä½¿æ²¡æœ‰ç»ˆæ­¢çš„å­è¿›ç¨‹ä¹Ÿä¸ä¼šè¿›å…¥é˜»å¡çŠ¶æ€ï¼Œè€Œæ˜¯è¿”å› 0 é€€å‡ºå‡½æ•°ã€‚ 8*/ waitpid.c
1#include &lt;stdio.h&gt; 2#include &lt;unistd.h&gt; 3#include &lt;sys/wait.h&gt; 4int main(int argc, char *argv[]) 5{ 6 int status; 7 pid_t pid = fork(); 8 if (pid == 0) 9 { 10 sleep(15); //ç”¨ sleep æ¨è¿Ÿå­è¿›ç¨‹çš„æ‰§è¡Œ 11 return 24; 12 } 13 else 14 { 15 //è°ƒç”¨waitpid ä¼ é€’å‚æ•° WNOHANG ï¼Œè¿™æ ·ä¹‹å‰æœ‰æ²¡æœ‰ç»ˆæ­¢çš„å­è¿›ç¨‹åˆ™è¿”å›0 16 while (!waitpid(-1, &amp;status, WNOHANG)) 17 { 18 sleep(3); 19 puts(&#34;sleep 3 sec.&#34;); 20 } 21 if (WIFEXITED(status)) 22 printf(&#34;Child send %d \\n&#34;, WEXITSTATUS(status)); 23 } 24 return 0; 10.3 ä¿¡å·å¤„ç† å­è¿›ç¨‹ç©¶ç«Ÿä½•æ—¶ç»ˆæ­¢ï¼Ÿè°ƒç”¨ waitpid å‡½æ•°åè¦æ— ä¼‘æ­¢çš„ç­‰å¾…å—ï¼Ÿ
ä¿¡å·æ˜¯ä¸€ç§è½¯ä¸­æ–­ï¼Œå®ƒæ˜¯ç”±æ“ä½œç³»ç»Ÿå‘è¿›ç¨‹å‘é€çš„é€šçŸ¥æ¶ˆæ¯ã€‚ä¿¡å·çš„ä½œç”¨æ˜¯é€šçŸ¥è¿›ç¨‹å‘ç”Ÿäº†æŸç§äº‹ä»¶ï¼Œå¦‚è¿›ç¨‹ç»ˆæ­¢ã€è¿›ç¨‹æ”¶åˆ°æŸç§è¾“å…¥ã€è¿›ç¨‹æ‰§è¡Œæ—¶é—´åˆ°è¾¾æŸä¸€ç‚¹ç­‰ã€‚ä¿¡å·çš„å¤„ç†æ–¹å¼æ˜¯é€šè¿‡ä¿¡å·å¤„ç†å‡½æ•°æ¥å®ç°çš„ã€‚
å­è¿›ç¨‹ç»ˆæ­¢çš„è¯†åˆ«ä¸»ä½“æ˜¯æ“ä½œç³»ç»Ÿï¼Œå› æ­¤ï¼Œè‹¥æ“ä½œç³»ç»Ÿèƒ½æŠŠå­è¿›ç¨‹ç»“æŸçš„ä¿¡æ¯å‘Šè¯‰æ­£å¿™äºå·¥ä½œçš„çˆ¶è¿›ç¨‹ï¼Œå°†æœ‰åŠ©äºæ„å»ºæ›´é«˜æ•ˆçš„ç¨‹åº
ä¿¡å·ä¸signalå‡½æ•° æˆ‘ä»¬å¯ä»¥æ³¨å†Œä¿¡å·å¤„ç†å‡½æ•°ï¼Œå½“ä¿¡å·å‘ç”Ÿæ—¶ï¼Œæ“ä½œç³»ç»Ÿå°†è°ƒç”¨ç›¸åº”çš„ä¿¡å·å¤„ç†å‡½æ•°ã€‚ä¿¡å·å¤„ç†å‡½æ•°çš„åŸå‹å¦‚ä¸‹ï¼š
1#include &lt;signal.h&gt; 2void (*signal(int signo, void (*func)(int)))(int); 3/* 4ä¸ºäº†åœ¨äº§ç”Ÿä¿¡å·æ—¶è°ƒç”¨ï¼Œè¿”å›ä¹‹å‰æ³¨å†Œçš„å‡½æ•°æŒ‡é’ˆ 5å‡½æ•°å: signal 6å‚æ•°ï¼šint signo,void(*func)(int) 7è¿”å›ç±»å‹ï¼šå‚æ•°ç±»å‹ä¸ºintå‹ï¼Œè¿”å› void å‹å‡½æ•°æŒ‡é’ˆ 8*/ è¿™ä¸ªå‡½æ•°æ¯”è¾ƒéš¾,æˆ‘è¿™æ ·ç†è§£
æœ‰å‡½æ•°ä¸º
1void func_a(int) è¿™ä¸ªå‡½æ•°çš„æ˜¯ä¸€ä¸ªè¿”å›å€¼ä¸ºvoid,å‚æ•°ä¸ºintçš„å‡½æ•°.
1void (*func_b)(int) 2 3//ç›¸å½“äº 4 5//å®šä¹‰ä¸€ä¸ªç±»å‹,å‡½æ•°æŒ‡é’ˆ 6typedef void (*)(int) func_a_pointer; 7// å®šä¹‰ä¸€ä¸ªæŒ‡å‘å‡½æ•°çš„å˜é‡ 8func_a_pointer func_a_p = func_a; æ€ä¹ˆç†è§£å‡½æ•°æŒ‡é’ˆ å†éš¾ä¸€ç‚¹,å®šä¹‰å‡½æ•°çš„è¿”å›å€¼ ä¸ºå‡½æ•°æŒ‡é’ˆ
1void (*func_c(int))(int) 2 3typedef void (*)(int) func_a_pointer; 4// å®šä¹‰ä¸€ä¸ªæŒ‡å‘å‡½æ•°çš„å˜é‡ 5func_a_pointer function_c(int); å†éš¾ä¸€ç‚¹,å‡½æ•°çš„è¿”å›å€¼ä¸ºå‡½æ•°æŒ‡é’ˆ,ä¸”å‡½æ•°çš„å‚æ•°è¿˜æœ‰ä¸€ä¸ªå‡½æ•°æŒ‡é’ˆ
1void (*signal(int signo, void (*func)(int)))(int); è°ƒç”¨ä¸Šè¿°å‡½æ•°æ—¶ï¼Œç¬¬ä¸€ä¸ªå‚æ•°ä¸ºç‰¹æ®Šæƒ…å†µä¿¡æ¯ï¼Œç¬¬äºŒä¸ªå‚æ•°ä¸ºç‰¹æ®Šæƒ…å†µä¸‹å°†è¦è°ƒç”¨çš„å‡½æ•°çš„åœ°å€å€¼ï¼ˆæŒ‡é’ˆï¼‰ã€‚å‘ç”Ÿç¬¬ä¸€ä¸ªå‚æ•°ä»£è¡¨çš„æƒ…å†µæ—¶ï¼Œè°ƒç”¨ç¬¬äºŒä¸ªå‚æ•°æ‰€æŒ‡çš„å‡½æ•°ã€‚ä¸‹é¢ç»™å‡ºå¯ä»¥åœ¨ signal å‡½æ•°ä¸­æ³¨å†Œçš„éƒ¨åˆ†ç‰¹æ®Šæƒ…å†µå’Œå¯¹åº”çš„å‡½æ•°ã€‚
SIGALRMï¼šå·²åˆ°é€šè¿‡è°ƒç”¨ alarm å‡½æ•°æ—¶å€™äº§ç”Ÿ SIGINTï¼šè¾“å…¥ ctrl+c SIGCHLDï¼šå­è¿›ç¨‹ç»ˆæ­¢ 1#include &lt;stdio.h&gt; 2#include &lt;unistd.h&gt; 3#include &lt;signal.h&gt; 4void timeout(int sig) //ä¿¡å·å¤„ç†å™¨ 5{ 6 if (sig == SIGALRM) 7 puts(&#34;Time out!&#34;); 8 alarm(2); //ä¸ºäº†æ¯éš” 2 ç§’é‡å¤äº§ç”Ÿ SIGALRM ä¿¡å·ï¼Œåœ¨ä¿¡å·å¤„ç†å™¨ä¸­è°ƒç”¨ alarm å‡½æ•° 9} 10void keycontrol(int sig) //ä¿¡å·å¤„ç†å™¨ 11{ 12 if (sig == SIGINT) 13 puts(&#34;CTRL+C pressed&#34;); 14} 15int main(int argc, char *argv[]) 16{ 17 int i; 18 signal(SIGALRM, timeout); //æ³¨å†Œä¿¡å·åŠç›¸åº”å¤„ç†å™¨ 19 signal(SIGINT, keycontrol); 20 alarm(2); //é¢„çº¦ 2 ç§’å€™å‘ç”Ÿ SIGALRM ä¿¡å· 21 22 for (i = 0; i &lt; 3; i++) 23 { 24 puts(&#34;wait...&#34;); 25 sleep(100); 26 } 27 return 0; 28} å‘ç”Ÿä¿¡å·æ—¶å°†å”¤é†’ç”±äºè°ƒç”¨ sleep å‡½æ•°è€Œè¿›å…¥é˜»å¡çŠ¶æ€çš„è¿›ç¨‹ã€‚
åˆ©ç”¨ sigaction å‡½æ•°è¿›è¡Œä¿¡å·å¤„ç† è¿˜æœ‰ä¸€ä¸ªå‡½æ•°ï¼Œå«åš sigaction å‡½æ•°ï¼Œä»–ç±»ä¼¼äº signal å‡½æ•°ï¼Œè€Œä¸”å¯ä»¥å®Œå…¨ä»£æ›¿åè€…ï¼Œä¹Ÿæ›´ç¨³å®šã€‚ä¹‹æ‰€ä»¥ç¨³å®šï¼Œæ˜¯å› ä¸ºï¼š
signal å‡½æ•°åœ¨ Unix ç³»åˆ—çš„ä¸åŒæ“ä½œç³»ç»Ÿå¯èƒ½å­˜åœ¨åŒºåˆ«ï¼Œä½† sigaction å‡½æ•°å®Œå…¨ç›¸åŒ
å®é™…ä¸Šç°åœ¨å¾ˆå°‘ç”¨ signal å‡½æ•°ç¼–å†™ç¨‹åºï¼Œä»–åªæ˜¯ä¸ºäº†ä¿æŒå¯¹æ—§ç¨‹åºçš„å…¼å®¹ï¼Œä¸‹é¢ä»‹ç» sigaction å‡½æ•°ï¼Œåªè®²è§£å¯ä»¥æ›¿æ¢ signal å‡½æ•°çš„åŠŸèƒ½ã€‚
1#include &lt;signal.h&gt; 2 3int sigaction(int signo, const struct sigaction *act, struct sigaction *oldact); 4/* 5æˆåŠŸæ—¶è¿”å› 0 ï¼Œå¤±è´¥æ—¶è¿”å› -1 6act: å¯¹äºç¬¬ä¸€ä¸ªå‚æ•°çš„ä¿¡å·å¤„ç†å‡½æ•°ï¼ˆä¿¡å·å¤„ç†å™¨ï¼‰ä¿¡æ¯ã€‚ 7oldact: é€šè¿‡æ­¤å‚æ•°è·å–ä¹‹å‰æ³¨å†Œçš„ä¿¡å·å¤„ç†å‡½æ•°æŒ‡é’ˆï¼Œè‹¥ä¸éœ€è¦åˆ™ä¼ é€’ 0 8*/ å£°æ˜å¹¶åˆå§‹åŒ– sigaction ç»“æ„ä½“å˜é‡ä»¥è°ƒç”¨ä¸Šè¿°å‡½æ•°ï¼Œè¯¥ç»“æ„ä½“å®šä¹‰å¦‚ä¸‹ï¼š
1struct sigaction 2{ 3 void (*sa_handler)(int); 4 sigset_t sa_mask; 5 int sa_flags; 6}; 1#include &lt;stdio.h&gt; 2#include &lt;unistd.h&gt; 3#include &lt;signal.h&gt; 4 5void timeout(int sig) 6{ 7 if (sig == SIGALRM) 8 puts(&#34;Time out!&#34;); 9 alarm(2); 10} 11 12int main(int argc, char *argv[]) 13{ 14 int i; 15 struct sigaction act; 16 act.sa_handler = timeout; //ä¿å­˜å‡½æ•°æŒ‡é’ˆ 17 sigemptyset(&amp;act.sa_mask); //å°† sa_mask æˆå‘˜çš„æ‰€æœ‰ä½åˆå§‹åŒ–æˆ0 18 act.sa_flags = 0; //sa_flags åŒæ ·åˆå§‹åŒ–æˆ 0 19 sigaction(SIGALRM, &amp;act, 0); //æ³¨å†Œ SIGALRM ä¿¡å·çš„å¤„ç†å™¨ã€‚ 20 21 alarm(2); //2 ç§’åå‘ç”Ÿ SIGALRM ä¿¡å· 22 23 for (int i = 0; i &lt; 3; i++) 24 { 25 puts(&#34;wait...&#34;); 26 sleep(100); 27 } 28 return 0; 29} 10.3.4 åˆ©ç”¨ä¿¡å·å¤„ç†æŠ€æœ¯æ¶ˆç­åƒµå°¸è¿›ç¨‹ ä¸‹é¢åˆ©ç”¨å­è¿›ç¨‹ç»ˆæ­¢æ—¶äº§ç”Ÿ SIGCHLD ä¿¡å·è¿™ä¸€ç‚¹ï¼Œæ¥ç”¨ä¿¡å·å¤„ç†æ¥æ¶ˆç­åƒµå°¸è¿›ç¨‹ã€‚çœ‹ä»¥ä¸‹ä»£ç ï¼š
1#include &lt;stdio.h&gt; 2#include &lt;stdlib.h&gt; 3#include &lt;unistd.h&gt; 4#include &lt;signal.h&gt; 5#include &lt;sys/wait.h&gt; 6 7void read_childproc(int sig) 8{ 9 int status; 10 pid_t id = waitpid(-1, &amp;status, WNOHANG); 11 if (WIFEXITED(status)) 12 { 13 printf(&#34;Removed proc id: %d \\n&#34;, id); //å­è¿›ç¨‹çš„ pid 14 printf(&#34;Child send: %d \\n&#34;, WEXITSTATUS(status)); //å­è¿›ç¨‹çš„è¿”å›å€¼ 15 } 16} 17 18int main(int argc, char *argv[]) 19{ 20 pid_t pid; 21 struct sigaction act; 22 act.sa_handler = read_childproc; 23 sigemptyset(&amp;act.sa_mask); 24 act.sa_flags = 0; 25 sigaction(SIGCHLD, &amp;act, 0); 26 27 pid = fork(); 28 if (pid == 0) //å­è¿›ç¨‹æ‰§è¡Œé˜¶æ®µ 29 { 30 puts(&#34;Hi I&#39;m child process&#34;); 31 sleep(10); 32 return 12; 33 } 34 else //çˆ¶è¿›ç¨‹æ‰§è¡Œé˜¶æ®µ 35 { 36 printf(&#34;Child proc id: %d\\n&#34;, pid); 37 pid = fork(); 38 if (pid == 0) 39 { 40 puts(&#34;Hi! I&#39;m child process&#34;); 41 sleep(10); 42 exit(24); 43 } 44 else 45 { 46 int i; 47 printf(&#34;Child proc id: %d \\n&#34;, pid); 48 for (i = 0; i &lt; 5; i++) 49 { 50 puts(&#34;wait&#34;); 51 sleep(5); 52 } 53 } 54 } 55 return 0; 56} 10.4 åŸºäºå¤šä»»åŠ¡çš„å¹¶å‘æœåŠ¡å™¨ ä¹‹å‰çš„å›å£°æœåŠ¡å™¨æ¯æ¬¡åªèƒ½åŒäº‹å‘ 1 ä¸ªå®¢æˆ·ç«¯æä¾›æœåŠ¡ã€‚å› æ­¤ï¼Œéœ€è¦æ‰©å±•å›å£°æœåŠ¡å™¨ï¼Œä½¿å…¶å¯ä»¥åŒæ—¶å‘å¤šä¸ªå®¢æˆ·ç«¯æä¾›æœåŠ¡ã€‚ä¸‹å›¾æ˜¯åŸºäºå¤šè¿›ç¨‹çš„å›å£°æœåŠ¡å™¨çš„æ¨¡å‹ã€‚
ä»å›¾ä¸­å¯ä»¥çœ‹å‡ºï¼Œæ¯å½“æœ‰å®¢æˆ·ç«¯è¯·æ±‚æ—¶ï¼ˆè¿æ¥è¯·æ±‚ï¼‰ï¼Œå›å£°æœåŠ¡å™¨éƒ½åˆ›å»ºå­è¿›ç¨‹ä»¥æä¾›æœåŠ¡ã€‚å¦‚æœè¯·æ±‚çš„å®¢æˆ·ç«¯æœ‰ 5 ä¸ªï¼Œåˆ™å°†åˆ›å»º 5 ä¸ªå­è¿›ç¨‹æ¥æä¾›æœåŠ¡ï¼Œä¸ºäº†å®Œæˆè¿™äº›ä»»åŠ¡ï¼Œéœ€è¦ç»è¿‡å¦‚ä¸‹è¿‡ç¨‹ï¼š
ç¬¬ä¸€é˜¶æ®µï¼šå›å£°æœåŠ¡å™¨ç«¯ï¼ˆçˆ¶è¿›ç¨‹ï¼‰é€šè¿‡è°ƒç”¨ accept å‡½æ•°å—ç†è¿æ¥è¯·æ±‚ ç¬¬äºŒé˜¶æ®µï¼šæ­¤æ—¶è·å–çš„å¥—æ¥å­—æ–‡ä»¶æè¿°ç¬¦åˆ›å»ºå¹¶ä¼ é€’ç»™å­è¿›ç¨‹ ç¬¬ä¸‰é˜¶æ®µï¼šå­è¿›ç¨‹åˆ©ç”¨ä¼ é€’æ¥çš„æ–‡ä»¶æè¿°ç¬¦æä¾›æœåŠ¡ Q ? å¦‚ä½•ä¼ é€’ç»™å­è¿›ç¨‹æ–‡ä»¶æè¿°ç¬¦
A å­è¿›ç¨‹ä¼šå¤åˆ¶çˆ¶è¿›ç¨‹çš„æ‰€æœ‰çš„èµ„æº,æ‰€ä»¥ä¸éœ€è¦ä¼ é€’
Q: å­è¿›ç¨‹ä¼šå¤åˆ¶çˆ¶è¿›ç¨‹çš„server_sdï¼ˆå¥—æ¥å­—æ–‡ä»¶æè¿°ç¬¦ï¼‰å—? é‚£ä»–ä¼šæ”¶åˆ°cientçš„æ•°æ®å—?
1#include &lt;stdio.h&gt; 2#include &lt;stdlib.h&gt; 3#include &lt;string.h&gt; 4#include &lt;unistd.h&gt; 5#include &lt;signal.h&gt; 6#include &lt;sys/wait.h&gt; 7#include &lt;arpa/inet.h&gt; 8#include &lt;sys/socket.h&gt; 9 10#define BUF_SIZE 30 11void error_handling(char *message); 12void read_childproc(int sig); 13 14int main(int argc, char *argv[]) 15{ 16 int serv_sock, clnt_sock; 17 struct sockaddr_in serv_adr, clnt_adr; 18 19 pid_t pid; 20 struct sigaction act; 21 socklen_t adr_sz; 22 int str_len, state; 23 char buf[BUF_SIZE]; 24 if (argc != 2) 25 { 26 printf(&#34;Usgae : %s &lt;port&gt;\\n&#34;, argv[0]); 27 exit(1); 28 } 29 act.sa_handler = read_childproc; //é˜²æ­¢åƒµå°¸è¿›ç¨‹ 30 sigemptyset(&amp;act.sa_mask); 31 act.sa_flags = 0; 32 state = sigaction(SIGCHLD, &amp;act, 0); //æ³¨å†Œä¿¡å·å¤„ç†å™¨,æŠŠæˆåŠŸçš„è¿”å›å€¼ç»™ state 33 serv_sock = socket(PF_INET, SOCK_STREAM, 0); //åˆ›å»ºæœåŠ¡ç«¯å¥—æ¥å­— 34 memset(&amp;serv_adr, 0, sizeof(serv_adr)); 35 serv_adr.sin_family = AF_INET; 36 serv_adr.sin_addr.s_addr = htonl(INADDR_ANY); 37 serv_adr.sin_port = htons(atoi(argv[1])); 38 39 if (bind(serv_sock, (struct sockaddr *)&amp;serv_adr, sizeof(serv_adr)) == -1) //åˆ†é…IPåœ°å€å’Œç«¯å£å· 40 error_handling(&#34;bind() error&#34;); 41 if (listen(serv_sock, 5) == -1) //è¿›å…¥ç­‰å¾…è¿æ¥è¯·æ±‚çŠ¶æ€ 42 error_handling(&#34;listen() error&#34;); 43 44 while (1) 45 { 46 adr_sz = sizeof(clnt_adr); 47 clnt_sock = accept(serv_sock, (struct sockaddr *)&amp;clnt_adr, &amp;adr_sz); 48 if (clnt_sock == -1) 49 continue; 50 else 51 puts(&#34;new client connected...&#34;); 52 pid = fork(); //æ­¤æ—¶ï¼Œçˆ¶å­è¿›ç¨‹åˆ†åˆ«å¸¦æœ‰ä¸€ä¸ªå¥—æ¥å­— 53 if (pid == -1) 54 { 55 close(clnt_sock); 56 continue; 57 } 58 if (pid == 0) //å­è¿›ç¨‹è¿è¡ŒåŒºåŸŸ,æ­¤éƒ¨åˆ†å‘å®¢æˆ·ç«¯æä¾›å›å£°æœåŠ¡ 59 { 60 close(serv_sock); //å…³é—­æœåŠ¡å™¨å¥—æ¥å­—ï¼Œå› ä¸ºä»çˆ¶è¿›ç¨‹ä¼ é€’åˆ°äº†å­è¿›ç¨‹ 61 while ((str_len = read(clnt_sock, buf, BUFSIZ)) != 0) 62 write(clnt_sock, buf, str_len); 63 64 close(clnt_sock); 65 puts(&#34;client disconnected...&#34;); 66 return 0; 67 } 68 else 69 close(clnt_sock); //é€šè¿‡ accept å‡½æ•°åˆ›å»ºçš„å¥—æ¥å­—æ–‡ä»¶æè¿°ç¬¦å·²ç»å¤åˆ¶ç»™å­è¿›ç¨‹ï¼Œå› ä¸ºæœåŠ¡å™¨ç«¯è¦é”€æ¯è‡ªå·±æ‹¥æœ‰çš„ 70 } 71 close(serv_sock); 72 73 return 0; 74} 75 76void error_handling(char *message) 77{ 78 fputs(message, stderr); 79 fputc(&#39;\\n&#39;, stderr); 80 exit(1); 81} 82void read_childproc(int sig) 83{ 84 pid_t pid; 85 int status; 86 pid = waitpid(-1, &amp;status, WNOHANG); 87 printf(&#34;removed proc id: %d \\n&#34;, pid); 88} 10.4.2 å®ç°å¹¶å‘æœåŠ¡å™¨ 10.4.3 é€šè¿‡ fork å‡½æ•°å¤åˆ¶æ–‡ä»¶æè¿°ç¬¦ ç¤ºä¾‹ä¸­ç»™å‡ºäº†é€šè¿‡ fork å‡½æ•°å¤åˆ¶æ–‡ä»¶æè¿°ç¬¦çš„è¿‡ç¨‹ã€‚çˆ¶è¿›ç¨‹å°† 2 ä¸ªå¥—æ¥å­—ï¼ˆä¸€ä¸ªæ˜¯æœåŠ¡ç«¯å¥—æ¥å­—å¦ä¸€ä¸ªæ˜¯å®¢æˆ·ç«¯å¥—æ¥å­—ï¼‰æ–‡ä»¶æè¿°ç¬¦å¤åˆ¶ç»™äº†å­è¿›ç¨‹ã€‚
è°ƒç”¨ fork å‡½æ•°æ—¶èµ‹å€¼çˆ¶è¿›ç¨‹çš„æ‰€æœ‰èµ„æºï¼Œä½†æ˜¯å¥—æ¥å­—ä¸æ˜¯å½’è¿›ç¨‹æ‰€æœ‰çš„ï¼Œè€Œæ˜¯å½’æ“ä½œç³»ç»Ÿæ‰€æœ‰ï¼Œåªæ˜¯è¿›ç¨‹æ‹¥æœ‰ä»£è¡¨ç›¸åº”å¥—æ¥å­—çš„æ–‡ä»¶æè¿°ç¬¦ã€‚
å¦‚å›¾æ‰€ç¤ºï¼Œ1 ä¸ªå¥—æ¥å­—å­˜åœ¨ 2 ä¸ªæ–‡ä»¶æè¿°ç¬¦æ—¶ï¼Œåªæœ‰ 2 ä¸ªæ–‡ä»¶æè¿°ç¬¦éƒ½ç»ˆæ­¢ï¼ˆé”€æ¯ï¼‰åï¼Œæ‰èƒ½é”€æ¯å¥—æ¥å­—ã€‚å¦‚æœç»´æŒå›¾ä¸­çš„çŠ¶æ€ï¼Œå³ä½¿å­è¿›ç¨‹é”€æ¯äº†ä¸å®¢æˆ·ç«¯è¿æ¥çš„å¥—æ¥å­—æ–‡ä»¶æè¿°ç¬¦ï¼Œä¹Ÿæ— æ³•é”€æ¯å¥—æ¥å­—ï¼ˆæœåŠ¡å™¨å¥—æ¥å­—åŒæ ·å¦‚æ­¤ï¼‰ã€‚å› æ­¤è°ƒç”¨ fork å‡½æ•°åï¼Œè¦å°†æ— å…³ç´§è¦çš„å¥—æ¥å­—æ–‡ä»¶æè¿°ç¬¦å…³æ‰ï¼Œå¦‚å›¾æ‰€ç¤ºï¼š
10.5 åˆ†å‰² TCP çš„ I/O ç¨‹åº `,url:"https://hugo-dead-simple.netlify.com/linux_tcp_program/tcpip%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/chapter_10.html"},"https://hugo-dead-simple.netlify.com/linux_tcp_program/tcpip%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/chapter_2.html":{title:"",tags:[],content:`socketç±»å‹ä¸åè®®è®¾ç½® ä¸‹æˆ‘åªä¸æˆ‘ç†è§£çš„å†…å®¹,å¦‚æœå…¨éƒ¨éƒ½å†™,é‚£ä¹ˆå°±å˜åœ¨äº†æŠ„ä¹¦äº†.
1int socket(int domain, int type, int protocol); å…¶ä¸­çš„domainå‚æ•°æŒ‡å®šåè®®æ—,å¸¸è§çš„æœ‰AF_INET, AF_INET6, AF_UNIXç­‰,åˆ†åˆ«å¯¹åº”IPv4, IPv6, Unix Domain Socket.
typeå‚æ•°æŒ‡å®šsocketç±»å‹,å¸¸è§çš„æœ‰SOCK_STREAM, SOCK_DGRAM, SOCK_RAW, SOCK_SEQPACKETç­‰,åˆ†åˆ«å¯¹åº”TCPæµå¼socket, UDPæ•°æ®æŠ¥å¼socket, åŸå§‹å¥—æ¥å­—, é¡ºåºåŒ…å¥—æ¥å­—ç­‰.
protocolå‚æ•°æŒ‡å®šåè®®,å¸¸è§çš„æœ‰IPPROTO_TCP, IPPROTO_UDP, IPPROTO_RAW, IPPROTO_SCTPç­‰,åˆ†åˆ«å¯¹åº”TCP, UDP, åŸå§‹åè®®, SCTPç­‰.
ä¸€èˆ¬æƒ…å†µä¸‹,æˆ‘ä»¬åªéœ€è¦è®¾ç½®domainå’Œtypeå‚æ•°,å› ä¸ºprotocolå‚æ•°ä¸€èˆ¬ç”±ç³»ç»Ÿè‡ªåŠ¨è®¾ç½®.
ä¾‹å¦‚,åˆ›å»ºä¸€ä¸ªTCPæµå¼socket,å¯ä»¥ä½¿ç”¨å¦‚ä¸‹ä»£ç :
è¿™ä¸ªç”¨åˆ°çš„æœ€å¤š,å…¶å®ä¹Ÿåªç”¨åˆ°è¿™ä¸ª(æˆ‘ä»¬è‡ªå·±å†™çš„ç®€å•ä»£ç ).
1int sockfd = socket(AF_INET, SOCK_STREAM, 0); åˆ›å»ºä¸€ä¸ªUDPæ•°æ®æŠ¥å¼socket,å¯ä»¥ä½¿ç”¨å¦‚ä¸‹ä»£ç :
1int sockfd = socket(AF_INET, SOCK_DGRAM, 0); åˆ›å»ºä¸€ä¸ªåŸå§‹å¥—æ¥å­—,å¯ä»¥ä½¿ç”¨å¦‚ä¸‹ä»£ç :
1int sockfd = socket(AF_INET, SOCK_RAW, IPPROTO_RAW); ä¼ è¾“çš„æ•°æ®ä¸å­˜åœ¨æ•°æ®è¾¹ç•Œ ä¹¦ä¸Šå‘Šè¯‰æˆ‘ä»¬,socketæ•°æ®çš„ä¼ è¾“æ˜¯æ— è¾¹ç•Œçš„,ä¹Ÿå°±æ˜¯è¯´,æˆ‘ä»¬å‘é€çš„æ•°æ®å¯èƒ½è¢«æ‹†åˆ†æˆå¤šä¸ªåŒ…,ä¹Ÿå¯èƒ½è¢«ç²˜åŒ…,æ¥æ”¶æ–¹ä¹Ÿå¯èƒ½ä¸€æ¬¡æ¥æ”¶å¤šä¸ªåŒ…,è¿™å–å†³äºç½‘ç»œçš„ä¼ è¾“é€Ÿç‡å’Œæ¥æ”¶æ–¹å¤„ç†èƒ½åŠ›.
è¿™é‡Œç»™å‡ºä¸€ä¸ªæˆ‘æ ¹æ®ä¹¦ä¸Šå†™çš„client.cä»£ç ,ç”¨æ¥æ¥æ”¶TCPæµå¼socketæ•°æ®:
å®ƒä¸€æ¬¡åªèƒ½è¯»å–ä¸€ä¸ªå­—èŠ‚.
1int tot = 0; 2int read_len; 3char buf[1024] 4while(1) { 5 //ä¸€æ¬¡è¯»å–ä¸€ä¸ªå­—èŠ‚ 6 read_len = read(sockfd, buf, 1); 7 if( read_len == -1) break; 8 //è¾“å‡ºè¯»å–çš„å­—ç¬¦ 9 printf(&#34;%c&#34;,buf[0]); 10 tot += read_len; 11} `,url:"https://hugo-dead-simple.netlify.com/linux_tcp_program/tcpip%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/chapter_2.html"},"https://hugo-dead-simple.netlify.com/linux_tcp_program/tcpip%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/chapter_3.html":{title:"",tags:[],content:`åœ°å€æ—ä¸æ•°æ®åºåˆ— ä¹¦ä¸Šè®²è§£äº†ä¸€äº›ipv4åœ°å€çš„æ¦‚å¿µï¼Œä»¥åŠipv6åœ°å€çš„æ¦‚å¿µã€‚
åˆè¯´äº†ä¸€äº›ç«¯å£å·çš„æ¦‚å¿µï¼Œä»¥åŠç«¯å£å·çš„ä½œç”¨ã€‚
ä½†æ˜¯è¿˜æ˜¯å¾ˆå¤æ‚çš„,ç›´æ¥ç†è§£æˆ‘ç¬¬ä¸€ç« èŠ‚è¯´çš„å†…å®¹,æ¯ä¸ªæ¦‚å¿µåªæœ‰ä¸€å¥è¯.ä½†æ˜¯è¿™æ˜¯å»ºç«‹åœ¨æˆ‘å¯¹ç½‘ç»œç¼–ç¨‹çš„äº†è§£åŸºç¡€ä¸Šçš„.
ä¸‹è®²è§£äº†
1mindmap 2 root((sockadd_in)) 3 sin_family(sin_family) 4 AF_INET(AF_INET) 5 AF_INET6(AF_INET6) 6 AF_Local(AF_Local) 7 sin_port(sin_port) 8 htons(&#34;htons(int)&#34;) 9 sin_addr(sin_addr) 10 s_addr(s_addr) 11 inet_addr(&#34;inet_addr(char*)&#34;) éœ€è¦æŠŠsockaddr_inè½¬åŒ–æˆstruct sockaddr *æ‰èƒ½ä½¿ç”¨bind()ç­‰å‡½æ•°.
ç½‘ç»œå­—èŠ‚åºä¸åœ°å€çš„è½¬æ¢ htons(int)ï¼šå°†intç±»å‹æ•´æ•°è½¬æ¢ä¸ºç½‘ç»œå­—èŠ‚åºã€‚ htonl(int)ï¼šå°†intç±»å‹æ•´æ•°è½¬æ¢ä¸ºç½‘ç»œå­—èŠ‚åºã€‚ ntohs(int)ï¼šå°†intç±»å‹æ•´æ•°è½¬æ¢ä¸ºä¸»æœºå­—èŠ‚åºã€‚ ntohl(int)ï¼šå°†intç±»å‹æ•´æ•°è½¬æ¢ä¸ºä¸»æœºå­—èŠ‚åºã€‚ inet_addr(char*)ï¼šå°†char*ç±»å‹å­—ç¬¦ä¸²è½¬æ¢ä¸ºin_addrç±»å‹ã€‚ inet_aton(char*, struct in_addr*)ï¼šå°†char*ç±»å‹å­—ç¬¦ä¸²è½¬æ¢ä¸ºin_addrç±»å‹ã€‚ inet_ntoa(struct in_addr)ï¼šå°†in_addrç±»å‹è½¬æ¢ä¸ºchar*ç±»å‹å­—ç¬¦ä¸²,å¤±è´¥è¿”å›-1 æ¯æ¬¡åˆ›å»ºæœåŠ¡å™¨ç«¯socketéƒ½è¦è¾“å…¥IPåœ°å€ä¼šæœ‰äº›ç¹ç,æ­¤æ—¶å¯ä»¥ä½¿ç”¨å¦‚ä¸‹çš„åˆå§‹åŒ–åœ°å€ä¿¡æ¯
1struct sockaddr_in server_addr; 2char * serv_port = &#34;8989&#34;; 3server_addr.sin_family = AF_INET; 4server_addr.sin_port = htons(atoi(serv_port)); 5server_addr.sin_addr.s_addr = inet_addr(INADDR_ANY); `,url:"https://hugo-dead-simple.netlify.com/linux_tcp_program/tcpip%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/chapter_3.html"},"https://hugo-dead-simple.netlify.com/linux_tcp_program/tcpip%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/chapter_4.html":{title:"",tags:[],content:`åŸºäºtcpçš„æœåŠ¡å™¨ç«¯/å®¢æˆ·ç«¯ è¯¦ç»†çš„å†…å®¹çœ‹è¿™é‡Œ,æˆ‘å°±ä¸å¤åˆ¶äº†:
https://github.com/riba2534/TCP-IP-NetworkNote/blob/master/ch04/README.md
TCP/IP åè®®æ ˆå…±åˆ†ä¸º 4 å±‚ï¼Œå¯ä»¥ç†è§£ä¸ºæ•°æ®æ”¶å‘åˆ†æˆäº† 4 ä¸ªå±‚æ¬¡åŒ–è¿‡ç¨‹ï¼Œé€šè¿‡å±‚æ¬¡åŒ–çš„æ–¹å¼æ¥è§£å†³é—®é¢˜
é“¾è·¯å±‚: ç‰©ç†å±‚,è´Ÿè´£ç½‘ç»œè®¾å¤‡ä¹‹é—´çš„é€šä¿¡ï¼Œå¦‚ç½‘å¡ã€ç½‘çº¿ç­‰ IPå±‚: æ•°æ®åŒ…è¿›è¡Œä¸­çº¿é€‰æ‹© TCP/UDPå±‚: è´Ÿè´£æ•°æ®åŒ…çš„ä¼ è¾“ï¼Œä¿è¯æ•°æ®åŒ…çš„å¯é æ€§å’Œé¡ºåºæ€§ å®ç°åŸºäº TCP çš„æœåŠ¡å™¨/å®¢æˆ·ç«¯ ä»£ç : hello_server
1{{#include ch04/hello_server.c}} ä»£ç : hello_client
1{{#include ch04/hello_client.c}} echoæœåŠ¡å™¨/å®¢æˆ·ç«¯ ç¨‹åºè¿è¡Œçš„åŸºæœ¬æ–¹å¼ï¼š
æœåŠ¡å™¨ç«¯åœ¨åŒä¸€æ—¶åˆ»åªä¸ä¸€ä¸ªå®¢æˆ·ç«¯ç›¸è¿ï¼Œå¹¶æä¾›å›å£°æœåŠ¡ã€‚ æœåŠ¡å™¨ç«¯ä¾æ¬¡å‘ 5 ä¸ªå®¢æˆ·ç«¯æä¾›æœåŠ¡å¹¶é€€å‡ºã€‚forå¾ªç¯5æ¬¡ å®¢æˆ·ç«¯æ¥å—ç”¨æˆ·è¾“å…¥çš„å­—ç¬¦ä¸²å¹¶å‘é€åˆ°æœåŠ¡å™¨ç«¯ã€‚ æœåŠ¡å™¨ç«¯å°†æ¥å—çš„å­—ç¬¦ä¸²æ•°æ®ä¼ å›å®¢æˆ·ç«¯ï¼Œå³ã€Œå›å£°ã€ æœåŠ¡å™¨ç«¯ä¸å®¢æˆ·ç«¯ä¹‹é—´çš„å­—ç¬¦ä¸²å›å£°ä¸€ç›´æ‰§è¡Œåˆ°å®¢æˆ·ç«¯è¾“å…¥ Q ä¸ºæ­¢ã€‚ 1{{#include ch04/echo_server.c}} 1{{#include ch04/echo_client.c}} FAQ é—®: æˆ‘åœ¨åœ¨linuxä¸‹ä½¿ç”¨socketè¿›è¡Œtcpç½‘ç»œç¼–ç¨‹,å¦‚æœclientç«¯è°ƒç”¨äº†close(sock)å‡½æ•°,é‚£ä¹ˆserverç«¯å£çš„readå‡½æ•°ä¼šè¯»å–åˆ°ä»€ä¹ˆ?
ç­”:
åœ¨Linuxä¸‹ä½¿ç”¨socketè¿›è¡ŒTCPç½‘ç»œç¼–ç¨‹æ—¶,å¦‚æœå®¢æˆ·ç«¯è°ƒç”¨äº†close(sock)å‡½æ•°,æœåŠ¡å™¨ç«¯çš„readå‡½æ•°çš„è¡Œä¸ºå–å†³äºå®¢æˆ·ç«¯å…³é—­è¿æ¥çš„æ–¹å¼å’Œæ—¶æœºã€‚
é€šå¸¸æƒ…å†µä¸‹,å½“å®¢æˆ·ç«¯è°ƒç”¨close(sock)å‡½æ•°æ—¶,ä¼šå‘æœåŠ¡å™¨å‘é€ä¸€ä¸ªFINåŒ…,è¡¨ç¤ºå®¢æˆ·ç«¯æƒ³è¦å…³é—­è¿æ¥ã€‚æœåŠ¡å™¨æ”¶åˆ°FINåŒ…å,ä¼šåšå‡ºä»¥ä¸‹å“åº”:
å¦‚æœæœåŠ¡å™¨å·²ç»è¯»å–äº†æ‰€æœ‰å®¢æˆ·ç«¯å‘é€çš„æ•°æ®,é‚£ä¹ˆreadå‡½æ•°ä¼šè¿”å›0,è¡¨ç¤ºå·²ç»åˆ°è¾¾æ–‡ä»¶æœ«å°¾(EOF)ã€‚è¿™æ„å‘³ç€å®¢æˆ·ç«¯å·²ç»å…³é—­äº†è¿æ¥,å¹¶ä¸”æ²¡æœ‰æ›´å¤šçš„æ•°æ®å¯è¯»ã€‚
å¦‚æœæœåŠ¡å™¨è¿˜æ²¡æœ‰è¯»å–å®Œå®¢æˆ·ç«¯å‘é€çš„æ‰€æœ‰æ•°æ®,é‚£ä¹ˆreadå‡½æ•°ä¼šç»§ç»­è¯»å–å‰©ä½™çš„æ•°æ®,ç›´åˆ°è¯»å–å®Œæ‰€æœ‰æ•°æ®æˆ–è€…é‡åˆ°é”™è¯¯ä¸ºæ­¢ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹,readå‡½æ•°ä¼šè¿”å›å®é™…è¯»å–åˆ°çš„å­—èŠ‚æ•°ã€‚å½“æ‰€æœ‰æ•°æ®è¯»å–å®Œæ¯•å,å†æ¬¡è°ƒç”¨readå‡½æ•°ä¼šè¿”å›0,è¡¨ç¤ºå·²ç»åˆ°è¾¾æ–‡ä»¶æœ«å°¾(EOF)ã€‚
å¦‚æœå®¢æˆ·ç«¯åœ¨å‘é€æ•°æ®çš„è¿‡ç¨‹ä¸­çªç„¶å…³é—­äº†è¿æ¥,é‚£ä¹ˆæœåŠ¡å™¨çš„readå‡½æ•°å¯èƒ½ä¼šè¿”å›ä¸€ä¸ªé”™è¯¯,é€šå¸¸æ˜¯ECONNRESETé”™è¯¯,è¡¨ç¤ºè¿æ¥è¢«é‡ç½®ã€‚
éœ€è¦æ³¨æ„çš„æ˜¯,å¦‚æœå®¢æˆ·ç«¯åœ¨å…³é—­è¿æ¥ä¹‹å‰æ²¡æœ‰å‘é€æ‰€æœ‰çš„æ•°æ®,é‚£ä¹ˆæœåŠ¡å™¨å¯èƒ½ä¼šä¸¢å¤±ä¸€éƒ¨åˆ†æ•°æ®ã€‚ä¸ºäº†ç¡®ä¿æ•°æ®çš„å®Œæ•´æ€§,é€šå¸¸å»ºè®®åœ¨å…³é—­è¿æ¥ä¹‹å‰,å…ˆè°ƒç”¨shutdown(sock, SHUT_WR)å‡½æ•°,å‘Šè¯‰æ“ä½œç³»ç»Ÿä¸å†å‘é€æ•°æ®,ç„¶åå†è°ƒç”¨close(sock)å‡½æ•°å…³é—­è¿æ¥ã€‚
æ€»ä¹‹,æœåŠ¡å™¨ç«¯çš„readå‡½æ•°åœ¨å®¢æˆ·ç«¯å…³é—­è¿æ¥æ—¶çš„è¡Œä¸ºå–å†³äºå…·ä½“çš„æƒ…å†µ:
å¦‚æœå®¢æˆ·ç«¯å‘é€äº†æ‰€æœ‰æ•°æ®å¹¶å…³é—­è¿æ¥,readå‡½æ•°ä¼šè¿”å›0,è¡¨ç¤ºEOFã€‚ å¦‚æœå®¢æˆ·ç«¯å…³é—­è¿æ¥æ—¶è¿˜æœ‰æœªè¯»å–çš„æ•°æ®,readå‡½æ•°ä¼šç»§ç»­è¯»å–å‰©ä½™æ•°æ®,ç›´åˆ°è¯»å–å®Œæ¯•,ç„¶åè¿”å›0,è¡¨ç¤ºEOFã€‚ å¦‚æœå®¢æˆ·ç«¯å¼‚å¸¸å…³é—­è¿æ¥,readå‡½æ•°å¯èƒ½ä¼šè¿”å›é”™è¯¯,å¦‚ECONNRESETã€‚ ä½œä¸ºæœåŠ¡å™¨ç«¯,éœ€è¦æ­£ç¡®å¤„ç†è¿™äº›ä¸åŒçš„æƒ…å†µ,ä»¥ç¡®ä¿ç¨‹åºçš„æ­£ç¡®æ€§å’Œé²æ£’æ€§ã€‚
é—®: å¦‚ä½•æ£€æµ‹åˆ° readå‡½æ•°è¿”å›ä¸€ä¸ªé”™è¯¯, ä¾‹å¦‚æ˜¯ECONNRESET?
åœ¨Linuxç³»ç»Ÿä¸­,å½“readå‡½æ•°è¿”å›é”™è¯¯æ—¶,ä¼šè®¾ç½®å…¨å±€å˜é‡errnoæ¥æŒ‡ç¤ºå…·ä½“çš„é”™è¯¯ç±»å‹ã€‚ä½ å¯ä»¥é€šè¿‡æ£€æŸ¥errnoçš„å€¼æ¥åˆ¤æ–­æ˜¯å¦å‘ç”Ÿäº†ECONNRESETé”™è¯¯ã€‚
ä¸‹é¢æ˜¯ä¸€ä¸ªç¤ºä¾‹ä»£ç ,æ¼”ç¤ºäº†å¦‚ä½•æ£€æµ‹readå‡½æ•°è¿”å›çš„é”™è¯¯:
1#include &lt;stdio.h&gt; 2#include &lt;stdlib.h&gt; 3#include &lt;unistd.h&gt; 4#include &lt;errno.h&gt; 5#include &lt;string.h&gt; 6 7ssize_t read_data(int sockfd, void *buf, size_t len) { 8 ssize_t num_read = read(sockfd, buf, len); 9 if (num_read == -1) { 10 if (errno == ECONNRESET) { 11 printf(&#34;Connection reset by peer\\n&#34;); 12 } else { 13 perror(&#34;read&#34;); 14 } 15 return -1; 16 } 17 return num_read; 18} åœ¨ä¸Šé¢çš„ä»£ç ä¸­,read_dataå‡½æ•°å°è£…äº†readå‡½æ•°çš„è°ƒç”¨ã€‚å®ƒæ£€æŸ¥readå‡½æ•°çš„è¿”å›å€¼:
å¦‚æœè¿”å›å€¼ä¸º-1,è¡¨ç¤ºå‘ç”Ÿäº†é”™è¯¯ã€‚æ­¤æ—¶,é€šè¿‡æ£€æŸ¥errnoçš„å€¼æ¥åˆ¤æ–­å…·ä½“çš„é”™è¯¯ç±»å‹: å¦‚æœerrnoçš„å€¼ç­‰äºECONNRESET,è¡¨ç¤ºè¿æ¥è¢«å¯¹ç«¯é‡ç½®,å¯ä»¥è¾“å‡ºç›¸åº”çš„é”™è¯¯ä¿¡æ¯ã€‚ å¦åˆ™,å¯ä»¥ä½¿ç”¨perrorå‡½æ•°è¾“å‡ºé”™è¯¯ä¿¡æ¯,perrorå‡½æ•°ä¼šæ ¹æ®errnoçš„å€¼è‡ªåŠ¨ç”Ÿæˆå¯¹åº”çš„é”™è¯¯æè¿°ã€‚ å¦‚æœè¿”å›å€¼ä¸ä¸º-1,è¡¨ç¤ºè¯»å–æˆåŠŸ,å‡½æ•°è¿”å›å®é™…è¯»å–åˆ°çš„å­—èŠ‚æ•°ã€‚ åœ¨å®é™…ä½¿ç”¨æ—¶,ä½ å¯ä»¥æ ¹æ®éœ€è¦å¯¹read_dataå‡½æ•°è¿›è¡Œè°ƒç”¨,å¹¶æ ¹æ®è¿”å›å€¼è¿›è¡Œç›¸åº”çš„å¤„ç†:
1char buffer[1024]; 2ssize_t num_read = read_data(sockfd, buffer, sizeof(buffer)); 3if (num_read == -1) { 4 // å¤„ç†é”™è¯¯æƒ…å†µ 5} else if (num_read == 0) { 6 // å¤„ç†è¿æ¥å…³é—­çš„æƒ…å†µ 7} else { 8 // å¤„ç†æˆåŠŸè¯»å–æ•°æ®çš„æƒ…å†µ 9} é€šè¿‡æ£€æŸ¥read_dataå‡½æ•°çš„è¿”å›å€¼,ä½ å¯ä»¥åˆ¤æ–­æ˜¯å¦å‘ç”Ÿäº†é”™è¯¯,å¹¶æ ¹æ®å…·ä½“çš„é”™è¯¯ç±»å‹é‡‡å–ç›¸åº”çš„å¤„ç†æªæ–½ã€‚
æ€»ä¹‹,é€šè¿‡æ£€æŸ¥readå‡½æ•°çš„è¿”å›å€¼å’Œerrnoçš„å€¼,ä½ å¯ä»¥æ£€æµ‹å¹¶å¤„ç†readå‡½æ•°è¿”å›çš„é”™è¯¯,åŒ…æ‹¬ECONNRESETé”™è¯¯ã€‚è¿™æ ·å¯ä»¥å¢å¼ºç¨‹åºçš„å¥å£®æ€§å’Œå¯é æ€§ã€‚
`,url:"https://hugo-dead-simple.netlify.com/linux_tcp_program/tcpip%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/chapter_4.html"},"https://hugo-dead-simple.netlify.com/linux_tcp_program/tcpip%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/chapter_5.html":{title:"",tags:[],content:`åŸºäºtcpçš„æœåŠ¡å™¨ç«¯/å®¢æˆ·ç«¯(2) æœ¬ç« èŠ‚è¯¦ç»†çš„è®²è§£äº†TCP ä¸­å¿…è¦çš„ç†è®ºçŸ¥è¯†
å›å£°å®¢æˆ·ç«¯é—®é¢˜çš„è§£å†³åŠæ³• è¿™ä¸ªé—®é¢˜å…¶å®å¾ˆå®¹æ˜“è§£å†³ï¼Œå› ä¸ºå¯ä»¥æå‰æ¥å—æ•°æ®çš„å¤§å°ã€‚è‹¥ä¹‹å‰ä¼ è¾“äº†20å­—èŠ‚é•¿çš„å­—ç¬¦ä¸²ï¼Œåˆ™å†æ¥æ”¶æ—¶å¾ªç¯è°ƒç”¨ read å‡½æ•°è¯»å– 20 ä¸ªå­—èŠ‚å³å¯ã€‚æ—¢ç„¶æœ‰äº†è§£å†³åŠæ³•ï¼Œæ ¸å¿ƒé‚£ä¹ˆä»£ç å¦‚ä¸‹ï¼š
1 2//å¾—åˆ°å‘é€çš„æ•°æ®å¤§å° 3str_len = write(sockfd,message,sizeof(message)); 4int recv_len = 0; 5while( recv_len &lt; str_len ) { 6 int recv_cnt += read(sockfd,recv_buf,str_len-recv_len); 7 //å¯¹æ–¹å…³é—­äº†è¿æ¥ 8 if( recv_cnt == 0 ) { 9 break; 10 } 11 if( recv_cnt &lt; 0 ) { 12 error_handing(&#34;read error&#34;)! 13 } 14 recv_len += recv_cnt; 15} 16message[recv_len] = &#39;\\0&#39;; 17printf(&#34;Received message: %s\\n&#34;,message); TCP åŸç† TCP socketä¸­çš„I/Oç¼“å†²
IOç¼“å†²åœ¨æ¯ä¸ªTCP socketä¸­å•ç‹¬å­˜åœ¨.
IOç¼“å†²åœ¨åœ¨åˆ›å»ºTCP socketè‡ªåŠ¨ç”Ÿæˆ.
å³ä½¿å…³é—­socket ä¹Ÿä¼šç»§ç»­ä¼ é€’è¾“å‡ºç¼“å†²ä¸­é—ç•™çš„æ•°æ®.
å…³é—­socketä¼šä¸¢å¤±è¾“å…¥ç¼“å†²ä¸­çš„æ•°æ®.
ä¸ä¼šå‘ç”Ÿè¶…è¿‡è¾“å…¥ç¼“å†²å¤§å°çš„æ•°æ®ä¼ è¾“!
writeå‡½æ•°ä¼šåœ¨æ•°æ®ç§»åˆ°è¾“å‡ºç¼“å†²æ—¶è¿”å›.
1. TCPè¿æ¥ 3æ¬¡æ¡æ‰‹(three-way handshaking)
1[SYN] SEQ:1000 ACK:NULL 2[SYN+ACK] SEQ: 2000, ACK: 1001 3[ACK] SEQ: 1001, ACK: 2001 2. TCPä¼ è¾“ 3. TCPæ–­å¼€ `,url:"https://hugo-dead-simple.netlify.com/linux_tcp_program/tcpip%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/chapter_5.html"},"https://hugo-dead-simple.netlify.com/linux_tcp_program/tcpip%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/chapter_7.html":{title:"",tags:[],content:`1 å•æ–¹é¢æ–­å¼€è¿æ¥å¸¦æ¥çš„é—®é¢˜ ä¸»æœº A å‘é€å®Œæœ€åçš„æ•°æ®åï¼Œè°ƒç”¨ close å‡½æ•°æ–­å¼€äº†æœ€åçš„è¿æ¥ï¼Œä¹‹åä¸»æœº A æ— æ³•å†æ¥å—ä¸»æœº B ä¼ è¾“çš„æ•°æ®ã€‚å®é™…ä¸Šï¼Œæ˜¯å®Œå…¨æ— æ³•è°ƒç”¨ä¸æ¥å—æ•°æ®ç›¸å…³çš„å‡½æ•°ã€‚æœ€ç»ˆï¼Œç”±ä¸»æœº B ä¼ è¾“çš„ã€ä¸»æœº A å¿…é¡»è¦æ¥å—çš„æ•°æ®ä¹Ÿé”€æ¯äº†ã€‚
2. shutdownå‡½æ•°çš„ä½œç”¨ 1#include &lt;sys/socket.h&gt; 2int shutdown(int sock, int howto); 3/* 4æˆåŠŸæ—¶è¿”å› 0 ï¼Œå¤±è´¥æ—¶è¿”å› -1 5sock: éœ€è¦æ–­å¼€å¥—æ¥å­—æ–‡ä»¶æè¿°ç¬¦ 6howto: ä¼ é€’æ–­å¼€æ–¹å¼ä¿¡æ¯ 7*/ è°ƒç”¨ä¸Šè¿°å‡½æ•°æ—¶ï¼Œç¬¬äºŒä¸ªå‚æ•°å†³å®šæ–­å¼€è¿æ¥çš„æ–¹å¼ï¼Œå…¶å€¼å¦‚ä¸‹æ‰€ç¤ºï¼š
SHUT_RD : æ–­å¼€è¾“å…¥æµ SHUT_WR : æ–­å¼€è¾“å‡ºæµ SHUT_RDWR : åŒæ—¶æ–­å¼€ I/O æµ è‹¥å‘ shutdown çš„ç¬¬äºŒä¸ªå‚æ•°ä¼ é€’SHUT_RDï¼Œåˆ™æ–­å¼€è¾“å…¥æµï¼Œå¥—æ¥å­—æ— æ³•æ¥æ”¶æ•°æ®ã€‚å³ä½¿è¾“å…¥ç¼“å†²æ”¶åˆ°æ•°æ®ä¹Ÿä¼šæŠ¹å»ï¼Œè€Œä¸”æ— æ³•è°ƒç”¨ç›¸å…³å‡½æ•°ã€‚å¦‚æœå‘ shutdown çš„ç¬¬äºŒä¸ªå‚æ•°ä¼ é€’SHUT_WRï¼Œåˆ™ä¸­æ–­è¾“å‡ºæµï¼Œä¹Ÿå°±æ— æ³•ä¼ è¾“æ•°æ®ã€‚è‹¥å¦‚æœè¾“å‡ºç¼“å†²ä¸­è¿˜æœ‰æœªä¼ è¾“çš„æ•°æ®ï¼Œåˆ™å°†ä¼ é€’ç»™ç›®æ ‡ä¸»æœºã€‚æœ€åï¼Œè‹¥ä¼ é€’å…³é”®å­—SHUT_RDWRï¼Œåˆ™åŒæ—¶ä¸­æ–­ I/O æµã€‚è¿™ç›¸å½“äºåˆ† 2 æ¬¡è°ƒç”¨ shutdown ï¼Œå…¶ä¸­ä¸€æ¬¡ä»¥SHUT_RDä¸ºå‚æ•°ï¼Œå¦ä¸€æ¬¡ä»¥SHUT_WRä¸ºå‚æ•°
3. ä¸ºä»€ä¹ˆè¦åŠå…³é—­è¿æ¥ ç•™ä¸‹è¶³å¤Ÿçš„æ—¶é—´,ç­‰æ‰€æœ‰çš„æ•°æ®äº¤æ¢å®Œä¸å°±è¡Œäº†,å¥½åƒä¹Ÿæ²¡æœ‰å¿…è¦ä½¿ç”¨åŠå…³é—­.
è€ƒè™‘ä»¥ä¸‹æƒ…å†µï¼š
ä¸€æ—¦å®¢æˆ·ç«¯è¿æ¥åˆ°æœåŠ¡å™¨ï¼ŒæœåŠ¡å™¨å°†çº¦å®šçš„æ–‡ä»¶ä¼ è¾“ç»™å®¢æˆ·ç«¯ï¼Œå®¢æˆ·ç«¯æ”¶åˆ°åå‘é€å­—ç¬¦ä¸²ã€ŒThank youã€ç»™æœåŠ¡å™¨ç«¯ã€‚
æ­¤å¤„ã€ŒThank youã€çš„ä¼ é€’æ˜¯å¤šä½™çš„ï¼Œè¿™åªæ˜¯ç”¨æ¥æ¨¡æ‹Ÿå®¢æˆ·ç«¯æ–­å¼€è¿æ¥å‰è¿˜æœ‰æ•°æ®è¦ä¼ è¾“çš„æƒ…å†µã€‚æ­¤æ—¶ç¨‹åºçš„è¿˜å«Œéš¾åº¦å¹¶ä¸å°ï¼Œå› ä¸ºä¼ è¾“æ–‡ä»¶çš„æœåŠ¡å™¨ç«¯åªéœ€è¿ç»­ä¼ è¾“æ–‡ä»¶æ•°æ®å³å¯ï¼Œè€Œå®¢æˆ·ç«¯æ— æ³•çŸ¥é“éœ€è¦æ¥æ”¶æ•°æ®åˆ°ä½•æ—¶ã€‚å®¢æˆ·ç«¯ä¹Ÿæ²¡åŠæ³•æ— ä¼‘æ­¢çš„è°ƒç”¨è¾“å…¥å‡½æ•°ï¼Œå› ä¸ºè¿™æœ‰å¯èƒ½å¯¼è‡´ç¨‹åºé˜»å¡ã€‚
æ˜¯å¦å¯ä»¥è®©æœåŠ¡å™¨å’Œå®¢æˆ·ç«¯çº¦å®šä¸€ä¸ªä»£è¡¨æ–‡ä»¶å°¾çš„å­—ç¬¦ï¼Ÿ
è¿™ç§æ–¹å¼ä¹Ÿæœ‰é—®é¢˜ï¼Œå› ä¸ºè¿™æ„å‘³è¿™æ–‡ä»¶ä¸­ä¸èƒ½æœ‰ä¸çº¦å®šå­—ç¬¦ç›¸åŒçš„å†…å®¹ã€‚ä¸ºäº†è§£å†³è¯¥é—®é¢˜ï¼ŒæœåŠ¡ç«¯åº”æœ€åå‘å®¢æˆ·ç«¯ä¼ é€’ EOF è¡¨ç¤ºæ–‡ä»¶ä¼ è¾“ç»“æŸã€‚å®¢æˆ·ç«¯é€šè¿‡å‡½æ•°è¿”å›å€¼æ¥å— EOF ï¼Œè¿™æ ·å¯ä»¥é¿å…ä¸æ–‡ä»¶å†…å®¹å†²çªã€‚é‚£ä¹ˆé—®é¢˜æ¥äº†ï¼ŒæœåŠ¡ç«¯å¦‚ä½•ä¼ é€’ EOF ï¼Ÿ
æ–­å¼€è¾“å‡ºæµæ—¶å‘ä¸»æœºä¼ è¾“ EOFã€‚
å½“ç„¶ï¼Œè°ƒç”¨ close å‡½æ•°çš„åŒæ—¶å…³é—­ I/O æµï¼Œè¿™æ ·ä¹Ÿä¼šå‘å¯¹æ–¹å‘é€ EOF ã€‚ä½†æ­¤æ—¶æ— æ³•å†æ¥å—å¯¹æ–¹ä¼ è¾“çš„æ•°æ®ã€‚æ¢è¨€ä¹‹ï¼Œè‹¥è°ƒç”¨ close å‡½æ•°å…³é—­æµï¼Œå°±æ— æ³•æ¥å—å®¢æˆ·ç«¯æœ€åå‘é€çš„å­—ç¬¦ä¸²ã€ŒThank youã€ã€‚è¿™æ—¶éœ€è¦è°ƒç”¨ shutdown å‡½æ•°ï¼Œåªå…³é—­æœåŠ¡å™¨çš„è¾“å‡ºæµã€‚è¿™æ ·æ—¢å¯ä»¥å‘é€ EOF ï¼ŒåŒæ—¶åˆä¿ç•™äº†è¾“å…¥æµã€‚ä¸‹é¢å®ç°æ”¶å‘æ–‡ä»¶çš„æœåŠ¡å™¨ç«¯/å®¢æˆ·ç«¯ã€‚
4. åŸºäºåŠå…³é—­çš„æ–‡ä»¶ä¼ è¾“ç¨‹åº serverä»£ç 
1{{#include chapter_7/file_server.c}} clientä»£ç 
1{{#include chapter_7/file_client.c}} `,url:"https://hugo-dead-simple.netlify.com/linux_tcp_program/tcpip%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/chapter_7.html"},"https://hugo-dead-simple.netlify.com/linux_tcp_program/tcpip%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/chapter_8.html":{title:"",tags:[],content:`ç¬¬ 8 ç«  åŸŸååŠç½‘ç»œåœ°å€ æœ¬ç« ä»£ç ï¼Œåœ¨TCP-IP-NetworkNoteä¸­å¯ä»¥æ‰¾åˆ°ã€‚
8.1 åŸŸåç³»ç»Ÿ DNS æ˜¯å¯¹IPåœ°å€å’ŒåŸŸåè¿›è¡Œç›¸äº’è½¬æ¢çš„ç³»ç»Ÿï¼Œå…¶æ ¸å¿ƒæ˜¯ DNS æœåŠ¡å™¨
8.1.1 ä»€ä¹ˆæ˜¯åŸŸå åŸŸåå°±æ˜¯æˆ‘ä»¬å¸¸å¸¸åœ¨åœ°å€æ é‡Œé¢è¾“å…¥çš„åœ°å€ï¼Œå°†æ¯”è¾ƒéš¾è®°å¿†çš„IPåœ°å€å˜æˆäººç±»å®¹æ˜“ç†è§£çš„ä¿¡æ¯ã€‚
8.1.2 DNS æœåŠ¡å™¨ ç›¸å½“äºä¸€ä¸ªå­—å…¸ï¼Œå¯ä»¥æŸ¥è¯¢å‡ºæŸä¸€ä¸ªåŸŸåå¯¹åº”çš„IPåœ°å€
å¦‚å›¾æ‰€ç¤ºï¼Œæ˜¾ç¤ºäº† DNS æœåŠ¡å™¨çš„æŸ¥è¯¢è·¯å¾„ã€‚
8.2 IPåœ°å€å’ŒåŸŸåä¹‹é—´çš„è½¬æ¢ 8.2.1 ç¨‹åºä¸­æœ‰å¿…è¦ä½¿ç”¨åŸŸåå—ï¼Ÿ ä¸€å¥è¯ï¼Œéœ€è¦ï¼Œå› ä¸ºIPåœ°å€å¯èƒ½ç»å¸¸æ”¹å˜ï¼Œè€Œä¸”ä¹Ÿä¸å®¹æ˜“è®°å¿†ï¼Œé€šè¿‡åŸŸåå¯ä»¥éšæ—¶æ›´æ”¹è§£æï¼Œè¾¾åˆ°æ›´æ¢IPçš„ç›®çš„
8.2.2 åˆ©ç”¨åŸŸåè·å–IPåœ°å€ ä½¿ç”¨ä»¥ä¸‹å‡½æ•°å¯ä»¥é€šè¿‡ä¼ é€’å­—ç¬¦ä¸²æ ¼å¼çš„åŸŸåè·å–IPåœ°å€
1#include &lt;netdb.h&gt; 2struct hostent *gethostbyname(const char *hostname); 3/* 4æˆåŠŸæ—¶è¿”å› hostent ç»“æ„ä½“åœ°å€ï¼Œå¤±è´¥æ—¶è¿”å› NULL æŒ‡é’ˆ 5*/ è¿™ä¸ªå‡½æ•°ä½¿ç”¨æ–¹ä¾¿ï¼Œåªè¦ä¼ é€’å­—ç¬¦ä¸²ï¼Œå°±å¯ä»¥è¿”å›åŸŸåå¯¹åº”çš„IPåœ°å€ã€‚åªæ˜¯è¿”å›æ—¶ï¼Œåœ°å€ä¿¡æ¯è£…å…¥ hostent ç»“æ„ä½“ã€‚æ­¤ç»“æ„ä½“çš„å®šä¹‰å¦‚ä¸‹ï¼š
1struct hostent 2{ 3 char *h_name; /* Official name of host. */ 4 char **h_aliases; /* Alias list. */ 5 int h_addrtype; /* Host address type. */ 6 int h_length; /* Length of address. */ 7 char **h_addr_list; /* List of addresses from name server. */ 8}; ä»ä¸Šè¿°ç»“æ„ä½“å¯ä»¥çœ‹å‡ºï¼Œä¸æ­¢è¿”å›IPä¿¡æ¯ï¼ŒåŒäº‹è¿˜å¸¦ç€å…¶ä»–ä¿¡æ¯ä¸€èµ·è¿”å›ã€‚åŸŸåè½¬æ¢æˆIPæ—¶åªéœ€è¦å…³æ³¨ h_addr_list ã€‚ä¸‹é¢ç®€è¦è¯´æ˜ä¸Šè¿°ç»“æ„ä½“çš„æˆå‘˜ï¼š
h_nameï¼šè¯¥å˜é‡ä¸­å­˜æœ‰å®˜æ–¹åŸŸåï¼ˆOfficial domain nameï¼‰ã€‚å®˜æ–¹åŸŸåä»£è¡¨æŸä¸€ä¸»é¡µï¼Œä½†å®é™…ä¸Šï¼Œä¸€äº›è‘—åå…¬å¸çš„åŸŸåå¹¶æ²¡æœ‰ç”¨å®˜æ–¹åŸŸåæ³¨å†Œã€‚ h_aliasesï¼šå¯ä»¥é€šè¿‡å¤šä¸ªåŸŸåè®¿é—®åŒä¸€ä¸»é¡µã€‚åŒä¸€IPå¯ä»¥ç»‘å®šå¤šä¸ªåŸŸåï¼Œå› æ­¤ï¼Œé™¤å®˜æ–¹åŸŸåå¤–è¿˜å¯ä»¥æŒ‡å®šå…¶ä»–åŸŸåã€‚è¿™äº›ä¿¡æ¯å¯ä»¥é€šè¿‡ h_aliases è·å¾—ã€‚ h_addrtypeï¼šgethostbyname å‡½æ•°ä¸ä»…æ”¯æŒ IPV4 è¿˜æ”¯æŒ IPV6 ã€‚å› æ­¤å¯ä»¥é€šè¿‡æ­¤å˜é‡è·å–ä¿å­˜åœ¨ h_addr_list çš„IPåœ°å€æ—ä¿¡æ¯ã€‚è‹¥æ˜¯ IPV4 ï¼Œåˆ™æ­¤å˜é‡ä¸­å­˜æœ‰ AF_INETã€‚ h_lengthï¼šä¿å­˜IPåœ°å€é•¿åº¦ã€‚è‹¥æ˜¯ IPV4 åœ°å€ï¼Œå› ä¸ºæ˜¯ 4 ä¸ªå­—èŠ‚ï¼Œåˆ™ä¿å­˜4ï¼›IPV6 æ—¶ï¼Œå› ä¸ºæ˜¯ 16 ä¸ªå­—èŠ‚ï¼Œæ•…ä¿å­˜ 16 h_addr_listï¼šè¿™ä¸ªæ˜¯æœ€é‡è¦çš„çš„æˆå‘˜ã€‚é€šè¿‡æ­¤å˜é‡ä»¥æ•´æ•°å½¢å¼ä¿å­˜åŸŸåç›¸å¯¹åº”çš„IPåœ°å€ã€‚å¦å¤–ï¼Œç”¨æˆ·æ¯”è¾ƒå¤šçš„ç½‘ç«™æœ‰å¯èƒ½åˆ†é…å¤šä¸ªIPåœ°å€ç»™åŒä¸€ä¸ªåŸŸåï¼Œåˆ©ç”¨å¤šä¸ªæœåŠ¡å™¨åšè´Ÿè½½å‡è¡¡ï¼Œã€‚æ­¤æ—¶å¯ä»¥é€šè¿‡æ­¤å˜é‡è·å–IPåœ°å€ä¿¡æ¯ã€‚ è°ƒç”¨ gethostbyname å‡½æ•°åï¼Œè¿”å›çš„ç»“æ„ä½“å˜é‡å¦‚å›¾æ‰€ç¤ºï¼š
ä¸‹é¢çš„ä»£ç é€šè¿‡ä¸€ä¸ªä¾‹å­æ¥æ¼”ç¤º gethostbyname çš„åº”ç”¨ï¼Œå¹¶è¯´æ˜ hostent ç»“æ„ä½“å˜é‡ç‰¹æ€§ã€‚
gethostbyname.c ç¼–è¯‘è¿è¡Œï¼š
1gcc gethostbyname.c -o hostname 2./hostname www.baidu.com ç»“æœï¼š
å¦‚å›¾æ‰€ç¤ºï¼Œæ˜¾ç¤ºå‡ºäº†å¯¹ç™¾åº¦çš„åŸŸåè§£æ
å¯ä»¥çœ‹å‡ºï¼Œç™¾åº¦æœ‰ä¸€ä¸ªåŸŸåè§£ææ˜¯ CNAME è§£æçš„ï¼ŒæŒ‡å‘äº†shifen.comï¼Œå…³äºç™¾åº¦å…·ä½“çš„è§£æè¿‡ç¨‹ã€‚
è¿™ä¸€éƒ¨åˆ†ç‰µæ‰¯åˆ°äº†å¾ˆå¤šå…³äºDNSè§£æçš„è¿‡ç¨‹ï¼Œè¿˜æœ‰ Linux ä¸‹å…³äºåŸŸåè§£æçš„ä¸€äº›å‘½ä»¤ï¼Œæˆ‘æ‰¾äº†ä¸€éƒ¨åˆ†èµ„æ–™ï¼Œå¯ä»¥ç‚¹ä¸‹é¢çš„é“¾æ¥æŸ¥çœ‹æ¯”è¾ƒè¯¦ç»†çš„ï¼š
å…³äºç™¾åº¦DNSçš„è§£æè¿‡ç¨‹ DNSè§£æçš„è¿‡ç¨‹æ˜¯ä»€ä¹ˆï¼Œæ±‚è¯¦ç»†çš„ï¼Ÿ Linux DNS æŸ¥è¯¢å‰–æ Linux DNSæŸ¥è¯¢å‘½ä»¤ Linuxä¸­DNSæœåŠ¡å™¨åœ°å€æŸ¥è¯¢å‘½ä»¤nslookupä½¿ç”¨æ•™ç¨‹ DNS åŸç†å…¥é—¨ ä»”ç»†é˜…è¯»è¿™ä¸€æ®µä»£ç ï¼š
1inet_ntoa(*(struct in_addr *)host-&gt;h_addr_list[i]) è‹¥åªçœ‹ hostent çš„å®šä¹‰ï¼Œç»“æ„ä½“æˆå‘˜ h_addr_list æŒ‡å‘å­—ç¬¦ä¸²æŒ‡é’ˆæ•°ç»„ï¼ˆç”±å¤šä¸ªå­—ç¬¦ä¸²åœ°å€æ„æˆçš„æ•°ç»„ï¼‰ã€‚ä½†æ˜¯å­—ç¬¦ä¸²æŒ‡é’ˆæ•°ç»„ä¿å­˜çš„å…ƒç´ å®é™…æŒ‡å‘çš„æ˜¯ in_addr ç»“æ„ä½“å˜é‡ä¸­åœ°å€å€¼è€Œéå­—ç¬¦ä¸²ï¼Œä¹Ÿå°±æ˜¯è¯´(struct in_addr *)host-&gt;h_addr_list[i]å…¶å®æ˜¯ä¸€ä¸ªæŒ‡é’ˆï¼Œç„¶åç”¨*ç¬¦å·å–å…·ä½“çš„å€¼ã€‚å¦‚å›¾æ‰€ç¤ºï¼š
8.2.3 åˆ©ç”¨IPåœ°å€è·å–åŸŸå è¯·çœ‹ä¸‹é¢çš„å‡½æ•°å®šä¹‰ï¼š
1#include &lt;netdb.h&gt; 2struct hostent *gethostbyaddr(const char *addr, socklen_t len, int family); 3/* 4æˆåŠŸæ—¶è¿”å› hostent ç»“æ„ä½“å˜é‡åœ°å€å€¼ï¼Œå¤±è´¥æ—¶è¿”å› NULL æŒ‡é’ˆ 5addr: å«æœ‰IPåœ°å€ä¿¡æ¯çš„ in_addr ç»“æ„ä½“æŒ‡é’ˆã€‚ä¸ºäº†åŒæ—¶ä¼ é€’ IPV4 åœ°å€ä¹‹å¤–çš„å…¨éƒ¨ä¿¡æ¯ï¼Œè¯¥å˜é‡çš„ç±»å‹å£°æ˜ä¸º char æŒ‡é’ˆ 6len: å‘ç¬¬ä¸€ä¸ªå‚æ•°ä¼ é€’çš„åœ°å€ä¿¡æ¯çš„å­—èŠ‚æ•°ï¼ŒIPV4æ—¶ä¸º 4 ï¼ŒIPV6 æ—¶ä¸º16. 7family: ä¼ é€’åœ°å€æ—ä¿¡æ¯ï¼Œipv4 æ˜¯ AF_INET ï¼ŒIPV6æ˜¯ AF_INET6 8*/ ä¸‹é¢çš„ä»£ç æ¼”ç¤ºä½¿ç”¨æ–¹æ³•ï¼š
gethostbyaddr.c ç¼–è¯‘è¿è¡Œï¼š
1gcc gethostbyaddr.c -o hostaddr 2./hostaddr 8.8.8.8 ç»“æœï¼š
ä»å›¾ä¸Šå¯ä»¥çœ‹å‡ºï¼Œ8.8.8.8è¿™ä¸ªIPåœ°å€æ˜¯è°·æ­Œçš„ã€‚
8.3 åŸºäº Windows çš„å®ç° æš‚ç•¥
8.4 ä¹ é¢˜ ä»¥ä¸‹ç­”æ¡ˆä»…ä»£è¡¨æœ¬äººä¸ªäººè§‚ç‚¹ï¼Œå¯èƒ½ä¸æ˜¯æ­£ç¡®ç­”æ¡ˆã€‚
ä¸‹åˆ—å…³äºDNSçš„è¯´æ³•é”™è¯¯çš„æ˜¯ï¼Ÿ
ç­”ï¼šå­—ä½“åŠ ç²—çš„è¡¨ç¤ºæ­£ç¡®ç­”æ¡ˆã€‚
å› ä¸ºDNSä»å­˜åœ¨ï¼Œæ•…å¯ä»¥ä½¿ç”¨åŸŸåä»£æ›¿IP DNSæœåŠ¡å™¨å®é™…ä¸Šæ˜¯è·¯ç”±å™¨ï¼Œå› ä¸ºè·¯ç”±å™¨æ ¹æ®åŸŸåå†³å®šæ•°æ®çš„è·¯å¾„ æ‰€æœ‰åŸŸåä¿¡æ¯å¹¶éé›†ä¸­ä¸ 1 å° DNS æœåŠ¡å™¨ï¼Œä½†å¯ä»¥è·å–æŸä¸€ DNS æœåŠ¡å™¨ä¸­æœªæ³¨å†Œçš„æ‰€æœ‰åœ°å€ DNS æœåŠ¡å™¨æ ¹æ®æ“ä½œç³»ç»Ÿè¿›è¡ŒåŒºåˆ†ï¼ŒWindows ä¸‹çš„ DNS æœåŠ¡å™¨å’Œ Linux ä¸‹çš„ DNS æœåŠ¡å™¨æ˜¯ä¸åŒçš„ã€‚ é˜…è¯»å¦‚ä¸‹å¯¹è¯ï¼Œå¹¶è¯´æ˜ä¸œç§€çš„æ–¹æ¡ˆæ˜¯å¦å¯è¡Œã€‚ï¼ˆå› ä¸ºå¯¹è¯çš„å­—å¤ªå¤šï¼Œç”¨å›¾ä»£æ›¿ï¼‰
ç­”ï¼šç­”æ¡ˆå°±æ˜¯å¯è¡Œï¼ŒDNS æœåŠ¡å™¨æ˜¯åˆ†å¸ƒå¼çš„ï¼Œä¸€å°åäº†å¯ä»¥æ‰¾å…¶ä»–çš„ã€‚
åœ¨æµè§ˆå™¨åœ°å€è¾“å…¥ www.orentec.co.kr ï¼Œå¹¶æ•´ç†å‡ºä¸»é¡µæ˜¾ç¤ºè¿‡ç¨‹ã€‚å‡è®¾æµè§ˆå™¨è®¿é—®é»˜è®¤ DNS æœåŠ¡å™¨ä¸­å¹¶æ²¡æœ‰å…³äº www.orentec.co.kr çš„åœ°å€ä¿¡æ¯.
ç­”ï¼šå¯ä»¥å‚è€ƒä¸€ä¸‹çŸ¥ä¹å›ç­”ï¼Œåœ¨æµè§ˆå™¨åœ°å€æ è¾“å…¥ä¸€ä¸ªURLåå›è½¦ï¼ŒèƒŒåä¼šè¿›è¡Œå“ªäº›æŠ€æœ¯æ­¥éª¤ï¼Ÿ,æˆ‘ç”¨æˆ‘è‡ªå·±çš„ç†è§£ï¼Œç®€å•è¯´ä¸€ä¸‹ï¼Œé¦–å…ˆä¼šå»å‘ä¸Šä¸€çº§çš„ DNS æœåŠ¡å™¨å»æŸ¥è¯¢ï¼Œé€šè¿‡è¿™ç§æ–¹å¼é€çº§å‘ä¸Šä¼ é€’ä¿¡æ¯ï¼Œä¸€ç›´åˆ°è¾¾æ ¹æœåŠ¡å™¨æ—¶ï¼Œå®ƒçŸ¥é“åº”è¯¥å‘å“ªä¸ª DNS æœåŠ¡å™¨å‘èµ·è¯¢é—®ã€‚å‘ä¸‹ä¼ é€’è§£æè¯·æ±‚ï¼Œå¾—åˆ°IPåœ°å€å€™åŸè·¯è¿”å›ï¼Œæœ€åä¼šå°†è§£æçš„IPåœ°å€ä¼ é€’åˆ°å‘èµ·è¯·æ±‚çš„ä¸»æœºã€‚
ä»£ç  gethostbyaddr.c
1{{#include chapter_8/gethostbyaddr.c}} gethostbyname.c
1{{#include chapter_8/gethostbyname.c}} `,url:"https://hugo-dead-simple.netlify.com/linux_tcp_program/tcpip%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/chapter_8.html"},"https://hugo-dead-simple.netlify.com/linux_tcp_program/tcpip%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/chapter_9.html":{title:"",tags:[],content:`ç¬¬ 9 ç«  å¥—æ¥å­—çš„å¤šç§å¯é€‰é¡¹ æœ¬ç« ä»£ç ï¼Œåœ¨TCP-IP-NetworkNoteä¸­å¯ä»¥æ‰¾åˆ°ã€‚
9.1 å¥—æ¥å­—å¯é€‰é¡¹å’Œ I/O ç¼“å†²å¤§å° æˆ‘ä»¬è¿›è¡Œå¥—æ¥å­—ç¼–ç¨‹æ—¶å¾€å¾€åªå…³æ³¨æ•°æ®é€šä¿¡ï¼Œè€Œå¿½ç•¥äº†å¥—æ¥å­—å…·æœ‰çš„ä¸åŒç‰¹æ€§ã€‚ä½†æ˜¯ï¼Œç†è§£è¿™äº›ç‰¹æ€§å¹¶æ ¹æ®å®é™…éœ€è¦è¿›è¡Œæ›´æ”¹ä¹Ÿå¾ˆé‡è¦
9.1.1 å¥—æ¥å­—å¤šç§å¯é€‰é¡¹ æˆ‘ä»¬ä¹‹å‰å†™å¾—ç¨‹åºéƒ½æ˜¯åˆ›å»ºå¥½å¥—æ¥å­—ä¹‹åç›´æ¥ä½¿ç”¨çš„ï¼Œæ­¤æ—¶é€šè¿‡é»˜è®¤çš„å¥—æ¥å­—ç‰¹æ€§è¿›è¡Œæ•°æ®é€šä¿¡ï¼Œè¿™é‡Œåˆ—å‡ºäº†ä¸€äº›å¥—æ¥å­—å¯é€‰é¡¹ã€‚
åè®®å±‚ é€‰é¡¹å è¯»å– è®¾ç½® SOL_SOCKET SO_SNDBUF O O SOL_SOCKET SO_RCVBUF O O SOL_SOCKET SO_REUSEADDR O O SOL_SOCKET SO_KEEPALIVE O O SOL_SOCKET SO_BROADCAST O O SOL_SOCKET SO_DONTROUTE O O SOL_SOCKET SO_OOBINLINE O O SOL_SOCKET SO_ERROR O X SOL_SOCKET SO_TYPE O X IPPROTO_IP IP_TOS O O IPPROTO_IP IP_TTL O O IPPROTO_IP IP_MULTICAST_TTL O O IPPROTO_IP IP_MULTICAST_LOOP O O IPPROTO_IP IP_MULTICAST_IF O O IPPROTO_TCP TCP_KEEPALIVE O O IPPROTO_TCP TCP_NODELAY O O IPPROTO_TCP TCP_MAXSEG O O ä»è¡¨ä¸­å¯ä»¥çœ‹å‡ºï¼Œå¥—æ¥å­—å¯é€‰é¡¹æ˜¯åˆ†å±‚çš„ã€‚
IPPROTO_IP å¯é€‰é¡¹æ˜¯IPåè®®ç›¸å…³äº‹é¡¹
IPPROTO_TCP å±‚å¯é€‰é¡¹æ˜¯ TCP åè®®çš„ç›¸å…³äº‹é¡¹
SOL_SOCKET å±‚æ˜¯å¥—æ¥å­—çš„é€šç”¨å¯é€‰é¡¹ã€‚
9.1.2 getsockopt &amp; setsockopt å¯é€‰é¡¹çš„è¯»å–å’Œè®¾ç½®é€šè¿‡ä»¥ä¸‹ä¸¤ä¸ªå‡½æ•°æ¥å®Œæˆ
1#include &lt;sys/socket.h&gt; 2 3int getsockopt(int sock, int level, int optname, void *optval, socklen_t *optlen); 4/* 5æˆåŠŸæ—¶è¿”å› 0 ï¼Œå¤±è´¥æ—¶è¿”å› -1 6sock: ç”¨äºæŸ¥çœ‹é€‰é¡¹å¥—æ¥å­—æ–‡ä»¶æè¿°ç¬¦ 7level: è¦æŸ¥çœ‹çš„å¯é€‰é¡¹åè®®å±‚ 8optname: è¦æŸ¥çœ‹çš„å¯é€‰é¡¹å 9optval: ä¿å­˜æŸ¥çœ‹ç»“æœçš„ç¼“å†²åœ°å€å€¼ 10optlen: å‘ç¬¬å››ä¸ªå‚æ•°ä¼ é€’çš„ç¼“å†²å¤§å°ã€‚è°ƒç”¨å‡½æ•°å€™ï¼Œè¯¥å˜é‡ä¸­ä¿å­˜é€šè¿‡ç¬¬å››ä¸ªå‚æ•°è¿”å›çš„å¯é€‰é¡¹ä¿¡æ¯çš„å­—èŠ‚æ•°ã€‚ 11*/ ä¸Šè¿°å‡½æ•°å¯ä»¥ç”¨æ¥è¯»å–å¥—æ¥å­—å¯é€‰é¡¹ï¼Œä¸‹é¢çš„å‡½æ•°å¯ä»¥æ›´æ”¹å¯é€‰é¡¹ï¼šd
1#include &lt;sys/socket.h&gt; 2 3int setsockopt(int sock, int level, int optname, const void *optval, socklen_t optlen); 4/* 5æˆåŠŸæ—¶è¿”å› 0 ï¼Œå¤±è´¥æ—¶è¿”å› -1 6sock: ç”¨äºæ›´æ”¹é€‰é¡¹å¥—æ¥å­—æ–‡ä»¶æè¿°ç¬¦ 7level: è¦æ›´æ”¹çš„å¯é€‰é¡¹åè®®å±‚ 8optname: è¦æ›´æ”¹çš„å¯é€‰é¡¹å 9optval: ä¿å­˜æ›´æ”¹ç»“æœçš„ç¼“å†²åœ°å€å€¼ 10optlen: å‘ç¬¬å››ä¸ªå‚æ•°ä¼ é€’çš„ç¼“å†²å¤§å°ã€‚è°ƒç”¨å‡½æ•°åï¼Œè¯¥å˜é‡ä¸­ä¿å­˜é€šè¿‡ç¬¬å››ä¸ªå‚æ•°è¿”å›çš„å¯é€‰é¡¹ä¿¡æ¯çš„å­—èŠ‚æ•°ã€‚ 11*/ ä¸‹é¢çš„ä»£ç å¯ä»¥çœ‹å‡º getsockopt çš„ä½¿ç”¨æ–¹æ³•ã€‚ä¸‹é¢ç¤ºä¾‹ç”¨åè®®å±‚ä¸º SOL_SOCKET ã€åä¸º SO_TYPE çš„å¯é€‰é¡¹æŸ¥çœ‹å¥—æ¥å­—ç±»å‹ï¼ˆTCP å’Œ UDP ï¼‰ã€‚
sock_type.c ç¼–è¯‘è¿è¡Œï¼š
1gcc sock_type.c -o sock_type 2./sock_type ç»“æœï¼š
1SOCK_STREAM: 1 2SOCK_DGRAM: 2 3Socket type one: 1 4Socket type two: 2 é¦–å…ˆåˆ›å»ºäº†ä¸€ä¸ª TCP å¥—æ¥å­—å’Œä¸€ä¸ª UDP å¥—æ¥å­—ã€‚ç„¶åé€šè¿‡è°ƒç”¨ getsockopt å‡½æ•°æ¥è·å¾—å½“å‰å¥—æ¥å­—çš„çŠ¶æ€ã€‚
ç”¨äºéªŒè¯å¥—æ¥ç±»å‹çš„ SO_TYPE æ˜¯åªè¯»å¯é€‰é¡¹ï¼Œå› ä¸ºå¥—æ¥å­—ç±»å‹åªèƒ½åœ¨åˆ›å»ºæ—¶å†³å®šï¼Œä»¥åä¸èƒ½å†æ›´æ”¹ã€‚
9.1.3 SO_SNDBUF &amp; SO_RCVBUF åˆ›å»ºå¥—æ¥å­—çš„åŒæ—¶ä¼šç”Ÿæˆ I/O ç¼“å†²ã€‚å…³äº I/O ç¼“å†²ï¼Œå¯ä»¥å»çœ‹ç¬¬äº”ç« ã€‚
SO_RCVBUF æ˜¯è¾“å…¥ç¼“å†²å¤§å°ç›¸å…³å¯é€‰é¡¹ï¼ŒSO_SNDBUF æ˜¯è¾“å‡ºç¼“å†²å¤§å°ç›¸å…³å¯é€‰é¡¹ã€‚ç”¨è¿™ 2 ä¸ªå¯é€‰é¡¹æ—¢å¯ä»¥è¯»å–å½“å‰ I/O å¤§å°ï¼Œä¹Ÿå¯ä»¥è¿›è¡Œæ›´æ”¹ã€‚é€šè¿‡ä¸‹åˆ—ç¤ºä¾‹è¯»å–åˆ›å»ºå¥—æ¥å­—æ—¶é»˜è®¤çš„ I/O ç¼“å†²å¤§å°ã€‚
get_buf.c ç¼–è¯‘è¿è¡Œï¼š
1gcc get_buf.c -o getbuf 2./getbuf è¿è¡Œç»“æœï¼š
1Input buffer size: 87380 2Output buffer size: 16384 å¯ä»¥çœ‹å‡ºæœ¬æœºçš„è¾“å…¥ç¼“å†²å’Œè¾“å‡ºç¼“å†²å¤§å°ã€‚
ä¸‹é¢çš„ä»£ç æ¼”ç¤ºäº†ï¼Œé€šè¿‡ç¨‹åºè®¾ç½® I/O ç¼“å†²åŒºçš„å¤§å°
set_buf.c ç¼–è¯‘è¿è¡Œï¼š
1gcc get_buf.c -o setbuf 2./setbuf ç»“æœ:
1Input buffer size: 6144 2Output buffer size: 6144 è¾“å‡ºç»“æœå’Œæˆ‘ä»¬é¢„æƒ³çš„ä¸æ˜¯å¾ˆç›¸åŒï¼Œç¼“å†²å¤§å°çš„è®¾ç½®éœ€è°¨æ…å¤„ç†ï¼Œå› æ­¤ä¸ä¼šå®Œå…¨æŒ‰ç…§æˆ‘ä»¬çš„è¦æ±‚è¿›è¡Œã€‚
9.2 SO_REUSEADDR 9.2.1 å‘ç”Ÿåœ°å€åˆ†é…é”™è¯¯ï¼ˆBinding Errorï¼‰ åœ¨å­¦ä¹  SO_REUSEADDR å¯é€‰é¡¹ä¹‹å‰ï¼Œåº”è¯¥å¥½å¥½ç†è§£ Time-wait çŠ¶æ€ã€‚çœ‹ä»¥ä¸‹ä»£ç çš„ç¤ºä¾‹ï¼š
reuseadr_eserver.c è¿™æ˜¯ä¸€ä¸ªå›å£°æœåŠ¡å™¨çš„æœåŠ¡ç«¯ä»£ç ï¼Œå¯ä»¥é…åˆç¬¬å››ç« çš„ echo_client.c ä½¿ç”¨ï¼Œåœ¨è¿™ä¸ªä»£ç ä¸­ï¼Œå®¢æˆ·ç«¯é€šçŸ¥æœåŠ¡å™¨ç»ˆæ­¢ç¨‹åºã€‚åœ¨å®¢æˆ·ç«¯æ§åˆ¶å°è¾“å…¥ Q å¯ä»¥ç»“æŸç¨‹åºï¼Œå‘æœåŠ¡å™¨å‘é€ FIN æ¶ˆæ¯å¹¶ç»è¿‡å››æ¬¡æ¡æ‰‹è¿‡ç¨‹ã€‚å½“ç„¶ï¼Œè¾“å…¥ CTRL+C ä¹Ÿä¼šå‘æœåŠ¡å™¨ä¼ é€’ FIN ä¿¡æ¯ã€‚å¼ºåˆ¶ç»ˆæ­¢ç¨‹åºæ—¶ï¼Œç”±æ“ä½œç³»ç»Ÿå…³é—­æ–‡ä»¶å¥—æ¥å­—ï¼Œæ­¤è¿‡ç¨‹ç›¸å½“äºè°ƒç”¨ close å‡½æ•°ï¼Œä¹Ÿä¼šå‘æœåŠ¡å™¨å‘é€ FIN æ¶ˆæ¯ã€‚
è¿™æ ·çœ‹ä¸åˆ°æ˜¯ä»€ä¹ˆç‰¹æ®Šç°è±¡ï¼Œè€ƒè™‘ä»¥ä¸‹æƒ…å†µï¼š
æœåŠ¡å™¨ç«¯å’Œå®¢æˆ·ç«¯éƒ½å·²ç»å»ºç«‹è¿æ¥çš„çŠ¶æ€ä¸‹ï¼Œå‘æœåŠ¡å™¨æ§åˆ¶å°è¾“å…¥ CTRL+C ï¼Œå¼ºåˆ¶å…³é—­æœåŠ¡ç«¯
å¦‚æœç”¨è¿™ç§æ–¹å¼ç»ˆæ­¢ç¨‹åºï¼Œå¦‚æœç”¨åŒä¸€ç«¯å£å·å†æ¬¡è¿è¡ŒæœåŠ¡ç«¯ï¼Œå°±ä¼šè¾“å‡ºã€Œbind() errorã€æ¶ˆæ¯ï¼Œå¹¶ä¸”æ— æ³•å†æ¬¡è¿è¡Œã€‚ä½†æ˜¯åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå†è¿‡å¤§çº¦ 3 åˆ†é’Ÿå°±å¯ä»¥é‡æ–°è¿è¡ŒæœåŠ¡ç«¯ã€‚
9.2.2 Time-wait çŠ¶æ€ è§‚å¯Ÿä»¥ä¸‹è¿‡ç¨‹ï¼š
å‡è®¾å›¾ä¸­ä¸»æœº A æ˜¯æœåŠ¡å™¨ï¼Œå› ä¸ºæ˜¯ä¸»æœº A å‘ B å‘é€ FIN æ¶ˆæ¯ï¼Œæ•…å¯æƒ³è±¡æˆæœåŠ¡å™¨ç«¯åœ¨æ§åˆ¶å°ä¸­è¾“å…¥ CTRL+C ã€‚ä½†æ˜¯é—®é¢˜æ˜¯ï¼Œå¥—æ¥å­—ç»è¿‡å››æ¬¡æ¡æ‰‹åå¹¶æ²¡æœ‰ç«‹å³æ¶ˆé™¤ï¼Œè€Œæ˜¯è¦ç»è¿‡ä¸€æ®µæ—¶é—´çš„ Time-wait çŠ¶æ€ã€‚å½“ç„¶ï¼Œåªæœ‰å…ˆæ–­å¼€è¿æ¥çš„ï¼ˆå…ˆå‘é€ FIN æ¶ˆæ¯çš„ï¼‰ä¸»æœºæ‰ç»è¿‡ Time-wait çŠ¶æ€ã€‚å› æ­¤ï¼Œè‹¥æœåŠ¡å™¨ç«¯å…ˆæ–­å¼€è¿æ¥ï¼Œåˆ™æ— æ³•ç«‹å³é‡æ–°è¿è¡Œã€‚å¥—æ¥å­—å¤„åœ¨ Time-wait è¿‡ç¨‹æ—¶ï¼Œç›¸åº”ç«¯å£æ˜¯æ­£åœ¨ä½¿ç”¨çš„çŠ¶æ€ã€‚å› æ­¤ï¼Œå°±åƒä¹‹å‰éªŒè¯è¿‡çš„ï¼Œbind å‡½æ•°è°ƒç”¨è¿‡ç¨‹ä¸­ä¼šå‘ç”Ÿé”™è¯¯ã€‚
å®é™…ä¸Šï¼Œä¸è®ºæ˜¯æœåŠ¡ç«¯è¿˜æ˜¯å®¢æˆ·ç«¯ï¼Œéƒ½è¦ç»è¿‡ä¸€æ®µæ—¶é—´çš„ Time-wait è¿‡ç¨‹ã€‚å…ˆæ–­å¼€è¿æ¥çš„å¥—æ¥å­—å¿…ç„¶ä¼šç»è¿‡ Time-wait è¿‡ç¨‹ï¼Œä½†æ˜¯ç”±äºå®¢æˆ·ç«¯å¥—æ¥å­—çš„ç«¯å£æ˜¯ä»»æ„æŒ‡å®šçš„ï¼Œæ‰€ä»¥æ— éœ€è¿‡å¤šå…³æ³¨ Time-wait çŠ¶æ€ã€‚
é‚£åˆ°åº•ä¸ºä»€ä¹ˆä¼šæœ‰ Time-wait çŠ¶æ€å‘¢ï¼Œåœ¨å›¾ä¸­å‡è®¾ï¼Œä¸»æœº A å‘ä¸»æœº B ä¼ è¾“ ACK æ¶ˆæ¯ï¼ˆSEQ 5001 , ACK 7502 ï¼‰åç«‹åˆ»æ¶ˆé™¤å¥—æ¥å­—ã€‚ä½†æ˜¯æœ€åè¿™æ¡ ACK æ¶ˆæ¯åœ¨ä¼ é€’è¿‡ç¨‹ä¸­ä¸¢å¤±ï¼Œæ²¡æœ‰ä¼ é€’ä¸»æœº B ï¼Œè¿™æ—¶ä¸»æœº B å°±ä¼šè¯•å›¾é‡ä¼ ã€‚ä½†æ˜¯æ­¤æ—¶ä¸»æœº A å·²ç»æ˜¯å®Œå…¨ç»ˆæ­¢çŠ¶æ€ï¼Œå› æ­¤ä¸»æœº B æ°¸è¿œæ— æ³•æ”¶åˆ°ä»ä¸»æœº A æœ€åä¼ æ¥çš„ ACK æ¶ˆæ¯ã€‚åŸºäºè¿™äº›é—®é¢˜çš„è€ƒè™‘ï¼Œæ‰€ä»¥è¦è®¾è®¡ Time-wait çŠ¶æ€ã€‚
9.2.3 åœ°å€å†åˆ†é… Time-wait çŠ¶æ€çœ‹ä¼¼é‡è¦ï¼Œä½†æ˜¯ä¸ä¸€å®šè®¨äººå–œæ¬¢ã€‚å¦‚æœç³»ç»Ÿå‘ç”Ÿæ•…éšœç´§æ€¥åœæ­¢ï¼Œè¿™æ—¶éœ€è¦å°½å¿«é‡å¯æœåŠ¡èµ·ä»¥æä¾›æœåŠ¡ï¼Œä½†å› å¤„äº Time-wait çŠ¶æ€è€Œå¿…é¡»ç­‰å¾…å‡ åˆ†é’Ÿã€‚å› æ­¤ï¼ŒTime-wait å¹¶éåªæœ‰ä¼˜ç‚¹ï¼Œè¿™äº›æƒ…å†µä¸‹å®¹æ˜“å¼•å‘å¤§é—®é¢˜ã€‚ä¸‹å›¾ä¸­å±•ç¤ºäº†å››æ¬¡æ¡æ‰‹æ—¶ä¸å¾—ä¸å»¶é•¿ Time-wait è¿‡ç¨‹çš„æƒ…å†µã€‚
ä»å›¾ä¸Šå¯ä»¥çœ‹å‡ºï¼Œåœ¨ä¸»æœº A å››æ¬¡æ¡æ‰‹çš„è¿‡ç¨‹ä¸­ï¼Œå¦‚æœæœ€åçš„æ•°æ®ä¸¢å¤±ï¼Œåˆ™ä¸»æœº B ä¼šè®¤ä¸ºä¸»æœº A æœªèƒ½æ”¶åˆ°è‡ªå·±å‘é€çš„ FIN ä¿¡æ¯ï¼Œå› æ­¤é‡ä¼ ã€‚è¿™æ—¶ï¼Œæ”¶åˆ°çš„ FIN æ¶ˆæ¯çš„ä¸»æœº A å°†é‡å¯ Time-wait è®¡æ—¶å™¨ã€‚å› æ­¤ï¼Œå¦‚æœç½‘ç»œçŠ¶å†µä¸ç†æƒ³ï¼Œ Time-wait å°†æŒç»­ã€‚
è§£å†³æ–¹æ¡ˆå°±æ˜¯åœ¨å¥—æ¥å­—çš„å¯é€‰é¡¹ä¸­æ›´æ”¹ SO_REUSEADDR çš„çŠ¶æ€ã€‚é€‚å½“è°ƒæ•´è¯¥å‚æ•°ï¼Œå¯å°† Time-wait çŠ¶æ€ä¸‹çš„å¥—æ¥å­—ç«¯å£å·é‡æ–°åˆ†é…ç»™æ–°çš„å¥—æ¥å­—ã€‚SO_REUSEADDR çš„é»˜è®¤å€¼ä¸º 0.è¿™å°±æ„å‘³ç€æ— æ³•åˆ†é… Time-wait çŠ¶æ€ä¸‹çš„å¥—æ¥å­—ç«¯å£å·ã€‚å› æ­¤éœ€è¦å°†è¿™ä¸ªå€¼æ”¹æˆ 1 ã€‚å…·ä½“ä½œæ³•å·²åœ¨ç¤ºä¾‹ reuseadr_eserver.c ç»™å‡ºï¼Œåªéœ€è¦æŠŠæ³¨é‡Šæ‰çš„ä¸œè¥¿è§£é™¤æ³¨é‡Šå³å¯ã€‚
1optlen = sizeof(option); 2option = TRUE; 3setsockopt(serv_sock, SOL_SOCKET, SO_REUSEADDR, (void *)&amp;option, optlen); æ­¤æ—¶ï¼Œå·²ç»è§£å†³äº†ä¸Šè¿°é—®é¢˜ã€‚
9.3 TCP_NODELAY 9.3.1 Nagle ç®—æ³• ä¸ºäº†é˜²æ­¢å› æ•°æ®åŒ…è¿‡å¤šè€Œå‘ç”Ÿç½‘ç»œè¿‡è½½ï¼ŒNagle ç®—æ³•è¯ç”Ÿäº†ã€‚å®ƒåº”ç”¨äº TCP å±‚ã€‚å®ƒæ˜¯å¦ä½¿ç”¨ä¼šå¯¼è‡´å¦‚å›¾æ‰€ç¤ºçš„å·®å¼‚ï¼š
å›¾ä¸­å±•ç¤ºäº†é€šè¿‡ Nagle ç®—æ³•å‘é€å­—ç¬¦ä¸² Nagle å’Œæœªä½¿ç”¨ Nagle ç®—æ³•çš„å·®åˆ«ã€‚å¯ä»¥å¾—åˆ°ä¸€ä¸ªç»“è®ºã€‚
åªæœ‰æ¥æ”¶åˆ°å‰ä¸€æ•°æ®çš„ ACK æ¶ˆæ¯ï¼Œ Nagle ç®—æ³•æ‰å‘é€ä¸‹ä¸€æ•°æ®ã€‚
TCP å¥—æ¥å­—é»˜è®¤ä½¿ç”¨ Nagle ç®—æ³•äº¤æ¢æ•°æ®ï¼Œå› æ­¤æœ€å¤§é™åº¦çš„è¿›è¡Œç¼“å†²ï¼Œç›´åˆ°æ”¶åˆ° ACK ã€‚å·¦å›¾ä¹Ÿå°±æ˜¯è¯´ä¸€å…±ä¼ é€’ 4 ä¸ªæ•°æ®åŒ…ä»¥ä¼ è¾“ä¸€ä¸ªå­—ç¬¦ä¸²ã€‚ä»å³å›¾å¯ä»¥çœ‹å‡ºï¼Œå‘é€æ•°æ®åŒ…ä¸€å…±ä½¿ç”¨äº† 10 ä¸ªæ•°æ®åŒ…ã€‚ç”±æ­¤å¯çŸ¥ï¼Œä¸ä½¿ç”¨ Nagle ç®—æ³•å°†å¯¹ç½‘ç»œæµé‡äº§ç”Ÿè´Ÿé¢å½±å“ã€‚å³ä½¿åªä¼ è¾“ä¸€ä¸ªå­—èŠ‚çš„æ•°æ®ï¼Œå…¶å¤´ä¿¡æ¯éƒ½å¯èƒ½æ˜¯å‡ åä¸ªå­—èŠ‚ã€‚å› æ­¤ï¼Œä¸ºäº†æé«˜ç½‘ç»œä¼ è¾“æ•ˆç‡ï¼Œå¿…é¡»ä½¿ç”¨ Nagle ç®—æ³•ã€‚
Nagle ç®—æ³•å¹¶ä¸æ˜¯ä»€ä¹ˆæƒ…å†µä¸‹éƒ½é€‚ç”¨ï¼Œç½‘ç»œæµé‡æœªå—å¤ªå¤§å½±å“æ—¶ï¼Œä¸ä½¿ç”¨ Nagle ç®—æ³•è¦æ¯”ä½¿ç”¨å®ƒæ—¶ä¼ è¾“é€Ÿåº¦å¿«ã€‚æœ€å…¸å‹çš„å°±æ˜¯ã€Œä¼ è¾“å¤§æ–‡æ•°æ®ã€ã€‚å°†æ–‡ä»¶æ•°æ®ä¼ å…¥è¾“å‡ºç¼“å†²ä¸ä¼šèŠ±å¤ªå¤šæ—¶é—´ï¼Œå› æ­¤ï¼Œä¸ä½¿ç”¨ Nagle ç®—æ³•ï¼Œä¹Ÿä¼šåœ¨è£…æ»¡è¾“å‡ºç¼“å†²æ—¶ä¼ è¾“æ•°æ®åŒ…ã€‚è¿™ä¸ä»…ä¸ä¼šå¢åŠ æ•°æ®åŒ…çš„æ•°é‡ï¼Œåè€Œåœ¨æ— éœ€ç­‰å¾… ACK çš„å‰æä¸‹è¿ç»­ä¼ è¾“ï¼Œå› æ­¤å¯ä»¥å¤§å¤§æé«˜ä¼ è¾“é€Ÿåº¦ã€‚
æ‰€ä»¥ï¼Œæœªå‡†ç¡®åˆ¤æ–­æ•°æ®æ€§è´¨æ—¶ä¸åº”ç¦ç”¨ Nagle ç®—æ³•ã€‚
9.3.2 ç¦ç”¨ Nagle ç®—æ³• ç¦ç”¨ Nagle ç®—æ³•åº”è¯¥ä½¿ç”¨ï¼š
1int opt_val = 1; 2setsockopt(sock, IPPROTO_TCP, TCP_NODELAY, (void *)&amp;opt_val, sizeof(opt_val)); é€šè¿‡ TCP_NODELAY çš„å€¼æ¥æŸ¥çœ‹Nagle ç®—æ³•çš„è®¾ç½®çŠ¶æ€ã€‚
1opt_len = sizeof(opt_val); 2getsockopt(sock, IPPROTO_TCP, TCP_NODELAY, (void *)&amp;opt_val, &amp;opt_len); å¦‚æœæ­£åœ¨ä½¿ç”¨Nagle ç®—æ³•ï¼Œé‚£ä¹ˆ opt_val å€¼ä¸º 0ï¼Œå¦‚æœç¦ç”¨åˆ™ä¸º 1.
å…³äºè¿™ä¸ªç®—æ³•ï¼Œå¯ä»¥å‚è€ƒè¿™ä¸ªå›ç­”ï¼šTCPè¿æ¥ä¸­å¯ç”¨å’Œç¦ç”¨TCP_NODELAYæœ‰ä»€ä¹ˆå½±å“ï¼Ÿ
9.4 åŸºäº Windows çš„å®ç° æš‚ç•¥
9.5 ä¹ é¢˜ ä»¥ä¸‹ç­”æ¡ˆä»…ä»£è¡¨æœ¬äººä¸ªäººè§‚ç‚¹ï¼Œå¯èƒ½ä¸æ˜¯æ­£ç¡®ç­”æ¡ˆã€‚
ä¸‹åˆ—å…³äº Time-wait çŠ¶æ€çš„è¯´æ³•é”™è¯¯çš„æ˜¯ï¼Ÿ
ç­”ï¼šä»¥ä¸‹å­—ä½“åŠ ç²—çš„ä»£è¡¨æ­£ç¡®ã€‚
Time-wait çŠ¶æ€åªåœ¨æœåŠ¡å™¨çš„å¥—æ¥å­—ä¸­å‘ç”Ÿ æ–­å¼€è¿æ¥çš„å››æ¬¡æ¡æ‰‹è¿‡ç¨‹ä¸­ï¼Œå…ˆä¼ è¾“ FIN æ¶ˆæ¯çš„å¥—æ¥å­—å°†è¿›å…¥ Time-wait çŠ¶æ€ã€‚ Time-wait çŠ¶æ€ä¸æ–­å¼€è¿æ¥çš„è¿‡ç¨‹æ— å…³ï¼Œè€Œä¸è¯·æ±‚è¿æ¥è¿‡ç¨‹ä¸­ SYN æ¶ˆæ¯çš„ä¼ è¾“é¡ºåºæœ‰å…³ Time-wait çŠ¶æ€é€šå¸¸å¹¶éå¿…è¦ï¼Œåº”å°½å¯èƒ½é€šè¿‡æ›´æ”¹å¥—æ¥å­—å¯é€‰é¡¹æ¥é˜²æ­¢å…¶å‘ç”Ÿ TCP_NODELAY å¯é€‰é¡¹ä¸ Nagle ç®—æ³•æœ‰å…³ï¼Œå¯é€šè¿‡å®ƒç¦ç”¨ Nagle ç®—æ³•ã€‚è¯·é—®ä½•æ—¶åº”è€ƒè™‘ç¦ç”¨ Nagle ç®—æ³•ï¼Ÿç»“åˆæ”¶å‘æ•°æ®çš„ç‰¹æ€§ç»™å‡ºè¯´æ˜ã€‚
ç­”ï¼šå½“ç½‘ç»œæµé‡æœªå—å¤ªå¤§å½±å“æ—¶ï¼Œä¸ä½¿ç”¨ Nagle ç®—æ³•è¦æ¯”ä½¿ç”¨å®ƒæ—¶ä¼ è¾“é€Ÿåº¦å¿«ï¼Œæ¯”å¦‚è¯´åœ¨ä¼ è¾“å¤§æ–‡ä»¶æ—¶ã€‚
ä»£ç  get_buf.c
1{{#include chapter_9/get_buf.c}} set_buf
1{{#include chapter_9/set_buf.c}} reuseadr_eserver
1{{#include chapter_9/reuseadr_eserver.c}} sock_type
1{{#include chapter_9/sock_type.c}} `,url:"https://hugo-dead-simple.netlify.com/linux_tcp_program/tcpip%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/chapter_9.html"},"https://hugo-dead-simple.netlify.com/linux_tcp_program/tcpip%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/readme.html":{title:"",tags:[],content:`è¯´æ˜ ä½œè€…: éŸ©å›½ - å°¹åœ£é›¨
å­¦ä¹ èµ„æº riba2534TCP-IP-NetworkNote ğŸ“˜ã€ŠTCPIPç½‘ç»œç¼–ç¨‹ã€‹(éŸ©-å°¹åœ£é›¨)å­¦ä¹ ç¬”è®° `,url:"https://hugo-dead-simple.netlify.com/linux_tcp_program/tcpip%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/readme.html"},"https://hugo-dead-simple.netlify.com/mongodb/readme.html":{title:"",tags:[],content:"",url:"https://hugo-dead-simple.netlify.com/mongodb/readme.html"},"https://hugo-dead-simple.netlify.com/nvim-for-oi/buffline.html":{title:"",tags:[],content:`:h bufferline-configuration
`,url:"https://hugo-dead-simple.netlify.com/nvim-for-oi/buffline.html"},"https://hugo-dead-simple.netlify.com/nvim-for-oi/nvim-dap.html":{title:"",tags:[],content:` Here's a thinking process that could lead to the detailed \`nvim-dap\` guide: Deconstruct the User&rsquo;s Request:
Core Question: &ldquo;How do I use the nvim-dap plugin?&rdquo; Implicit Needs: This is a broad question. A good answer needs to cover several aspects, not just one command. It implies the user wants to set up a debugging environment in Neovim. I need to break this down into a logical, step-by-step process. Audience: The user has been asking about LSP and completion. They are comfortable with lazy.nvim and editing Lua configs. They are likely a C++ developer, given the clangd context. So, I should use C++ as the primary example. Structure the Answer - The &ldquo;Hero&rsquo;s Journey&rdquo; of Debugging Setup:
I&rsquo;ll structure the answer like a guide, taking the user from zero to a working debugger.
Part 1: The Big Picture - What is DAP?
Start with a high-level analogy. The LSP analogy worked well before (&ldquo;LSP lets your editor understand code&rdquo;). So, &ldquo;DAP lets your editor control a debugger.&rdquo; Explain the key components: nvim-dap (The Neovim frontend/client). Debug Adapter (The middleman, like vscode-cpptools). This is a crucial concept to explain. It&rsquo;s the &ldquo;server&rdquo; in the DAP &ldquo;client-server&rdquo; model. The actual Debugger (The backend, like GDB or LLDB). A simple diagram would be helpful here: Neovim &lt;-&gt; nvim-dap &lt;-&gt; Debug Adapter &lt;-&gt; GDB/LLDB. This clarifies the roles. Part 2: Installation and Core Configuration (lazy.nvim).
This is the practical, hands-on part. I need to provide a lazy.nvim configuration. Core Plugin: mfussenegger/nvim-dap. UI Plugin: nvim-dap itself is just the backend. A UI is essential for a good experience. rcarriga/nvim-dap-ui is the standard choice. I must include this. Virtual Text (Optional but recommended): theHamsta/nvim-dap-virtual-text is another great addition for showing variable values inline. The Configuration: Create a lazy.nvim spec for nvim-dap. Inside the config function, define the keymaps. This is critical for usability. I need to provide a standard, ergonomic set of keybindings with clear comments explaining what each one does (e.g., F5 to continue, F9 for breakpoint, F10 for step over). Create a spec for nvim-dap-ui. Inside its config, call dapui.setup(). I&rsquo;ll also show how to configure it to open/close automatically with DAP sessions. Create a spec for nvim-dap-virtual-text. Part 3: Setting up a Specific Language (The C++ Example).
This bridges the gap from &ldquo;plugins installed&rdquo; to &ldquo;I can actually debug my code.&rdquo; Step 3.1: Install the Debug Adapter. This is often a point of confusion. I need to be very clear here. For C++, the common choice is vscode-cpptools, which contains the OpenDebugAD7 adapter. I&rsquo;ll provide the mason.nvim way to install it (:MasonInstall cpptools). This is the easiest for most users. If they don&rsquo;t use Mason, I should briefly mention manual installation (cloning the repo, etc.), but focus on the Mason path. Step 3.2: Configure the Adapter in Neovim. Explain that nvim-dap needs to know how to launch the adapter. Provide the Lua code for configuring the cppdbg adapter. I&rsquo;ll explain the type = 'cppdbg' and how the command and args point to the installed adapter. The path will need to be dynamic, so I&rsquo;ll use mason_registry to find it automatically. This makes the config robust. Step 3.3: Configure the Launch Configuration (launch.json). Explain what launch.json is (tells the adapter how to start your program). This is another common stumbling block. Provide a clear, commented example of a launch.json for a simple C++ program. I&rsquo;ll explain each key: name, type, request, program, args, cwd. Crucially, I must emphasize the need to compile the C++ code with debug symbols (-g flag). This is a classic &ldquo;gotcha&rdquo;. Part 4: The Debugging Workflow - Putting It All Together.
This is the payoff. A step-by-step walkthrough of a debugging session. Compile your code with -g. Open the source file in Neovim. Set a breakpoint (using the F9 key we defined). Start debugging (using the F5 key we defined). nvim-dap will read the .vscode/launch.json. The dap-ui will open, the program will pause at the breakpoint. Explain what the user will see in the UI (variables, call stack, etc.). Demonstrate using the other keys: F10 (step over), F11 (step into), Shift+F5 (stop). Explain how to use the REPL to inspect variables. Review and Refine:
Read through the entire guide. Is the flow logical? Are the code blocks correct and well-commented? Is the language clear and not overly jargony? (The initial analogy helps a lot here). Have I anticipated common problems? (Forgetting -g, incorrect launch.json path, not installing the adapter). I&rsquo;ve addressed these. Is the C++ example self-contained and easy to follow? (Yes, simple main.cpp and g++ -g ... command). The structure seems solid: Concept -&gt; Installation -&gt; Configuration (Language Specific) -&gt; Workflow. This is a complete and actionable guide.å½“ç„¶ï¼nvim-dap æ˜¯ Neovim çš„ä¸€ä¸ªè°ƒè¯•é€‚é…å™¨åè®®ï¼ˆDebug Adapter Protocol, DAPï¼‰å®¢æˆ·ç«¯ã€‚å®ƒæœ¬èº«æ˜¯ä¸€ä¸ªå¼ºå¤§çš„åç«¯ï¼Œè®© Neovim èƒ½å¤Ÿä¸å„ç§è°ƒè¯•å™¨ï¼ˆå¦‚ GDB, LLDB, PDB ç­‰ï¼‰è¿›è¡Œé€šä¿¡ã€‚ ä¸ºäº†è·å¾—ç±»ä¼¼ VS Code çš„å›¾å½¢åŒ–è°ƒè¯•ä½“éªŒï¼Œæˆ‘ä»¬é€šå¸¸ä¼šå°† nvim-dap ä¸ä¸€ä¸ª UI æ’ä»¶ï¼ˆå¦‚ nvim-dap-uiï¼‰ç»“åˆä½¿ç”¨ã€‚
ä¸‹é¢æˆ‘å°†ä¸ºä½ æä¾›ä¸€ä¸ªå®Œæ•´çš„ä½¿ç”¨æŒ‡å—ï¼ŒåŒ…æ‹¬ï¼š
åŸºæœ¬æ¦‚å¿µï¼šnvim-dap æ˜¯å¦‚ä½•å·¥ä½œçš„ã€‚ å®‰è£…é…ç½®ï¼šä½¿ç”¨ lazy.nvim å®‰è£… nvim-dap å’Œ nvim-dap-uiã€‚ è¯­è¨€é…ç½®ï¼šä»¥ C++ ä¸ºä¾‹ï¼Œé…ç½®è°ƒè¯•å™¨é€‚é…å™¨ï¼ˆAdapterï¼‰ã€‚ è°ƒè¯•æµç¨‹ï¼šä¸€ä¸ªå®Œæ•´çš„ä»è®¾ç½®æ–­ç‚¹åˆ°å¼€å§‹è°ƒè¯•çš„æ­¥éª¤ã€‚ 1. åŸºæœ¬æ¦‚å¿µï¼šDAP çš„ä¸‰ä¸ªæ ¸å¿ƒç»„ä»¶ ç†è§£è¿™ä¸‰ä¸ªç»„ä»¶çš„å…³ç³»è‡³å…³é‡è¦ï¼š
Neovim + nvim-dap (å®¢æˆ·ç«¯)
è¿™æ˜¯ä½ äº¤äº’çš„å‰ç«¯ã€‚ä½ åœ¨è¿™é‡Œè®¾ç½®æ–­ç‚¹ã€æŸ¥çœ‹å˜é‡ã€æ§åˆ¶æ‰§è¡Œæµç¨‹ã€‚ è°ƒè¯•é€‚é…å™¨ (Adapter)
è¿™æ˜¯ä¸€ä¸ªä¸­é—´ä»¶ï¼Œä¸€ä¸ªç‹¬ç«‹çš„ç¨‹åºã€‚å®ƒå°† Neovim å‘é€çš„ DAP æŒ‡ä»¤ï¼ˆå¦‚â€œåœ¨ç¬¬ 10 è¡Œè®¾ç½®æ–­ç‚¹â€ï¼‰ç¿»è¯‘æˆç‰¹å®šè°ƒè¯•å™¨èƒ½å¬æ‡‚çš„å‘½ä»¤ï¼ˆå¦‚ GDB çš„ break 10ï¼‰ã€‚ å¯¹äº C++ï¼Œæœ€å¸¸ç”¨çš„é€‚é…å™¨æ˜¯ cpptoolsï¼ˆç”±å¾®è½¯æä¾›ï¼‰ã€‚ å¯¹äº Pythonï¼Œæ˜¯ debugpyã€‚ è°ƒè¯•å™¨ (Debugger)
è¿™æ˜¯çœŸæ­£æ‰§è¡Œè°ƒè¯•å·¥ä½œçš„åç«¯ï¼Œå¦‚ gdb æˆ– lldbã€‚ æµç¨‹å›¾ï¼š Neovim (ä½ ) &lt;&ndash;&gt; nvim-dap &lt;&ndash;&gt; è°ƒè¯•é€‚é…å™¨ (cpptools) &lt;&ndash;&gt; è°ƒè¯•å™¨ (gdb/lldb)
2. å®‰è£…ä¸æ ¸å¿ƒé…ç½® (lazy.nvim) æˆ‘ä»¬å°†å®‰è£…ä¸‰ä¸ªæ’ä»¶ï¼š
nvim-dap: æ ¸å¿ƒåè®®å®ç°ã€‚ nvim-dap-ui: æä¾›ç¾è§‚çš„è°ƒè¯• UI ç•Œé¢ã€‚ nvim-dap-virtual-text: (å¯é€‰) åœ¨ä»£ç æ—ä»¥å†…è”æ–¹å¼æ˜¾ç¤ºå˜é‡å€¼ã€‚ åœ¨ä½ çš„ plugins ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªæ–°æ–‡ä»¶ lua/plugins/dap.luaï¼Œå¹¶ç²˜è´´ä»¥ä¸‹å†…å®¹ï¼š
1-- lua/plugins/dap.lua 2 3return { 4 { 5 -- nvim-dap æ ¸å¿ƒæ’ä»¶ 6 &#34;mfussenegger/nvim-dap&#34;, 7 dependencies = { 8 -- DAP çš„ UI ç•Œé¢ 9 { 10 &#34;rcarriga/nvim-dap-ui&#34;, 11 config = function() 12 local dapui = require(&#34;dapui&#34;) 13 dapui.setup({ 14 -- UI å¸ƒå±€é…ç½® 15 layouts = { 16 { 17 elements = { 18 { id = &#34;scopes&#34;, size = 0.25 }, 19 { id = &#34;breakpoints&#34;, size = 0.25 }, 20 { id = &#34;stacks&#34;, size = 0.25 }, 21 { id = &#34;watches&#34;, size = 0.25 }, 22 }, 23 size = 40, 24 position = &#34;left&#34;, 25 }, 26 { 27 elements = { 28 { id = &#34;repl&#34;, size = 0.5 }, 29 { id = &#34;console&#34;, size = 0.5 }, 30 }, 31 size = 0.25, 32 position = &#34;bottom&#34;, 33 }, 34 }, 35 -- å…¶ä»–è®¾ç½®... 36 }) 37 38 local dap, dapui = require(&#34;dap&#34;), require(&#34;dapui&#34;) 39 40 -- åœ¨è°ƒè¯•ä¼šè¯å¼€å§‹æ—¶è‡ªåŠ¨æ‰“å¼€ UIï¼Œåœ¨ç»“æŸæ—¶è‡ªåŠ¨å…³é—­ 41 dap.listeners.after.event_initialized[&#34;dapui_config&#34;] = function() 42 dapui.open() 43 end 44 dap.listeners.before.event_terminated[&#34;dapui_config&#34;] = function() 45 dapui.close() 46 end 47 dap.listeners.before.event_exited[&#34;dapui_config&#34;] = function() 48 dapui.close() 49 end 50 end, 51 }, 52 -- (å¯é€‰) åœ¨ä»£ç æ—æ˜¾ç¤ºå˜é‡å€¼ 53 { &#34;theHamsta/nvim-dap-virtual-text&#34; }, 54 }, 55 config = function() 56 local dap = require(&#34;dap&#34;) 57 58 -- å®šä¹‰è°ƒè¯•å¿«æ·é”® 59 -- ä½¿ç”¨ F é”®åŒºä½œä¸ºè°ƒè¯•çš„æ ‡å‡†é”®ä½ 60 vim.keymap.set(&#34;n&#34;, &#34;&lt;F5&gt;&#34;, dap.continue, { desc = &#34;DAP: Continue&#34; }) 61 vim.keymap.set(&#34;n&#34;, &#34;&lt;F1&gt;&#34;, dap.step_into, { desc = &#34;DAP: Step Into&#34; }) 62 vim.keymap.set(&#34;n&#34;, &#34;&lt;F2&gt;&#34;, dap.step_over, { desc = &#34;DAP: Step Over&#34; }) 63 vim.keymap.set(&#34;n&#34;, &#34;&lt;F3&gt;&#34;, dap.step_out, { desc = &#34;DAP: Step Out&#34; }) 64 vim.keymap.set(&#34;n&#34;, &#34;&lt;F9&gt;&#34;, dap.toggle_breakpoint, { desc = &#34;DAP: Toggle Breakpoint&#34; }) 65 vim.keymap.set(&#34;n&#34;, &#34;&lt;Leader&gt;b&#34;, function() 66 dap.set_breakpoint(vim.fn.input(&#39;Breakpoint condition: &#39;)) 67 end, { desc = &#34;DAP: Set Conditional Breakpoint&#34; }) 68 69 -- æŸ¥çœ‹æ‚¬æµ®å˜é‡ 70 vim.keymap.set(&#34;n&#34;, &#34;&lt;Leader&gt;dh&#34;, function() require(&#39;dap.ui.widgets&#39;).hover() end, { desc = &#34;DAP: Hover Variable&#34; }) 71 end, 72 }, 73} ä¿å­˜æ–‡ä»¶å¹¶é‡å¯ Neovimï¼Œè®© lazy.nvim å®Œæˆå®‰è£…ã€‚
3. é…ç½® C++ è°ƒè¯•å™¨é€‚é…å™¨ ç°åœ¨ï¼Œæˆ‘ä»¬éœ€è¦å®‰è£…å¹¶é…ç½® C++ çš„è°ƒè¯•é€‚é…å™¨ã€‚
æ­¥éª¤ 3.1: å®‰è£…è°ƒè¯•é€‚é…å™¨ (cpptools) å¦‚æœä½ åœ¨ä½¿ç”¨ mason.nvimï¼Œè¿™æ˜¯æœ€ç®€å•çš„æ–¹æ³•ã€‚
è¿è¡Œ :Mason å‘½ä»¤ã€‚ æ‰¾åˆ° cpptools å¹¶æŒ‰ i å®‰è£…å®ƒã€‚ æ­¥éª¤ 3.2: åœ¨ Neovim ä¸­æ³¨å†Œé€‚é…å™¨ nvim-dap éœ€è¦çŸ¥é“å¦‚ä½•å¯åŠ¨ cpptoolsã€‚åœ¨ä½ çš„ Neovim é…ç½®ä¸­çš„æŸä¸ªåœ°æ–¹ï¼ˆä¾‹å¦‚ init.lua æˆ–ä¸“é—¨çš„ dap é…ç½®æ–‡ä»¶ä¸­ï¼‰ï¼Œæ·»åŠ ä»¥ä¸‹ä»£ç ï¼š
1-- å°†æ­¤ä»£ç æ·»åŠ åˆ°ä½ çš„é…ç½®ä¸­ 2local dap = require(&#39;dap&#39;) 3 4-- é€‚é…å™¨é…ç½®ï¼šå‘Šè¯‰ nvim-dap å¦‚ä½•å¯åŠ¨ cpptools 5dap.adapters.cppdbg = { 6 id = &#39;cppdbg&#39;, 7 type = &#39;executable&#39;, 8 -- æ³¨æ„ï¼šè¿™é‡Œçš„è·¯å¾„éœ€è¦æŒ‡å‘ä½ é€šè¿‡ Mason å®‰è£…çš„ cpptools çš„ä½ç½® 9 -- ä½ å¯ä»¥é€šè¿‡åœ¨ Mason çª—å£ä¸­å¯¹ cpptools æŒ‰ \`g?\` æŸ¥çœ‹è·¯å¾„ 10 -- æˆ–è€…ä½¿ç”¨ \`mason-lspconfig\` è¿™æ ·çš„æ’ä»¶æ¥è‡ªåŠ¨è·å–è·¯å¾„ 11 command = vim.fn.stdpath(&#39;data&#39;) .. &#39;/mason/bin/OpenDebugAD7&#39;, 12} 13 14-- è¯­è¨€é…ç½®ï¼šå°† cppdbg é€‚é…å™¨ä¸ c å’Œ cpp æ–‡ä»¶ç±»å‹å…³è”èµ·æ¥ 15dap.configurations.cpp = { 16 { 17 name = &#34;Launch file&#34;, 18 type = &#34;cppdbg&#34;, 19 request = &#34;launch&#34;, 20 program = function() 21 -- è¦æ±‚ç”¨æˆ·è¾“å…¥è¦è°ƒè¯•çš„å¯æ‰§è¡Œæ–‡ä»¶è·¯å¾„ 22 return vim.fn.input(&#39;Path to executable: &#39;, vim.fn.getcwd() .. &#39;/&#39;, &#39;file&#39;) 23 end, 24 cwd = &#39;\${workspaceFolder}&#39;, 25 stopAtEntry = true, -- åœ¨ main å‡½æ•°å…¥å£å¤„æš‚åœ 26 }, 27} 28 29-- ä¸º c æ–‡ä»¶ä¹Ÿè®¾ç½®åŒæ ·çš„é…ç½® 30dap.configurations.c = dap.configurations.cpp æ³¨æ„ï¼šcommand è·¯å¾„æ˜¯ç¡¬ç¼–ç çš„ç¤ºä¾‹ï¼Œå¦‚æœä½ çš„ mason å®‰è£…åœ¨ä¸åŒä½ç½®ï¼Œè¯·ç›¸åº”ä¿®æ”¹ã€‚
4. å®Œæ•´è°ƒè¯•æµç¨‹ï¼šä¸€ä¸ª C++ ç¤ºä¾‹ ç°åœ¨ï¼Œä¸€åˆ‡å‡†å¤‡å°±ç»ªï¼è®©æˆ‘ä»¬æ¥è°ƒè¯•ä¸€ä¸ªç®€å•çš„ C++ ç¨‹åºã€‚
æ­¥éª¤ 4.1: å‡†å¤‡ç¤ºä¾‹ä»£ç  åˆ›å»ºä¸€ä¸ªåä¸º main.cpp çš„æ–‡ä»¶ï¼š
1#include &lt;iostream&gt; 2#include &lt;vector&gt; 3 4void print_hello(int count) { 5 for (int i = 0; i &lt; count; ++i) { 6 std::cout &lt;&lt; &#34;Hello, number &#34; &lt;&lt; i + 1 &lt;&lt; std::endl; 7 } 8} 9 10int main() { 11 std::vector&lt;int&gt; numbers = {1, 2, 3}; 12 int total_count = 5; 13 14 print_hello(total_count); 15 16 numbers.push_back(4); 17 std::cout &lt;&lt; &#34;Final size: &#34; &lt;&lt; numbers.size() &lt;&lt; std::endl; 18 19 return 0; 20} æ­¥éª¤ 4.2: ç¼–è¯‘å¹¶ç”Ÿæˆè°ƒè¯•ä¿¡æ¯ è¿™æ˜¯æœ€å…³é”®çš„ä¸€æ­¥ï¼ å¿…é¡»ä½¿ç”¨ -g æ ‡å¿—æ¥ç¼–è¯‘ä½ çš„ç¨‹åºï¼Œè¿™æ ·å¯æ‰§è¡Œæ–‡ä»¶ä¸­æ‰ä¼šåŒ…å«è°ƒè¯•ç¬¦å·ã€‚
1g++ -g -std=c++17 main.cpp -o main_debug ç°åœ¨ä½ ç›®å½•ä¸‹æœ‰äº†ä¸€ä¸ªåä¸º main_debug çš„å¯æ‰§è¡Œæ–‡ä»¶ã€‚
æ­¥éª¤ 4.3: åœ¨ Neovim ä¸­å¼€å§‹è°ƒè¯• ç”¨ Neovim æ‰“å¼€ main.cpp æ–‡ä»¶ã€‚ è®¾ç½®æ–­ç‚¹ï¼šå°†å…‰æ ‡ç§»åŠ¨åˆ° print_hello(total_count); è¿™ä¸€è¡Œï¼Œç„¶åæŒ‰ &lt;F9&gt;ã€‚ä½ ä¼šçœ‹åˆ°è¡Œå·æ—è¾¹å‡ºç°ä¸€ä¸ªçº¢ç‚¹ ğŸ”´ï¼Œè¡¨ç¤ºæ–­ç‚¹å·²è®¾ç½®ã€‚ å¯åŠ¨è°ƒè¯•ä¼šè¯ï¼šæŒ‰ &lt;F5&gt;ã€‚ æ­¤æ—¶ Neovim ä¼šåœ¨åº•éƒ¨æç¤ºä½  Path to executable:ã€‚ è¾“å…¥ä½ åˆšåˆšç¼–è¯‘å¥½çš„æ–‡ä»¶å main_debugï¼Œç„¶åæŒ‰å›è½¦ã€‚ è°ƒè¯•å¼€å§‹ï¼ nvim-dap-ui ç•Œé¢ä¼šè‡ªåŠ¨åœ¨å·¦ä¾§å’Œä¸‹æ–¹æ‰“å¼€ã€‚ ç¨‹åºä¼šåœåœ¨ä½ è®¾ç½®çš„æ–­ç‚¹å¤„ï¼Œè¯¥è¡Œä¼šé«˜äº®æ˜¾ç¤ºã€‚ æ­¥éª¤ 4.4: æ§åˆ¶è°ƒè¯•æµç¨‹ ç°åœ¨ï¼Œä½ å¯ä»¥ä½¿ç”¨æˆ‘ä»¬ä¹‹å‰å®šä¹‰çš„å¿«æ·é”®æ¥æ§åˆ¶è°ƒè¯•ï¼š
(Continue): ç»§ç»­æ‰§è¡Œï¼Œç›´åˆ°é‡åˆ°ä¸‹ä¸€ä¸ªæ–­ç‚¹æˆ–ç¨‹åºç»“æŸã€‚ (Step Over): å•æ­¥æ‰§è¡Œï¼Œä½†ä¸è¿›å…¥å‡½æ•°å†…éƒ¨ã€‚å°†å…‰æ ‡æ”¾åœ¨ print_hello è¿™ä¸€è¡Œï¼ŒæŒ‰ &lt;F2&gt;ï¼Œç¨‹åºä¼šæ‰§è¡Œå®Œæ•´ä¸ªå‡½æ•°ï¼Œåœåœ¨ä¸‹ä¸€è¡Œã€‚ (Step Into): å•æ­¥æ‰§è¡Œï¼Œå¹¶è¿›å…¥å‡½æ•°å†…éƒ¨ã€‚å°†å…‰æ ‡æ”¾åœ¨ print_hello è¿™ä¸€è¡Œï¼ŒæŒ‰ &lt;F1&gt;ï¼Œä½ ä¼šè·³è½¬åˆ° print_hello å‡½æ•°çš„ç¬¬ä¸€è¡Œã€‚ (Step Out): ä»å½“å‰å‡½æ•°è·³å‡ºï¼Œè¿”å›åˆ°è°ƒç”¨å®ƒçš„åœ°æ–¹ã€‚ æ­¥éª¤ 4.5: è§‚å¯Ÿå˜é‡å’Œäº¤äº’ å·¦ä¾§ UI ç•Œé¢ï¼š Scopes: ä½ å¯ä»¥çœ‹åˆ°å½“å‰ä½œç”¨åŸŸå†…çš„æ‰€æœ‰å˜é‡ï¼ˆä¾‹å¦‚ numbers å’Œ total_countï¼‰ä»¥åŠå®ƒä»¬çš„å€¼ã€‚ Breakpoints: åˆ—å‡ºæ‰€æœ‰è®¾ç½®çš„æ–­ç‚¹ã€‚ Stacks: æ˜¾ç¤ºå½“å‰çš„å‡½æ•°è°ƒç”¨æ ˆã€‚ åº•éƒ¨ UI ç•Œé¢ (REPL)ï¼š è¿™æ˜¯ä¸€ä¸ªäº¤äº’å¼æ§åˆ¶å°ã€‚ä½ å¯ä»¥è¾“å…¥å˜é‡åæ¥æŸ¥çœ‹å®ƒçš„å€¼ï¼Œç”šè‡³å¯ä»¥æ‰§è¡Œä¸€äº›ç®€å•çš„è¡¨è¾¾å¼ï¼Œä¾‹å¦‚è¾“å…¥ numbers.size() å¹¶å›è½¦ã€‚ é€šè¿‡è¿™å¥—æµç¨‹ï¼Œä½ å°±æ‹¥æœ‰äº†ä¸€ä¸ªåŠŸèƒ½é½å…¨ã€å¯åª²ç¾ IDE çš„è°ƒè¯•ç¯å¢ƒï¼Œå®Œå…¨é›†æˆåœ¨ Neovim ä¸­ï¼
`,url:"https://hugo-dead-simple.netlify.com/nvim-for-oi/nvim-dap.html"},"https://hugo-dead-simple.netlify.com/nvim-for-oi/snack-picker.html":{title:"",tags:[],content:`rainboylvx: è¯»å–æ•´ä¸ªé¡¹ç›®,æ•™ä¼šæˆ‘è¿™ä¸ªnvimæ’ä»¶é¡¹ç›®çš„æºç , æ¯æ¬¡åˆ†æä¸€ä¸ªæ–‡ä»¶(æŒ‰ä»£ç æ–‡ä»¶çš„ç›´æ¥çš„è°ƒç”¨é€»è¾‘),è¯¢é—®ç”¨æˆ·æ˜¯å¦ç†è§£å,åœ¨åˆ†æä¸‹ä¸€ä¸ªä»£ç æ–‡ä»¶
Workspace: æ­£åœ¨æ”¶é›†å·¥ä½œåŒºä¿¡æ¯å¥½çš„ï¼Œæˆ‘ä»¬å¼€å§‹åˆ†æè¿™ä¸ªé¡¹ç›®ã€‚æˆ‘å°†ä»ä½ å½“å‰æ‰“å¼€çš„æ–‡ä»¶å¼€å§‹ï¼ŒæŒ‰ç…§ä»£ç çš„è°ƒç”¨é€»è¾‘é€ä¸€åˆ†æï¼Œå¹¶åœ¨åˆ†æå®Œæ¯ä¸ªæ–‡ä»¶åè¯¢é—®ä½ æ˜¯å¦ç†è§£ã€‚
æˆ‘ä»¬ä»å…¥å£æ–‡ä»¶ lua/snacks/picker/init.lua å¼€å§‹ã€‚
è¿™ä¸ªæ–‡ä»¶æ˜¯ snacks.picker æ¨¡å—çš„æ ¸å¿ƒã€‚å®ƒçš„ä¸»è¦ä½œç”¨æ˜¯ï¼š
ä½œä¸ºæ¨¡å—çš„å…¥å£ï¼šé€šè¿‡ setmetatableï¼Œå®ƒå®ç°äº†ä¸€ä¸ªå·§å¦™çš„åŠ è½½æœºåˆ¶ã€‚ __call å…ƒæ–¹æ³•å…è®¸ä½ åƒå‡½æ•°ä¸€æ ·è°ƒç”¨è¿™ä¸ªæ¨¡å—ï¼ˆä¾‹å¦‚ require(&quot;snacks.picker&quot;)(opts)ï¼‰ï¼Œè¿™å®é™…ä¸Šä¼šæ‰§è¡Œ M.pick å‡½æ•°ã€‚ __index å…ƒæ–¹æ³•å®ç°äº†å­æ¨¡å—çš„æ‡’åŠ è½½ã€‚å½“ä½ è®¿é—® picker.actions æˆ– picker.config è¿™æ ·çš„å­æ¨¡å—æ—¶ï¼Œå®ƒä¼šè‡ªåŠ¨ require å¯¹åº”çš„æ–‡ä»¶ï¼ˆå¦‚ snacks.picker.actionsï¼‰ï¼Œè¿™æé«˜äº†å¯åŠ¨æ€§èƒ½ã€‚ åˆ›å»ºé€‰æ‹©å™¨ (Picker)ï¼šæ ¸å¿ƒåŠŸèƒ½ç”± M.pick å‡½æ•°æä¾›ã€‚ è¿™ä¸ªå‡½æ•°æ˜¯åˆ›å»ºæ–°é€‰æ‹©å™¨ UI çš„ä¸»è¦æ–¹å¼ã€‚ å®ƒå¤„ç†ä¸åŒçš„å‚æ•°ç»„åˆï¼Œä¾‹å¦‚å¯ä»¥åªä¼ å…¥é…ç½®è¡¨ï¼Œä¹Ÿå¯ä»¥åŒæ—¶ä¼ å…¥æ•°æ®æºåç§°å’Œé…ç½®ã€‚ å¦‚æœè°ƒç”¨æ—¶æ²¡æœ‰æä¾›æ•°æ®æº (source)ã€æ¡ç›® (items) æˆ–æŸ¥æ‰¾å™¨ (finder)ï¼Œå®ƒä¼šé»˜è®¤æ‰“å¼€ä¸€ä¸ªå±•ç¤ºæ‰€æœ‰å¯ç”¨é€‰æ‹©å™¨çš„é€‰æ‹©å™¨ã€‚ æœ€å…³é”®çš„ä¸€è¡Œæ˜¯ require(&quot;snacks.picker.core.picker&quot;).new(opts)ï¼Œè¿™è¡¨æ˜å®é™…çš„é€‰æ‹©å™¨å¯¹è±¡æ˜¯åœ¨ picker.lua æ–‡ä»¶ä¸­åˆ›å»ºå’Œç®¡ç†çš„ã€‚ é›†æˆ vim.ui.selectï¼šé€šè¿‡ M.select å‡½æ•°ï¼Œå®ƒæä¾›äº†ä¸€ä¸ªå¯ä»¥æ›¿ä»£ Neovim å†…ç½® vim.ui.select çš„å®ç°ï¼Œè¿™ä¸ªå®ç°æ¥è‡ªäº select.lua æ–‡ä»¶ã€‚ æä¾›è¾…åŠ©åŠŸèƒ½ï¼š M.get ç”¨äºè·å–å½“å‰æ´»åŠ¨çš„é€‰æ‹©å™¨å®ä¾‹ã€‚ M.setup ç”¨äºåœ¨å¯åŠ¨æ—¶åº”ç”¨é…ç½®ï¼Œæ¯”å¦‚ç”¨å½“å‰æ’ä»¶çš„ UI æ›¿æ¢ vim.ui.selectã€‚ æ€»ç»“æ¥è¯´ï¼Œinit.lua æ˜¯ä¸€ä¸ªé«˜åº¦å°è£…çš„å…¥å£ï¼Œå®ƒå°†åŠŸèƒ½å§”æ‰˜ç»™å…¶ä»–æ¨¡å—ï¼Œå¹¶ä¸ºç”¨æˆ·æä¾›äº†ä¸€ä¸ªç®€æ´çš„ APIã€‚å…¶æœ€é‡è¦çš„ä¾èµ–æ˜¯ picker.luaï¼Œå› ä¸ºé€‰æ‹©å™¨çš„åˆ›å»ºå’Œç”Ÿå‘½å‘¨æœŸç®¡ç†éƒ½åœ¨é‚£é‡Œå®ç°ã€‚
ä»¥ä¸Šæ˜¯å…³äº init.lua æ–‡ä»¶çš„åˆ†æã€‚ä½ ç†è§£äº†å—ï¼Ÿå¦‚æœç†è§£äº†ï¼Œæˆ‘ä»¬æ¥ä¸‹æ¥å°±åˆ†æå®ƒæœ€é‡è¦çš„ä¾èµ–æ–‡ä»¶ picker.luaã€‚
rainboylvx: ç†è§£,ç»§ç»­
GitHub Copilot: å¥½çš„ï¼Œæˆ‘ä»¬ç»§ç»­åˆ†æä¸‹ä¸€ä¸ªæ–‡ä»¶ï¼šlua/snacks/picker/core/picker.luaã€‚
è¿™ä¸ªæ–‡ä»¶å¯ä»¥è¯´æ˜¯æ•´ä¸ªé€‰æ‹©å™¨åŠŸèƒ½çš„å¿ƒè„ã€‚å®ƒå®šä¹‰äº† Picker è¿™ä¸ªç±»ï¼Œæ¯ä¸€ä¸ªä½ çœ‹åˆ°çš„ UI é€‰æ‹©å™¨éƒ½æ˜¯è¿™ä¸ªç±»çš„ä¸€ä¸ªå®ä¾‹ã€‚
ä»¥ä¸‹æ˜¯å®ƒçš„æ ¸å¿ƒèŒè´£å’Œå·¥ä½œæµç¨‹ï¼š
æ„é€ å‡½æ•° Picker.new(opts)ï¼š
è¿™æ˜¯åˆ›å»ºæ–°é€‰æ‹©å™¨å®ä¾‹çš„å…¥å£ã€‚ å®ƒåšçš„ç¬¬ä¸€ä»¶äº‹æ˜¯åˆå¹¶é…ç½®ã€‚å®ƒä¼šå°†ä½ ä¼ å…¥çš„ optsã€æ•°æ®æº (source) çš„é»˜è®¤é…ç½®ä»¥åŠæ’ä»¶çš„å…¨å±€é»˜è®¤é…ç½®åˆå¹¶åœ¨ä¸€èµ·ï¼Œå½¢æˆæœ€ç»ˆçš„é…ç½®ã€‚ åˆå§‹åŒ–çŠ¶æ€ (self.state)ï¼šå®ƒåˆ›å»ºäº†ä¸€ä¸ª state è¡¨ï¼Œç”¨æ¥å­˜æ”¾æ‰€æœ‰åŠ¨æ€å˜åŒ–çš„æ•°æ®ï¼Œæ¯”å¦‚ï¼š items: å½“å‰æ˜¾ç¤ºçš„æ‰€æœ‰æ¡ç›®ã€‚ query: ç”¨æˆ·åœ¨è¾“å…¥æ¡†ä¸­è¾“å…¥çš„æŸ¥è¯¢å­—ç¬¦ä¸²ã€‚ selection: å½“å‰å…‰æ ‡é€‰ä¸­çš„æ¡ç›®ã€‚ status: é€‰æ‹©å™¨çš„çŠ¶æ€ï¼ˆä¾‹å¦‚ &ldquo;loading&rdquo;, &ldquo;idle&rdquo;ï¼‰ã€‚ åˆ›å»º UI å®ä¾‹ï¼šé€šè¿‡ require(&quot;snacks.picker.core.ui&quot;).new(self)ï¼Œå®ƒåˆ›å»ºäº†ä¸€ä¸ª UI å¯¹è±¡ (self.ui) å¹¶å°†å½“å‰çš„ Picker å®ä¾‹è‡ªèº«ä¼ é€’ç»™ UIã€‚è¿™è¡¨æ˜ UI çš„æ¸²æŸ“å’Œæ›´æ–°å°†ç”± core/ui.lua æ–‡ä»¶è´Ÿè´£ã€‚ è®¾ç½®æ•°æ®æº (self.source)ï¼šå®ƒä¼šåˆå§‹åŒ–æ•°æ®æº (require(&quot;snacks.picker.source&quot;).new(self))ï¼Œæ•°æ®æºè´Ÿè´£è·å–å’Œè¿‡æ»¤è¦æ˜¾ç¤ºçš„æ¡ç›®ã€‚ äº‹ä»¶é©±åŠ¨æ¶æ„ï¼šå®ƒå®ç°äº† on, once, emit ç­‰æ–¹æ³•ï¼Œå»ºç«‹äº†ä¸€ä¸ªäº‹ä»¶ç³»ç»Ÿã€‚è¿™æ˜¯å®ç°è§£è€¦çš„å…³é”®ã€‚ä¾‹å¦‚ï¼š å½“ç”¨æˆ·è¾“å…¥æ—¶ï¼Œä¼šå‘å‡º (emit) ä¸€ä¸ª &quot;query.changed&quot; äº‹ä»¶ã€‚ æ•°æ®æº (source) ç›‘å¬åˆ°è¿™ä¸ªäº‹ä»¶åï¼Œä¼šå»æŸ¥æ‰¾åŒ¹é…çš„æ¡ç›®ã€‚ æ‰¾åˆ°åï¼Œæ•°æ®æºä¼šè°ƒç”¨ picker:set_items() æ¥æ›´æ–°çŠ¶æ€ã€‚ çŠ¶æ€æ›´æ–°åï¼Œä¼šè§¦å‘ UI çš„é‡æ–°æ¸²æŸ“ã€‚ æŒ‚è½½ UIï¼šæœ€åè°ƒç”¨ self:mount() æ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•å®é™…ä¸Šä¼šè°ƒç”¨ self.ui:mount()ï¼Œä»è€Œå°†é€‰æ‹©å™¨çš„çª—å£æ˜¾ç¤ºåœ¨å±å¹•ä¸Šã€‚ ç”Ÿå‘½å‘¨æœŸç®¡ç†ï¼š
Picker:mount(): æ˜¾ç¤ºé€‰æ‹©å™¨ã€‚ Picker:close(): å…³é—­é€‰æ‹©å™¨ã€‚å®ƒä¼šåšä¸€äº›æ¸…ç†å·¥ä½œï¼Œæ¯”å¦‚é”€æ¯ UI çª—å£ (self.ui:unmount())ï¼Œå¹¶å‘å‡º &quot;close&quot; äº‹ä»¶ã€‚ çŠ¶æ€ç®¡ç†ï¼š
Picker:set_state(change) å’Œ Picker:update_state(change) æ˜¯æ›´æ–°é€‰æ‹©å™¨çŠ¶æ€çš„æ ¸å¿ƒæ–¹æ³•ã€‚ å½“çŠ¶æ€ï¼ˆå¦‚ items æˆ– selectionï¼‰æ”¹å˜æ—¶ï¼Œå®ƒä¼šç¡®ä¿ UI ä¹Ÿéšä¹‹æ›´æ–° (self.ui:update(state, self.state))ã€‚ ä¸ç”¨æˆ·äº¤äº’ï¼š
Picker:actions(name): è¿™ä¸ªæ–¹æ³•ç”¨æ¥æ‰§è¡Œä¸€ä¸ªå…·ä½“çš„ &ldquo;åŠ¨ä½œ&rdquo;ï¼Œæ¯”å¦‚ &ldquo;å‘ä¸Šç§»åŠ¨å…‰æ ‡&rdquo;ã€&ldquo;ç¡®è®¤é€‰æ‹©&rdquo; ç­‰ã€‚è¿™äº›åŠ¨ä½œçš„å…·ä½“å®ç°åœ¨ actions ç›®å½•ä¸‹ã€‚ å®ƒé€šè¿‡ self.ui:input(fn) æ¥å¤„ç†ç”¨æˆ·çš„æŒ‰é”®è¾“å…¥ï¼Œå¹¶å°†æŒ‰é”®æ˜ å°„åˆ°å¯¹åº”çš„åŠ¨ä½œä¸Šã€‚ æ€»ç»“ï¼špicker.lua å®šä¹‰äº†ä¸€ä¸ª Picker å¯¹è±¡ï¼Œå®ƒåƒä¸€ä¸ªâ€œæŒ‡æŒ¥å®˜â€ï¼Œè´Ÿè´£ï¼š
ç®¡ç†è‡ªå·±çš„çŠ¶æ€ (state)ã€‚ åè°ƒæ•°æ®æº (source.lua) æ¥è·å–æ•°æ®ã€‚ åè°ƒUI (ui.lua) æ¥å±•ç¤ºç•Œé¢å’Œæ¥æ”¶è¾“å…¥ã€‚ é€šè¿‡äº‹ä»¶å’ŒåŠ¨ä½œ (actions) å°†æ‰€æœ‰éƒ¨åˆ†ä¸²è”èµ·æ¥ï¼Œå“åº”ç”¨æˆ·çš„äº¤äº’ã€‚ è¿™ä¸ªæ–‡ä»¶æ˜¯ç†è§£æ•´ä¸ªæ’ä»¶å·¥ä½œæµç¨‹çš„å…³é”®ã€‚å®ƒæœ¬èº«ä¸ç›´æ¥å¤„ç† UI æ¸²æŸ“æˆ–æ•°æ®è·å–ï¼Œè€Œæ˜¯å°†è¿™äº›ä»»åŠ¡å§”æ‰˜ç»™äº†å…¶ä»–ä¸“é—¨çš„æ¨¡å—ã€‚
ä½ ç†è§£ Picker ç±»æ˜¯å¦‚ä½•ä½œä¸ºæ ¸å¿ƒæ¥åè°ƒå…¶ä»–æ¨¡å—å·¥ä½œçš„å—ï¼Ÿå¦‚æœç†è§£äº†ï¼Œæˆ‘ä»¬æ¥ä¸‹æ¥å¯ä»¥çœ‹çœ‹å®ƒæ˜¯å¦‚ä½•æ¸²æŸ“ UI çš„ï¼Œä¹Ÿå°±æ˜¯åˆ†æ core/ui.lua æ–‡ä»¶ã€‚
rainboylvx: &lsquo;core/picker.lua&rsquo; é‚£ä¸ªä½ç½®çš„ä»£ç ,åˆå§‹åŒ–self.state
GitHub Copilot: æŠ±æ­‰ï¼Œæˆ‘ä¹‹å‰çš„è§£é‡Šå¯èƒ½å¼•èµ·äº†è¯¯è§£ï¼Œä¸ºäº†ä¾¿äºç†è§£ï¼Œæˆ‘åšäº†ä¸€ä¸ªæ¦‚å¿µä¸Šçš„ç®€åŒ–ã€‚
åœ¨ picker.lua çš„å®é™…ä»£ç ä¸­ï¼Œå¹¶æ²¡æœ‰ä¸€ä¸ªåä¸º self.state çš„ä¸­å¿ƒåŒ–çŠ¶æ€è¡¨ã€‚
è¿™ä¸ªæ’ä»¶é‡‡ç”¨äº†ä¸€ç§æ›´åˆ†æ•£çš„è®¾è®¡ï¼Œå°†çŠ¶æ€åˆ†å¸ƒåœ¨ä¸åŒçš„å­å¯¹è±¡ä¸­ï¼Œè€Œä¸æ˜¯é›†ä¸­å­˜æ”¾åœ¨ä¸€ä¸ªåœ°æ–¹ã€‚è¿™æ ·åšå¯ä»¥æ›´å¥½åœ°åˆ†ç¦»å„ä¸ªæ¨¡å—çš„å…³æ³¨ç‚¹ã€‚
åœ¨ Picker.new å‡½æ•°ä¸­ï¼ŒPicker å¯¹è±¡åˆå§‹åŒ–äº†å‡ ä¸ªå…³é”®çš„ã€æŒæœ‰çŠ¶æ€çš„å­å¯¹è±¡ï¼š
è¾“å…¥çŠ¶æ€ï¼šç”± self.input å¯¹è±¡ç®¡ç†ï¼Œå®ƒåŒ…å«äº†ç”¨æˆ·è¾“å…¥çš„æŸ¥è¯¢æ¨¡å¼ (pattern) å’Œæœç´¢è¯ (search)ã€‚
1// filepath: /Users/rainboy/test/snacks.nvim/lua/snacks/picker/core/picker.lua 2// ...existing code... 3 self.resolved_layout = layout 4 self.list = require(&#34;snacks.picker.core.list&#34;).new(self) 5 self.input = require(&#34;snacks.picker.core.input&#34;).new(self) 6 self.preview = require(&#34;snacks.picker.core.preview&#34;).new(self) 7// ...existing code... åˆ—è¡¨çŠ¶æ€ï¼šç”± self.list å¯¹è±¡ç®¡ç†ï¼Œå®ƒç®¡ç†ç€è¿‡æ»¤å’Œæ’åºåçš„æ¡ç›®ã€å½“å‰å…‰æ ‡ä½ç½®ã€å·²é€‰æ‹©çš„æ¡ç›®ç­‰ã€‚
1// filepath: /Users/rainboy/test/snacks.nvim/lua/snacks/picker/core/picker.lua 2// ...existing code... 3 M._pickers[self] = true 4 M._active[self] = true 5 6 local layout = Snacks.picker.config.layout(self.opts) 7 self.resolved_layout = layout 8 self.list = require(&#34;snacks.picker.core.list&#34;).new(self) 9 self.input = require(&#34;snacks.picker.core.input&#34;).new(self) 10 self.preview = require(&#34;snacks.picker.core.preview&#34;).new(self) 11// ...existing code... æ•°æ®æºçŠ¶æ€ï¼šç”± self.finder å¯¹è±¡ç®¡ç†ï¼Œå®ƒæŒæœ‰æ‰€æœ‰åŸå§‹çš„ã€æœªç»è¿‡æ»¤çš„æ¡ç›®ã€‚
1// filepath: /Users/rainboy/test/snacks.nvim/lua/snacks/picker/core/picker.lua 2// ...existing code... 3 self.matcher = require(&#34;snacks.picker.core.matcher&#34;).new(self.opts.matcher) 4 5 self.finder = Finder.new(Snacks.picker.config.finder(self.opts.finder) or function() 6 return self.opts.items or {} 7 end) 8 9 self.format = Snacks.picker.config.format(self.opts) 10// ...existing code... æ‰€ä»¥ï¼Œè™½ç„¶ Picker å¯¹è±¡æœ¬èº«ä¸ç›´æ¥æ‹¥æœ‰ä¸€ä¸ª state è¡¨ï¼Œä½†å®ƒé€šè¿‡åˆå§‹åŒ–å¹¶æŒæœ‰ self.inputã€self.list å’Œ self.finder ç­‰å¯¹è±¡æ¥é—´æ¥ç®¡ç†æ•´ä¸ªé€‰æ‹©å™¨çš„çŠ¶æ€ã€‚
æˆ‘ä¸ºä¹‹å‰ä¸å¤Ÿç²¾ç¡®çš„ç®€åŒ–æè¿°é“æ­‰ã€‚è¿™ä¸ªæ›´è¯¦ç»†çš„è§£é‡Šæ˜¯å¦æ¸…æ¥šï¼Ÿå¦‚æœæ¸…æ¥šï¼Œæˆ‘ä»¬å°±ç»§ç»­åˆ†æè´Ÿè´£ UI å¸ƒå±€å’Œæ¸²æŸ“çš„ core/layout.lua (æ›´æ­£ï¼šåº”è¯¥æ˜¯ snacks.layout æ¨¡å—ï¼Œå®ƒè¢« picker.lua ç”¨æ¥ç®¡ç†çª—å£å¸ƒå±€) å’Œ list.lua (å®ƒè´Ÿè´£æ¸²æŸ“åˆ—è¡¨å†…å®¹)ã€‚æˆ‘ä»¬å…ˆä» list.lua å¼€å§‹ï¼Œå› ä¸ºå®ƒç›´æ¥å¤„ç†æ¡ç›®çš„æ˜¾ç¤ºã€‚
rainboylvx: å· ç»§ç»­
GitHub Copilot: å¥½çš„ï¼Œæˆ‘ä»¬æ¥ç€åˆ†æ lua/snacks/picker/core/list.luaã€‚
è¿™ä¸ªæ–‡ä»¶å®šä¹‰äº† List ç±»ï¼Œå®ƒå…¨æƒè´Ÿè´£ç®¡ç†é€‰æ‹©å™¨ä¸­æ˜¾ç¤ºæ¡ç›®çš„åˆ—è¡¨çª—å£ã€‚å¯ä»¥æŠŠå®ƒçœ‹ä½œæ˜¯ç»“æœå±•ç¤ºåŒºçš„â€œç®¡å®¶â€ã€‚
å®ƒçš„ä¸»è¦èŒè´£å¦‚ä¸‹ï¼š
åˆ›å»ºå’Œç®¡ç†åˆ—è¡¨çª—å£ï¼š
åœ¨ List.new(picker) æ„é€ å‡½æ•°ä¸­ï¼Œå®ƒé€šè¿‡ require(&quot;snacks.win&quot;).new(...) åˆ›å»ºäº†ä¸€ä¸ª snacks.win å®ä¾‹ (self.win)ã€‚è¿™ä¸ªå®ä¾‹å°±æ˜¯æˆ‘ä»¬åœ¨å±å¹•ä¸Šçœ‹åˆ°çš„é‚£ä¸ªæµ®åŠ¨æˆ–åˆ†å‰²çš„åˆ—è¡¨çª—å£ã€‚ å®ƒä¸ºè¿™ä¸ªçª—å£è®¾ç½®äº†æ‰€æœ‰å¿…è¦çš„é€‰é¡¹ï¼Œæ¯”å¦‚ buffer é€‰é¡¹ (buftype, filetype) å’Œçª—å£é€‰é¡¹ (cursorline, number)ã€‚ çŠ¶æ€ç®¡ç†ï¼š
self.items: å­˜æ”¾ç»è¿‡åŒ¹é…å’Œæ’åºåçš„æ¡ç›®ã€‚è¿™æ˜¯å®é™…æ˜¾ç¤ºåœ¨åˆ—è¡¨ä¸­çš„æ•°æ®ã€‚ self.cursor: è®°å½•å½“å‰å…‰æ ‡æ‰€åœ¨çš„è¡Œå·ã€‚ self.selected: ä¸€ä¸ª Set é›†åˆï¼Œè®°å½•æ‰€æœ‰è¢«ç”¨æˆ·é€‰ä¸­çš„æ¡ç›®ã€‚ self.top: è®°å½•åˆ—è¡¨çª—å£æ»šåŠ¨åˆ°çš„é¡¶éƒ¨è¡Œå·ï¼Œç”¨äºå®ç°æ»šåŠ¨ã€‚ self.topk: è¿™æ˜¯ä¸€ä¸ªéå¸¸é‡è¦çš„ä¼˜åŒ–ã€‚å®ƒæ˜¯ä¸€ä¸ª TopK æ•°æ®ç»“æ„ï¼Œç”¨äºåœ¨æœ‰å¤§é‡æ¡ç›®æ—¶ï¼Œåªå¯¹æœ€åŒ¹é…çš„å‰ K ä¸ªç»“æœè¿›è¡Œæ’åºå’Œæ˜¾ç¤ºï¼Œæå¤§åœ°æé«˜äº†æ€§èƒ½ã€‚ æ¸²æŸ“å’Œæ›´æ–°ï¼š
æ ¸å¿ƒæ–¹æ³•æ˜¯ List:update()ã€‚è¿™ä¸ªæ–¹æ³•è¢« picker åœ¨éœ€è¦æ›´æ–°è§†å›¾æ—¶è°ƒç”¨ã€‚ å®ƒçš„å·¥ä½œæµç¨‹æ˜¯ï¼š a. ä» self.topk æˆ– self.items ä¸­è·å–éœ€è¦æ˜¾ç¤ºçš„æ¡ç›®ã€‚ b. ä½¿ç”¨ picker.format.item å‡½æ•°å°†æ¯ä¸ªæ¡ç›®æ•°æ®æ ¼å¼åŒ–æˆä¸€è¡Œæ–‡æœ¬ã€‚ c. è®¡ç®—å¹¶åº”ç”¨è¯­æ³•é«˜äº®ã€‚ d. æœ€åï¼Œé€šè¿‡ self.win.buf:set() å°†æ ¼å¼åŒ–å¥½çš„æ–‡æœ¬å’Œé«˜äº®ä¸€æ¬¡æ€§è®¾ç½®åˆ°åˆ—è¡¨çª—å£çš„ buffer ä¸­ï¼Œå®Œæˆæ¸²æŸ“ã€‚ List:set_items(items): è¿™ä¸ªæ–¹æ³•ç”± matcher (åŒ¹é…å™¨)è°ƒç”¨ï¼Œå½“åŒ¹é…å™¨è®¡ç®—å‡ºæ–°çš„åŒ¹é…ç»“æœæ—¶ï¼Œä¼šé€šè¿‡è¿™ä¸ªæ–¹æ³•æŠŠç»“æœäº¤ç»™ List å¯¹è±¡ã€‚ å“åº”äº¤äº’ï¼š
List:move(delta): ç§»åŠ¨å…‰æ ‡ï¼Œdelta ä¸º 1 è¡¨ç¤ºå‘ä¸‹ï¼Œ-1 è¡¨ç¤ºå‘ä¸Šã€‚å®ƒä¼šæ›´æ–° self.cursor å¹¶è§¦å‘è§†å›¾æ›´æ–°ã€‚ List:scroll(delta): æ»šåŠ¨åˆ—è¡¨ã€‚ List:toggle_selection(): åˆ‡æ¢å½“å‰å…‰æ ‡ä¸‹æ¡ç›®çš„é€‰ä¸­çŠ¶æ€ã€‚ List:current(): è·å–å½“å‰å…‰æ ‡ä¸‹çš„æ¡ç›®æ•°æ®ã€‚ æ€»ç»“ï¼šlist.lua è´Ÿè´£å°† matcher è®¡ç®—å‡ºçš„æ•°æ®ç»“æœï¼Œé€šè¿‡æ ¼å¼åŒ–ï¼Œæœ€ç»ˆæ¸²æŸ“åˆ° Neovim çš„ä¸€ä¸ªå…·ä½“çª—å£ä¸­ã€‚å®ƒç»´æŠ¤ç€åˆ—è¡¨æœ¬èº«çš„æ‰€æœ‰çŠ¶æ€ï¼ˆå¦‚å…‰æ ‡ã€æ»šåŠ¨ã€é€‰ä¸­ï¼‰ï¼Œå¹¶æä¾›æ–¹æ³•æ¥æ“ä½œè¿™äº›çŠ¶æ€ï¼Œä»¥å“åº”ç”¨æˆ·çš„äº¤äº’åŠ¨ä½œã€‚
å¯ä»¥ç†è§£ä¸ºï¼ŒPicker æ˜¯æ€»æŒ‡æŒ¥ï¼ŒMatcher æ˜¯å‚è°‹ï¼ˆè´Ÿè´£è®¡ç®—ï¼‰ï¼Œè€Œ List å°±æ˜¯æ‰§è¡Œå®˜ï¼ˆè´Ÿè´£ç”»å‡ºæ¥ï¼‰ã€‚
ä½ ç†è§£ list.lua æ˜¯å¦‚ä½•ç®¡ç†åˆ—è¡¨çª—å£å’Œæ¸²æŸ“æ•°æ®çš„å—ï¼Ÿå¦‚æœç†è§£äº†ï¼Œæˆ‘ä»¬å¯ä»¥æ¥ç€åˆ†æå®ƒçš„æ•°æ®æ¥æºâ€”â€”matcher.luaã€‚
rainboylvx: ç»§ç»­
GitHub Copilot: å¥½çš„ï¼Œæˆ‘ä»¬æ¥åˆ†æ lua/snacks/picker/core/matcher.luaã€‚
å¦‚æœè¯´ list.lua æ˜¯è´Ÿè´£å±•ç¤ºçš„æ‰§è¡Œå®˜ï¼Œé‚£ä¹ˆ matcher.lua å°±æ˜¯è´Ÿè´£ç­›é€‰å’Œè®¡ç®—çš„å‚è°‹ã€‚å®ƒæ˜¯é€‰æ‹©å™¨çš„â€œæœç´¢å¼•æ“â€æ ¸å¿ƒã€‚
å®ƒçš„ä¸»è¦èŒè´£æ˜¯ï¼š
è§£ææŸ¥è¯¢ (Matcher:init(pattern))ï¼š
è¿™ä¸ªæ¨¡å—ä¸ä¼šç›´æ¥ä½¿ç”¨ç”¨æˆ·è¾“å…¥æ¡†é‡Œçš„å®Œæ•´å­—ç¬¦ä¸²ã€‚init æ–¹æ³•ä¼šå…ˆè§£æè¿™ä¸ªå­—ç¬¦ä¸²ã€‚ å®ƒæ”¯æŒå­—æ®µåŒ–æœç´¢ã€‚ä¾‹å¦‚ï¼Œå¦‚æœç”¨æˆ·è¾“å…¥ file:core text:listï¼Œå®ƒä¼šè§£æå‡ºä¸¤ä¸ªéƒ¨åˆ†ï¼šåœ¨ file å­—æ®µä¸­æœç´¢ coreï¼Œåœ¨ text å­—æ®µä¸­æœç´¢ listã€‚ å®ƒä¹Ÿæ”¯æŒæ­£åˆ™è¡¨è¾¾å¼æœç´¢ï¼Œè¿™åœ¨ new å‡½æ•°çš„ opts.regex ä¸­é…ç½®ã€‚ åŒ¹é…ä¸è¯„åˆ† (Matcher:run(items))ï¼š
è¿™æ˜¯æœ€æ ¸å¿ƒçš„åŠŸèƒ½ã€‚å®ƒæ¥æ”¶ä¸€ä¸ªæ¡ç›®åˆ—è¡¨ (items)ï¼Œç„¶åé€ä¸€æ£€æŸ¥æ¯ä¸ªæ¡ç›®æ˜¯å¦åŒ¹é… init é˜¶æ®µè§£æå¥½çš„æŸ¥è¯¢æ¡ä»¶ã€‚ å¯¹äºæ¯ä¸ªåŒ¹é…çš„æ¡ç›®ï¼Œå®ƒä¸ä»…ä»…æ˜¯ç®€å•åœ°è¿”å›â€œæ˜¯â€æˆ–â€œå¦â€ï¼Œè€Œæ˜¯ä¼šè®¡ç®—ä¸€ä¸ªåˆ†æ•° (score)ã€‚åˆ†æ•°ä»£è¡¨äº†åŒ¹é…çš„ä¼˜åŠ£ç¨‹åº¦ï¼ˆä¾‹å¦‚ï¼Œè¿ç»­åŒ¹é…çš„åˆ†æ•°é«˜äºä¸è¿ç»­çš„ï¼‰ã€‚ å®ƒè¿˜ä¼šè®°å½•ä¸‹åŒ¹é…ä¸­çš„å…·ä½“å­—ç¬¦ä½ç½® (positions)ã€‚ å¼‚æ­¥æ‰§è¡Œï¼š
åŒ¹é…å¤§é‡æ¡ç›®å¯èƒ½æ˜¯ä¸€ä¸ªè€—æ—¶æ“ä½œï¼Œå¦‚æœç›´æ¥åœ¨ä¸»çº¿ç¨‹æ‰§è¡Œä¼šå¡ä½ Neovimã€‚ å› æ­¤ï¼Œpicker.lua ä¸­çš„ Picker:find() æ–¹æ³•ä¼šé€šè¿‡ Async.run æŠŠ matcher:run() çš„è°ƒç”¨æ”¾åˆ°ä¸€ä¸ªåå°ä»»åŠ¡ä¸­æ‰§è¡Œï¼Œä»è€Œä¿è¯äº†ç•Œé¢çš„æµç•…ã€‚ æä¾›é«˜äº®ä¿¡æ¯ (Matcher:positions(item))ï¼š
å½“ list.lua æ¸²æŸ“åˆ—è¡¨æ—¶ï¼Œå®ƒéœ€è¦çŸ¥é“å“ªäº›å­—ç¬¦åº”è¯¥è¢«é«˜äº®ä¸ºåŒ¹é…é¡¹ã€‚ list.lua ä¼šè°ƒç”¨ matcher:positions(item) æ¥è·å–è¿™äº›ç²¾ç¡®çš„ä½ç½®ä¿¡æ¯ï¼Œç„¶ååº”ç”¨ SnacksPickerMatch é«˜äº®ç»„ã€‚ æ€»ç»“ï¼šmatcher.lua æ˜¯ä¸€ä¸ªçº¯è®¡ç®—æ¨¡å—ã€‚å®ƒæ¥æ”¶æŸ¥è¯¢å­—ç¬¦ä¸²å’ŒåŸå§‹æ•°æ®ï¼Œç„¶åè¾“å‡ºå¸¦æœ‰åˆ†æ•°ï¼ˆç”¨äºæ’åºï¼‰å’Œé«˜äº®ä½ç½®ï¼ˆç”¨äºæ¸²æŸ“ï¼‰çš„åŒ¹é…ç»“æœã€‚å®ƒè¢«è®¾è®¡ä¸ºå¯å¼‚æ­¥è¿è¡Œï¼Œä»¥å¤„ç†å¤§è§„æ¨¡æ•°æ®é›†è€Œä¸å½±å“ç”¨æˆ·ä½“éªŒã€‚
å®ƒä¸å…¶å®ƒæ¨¡å—çš„åä½œæµç¨‹å¦‚ä¸‹ï¼š
picker.lua ä» input.lua è·å–ç”¨æˆ·è¾“å…¥çš„ patternã€‚ picker.lua è°ƒç”¨ matcher:init(pattern) æ¥å‡†å¤‡åŒ¹é…å™¨ã€‚ picker.lua åœ¨åå°ä»»åŠ¡ä¸­è°ƒç”¨ matcher:run(items)ï¼Œå…¶ä¸­ items æ¥è‡ª finder.luaã€‚ matcher è¿”å›åŒ¹é…ç»“æœç»™ pickerã€‚ picker å°†ç»“æœäº¤ç»™ list.lua è¿›è¡Œå¤„ç†å’Œæœ€ç»ˆæ¸²æŸ“ã€‚ ä½ ç†è§£ matcher.lua æ˜¯å¦‚ä½•å¤„ç†æœç´¢ã€è¯„åˆ†å’Œé«˜äº®ä¿¡æ¯çš„å—ï¼Ÿå¦‚æœç†è§£ï¼Œæˆ‘ä»¬ä¸‹ä¸€ä¸ªè¦åˆ†æçš„å°±æ˜¯ä¸ºå®ƒæä¾›åŸå§‹æ•°æ®çš„ finder.luaã€‚
rainboylvx: å¥½çš„,ç»§ç»­
GitHub Copilot: å¥½çš„ï¼Œæˆ‘ä»¬ç»§ç»­ã€‚ç°åœ¨æˆ‘ä»¬æ¥åˆ†æ lua/snacks/picker/core/finder.luaã€‚
è¿™ä¸ªæ–‡ä»¶å®šä¹‰äº† Finder ç±»ï¼Œå®ƒçš„è§’è‰²éå¸¸ä¸“ä¸€ï¼šä¸ºé€‰æ‹©å™¨æä¾›åŸå§‹çš„ã€æœªç»ç­›é€‰çš„æ¡ç›®åˆ—è¡¨ã€‚å¯ä»¥æŠŠå®ƒçœ‹ä½œæ˜¯æ•°æ®æºçš„æ‰§è¡Œè€…ã€‚
å®ƒçš„æ ¸å¿ƒèŒè´£å¦‚ä¸‹ï¼š
æ•°æ®è·å– (Finder:run())ï¼š
è¿™æ˜¯ Finder æœ€é‡è¦çš„æ–¹æ³•ã€‚å½“ picker éœ€è¦æ•°æ®æ—¶ï¼Œå°±ä¼šè°ƒç”¨å®ƒã€‚ Finder æœ¬èº«å¹¶ä¸çŸ¥é“å¦‚ä½•è·å–æ•°æ®ï¼ˆæ¯”å¦‚ä¸çŸ¥é“å¦‚ä½•æœç´¢æ–‡ä»¶æˆ–åˆ—å‡ºç¼“å†²åŒºï¼‰ã€‚å®ƒä¾èµ–äºä¸€ä¸ªåœ¨åˆ›å»ºæ—¶ä¼ å…¥çš„å‡½æ•°ã€‚ è¿™ä¸ªå‡½æ•°ï¼ˆåœ¨ picker.lua ä¸­é€šè¿‡ Snacks.picker.config.finder(self.opts.finder) è·å–ï¼‰æ‰æ˜¯çœŸæ­£æ‰§è¡Œæ•°æ®æŸ¥æ‰¾é€»è¾‘çš„åœ°æ–¹ã€‚ä¾‹å¦‚ï¼Œå¯¹äºæ–‡ä»¶æœç´¢ï¼Œè¿™ä¸ªå‡½æ•°å¯èƒ½ä¼šè°ƒç”¨ find æˆ– ripgrep å‘½ä»¤ã€‚ å¼‚æ­¥æ‰§è¡Œï¼š
æ•°æ®è·å–å¾€å¾€æ˜¯è€—æ—¶æ“ä½œï¼ˆå¦‚ç£ç›˜ I/Oï¼‰ã€‚ä¸ºäº†ä¸é˜»å¡ Neovim çš„ä¸»çº¿ç¨‹ï¼ŒFinder:run() ä½¿ç”¨äº† Async.new å°†æ•°æ®è·å–å‡½æ•°æ”¾åˆ°ä¸€ä¸ªåå°åç¨‹ä¸­è¿è¡Œã€‚ å®ƒé€šè¿‡ self.task å¯¹è±¡æ¥ç®¡ç†è¿™ä¸ªåå°ä»»åŠ¡ã€‚picker å’Œ matcher å¯ä»¥é€šè¿‡ finder.task:running() æ¥æ£€æŸ¥æ•°æ®æºæ˜¯å¦è¿˜åœ¨åŠ è½½ä¸­ã€‚ æ•°æ®å­˜å‚¨å’Œæµå¼å¤„ç†ï¼š
finder æ‰¾åˆ°çš„æ•°æ®ä¼šå­˜æ”¾åœ¨ self.items è¿™ä¸ªè¡¨ä¸­ã€‚ å®ƒæ”¯æŒæµå¼å¤„ç†ã€‚æ•°æ®è·å–å‡½æ•°å¯ä»¥ä¸ä¸€æ¬¡æ€§è¿”å›æ‰€æœ‰ç»“æœï¼Œè€Œæ˜¯é€šè¿‡ä¸€ä¸ªå›è°ƒå‡½æ•° (self:add(items)) é€æ‰¹æ¬¡åœ°æ·»åŠ æ•°æ®ã€‚è¿™å…è®¸ matcher åœ¨ finder è¿˜åœ¨è¿è¡Œæ—¶å°±å¼€å§‹å¤„ç†å·²ç»åˆ°è¾¾çš„æ•°æ®ï¼Œå®ç°äº†é«˜æ•ˆçš„æµæ°´çº¿ä½œä¸šï¼Œè®©ç”¨æˆ·èƒ½æ›´å¿«åœ°çœ‹åˆ°éƒ¨åˆ†ç»“æœã€‚ ç¼“å­˜ (finders è¡¨)ï¼š
åœ¨æ–‡ä»¶é¡¶éƒ¨ï¼Œæœ‰ä¸€ä¸ª finders è¡¨ï¼Œå®ƒä»¥ finder å‡½æ•°ä¸ºé”®æ¥ç¼“å­˜ Finder å®ä¾‹ã€‚è¿™æ„å‘³ç€å¦‚æœå¤šä¸ªé€‰æ‹©å™¨ä½¿ç”¨å®Œå…¨ç›¸åŒçš„æ•°æ®è·å–é€»è¾‘ï¼Œå®ƒä»¬å¯ä»¥å…±äº«åŒä¸€ä¸ª Finder å®ä¾‹å’Œå…¶ç¼“å­˜çš„ç»“æœï¼Œé¿å…äº†é‡å¤å·¥ä½œã€‚ æ€»ç»“ï¼šfinder.lua åªæ˜¯ä¸€ä¸ªæ‰§è¡Œæ¡†æ¶ã€‚å®ƒæä¾›äº†ä¸€ä¸ªå¼‚æ­¥çš„ã€æ”¯æŒæµå¼å¤„ç†çš„è¿è¡Œç¯å¢ƒï¼Œä½†å®é™…çš„æ•°æ®è·å–é€»è¾‘åˆ™å®Œå…¨å§”æ‰˜ç»™äº†å¤–éƒ¨ä¼ å…¥çš„ä¸€ä¸ªå‡½æ•°ã€‚
å®ƒåœ¨æ•´ä¸ªæµç¨‹ä¸­çš„ä½ç½®æ˜¯ç¬¬ä¸€ç«™ï¼š
Finder åœ¨åå°è¿è¡Œï¼Œè·å–åŸå§‹æ•°æ®ï¼Œå¹¶æŠŠç»“æœæ”¾å…¥ finder.itemsã€‚ Matcher ç›‘è§† finder.itemsï¼Œä¸€æ—¦æœ‰æ–°æ•°æ®å°±è¿›è¡ŒåŒ¹é…å’Œè¯„åˆ†ã€‚ List æ ¹æ® Matcher çš„ç»“æœè¿›è¡Œæ’åºå’Œæ¸²æŸ“ã€‚ ä½ ç†è§£ finder.lua æ˜¯å¦‚ä½•ä½œä¸ºæ•°æ®æºçš„æ‰§è¡Œè€…ï¼Œå¹¶ä»¥å¼‚æ­¥æµå¼çš„æ–¹å¼æä¾›åŸå§‹æ•°æ®çš„å—ï¼Ÿå¦‚æœç†è§£äº†ï¼Œæˆ‘ä»¬æ¥ä¸‹æ¥å¯ä»¥çœ‹çœ‹è§¦å‘è¿™ä¸€åˆ‡çš„èµ·ç‚¹ï¼šinput.luaï¼Œå®ƒè´Ÿè´£å¤„ç†ç”¨æˆ·çš„è¾“å…¥ã€‚
rainboylvx: å¥½çš„
GitHub Copilot: å¥½çš„ï¼Œæˆ‘ä»¬æ¥åˆ†æ lua/snacks/picker/core/input.luaã€‚
è¿™ä¸ªæ–‡ä»¶å®šä¹‰äº† Input ç±»ï¼Œå®ƒè´Ÿè´£ç®¡ç†é€‰æ‹©å™¨ä¸­ç”¨æˆ·è¾“å…¥çš„é‚£ä¸€è¡Œæç¤ºç¬¦ã€‚å®ƒæ˜¯ç”¨æˆ·ä¸é€‰æ‹©å™¨äº¤äº’çš„ç›´æ¥å…¥å£ã€‚
å®ƒçš„æ ¸å¿ƒèŒè´£å¦‚ä¸‹ï¼š
åˆ›å»ºè¾“å…¥çª—å£ï¼š
ä¸ list.lua ç±»ä¼¼ï¼ŒInput.new(picker) æ„é€ å‡½æ•°ä¹Ÿä¼šé€šè¿‡ require(&quot;snacks.win&quot;).new(...) åˆ›å»ºä¸€ä¸ª snacks.win å®ä¾‹ã€‚è¿™ä¸ªå®ä¾‹å°±æ˜¯æˆ‘ä»¬çœ‹åˆ°çš„ã€ç”¨äºè¾“å…¥æœç´¢è¯çš„é‚£ä¸ªå°çª—å£ã€‚ å®ƒä¼šä¸ºè¿™ä¸ªçª—å£çš„ buffer è®¾ç½®ç‰¹æ®Šçš„é€‰é¡¹ï¼Œæ¯”å¦‚ modifiable = true å…è®¸ç”¨æˆ·è¾“å…¥ï¼Œå¹¶è®¾ç½® filetype ä¸º snacks-input ä»¥åº”ç”¨ç‰¹å®šçš„è¯­æ³•å’Œè¡Œä¸ºã€‚ å¤„ç†é”®ç›˜è¾“å…¥ï¼š
è¿™æ˜¯ Input ç±»çš„æ ¸å¿ƒã€‚å®ƒé€šè¿‡ vim.api.nvim_buf_attach ç›‘å¬ buffer çš„å˜åŒ– (on_bytes)ã€‚ å½“ç”¨æˆ·è¾“å…¥æˆ–åˆ é™¤å­—ç¬¦æ—¶ï¼Œè¿™ä¸ªå›è°ƒå‡½æ•°ä¼šè¢«è§¦å‘ã€‚ ç®¡ç†æŸ¥è¯¢æ¨¡å¼ (self.pattern)ï¼š
å®ƒç»´æŠ¤ç€å½“å‰è¾“å…¥æ¡†ä¸­çš„å®Œæ•´æ–‡æœ¬ï¼Œå³ self.patternã€‚ å½“æ–‡æœ¬å‘ç”Ÿå˜åŒ–æ—¶ï¼Œå®ƒä¸ä¼šç«‹å³è§¦å‘æœç´¢ï¼Œè€Œæ˜¯ä½¿ç”¨ vim.defer_fn åŠ ä¸Šä¸€ä¸ªå»¶è¿Ÿ (picker.opts.debounce)ã€‚è¿™æ˜¯ä¸€ç§é˜²æŠ–æŠ€æœ¯ï¼Œé¿å…äº†åœ¨ç”¨æˆ·å¿«é€Ÿè¾“å…¥æ—¶è¿›è¡Œå¤§é‡ä¸å¿…è¦çš„é‡å¤æœç´¢ï¼Œæ˜¾è‘—æå‡äº†æ€§èƒ½ã€‚ è§¦å‘æœç´¢ (picker:find())ï¼š
å½“é˜²æŠ–è®¡æ—¶å™¨åˆ°æœŸåï¼Œå®ƒä¼šè°ƒç”¨ picker:find(self.pattern)ã€‚è¿™ä¸ªè°ƒç”¨å°±æ˜¯æ•´ä¸ªâ€œæŸ¥æ‰¾-åŒ¹é…-æ¸²æŸ“â€æµç¨‹çš„èµ·ç‚¹ã€‚ æ˜ å°„æŒ‰é”®åˆ°åŠ¨ä½œ (picker:actions())ï¼š
è¾“å…¥çª—å£ä¸ä»…å¤„ç†æ–‡æœ¬è¾“å…¥ï¼Œè¿˜è¦å¤„ç†åŠŸèƒ½é”®ï¼Œå¦‚ &lt;Enter&gt;, &lt;Up&gt;, &lt;Down&gt;, &lt;Tab&gt; ç­‰ã€‚ å®ƒé€šè¿‡åœ¨ buffer ä¸Šè®¾ç½®æœ¬åœ°é”®ä½æ˜ å°„ (buf:map) æ¥å®ç°è¿™ä¸€ç‚¹ã€‚ å½“ç”¨æˆ·æŒ‰ä¸‹è¿™äº›é”®æ—¶ï¼Œæ˜ å°„ä¼šè°ƒç”¨ picker:actions(action_name)ã€‚ä¾‹å¦‚ï¼ŒæŒ‰ä¸‹ &lt;Down&gt; ä¼šè°ƒç”¨ picker:actions(&quot;move_down&quot;). picker å¯¹è±¡æ¥æ”¶åˆ°è¿™ä¸ªæŒ‡ä»¤åï¼Œä¼šå»è°ƒç”¨ list.lua ä¸­å¯¹åº”çš„å‡½æ•°æ¥ç§»åŠ¨å…‰æ ‡ã€‚ æ€»ç»“ï¼šinput.lua æ˜¯ä¸€ä¸ªâ€œå‘½ä»¤è§£é‡Šå™¨â€ã€‚å®ƒæ•è·ç”¨æˆ·çš„æ‰€æœ‰æŒ‰é”®è¾“å…¥ï¼Œå¹¶åšå‡ºåŒºåˆ†ï¼š
å¦‚æœæ˜¯æ–‡æœ¬å­—ç¬¦ï¼Œå°±æ›´æ–°æŸ¥è¯¢å­—ç¬¦ä¸²ï¼Œå¹¶åœ¨å»¶è¿Ÿåè§¦å‘ picker çš„æœç´¢æµç¨‹ã€‚ å¦‚æœæ˜¯åŠŸèƒ½é”®ï¼Œå°±å°†å…¶ç¿»è¯‘æˆä¸€ä¸ªâ€œåŠ¨ä½œâ€åç§°ï¼Œå¹¶å‘½ä»¤ picker å»æ‰§è¡Œè¿™ä¸ªåŠ¨ä½œã€‚ è‡³æ­¤ï¼Œæˆ‘ä»¬å·²ç»åˆ†æäº†æ„æˆé€‰æ‹©å™¨æ ¸å¿ƒ UI çš„å‡ ä¸ªéƒ¨åˆ†ï¼š
picker.lua: æ€»æŒ‡æŒ¥ã€‚ finder.lua: æ•°æ®é‡‡é›†å‘˜ã€‚ matcher.lua: æ•°æ®åˆ†æå¸ˆã€‚ list.lua: ç»“æœå±•ç¤ºæ¿ã€‚ input.lua: å‘½ä»¤è¾“å…¥ç«¯ã€‚ ä½ ç†è§£ input.lua æ˜¯å¦‚ä½•æ•è·ç”¨æˆ·è¾“å…¥å¹¶é©±åŠ¨æ•´ä¸ªé€‰æ‹©å™¨å·¥ä½œçš„å—ï¼Ÿå¦‚æœç†è§£äº†ï¼Œæˆ‘ä»¬æ¥ä¸‹æ¥å¯ä»¥çœ‹çœ‹å®ƒæ˜¯å¦‚ä½•æ‰§è¡Œå„ç§æ“ä½œçš„ï¼Œæ¯”å¦‚ç¡®è®¤é€‰æ‹©ã€å…³é—­çª—å£ç­‰ï¼Œä¹Ÿå°±æ˜¯åˆ†æ lua/snacks/picker/actions.luaã€‚
rainboylvx: å¥½çš„
GitHub Copilot: å¥½çš„ï¼Œæˆ‘ä»¬æ¥åˆ†æ lua/snacks/picker/actions.luaã€‚
è¿™ä¸ªæ–‡ä»¶éå¸¸ç›´æ¥ï¼Œå®ƒæ˜¯ä¸€ä¸ªåŠ¨ä½œåº“ã€‚å®ƒå®šä¹‰äº†ç”¨æˆ·å¯ä»¥åœ¨é€‰æ‹©å™¨ä¸­æ‰§è¡Œçš„æ‰€æœ‰æ ‡å‡†æ“ä½œï¼Œæ¯”å¦‚é€‰æ‹©æ¡ç›®ã€ç§»åŠ¨å…‰æ ‡ã€å…³é—­çª—å£ç­‰ã€‚
å®ƒçš„ç»“æ„å¾ˆç®€å•ï¼šä¸€ä¸ªè¿”å›åŒ…å«å¤šä¸ªå‡½æ•°çš„ Lua è¡¨ã€‚æ¯ä¸ªå‡½æ•°éƒ½ä»£è¡¨ä¸€ä¸ªå…·ä½“çš„åŠ¨ä½œã€‚
æ ¸å¿ƒå·¥ä½œæ–¹å¼ï¼š
å®šä¹‰åŠ¨ä½œå‡½æ•°ï¼š
æ¯ä¸ªå‡½æ•°éƒ½æ¥å— picker å®ä¾‹ä½œä¸ºç¬¬ä¸€ä¸ªå‚æ•°ï¼Œè¿™æ ·å®ƒå°±èƒ½è®¿é—®å’Œæ“ä½œé€‰æ‹©å™¨çš„æ‰€æœ‰éƒ¨åˆ†ï¼ˆå¦‚ picker.list, picker.ui ç­‰ï¼‰ã€‚ ä¾‹å¦‚ M.move_down(picker) è¿™ä¸ªå‡½æ•°ï¼Œå®ƒçš„å®ç°éå¸¸ç®€å•ï¼špicker.list:move(1)ã€‚å®ƒè‡ªå·±ä¸åšä»»ä½•å¤æ‚è®¡ç®—ï¼Œè€Œæ˜¯å°†â€œå‘ä¸‹ç§»åŠ¨â€è¿™ä¸ªæŒ‡ä»¤å§”æ‰˜ç»™äº† list æ¨¡å—å»å¤„ç†ã€‚ å®ç°æ ¸å¿ƒé€»è¾‘ï¼ˆå¦‚ selectï¼‰ï¼š
M.select(picker, opts) æ˜¯æœ€é‡è¦çš„åŠ¨ä½œä¹‹ä¸€ã€‚å½“ç”¨æˆ·æŒ‰å›è½¦ç¡®è®¤é€‰æ‹©æ—¶ï¼Œè¿™ä¸ªå‡½æ•°ä¼šè¢«è°ƒç”¨ã€‚ å®ƒçš„å·¥ä½œæµç¨‹æ˜¯ï¼š a. ä» picker.list è·å–å½“å‰é€‰ä¸­çš„æ¡ç›®ã€‚ b. è°ƒç”¨ picker:close() å…³é—­é€‰æ‹©å™¨ UIã€‚ c. æ‰§è¡Œå›è°ƒï¼šæœ€å…³é”®çš„ä¸€æ­¥æ˜¯ picker.opts.on_select(selection)ã€‚å®ƒä¼šè°ƒç”¨åˆ›å»ºé€‰æ‹©å™¨æ—¶ä¼ å…¥çš„ on_select å›è°ƒå‡½æ•°ï¼Œå¹¶å°†ç”¨æˆ·é€‰æ‹©çš„æ¡ç›®ä½œä¸ºå‚æ•°ä¼ é€’è¿‡å»ã€‚è¿™æ­£æ˜¯æ’ä»¶å®ç°â€œé€‰æ‹©ååšäº‹â€ï¼ˆå¦‚æ‰“å¼€æ–‡ä»¶ã€æ‰§è¡Œå‘½ä»¤ï¼‰çš„æ–¹å¼ã€‚ ä½œä¸ºä¸­å¤®è°ƒåº¦å™¨ï¼š
actions.lua çš„ä½œç”¨æ˜¯å°†ä¸€ä¸ªæŠ½è±¡çš„â€œåŠ¨ä½œåç§°â€ï¼ˆå¦‚ &quot;move_down&quot;ï¼‰å’Œä¸€ä¸ªå…·ä½“çš„å®ç°ï¼ˆpicker.list:move(1)ï¼‰å…³è”èµ·æ¥ã€‚ å½“ input.lua æ•è·åˆ°ä¸€ä¸ªåŠŸèƒ½é”®ï¼ˆæ¯”å¦‚ Down é”®ï¼‰æ—¶ï¼Œå®ƒä¼šå‘Šè¯‰ picker å¯¹è±¡ï¼šâ€œè¯·æ‰§è¡Œ move_down åŠ¨ä½œâ€ã€‚picker å¯¹è±¡éšåä¼šæŸ¥æ‰¾å¹¶è°ƒç”¨ actions.lua ä¸­å¯¹åº”çš„å‡½æ•°ã€‚ æ€»ç»“ï¼šactions.lua æ˜¯ä¸€ä¸ªå‘½ä»¤ä¸­å¿ƒï¼Œå®ƒå°†ç”¨æˆ·æ„å›¾ï¼ˆå¦‚â€œå‘ä¸‹ç§»åŠ¨â€ï¼‰è½¬åŒ–ä¸ºå¯¹ç›¸åº”æ¨¡å—ï¼ˆå¦‚ list æ¨¡å—ï¼‰çš„å…·ä½“å‡½æ•°è°ƒç”¨ã€‚å®ƒæœ¬èº«é€»è¾‘å¾ˆè½»ï¼Œä¸»è¦èµ·åˆ°äº†ç»„ç»‡å’Œå§”æ‰˜çš„ä½œç”¨ï¼Œä½¿å¾—é”®ä½æ˜ å°„å’ŒåŠ¨ä½œå®ç°å¾—ä»¥è§£è€¦ã€‚
åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬å·²ç»å®Œæ•´åœ°è¿‡äº†ä¸€éä»ç”¨æˆ·è¾“å…¥åˆ°æœ€ç»ˆæ‰§è¡ŒåŠ¨ä½œçš„æ•´ä¸ªæ ¸å¿ƒæµç¨‹ã€‚
ä½ ç†è§£ actions.lua æ˜¯å¦‚ä½•ä½œä¸ºåŠ¨ä½œåº“æ¥å“åº”ç”¨æˆ·æ“ä½œçš„å—ï¼Ÿå¦‚æœç†è§£äº†ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å¯ä»¥çœ‹çœ‹ä¸€äº›è¾…åŠ©ä½†åŒæ ·é‡è¦çš„éƒ¨åˆ†ï¼Œæ¯”å¦‚è´Ÿè´£é…ç½®çš„ config.luaï¼Œæˆ–è€…è´Ÿè´£é¢„è§ˆçª—å£çš„ preview.luaã€‚æˆ‘ä»¬å…ˆåˆ†æ preview.lua å§ã€‚
rainboylvx: ç»§ç»­
GitHub Copilot: å¥½çš„ï¼Œæˆ‘ä»¬æ¥åˆ†æ lua/snacks/picker/core/preview.luaã€‚
è¿™ä¸ªæ–‡ä»¶å®šä¹‰äº† Preview ç±»ï¼Œå®ƒä¸“é—¨è´Ÿè´£ç®¡ç†é€‰æ‹©å™¨å³ä¾§ï¼ˆæˆ–åº•éƒ¨ç­‰ï¼‰çš„é¢„è§ˆçª—å£ã€‚å½“ä½ çš„å…‰æ ‡åœ¨æ¡ç›®åˆ—è¡¨ä¸Šç§»åŠ¨æ—¶ï¼Œè¿™ä¸ªçª—å£ä¼šæ˜¾ç¤ºè¯¥æ¡ç›®çš„è¯¦ç»†ä¿¡æ¯ï¼Œæ¯”å¦‚æ–‡ä»¶å†…å®¹ã€Git diff ç­‰ã€‚
å®ƒçš„æ ¸å¿ƒèŒè´£å¦‚ä¸‹ï¼š
åˆ›å»ºé¢„è§ˆçª—å£ï¼š
Preview.new(picker) æ„é€ å‡½æ•°åŒæ ·ä½¿ç”¨ require(&quot;snacks.win&quot;).new(...) åˆ›å»ºä¸€ä¸ª snacks.win å®ä¾‹ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬çœ‹åˆ°çš„é¢„è§ˆçª—å£ã€‚ å®ƒä¼šä¸ºè¿™ä¸ªçª—å£è®¾ç½®å¿…è¦çš„é€‰é¡¹ï¼Œä¾‹å¦‚ filetypeï¼Œä»¥ä¾¿å¯¹é¢„è§ˆå†…å®¹è¿›è¡Œæ­£ç¡®çš„è¯­æ³•é«˜äº®ã€‚ å†³å®šå¦‚ä½•é¢„è§ˆ (Preview:resolve(item))ï¼š
Preview ç±»æœ¬èº«ä¸çŸ¥é“å¦‚ä½•é¢„è§ˆä¸€ä¸ªæ¡ç›®ã€‚å®ƒéœ€è¦ä¸€ä¸ªé¢„è§ˆå™¨ (previewer) å‡½æ•°æ¥æä¾›å†…å®¹ã€‚ resolve æ–¹æ³•çš„ä½œç”¨å°±æ˜¯ä¸ºç»™å®šçš„æ¡ç›® item æ‰¾åˆ°æ­£ç¡®çš„é¢„è§ˆå™¨å‡½æ•°ã€‚å®ƒä¼šæ£€æŸ¥ picker.opts.preview é…ç½®ï¼Œè¿™ä¸ªé…ç½®å¯ä»¥å°†ä¸åŒçš„æ–‡ä»¶ç±»å‹æˆ–æ•°æ®æºæ˜ å°„åˆ°ä¸åŒçš„é¢„è§ˆå™¨å‡½æ•°ã€‚ä¾‹å¦‚ï¼Œ.md æ–‡ä»¶å¯ä»¥ä½¿ç”¨ Markdown é¢„è§ˆå™¨ï¼Œå›¾ç‰‡æ–‡ä»¶å¯ä»¥ä½¿ç”¨å›¾ç‰‡é¢„è§ˆå™¨ã€‚ è¿™äº›å…·ä½“çš„é¢„è§ˆå™¨å‡½æ•°é€šå¸¸å®šä¹‰åœ¨ lua/snacks/picker/previewers.lua æ–‡ä»¶ä¸­ã€‚ æ˜¾ç¤ºé¢„è§ˆå†…å®¹ (Preview:show(item))ï¼š
è¿™æ˜¯ Preview ç±»çš„æ ¸å¿ƒå…¥å£ã€‚å½“é€‰æ‹©å™¨éœ€è¦æ›´æ–°é¢„è§ˆæ—¶ï¼ˆé€šå¸¸æ˜¯å…‰æ ‡ç§»åŠ¨åï¼‰ï¼Œpicker å¯¹è±¡ä¼šè°ƒç”¨è¿™ä¸ªæ–¹æ³•ã€‚ å®ƒçš„å·¥ä½œæµç¨‹æ˜¯ï¼š a. è°ƒç”¨ self:resolve(item) æ‰¾åˆ°åˆé€‚çš„é¢„è§ˆå™¨å‡½æ•°ã€‚ b. å¼‚æ­¥æ‰§è¡Œé¢„è§ˆå™¨ï¼šå› ä¸ºè·å–é¢„è§ˆå†…å®¹ï¼ˆå¦‚è¯»å–å¤§æ–‡ä»¶ï¼‰å¯èƒ½å¾ˆè€—æ—¶ï¼Œå®ƒä¼šå°†é¢„è§ˆå™¨å‡½æ•°çš„æ‰§è¡ŒåŒ…è£¹åœ¨ Async.run ä¸­ï¼Œé˜²æ­¢é˜»å¡ UIã€‚ c. è·å–åˆ°é¢„è§ˆå†…å®¹ï¼ˆæ¯”å¦‚ä¸€ä¸ªæ–‡ä»¶è·¯å¾„ï¼Œæˆ–è€…ä¸€ä¸ªå­—ç¬¦ä¸²åˆ—è¡¨ï¼‰åï¼Œè°ƒç”¨ self:render(content)ã€‚ æ¸²æŸ“å†…å®¹ (Preview:render(content))ï¼š
è¿™ä¸ªæ–¹æ³•æ¥æ”¶é¢„è§ˆå™¨è¿”å›çš„å†…å®¹ï¼Œå¹¶å°†å…¶æ˜¾ç¤ºåœ¨é¢„è§ˆçª—å£çš„ buffer ä¸­ã€‚ å®ƒèƒ½å¤„ç†ä¸åŒç±»å‹çš„å†…å®¹ï¼š å¦‚æœå†…å®¹æ˜¯æ–‡ä»¶è·¯å¾„ï¼Œå®ƒä¼šåŠ è½½è¯¥æ–‡ä»¶åˆ° buffer ä¸­ã€‚ å¦‚æœå†…å®¹æ˜¯å­—ç¬¦ä¸²åˆ—è¡¨ï¼Œå®ƒä¼šå°†è¿™äº›è¡Œå†™å…¥ bufferã€‚ å®ƒè¿˜ä¼šè´Ÿè´£è®¾ç½®æ­£ç¡®çš„è¯­æ³•é«˜äº® (filetype)ã€‚ æ€»ç»“ï¼špreview.lua æ‰®æ¼”äº†ä¸€ä¸ªâ€œå†…å®¹å±•ç¤ºæ¿â€çš„è§’è‰²ã€‚å®ƒä¸ç”Ÿäº§å†…å®¹ï¼Œè€Œæ˜¯ä½œä¸º picker å’Œå…·ä½“ previewer å‡½æ•°ä¹‹é—´çš„æ¡¥æ¢ã€‚å®ƒç®¡ç†ç€é¢„è§ˆçª—å£çš„ç”Ÿå‘½å‘¨æœŸï¼Œå¹¶æ ¹æ®é…ç½®è°ƒç”¨æ­£ç¡®çš„ previewer å‡½æ•°æ¥è·å–å†…å®¹ï¼Œç„¶åå°†å†…å®¹å¼‚æ­¥åœ°æ¸²æŸ“å‡ºæ¥ã€‚
è¿™ä¸ªæ¨¡å—çš„å¼‚æ­¥è®¾è®¡å¯¹äºä¿æŒæµç•…çš„ç”¨æˆ·ä½“éªŒè‡³å…³é‡è¦ã€‚
ä½ ç†è§£ preview.lua æ˜¯å¦‚ä½•ç®¡ç†é¢„è§ˆçª—å£å¹¶å±•ç¤ºå†…å®¹çš„å—ï¼Ÿå¦‚æœç†è§£äº†ï¼Œæˆ‘ä»¬æ¥ä¸‹æ¥åˆ†æ lua/snacks/picker/config.luaï¼Œçœ‹çœ‹è¿™ä¸ªæ’ä»¶æ˜¯å¦‚ä½•è¿›è¡Œé…ç½®çš„ã€‚
rainboylvx: å¥½
GitHub Copilot: å¥½çš„ï¼Œæˆ‘ä»¬æ¥åˆ†æ lua/snacks/picker/config.luaã€‚
è¿™ä¸ªæ–‡ä»¶æ˜¯æ•´ä¸ª snacks.picker æ¨¡å—çš„é…ç½®ä¸­å¿ƒã€‚æ‰€æœ‰å…³äºé€‰æ‹©å™¨å¤–è§‚ã€è¡Œä¸ºã€æ•°æ®æºç­‰çš„é»˜è®¤è®¾ç½®å’Œç”¨æˆ·è‡ªå®šä¹‰è®¾ç½®éƒ½åœ¨è¿™é‡Œè¢«ç®¡ç†å’Œåˆå¹¶ã€‚
å®ƒçš„æ ¸å¿ƒèŒè´£å¦‚ä¸‹ï¼š
å®šä¹‰é»˜è®¤å€¼ (M.defaults)ï¼š
æ–‡ä»¶å†…éƒ¨æœ‰ä¸€ä¸ªå·¨å¤§çš„ M.defaults è¡¨ã€‚è¿™ä¸ªè¡¨å®šä¹‰äº†é€‰æ‹©å™¨æ‰€æœ‰å¯é…ç½®é¡¹çš„å‡ºå‚è®¾ç½®ã€‚ å®ƒæ¶µç›–äº†æ–¹æ–¹é¢é¢ï¼ŒåŒ…æ‹¬ï¼š win: çª—å£çš„å¤–è§‚ï¼ˆè¾¹æ¡†ã€æ ‡é¢˜ã€é«˜äº®ï¼‰ã€‚ layout: çª—å£çš„å¸ƒå±€ï¼ˆæ¯”å¦‚ flex å¸ƒå±€ï¼‰ã€‚ finder, sorter, matcher: æ•°æ®æŸ¥æ‰¾ã€æ’åºã€åŒ¹é…çš„é»˜è®¤ç®—æ³•å’Œè¡Œä¸ºã€‚ actions: é»˜è®¤çš„æŒ‰é”®æ˜ å°„å’ŒåŠ¨ä½œã€‚ sources: ä¸ºå†…ç½®çš„å„ç§é€‰æ‹©å™¨ï¼ˆå¦‚æ–‡ä»¶ã€ç¼“å†²åŒºï¼‰æä¾›çš„ç‰¹å®šé…ç½®ã€‚ åˆå¹¶é…ç½® (M.setup(opts))ï¼š
è¿™æ˜¯ç”¨æˆ·åœ¨è‡ªå·±çš„ Neovim é…ç½®ä¸­è°ƒç”¨çš„å‡½æ•°ï¼Œç”¨äºè®¾ç½®æ’ä»¶ã€‚ å®ƒæ¥æ”¶ç”¨æˆ·æä¾›çš„é…ç½® optsï¼Œå¹¶ä½¿ç”¨ vim.tbl_deep_extend å°†å…¶ä¸ M.defaults è¿›è¡Œæ·±åº¦åˆå¹¶ã€‚ç”¨æˆ·çš„è®¾ç½®ä¼šè¦†ç›–é»˜è®¤è®¾ç½®ã€‚ åˆå¹¶åçš„æœ€ç»ˆé…ç½®å­˜å‚¨åœ¨æ¨¡å—çº§çš„ config å˜é‡ä¸­ã€‚ æä¾›é…ç½®æŸ¥è¯¢ (M.get(), M.wrap(), M.layout(), etc.)ï¼š
M.get(): è®©æ’ä»¶çš„å…¶ä»–éƒ¨åˆ†å¯ä»¥éšæ—¶è·å–å½“å‰ç”Ÿæ•ˆçš„å®Œæ•´é…ç½®ã€‚ M.wrap(source, opts): è¿™æ˜¯ä¸€ä¸ªéå¸¸é‡è¦çš„å‡½æ•°ã€‚å½“åˆ›å»ºä¸€ä¸ªæ–°çš„é€‰æ‹©å™¨æ—¶ï¼ˆæ¯”å¦‚ M.pick(&quot;files&quot;, {})ï¼‰ï¼Œpicker.lua ä¼šè°ƒç”¨è¿™ä¸ªå‡½æ•°ã€‚å®ƒä¼šæ™ºèƒ½åœ°åˆå¹¶å¤šä¸ªé…ç½®å±‚çº§ï¼š å…¨å±€é»˜è®¤é…ç½® (M.defaults)ã€‚ è¯¥æ•°æ®æº (source) çš„é»˜è®¤é…ç½® (ä¾‹å¦‚ M.defaults.sources.files)ã€‚ ç”¨æˆ·ä¸ºè¯¥æ•°æ®æºè®¾ç½®çš„å…¨å±€é…ç½®ã€‚ æœ¬æ¬¡è°ƒç”¨ä¸´æ—¶ä¼ å…¥çš„é…ç½® (opts)ã€‚ è¿™æ ·å°±å®ç°äº†çµæ´»çš„ã€åˆ†å±‚çº§çš„é…ç½®è¦†ç›–ã€‚ M.layout(), M.preview(), M.finder() ç­‰ï¼šè¿™äº›æ˜¯è¾…åŠ©å‡½æ•°ï¼Œç”¨äºä»å¤æ‚çš„é…ç½®è¡¨ä¸­è§£æå‡ºå½“å‰éœ€è¦ä½¿ç”¨çš„å…·ä½“å®ç°ï¼ˆæ¯”å¦‚ï¼Œæ ¹æ®é…ç½®è¿”å› flex å¸ƒå±€å‡½æ•°è¿˜æ˜¯ vertical å¸ƒå±€å‡½æ•°ï¼‰ã€‚picker.lua åœ¨åˆå§‹åŒ–æ—¶ä¼šè°ƒç”¨è¿™äº›å‡½æ•°æ¥è·å–æ­£ç¡®çš„ç»„ä»¶ã€‚ æ€»ç»“ï¼šconfig.lua æ˜¯æ’ä»¶å¯å®šåˆ¶æ€§çš„åŸºçŸ³ã€‚å®ƒé€šè¿‡ä¸€ä¸ªå·¨å¤§çš„é»˜è®¤é…ç½®è¡¨å’Œä¸€å¥—æ™ºèƒ½åˆå¹¶è§„åˆ™ï¼Œä¸ºç”¨æˆ·æä¾›äº†æå¤§çš„çµæ´»æ€§ã€‚æ’ä»¶çš„å…¶ä»–æ¨¡å—ä¸ç›´æ¥ç¡¬ç¼–ç è¡Œä¸ºï¼Œè€Œæ˜¯å‘ config.lua &ldquo;æŸ¥è¯¢&rdquo; åº”è¯¥ä½¿ç”¨å“ªä¸ªå‡½æ•°ã€å“ªä¸ªå¸ƒå±€ã€å“ªä¸ªé€‰é¡¹ï¼Œä»è€Œå®ç°äº†è¡Œä¸ºå’Œé…ç½®çš„å®Œå…¨åˆ†ç¦»ã€‚
æˆ‘ä»¬å·²ç»åˆ†æäº†æ ¸å¿ƒçš„ UI å’Œæ•°æ®æµï¼Œä»¥åŠå¦‚ä½•é…ç½®å®ƒä»¬ã€‚æ•´ä¸ªæ’ä»¶çš„éª¨æ¶å·²ç»å¾ˆæ¸…æ™°äº†ã€‚
ä½ ç†è§£ config.lua æ˜¯å¦‚ä½•ç®¡ç†å’Œæä¾›é…ç½®çš„å—ï¼Ÿå¦‚æœç†è§£äº†ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹çœ‹å®ƒæ˜¯å¦‚ä½•å®šä¹‰ä¸åŒç§ç±»çš„é€‰æ‹©å™¨ï¼ˆå¦‚æ–‡ä»¶é€‰æ‹©å™¨ã€buffer é€‰æ‹©å™¨ï¼‰çš„ï¼Œå³åˆ†æ lua/snacks/picker/config/sources.luaã€‚
rainboylvx: lua/snacks/picker/config.lua,æˆ‘æ²¡æœ‰æ‰¾åˆ°è¿™ä¸ªæ–‡ä»¶,ä½†æ˜¯æœ‰ä¸€ä¸ªconfig æ–‡ä»¶å¤¹
GitHub Copilot: ä½ è¯´å¾—å¯¹ï¼Œéå¸¸æŠ±æ­‰ï¼Œæˆ‘çš„åˆ†ææœ‰è¯¯ã€‚æˆ‘åº”è¯¥æŸ¥çœ‹é¡¹ç›®çš„æ–‡ä»¶ç»“æ„ã€‚
é…ç½®åŠŸèƒ½è¢«æ¨¡å—åŒ–åœ°æ”¾åœ¨äº† lua/snacks/picker/config/ ç›®å½•ä¸­ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªå•ç‹¬çš„æ–‡ä»¶ã€‚è¯¥æ¨¡å—çš„çœŸæ­£å…¥å£æ–‡ä»¶æ˜¯ lua/snacks/picker/config/init.luaã€‚
è®©æˆ‘ä»¬æ¥åˆ†æ lua/snacks/picker/config/init.luaã€‚
è¿™ä¸ªæ–‡ä»¶çš„ä½œç”¨ä¸æˆ‘ä¹‹å‰æè¿°çš„ config.lua éå¸¸ç›¸ä¼¼ï¼Œä½†å®ƒçš„å®ç°æ–¹å¼æ˜¯èšåˆå…¶ä»–é…ç½®æ–‡ä»¶ã€‚
å®ƒçš„æ ¸å¿ƒèŒè´£å¦‚ä¸‹ï¼š
å®šä¹‰å’Œèšåˆé»˜è®¤å€¼ (M.defaults)ï¼š
å®ƒé¦–å…ˆ require åŒç›®å½•ä¸‹çš„ defaults.lua æ–‡ä»¶ï¼Œè¿™ä¸ªæ–‡ä»¶åŒ…å«äº†æœ€åŸºç¡€çš„ã€ä¸æ•°æ®æºæ— å…³çš„é»˜è®¤é…ç½®ï¼ˆå¦‚çª—å£å¤–è§‚ã€å¸ƒå±€ç­‰ï¼‰ã€‚ ç„¶åï¼Œå®ƒ require äº† sources.lua æ–‡ä»¶ï¼Œè¿™ä¸ªæ–‡ä»¶å®šä¹‰äº†æ‰€æœ‰å†…ç½®é€‰æ‹©å™¨ï¼ˆå¦‚æ–‡ä»¶ã€buffersï¼‰çš„ç‰¹å®šé…ç½®ã€‚ æœ€åï¼Œå®ƒå°† sources.lua çš„é…ç½®åˆå¹¶åˆ°ä¸» defaults è¡¨ä¸­ï¼Œå½¢æˆä¸€ä¸ªå®Œæ•´çš„é»˜è®¤é…ç½®é›†åˆã€‚ ç®¡ç†ç”¨æˆ·é…ç½® (M.setup(opts), M.get()):
M.setup(opts) å‡½æ•°æ¥æ”¶ç”¨æˆ·åœ¨ setup æ—¶ä¼ å…¥çš„é…ç½®ï¼Œå¹¶å°†å…¶ä¸ M.defaults æ·±åº¦åˆå¹¶ï¼Œæœ€ç»ˆç»“æœå­˜æ”¾åœ¨æ¨¡å—å†…éƒ¨çš„ config å˜é‡ä¸­ã€‚ M.get() å‡½æ•°è®©æ’ä»¶çš„å…¶ä»–éƒ¨åˆ†å¯ä»¥éšæ—¶è¯»å–è¿™ä»½åˆå¹¶åçš„æœ€ç»ˆé…ç½®ã€‚ åˆ›å»ºå®ä¾‹é…ç½® (M.wrap(source, opts)):
è¿™ä¸ªå…³é”®å‡½æ•°ç”¨äºåœ¨åˆ›å»ºå…·ä½“é€‰æ‹©å™¨å®ä¾‹æ—¶ï¼Œç”Ÿæˆä¸€ä¸ªä¸“å±çš„é…ç½®ã€‚ å®ƒä¼šæŒ‰ç…§ä¼˜å…ˆçº§ä»ä½åˆ°é«˜çš„é¡ºåºåˆå¹¶å¤šä¸ªé…ç½®æºï¼š æ’ä»¶çš„å…¨å±€é»˜è®¤å€¼ (defaults.lua)ã€‚ è¯¥æ•°æ®æº (source) çš„é»˜è®¤é…ç½® (æ¥è‡ª sources.lua)ã€‚ ç”¨æˆ·åœ¨ setup ä¸­ä¸ºè¯¥æ•°æ®æºè®¾ç½®çš„é…ç½®ã€‚ ç”¨æˆ·åœ¨ setup ä¸­è®¾ç½®çš„å…¨å±€é…ç½®ã€‚ åœ¨è°ƒç”¨ picker() æ—¶ä¸´æ—¶ä¼ å…¥çš„ optsã€‚ è¿™ç§åˆ†å±‚åˆå¹¶çš„æœºåˆ¶æä¾›äº†æé«˜çš„çµæ´»æ€§ã€‚ æ€»ç»“ï¼šinit.lua æ˜¯é…ç½®ç³»ç»Ÿçš„â€œæ€»è£…è½¦é—´â€ã€‚å®ƒè‡ªå·±ä¸å®šä¹‰å¤ªå¤šå…·ä½“çš„é…ç½®é¡¹ï¼Œè€Œæ˜¯é€šè¿‡ require å¼•å…¥ defaults.lua å’Œ sources.lua ç­‰éƒ¨ä»¶ï¼Œå¹¶å°†å®ƒä»¬ä¸ç”¨æˆ·é…ç½®ç»„è£…æˆæœ€ç»ˆç”Ÿæ•ˆçš„é…ç½®ã€‚åŒæ—¶ï¼Œå®ƒæä¾›äº† wrap æ–¹æ³•ï¼Œä¸ºæ¯ä¸ªé€‰æ‹©å™¨å®ä¾‹é‡èº«å®šåˆ¶é…ç½®ã€‚
ä½ ç†è§£ init.lua æ˜¯å¦‚ä½•ä½œä¸ºé…ç½®çš„èšåˆå™¨æ¥å·¥ä½œçš„å—ï¼Ÿå¦‚æœç†è§£äº†ï¼Œæˆ‘ä»¬æ¥ä¸‹æ¥å°±åˆ†æå®ƒæ‰€ä¾èµ–çš„ã€å®šä¹‰äº†å„ç§é€‰æ‹©å™¨ç±»å‹çš„ sources.lua æ–‡ä»¶ã€‚
rainboylvx: åé¢,ä¸ç”¨åˆ†æäº†, ç°åœ¨è¯· å¯¹ æ¯ä¸ªä»£ç æ–‡ä»¶,ç”¨ä¸€å¥è¯æè¿°å®ƒçš„æ ¸å¿ƒä½œç”¨, ç„¶åæ€»ä½“æè¿°æ¯ä¸ªä»£ç æ–‡ä»¶çš„ä¾èµ–å…³ç³»
GitHub Copilot: å¥½çš„ã€‚ä¸‹é¢æ˜¯å¯¹æ¯ä¸ªæ–‡ä»¶æ ¸å¿ƒä½œç”¨çš„ä¸€å¥è¯æè¿°ï¼Œä»¥åŠå®ƒä»¬ä¹‹é—´çš„æ€»ä½“ä¾èµ–å…³ç³»ã€‚
æ–‡ä»¶æ ¸å¿ƒä½œç”¨ lua/snacks/picker/init.lua: ä½œä¸ºæ¨¡å—çš„å…¬å…± API å…¥å£ï¼Œæä¾› pick() å‡½æ•°æ¥åˆ›å»ºé€‰æ‹©å™¨ï¼Œå¹¶æ‡’åŠ è½½å…¶ä»–å­æ¨¡å—ã€‚ lua/snacks/picker/select.lua: æä¾›äº† vim.ui.select çš„ä¸€ä¸ªæ›¿ä»£å®ç°ï¼Œä½¿ç”¨æœ¬æ’ä»¶çš„ UIã€‚ lua/snacks/picker/core/picker.lua: å®šä¹‰äº†æ ¸å¿ƒ Picker ç±»ï¼Œå®ƒåƒä¸€ä¸ªæ€»æŒ‡æŒ¥ï¼Œåˆ›å»ºå¹¶åè°ƒæ‰€æœ‰ UI ç»„ä»¶å’Œæ•°æ®å¤„ç†æµç¨‹ã€‚ lua/snacks/picker/core/input.lua: ç®¡ç†ç”¨æˆ·è¾“å…¥çš„æç¤ºç¬¦çª—å£ï¼Œæ•è·æ‰€æœ‰æŒ‰é”®å¹¶å°†å…¶åˆ†å‘ä¸ºâ€œæŸ¥è¯¢æ›´æ–°â€æˆ–â€œæ‰§è¡ŒåŠ¨ä½œâ€ã€‚ lua/snacks/picker/core/list.lua: ç®¡ç†æ˜¾ç¤ºç»“æœçš„åˆ—è¡¨çª—å£ï¼Œè´Ÿè´£æ¸²æŸ“æ¡ç›®ã€å¤„ç†å…‰æ ‡ç§»åŠ¨å’Œæ¡ç›®é€‰æ‹©ã€‚ lua/snacks/picker/core/preview.lua: ç®¡ç†é¢„è§ˆçª—å£ï¼Œè´Ÿè´£å¼‚æ­¥åŠ è½½å¹¶æ˜¾ç¤ºå½“å‰é€‰ä¸­æ¡ç›®çš„è¯¦ç»†å†…å®¹ã€‚ lua/snacks/picker/core/finder.lua: æä¾›ä¸€ä¸ªå¼‚æ­¥æ¡†æ¶æ¥æ‰§è¡Œæ•°æ®è·å–æ“ä½œï¼ˆå¦‚æœç´¢æ–‡ä»¶ï¼‰ï¼Œæ˜¯æ•°æ®æµçš„ç¬¬ä¸€ç«™ã€‚ lua/snacks/picker/core/matcher.lua: å¯¹ finder æä¾›çš„æ•°æ®è¿›è¡ŒåŒ¹é…ã€è¯„åˆ†å’Œæ’åºï¼Œæ˜¯é€‰æ‹©å™¨çš„â€œæœç´¢å¼•æ“â€ã€‚ lua/snacks/picker/core/actions.lua: å®šä¹‰äº†æ‰€æœ‰å¯æ‰§è¡ŒåŠ¨ä½œï¼ˆå¦‚ç¡®è®¤é€‰æ‹©ã€å…³é—­ï¼‰çš„å…·ä½“å®ç°ï¼Œæ˜¯å‘½ä»¤çš„æ‰§è¡Œä¸­å¿ƒã€‚ lua/snacks/picker/config/init.lua: é…ç½®ç³»ç»Ÿçš„æ€»å…¥å£ï¼Œè´Ÿè´£èšåˆé»˜è®¤é…ç½®ã€æ•°æ®æºé…ç½®å’Œç”¨æˆ·è‡ªå®šä¹‰é…ç½®ã€‚ lua/snacks/picker/config/defaults.lua: å®šä¹‰äº†é€‰æ‹©å™¨ä¸æ•°æ®æºæ— å…³çš„å…¨å±€é»˜è®¤å¤–è§‚å’Œè¡Œä¸ºã€‚ lua/snacks/picker/config/sources.lua: å®šä¹‰äº†æ‰€æœ‰å†…ç½®æ•°æ®æºï¼ˆå¦‚ files, buffersï¼‰çš„ä¸“å±é»˜è®¤é…ç½®ã€‚ æ€»ä½“ä¾èµ–å…³ç³» è¿™ä¸ªé¡¹ç›®çš„ä¾èµ–å…³ç³»å¯ä»¥çœ‹ä½œä¸€ä¸ªç”± picker.lua ä¸ºä¸­å¿ƒçš„æ˜Ÿå‹ç»“æ„ã€‚
å¯åŠ¨æµç¨‹:
ç”¨æˆ·è°ƒç”¨ picker.init.lua ä¸­çš„ pick() å‡½æ•°ã€‚ init.lua è°ƒç”¨ picker.lua çš„ new() æ–¹æ³•æ¥åˆ›å»ºä¸€ä¸ª Picker å®ä¾‹ã€‚ Picker å®ä¾‹åœ¨åˆå§‹åŒ–æ—¶ï¼Œä¼šå‘ init.lua è¯·æ±‚åˆå¹¶åçš„é…ç½®ã€‚ ç„¶åï¼ŒPicker å®ä¾‹ä¼šåˆ›å»º input.lua, list.lua, preview.lua ç­‰ UI ç»„ä»¶çš„å®ä¾‹ï¼Œå¹¶å°†è‡ªèº«ï¼ˆselfï¼‰ä¼ é€’ç»™å®ƒä»¬ï¼Œä»¥ä¾¿å®ƒä»¬å¯ä»¥å›è°ƒPickerã€‚ æ•°æ®å¤„ç†æµç¨‹ï¼ˆç”¨æˆ·è¾“å…¥æ—¶ï¼‰:
input.lua æ•è·ç”¨æˆ·è¾“å…¥ï¼Œå»¶è¿Ÿï¼ˆdebounceï¼‰åè°ƒç”¨ Picker çš„ :find() æ–¹æ³•ã€‚ Picker è§¦å‘ finder.lua åœ¨åå°å¼‚æ­¥è·å–åŸå§‹æ•°æ®ã€‚ matcher.lua ç›‘è§† finder çš„ç»“æœï¼Œå¹¶å¯¹æ–°æ•°æ®è¿›è¡Œå®æ—¶åŒ¹é…å’Œè¯„åˆ†ã€‚ Picker å°† matcher çš„ç»“æœä¼ é€’ç»™ list.luaã€‚ list.lua å°†æœ€ç»ˆæ’åºå’Œæ ¼å¼åŒ–åçš„æ¡ç›®æ¸²æŸ“åˆ°çª—å£ä¸­ã€‚ åŠ¨ä½œæ‰§è¡Œæµç¨‹ï¼ˆç”¨æˆ·æŒ‰åŠŸèƒ½é”®æ—¶ï¼‰:
input.lua æ•è·åŠŸèƒ½é”®ï¼ˆå¦‚ &lt;Enter&gt;ï¼‰ï¼Œå¹¶è°ƒç”¨ Picker çš„ :actions(&quot;action_name&quot;) æ–¹æ³•ã€‚ Picker æŸ¥æ‰¾ actions.lua ä¸­å¯¹åº”çš„åŠ¨ä½œå‡½æ•°å¹¶æ‰§è¡Œã€‚ è¯¥åŠ¨ä½œå‡½æ•°å¯èƒ½ä¼šåè¿‡æ¥è°ƒç”¨ list.lua çš„æ–¹æ³•ï¼ˆå¦‚ :toggle_selection()ï¼‰æˆ– Picker è‡ªèº«çš„æ–¹æ³•ï¼ˆå¦‚ :close()ï¼‰ã€‚ ç®€å•æ¥è¯´ï¼ŒPicker æ˜¯ä¸­å¤®åè°ƒå™¨ï¼Œå®ƒä¸äº²è‡ªå¹²æ´»ï¼Œè€Œæ˜¯å°†ä»»åŠ¡åˆ†æ´¾ç»™ä¸“é—¨çš„æ¨¡å—ï¼šinput è´Ÿè´£æ¥æ”¶æŒ‡ä»¤ï¼Œfinder å’Œ matcher è´Ÿè´£å¤„ç†æ•°æ®ï¼Œlist å’Œ preview è´Ÿè´£å±•ç¤ºï¼Œactions è´Ÿè´£æ‰§è¡Œå…·ä½“æ“ä½œï¼Œè€Œæ‰€æœ‰æ¨¡å—çš„è¡Œä¸ºéƒ½ç”± config æ¥å®šä¹‰ã€‚
rainboylvx: ç°åœ¨æˆ‘æƒ³è¦ å®ç°ä¸€ä¸ªåŠŸèƒ½ ,æˆ‘æœ‰ä¸€ä¸ª code/snip æ–‡ä»¶: é‡Œé¢æœ‰å¾ˆå¤šä»£ç snip,å½“æˆ‘é€‰ä¸­æŸä¸ªsnipçš„åå­—å, æ’å…¥å½“å‰snipæ–‡ä»¶çš„å†…å®¹åˆ° å½“å‰bufferé‡Œ, ä½¿ç”¨picker
GitHub Copilot: å¥½çš„ï¼Œè¿™æ˜¯ä¸€ä¸ªéå¸¸æ£’çš„å®è·µï¼ä½¿ç”¨ picker æ¥å®ç°è¿™ä¸ªåŠŸèƒ½æ˜¯å®ƒçš„å…¸å‹ç”¨ä¾‹ã€‚
æˆ‘ä»¬å°†åˆ†ä¸¤æ­¥æ¥å®Œæˆè¿™ä¸ªåŠŸèƒ½ï¼š
åˆ›å»ºä¸€ä¸ª code/snip æ–‡ä»¶ï¼Œå¹¶å®šä¹‰ä¸€äº›ä»£ç ç‰‡æ®µã€‚ ç¼–å†™ Lua ä»£ç ï¼Œä½¿ç”¨ snacks.picker æ¥è¯»å–ã€æ˜¾ç¤ºå¹¶æ’å…¥è¿™äº›ç‰‡æ®µã€‚ ç¬¬ä¸€æ­¥ï¼šåˆ›å»º code/snip æ–‡ä»¶ é¦–å…ˆï¼Œåœ¨ä½ çš„ Neovim é…ç½®ç›®å½•ï¼ˆé€šå¸¸æ˜¯ ~/.config/nvim/ï¼‰ä¸‹ï¼Œåˆ›å»ºä¸€ä¸ªåä¸º code/snip çš„æ–‡ä»¶ã€‚
æ–‡ä»¶è·¯å¾„ï¼š~/.config/nvim/code/snip
ç„¶åï¼Œå‘è¿™ä¸ªæ–‡ä»¶é‡Œæ·»åŠ ä¸€äº›ä»£ç ç‰‡æ®µã€‚æˆ‘ä»¬ä½¿ç”¨ä¸€ä¸ªç®€å•çš„æ ¼å¼ï¼šç”¨ --- ç‰‡æ®µå --- ä½œä¸ºåˆ†éš”ç¬¦ã€‚
1--- My Awesome Function --- 2function MyAwesomeFunction(name) 3 print(&#34;Hello, &#34; .. name) 4end 5 6--- React Component --- 7import React from &#39;react&#39;; 8 9const MyComponent = () =&gt; { 10 return &lt;div&gt;Hello, World!&lt;/div&gt;; 11}; 12 13export default MyComponent; 14 15--- Simple Python Class --- 16class MyClass: 17 def __init__(self, name): 18 self.name = name 19 20 def greet(self): 21 print(f&#34;Hello, {self.name}&#34;) ç¬¬äºŒæ­¥ï¼šç¼–å†™ Picker é…ç½® ç°åœ¨ï¼Œå°†ä¸‹é¢çš„ Lua ä»£ç æ·»åŠ åˆ°ä½ çš„ Neovim é…ç½®æ–‡ä»¶ä¸­ï¼ˆæ¯”å¦‚ init.lua æˆ–è€…ä¸€ä¸ªä½ ä¸“é—¨ç”¨æ¥å­˜æ”¾è‡ªå®šä¹‰å‡½æ•°çš„æ–‡ä»¶ï¼‰ã€‚
è¿™æ®µä»£ç å®šä¹‰äº†ä¸€ä¸ªå‡½æ•°ï¼Œè°ƒç”¨å®ƒæ—¶ä¼šè§¦å‘ä¸€ä¸ªé€‰æ‹©å™¨ï¼Œè¯¥é€‰æ‹©å™¨ä¼šè¯»å–å¹¶è§£æä½ åˆšåˆšåˆ›å»ºçš„ code/snip æ–‡ä»¶ã€‚
1// ...existing code... 2local function show_snips() 3 require(&#34;snacks.picker&#34;).pick({ 4 -- \`finder\` è´Ÿè´£è¯»å–å’Œè§£ææ–‡ä»¶ï¼Œè¿”å›ä¸€ä¸ªæ¡ç›®åˆ—è¡¨ 5 finder = function() 6 local path = vim.fn.stdpath(&#34;config&#34;) .. &#34;/code/snip&#34; 7 local lines = vim.fn.readfile(path) 8 if not lines or #lines == 0 then 9 vim.notify(&#34;Snippet file is empty or not found: &#34; .. path, vim.log.levels.ERROR) 10 return {} 11 end 12 13 local items = {} 14 local current_name = nil 15 local current_content = {} 16 17 for _, line in ipairs(lines) do 18 -- ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…ç‰‡æ®µåç§°ï¼Œä¾‹å¦‚ &#34;--- My Name ---&#34; 19 local name = line:match(&#34;^%-%-%- (.*) %-%-%-$&#34;) 20 if name then 21 -- å¦‚æœå·²ç»æœ‰ä¸€ä¸ªç‰‡æ®µæ­£åœ¨è®°å½•ï¼Œå…ˆä¿å­˜å®ƒ 22 if current_name then 23 table.insert(items, { display = current_name, content = table.concat(current_content, &#34;\\n&#34;) }) 24 end 25 -- å¼€å§‹è®°å½•æ–°çš„ç‰‡æ®µ 26 current_name = name 27 current_content = {} 28 elseif current_name then 29 -- å°†å½“å‰è¡Œæ·»åŠ åˆ°ç‰‡æ®µå†…å®¹ä¸­ 30 table.insert(current_content, line) 31 end 32 end 33 34 -- ä¸è¦å¿˜è®°ä¿å­˜æœ€åä¸€ä¸ªç‰‡æ®µ 35 if current_name then 36 table.insert(items, { display = current_name, content = table.concat(current_content, &#34;\\n&#34;) }) 37 end 38 39 return items 40 end, 41 42 -- \`format.item\` å‘Šè¯‰é€‰æ‹©å™¨å¦‚ä½•æ˜¾ç¤ºæ¯ä¸ªæ¡ç›® 43 format = { 44 item = function(item) 45 return item.display 46 end, 47 }, 48 49 -- \`preview\` å‘Šè¯‰é¢„è§ˆçª—å£è¦æ˜¾ç¤ºä»€ä¹ˆå†…å®¹ 50 preview = function(item) 51 if not item.content then return end 52 -- è¿”å›ä¸€ä¸ªè¡Œçš„åˆ—è¡¨ 53 return vim.split(item.content, &#34;\\n&#34;) 54 end, 55 56 -- \`on_select\` å®šä¹‰äº†å½“ç”¨æˆ·æŒ‰ä¸‹å›è½¦é”®åè¦æ‰§è¡Œçš„æ“ä½œ 57 on_select = function(selection) 58 if not selection or #selection == 0 then return end 59 60 -- è·å–é€‰ä¸­ç‰‡æ®µçš„å†…å®¹ 61 local content = selection[1].content 62 if not content then return end 63 64 -- å°†å†…å®¹åˆ†å‰²æˆè¡Œåˆ—è¡¨ï¼Œå› ä¸º nvim_put æ¥æ”¶è¿™ä¸ªæ ¼å¼ 65 local lines_to_insert = vim.split(content, &#34;\\n&#34;) 66 67 -- ï¼ˆå¯é€‰ï¼‰æ¸…ç†å‰åå¯èƒ½å­˜åœ¨çš„ç©ºè¡Œ 68 if lines_to_insert[1] == &#34;&#34; then table.remove(lines_to_insert, 1) end 69 if #lines_to_insert &gt; 0 and lines_to_insert[#lines_to_insert] == &#34;&#34; then table.remove(lines_to_insert, #lines_to_insert) end 70 71 -- å°†å†…å®¹æ’å…¥åˆ°å½“å‰å…‰æ ‡ä½ç½® 72 vim.api.nvim_put(lines_to_insert, &#39;c&#39;, false, true) 73 end, 74 }) 75end 76 77-- åˆ›å»ºä¸€ä¸ªç”¨æˆ·å‘½ä»¤ \`:Snips\` æ¥è§¦å‘è¿™ä¸ªé€‰æ‹©å™¨ 78vim.api.nvim_create_user_command(&#34;Snips&#34;, show_snips, {}) 79 80-- æˆ–è€…ï¼Œåˆ›å»ºä¸€ä¸ªé”®ä½æ˜ å°„ï¼Œä¾‹å¦‚åœ¨æ™®é€šæ¨¡å¼ä¸‹æŒ‰ &lt;leader&gt;ss 81-- vim.keymap.set(&#34;n&#34;, &#34;&lt;leader&gt;ss&#34;, show_snips, { desc = &#34;Show snippets&#34; }) 82// ...existing code... å¦‚ä½•ä½¿ç”¨ é‡å¯ Neovim æˆ–é‡æ–°åŠ è½½ä½ çš„é…ç½®ã€‚ åœ¨ä»»æ„ buffer ä¸­ï¼Œè¾“å…¥å‘½ä»¤ :Snips å¹¶æŒ‰å›è½¦ã€‚ ä¸€ä¸ªé€‰æ‹©å™¨ä¼šå¼¹å‡ºï¼Œæ˜¾ç¤ºä½ åœ¨ code/snip æ–‡ä»¶ä¸­å®šä¹‰çš„æ‰€æœ‰ç‰‡æ®µåç§°ã€‚ ä½¿ç”¨ä¸Šä¸‹é”®ç§»åŠ¨å…‰æ ‡ï¼Œå³ä¾§çš„é¢„è§ˆçª—å£ä¼šå®æ—¶æ˜¾ç¤ºç‰‡æ®µçš„ä»£ç å†…å®¹ã€‚ åœ¨æƒ³è¦æ’å…¥çš„ç‰‡æ®µä¸ŠæŒ‰å›è½¦ï¼Œè¯¥ç‰‡æ®µçš„ä»£ç å°±ä¼šè¢«æ’å…¥åˆ°ä½ ä¹‹å‰æ‰€åœ¨çš„å…‰æ ‡ä½ç½®ã€‚ `,url:"https://hugo-dead-simple.netlify.com/nvim-for-oi/snack-picker.html"},"https://hugo-dead-simple.netlify.com/mongodb/index.html":{title:"MongoDB å­¦ä¹ ç¬”è®°",tags:[],content:`è¿™é‡Œæ˜¯æˆ‘å­¦ä¹  MongoDB è¿‡ç¨‹ä¸­è®°å½•çš„æ‰€æœ‰ç¬”è®°å’Œç»ƒä¹ ã€‚
MongoDB - Lookup æ“ä½œè¯¦è§£ MongoDB ç»ƒä¹  1 MongoDB ç»ƒä¹  2 MongoDB ç»ƒä¹  3 MongoDB ç»ƒä¹  4 MongoDB - åœ¨æ•°ç»„ä¸ŠæŸ¥è¯¢ `,url:"https://hugo-dead-simple.netlify.com/mongodb/index.html"},"https://hugo-dead-simple.netlify.com/search.html":{title:"Search Results",tags:[],content:"",url:"https://hugo-dead-simple.netlify.com/search.html"},"https://hugo-dead-simple.netlify.com/math/index.html":{title:"æˆ‘çš„æ•°å­¦ç¬”è®°",tags:[],content:"",url:"https://hugo-dead-simple.netlify.com/math/index.html"},"https://hugo-dead-simple.netlify.com/books/%E7%AE%97%E6%B3%95%E7%AB%9E%E8%B5%9B%E8%BF%9B%E9%98%B6%E6%8C%87%E5%8D%97/index.html":{title:"ç®—æ³•ç«èµ›è¿›é˜¶æŒ‡å— å­¦ä¹ ç¬”è®°",tags:[],content:" 0x00 åŸºæœ¬ç®—æ³• ç¯å½¢å‡åˆ†çº¸ç‰Œ ",url:"https://hugo-dead-simple.netlify.com/books/%E7%AE%97%E6%B3%95%E7%AB%9E%E8%B5%9B%E8%BF%9B%E9%98%B6%E6%8C%87%E5%8D%97/index.html"},"https://hugo-dead-simple.netlify.com/index.html":{title:"é¦–é¡µ",tags:[],content:" è¿™é‡Œæ˜¯rainboyå†™çš„æ–‡ç« , æ‰˜ç®¡åœ¨ GitHub ä»“åº“ ",url:"https://hugo-dead-simple.netlify.com/index.html"}}</script><script defer src=/js/lunr.js></script><script defer src=/js/search.js></script><br><footer><div class=footer-info><p>Copyright &copy; 2025 Rainboy. All rights reserved.
<span>| Last build: 2025-10-24 15:51:58</span></p></div><script defer>document.addEventListener("keydown",function(e){if(document.activeElement.isContentEditable)return!1;if(document.activeElement.tagName=="INPUT")return!1;if(e.altKey||e.ctrlKey||e.shiftKey)return!1;var t=e.key;if(t==="h")e.preventDefault(),e.stopPropagation(),window.location.href="/";else if(t==="t")e.preventDefault(),e.stopPropagation(),window.location.href=`https://${location.hostname}/tags`;else if(t==="i"){e.preventDefault(),e.stopPropagation();const t=document.querySelectorAll("input");for(let e=0;e<t.length;e++)if(t[e].offsetParent!==null){t[e].selectionStart=t[e].selectionEnd=t[e].value.length,t[e].focus();break}}return!1})</script><script defer>function throttle(e,t){var n=Date.now();return function(){var s=Date.now();n+t-s<0&&(e(),n=s)}}function scrollHandler(){const e=Array.from(document.querySelectorAll("body h2, body h3"));function t(){for(var n,s,o,i=window.pageYOffset||document.documentElement.scrollTop,t=0;t<e.length;t++)s=e[t].getAttribute("id"),n=document.querySelector('nav ul li a[href="#'+s+'"]'),n&&n.classList.remove("active-toc");for(t=e.length-1;t>=0;t--)if(o=e[t].offsetTop,i>o-75&&(s=e[t].getAttribute("id"),n=document.querySelector('nav ul li a[href="#'+s+'"]'),n)){n.classList.add("active-toc");break}}window.addEventListener("scroll",throttle(t,200))}setTimeout(scrollHandler,100)</script><script defer>function addCopyButtonToCodeBlocks(){const e=document.querySelectorAll('code[class^="language-"]:not(.output):not([class*="language-console"])');e.forEach(e=>{const t=document.createElement("button");t.classList.add("copy-code-button"),t.innerHTML="copy",t.addEventListener("click",()=>{const s=e.querySelectorAll(".cl");let n="";s.forEach(e=>{n+=e.innerText}),navigator.clipboard.writeText(n),t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},1500)}),e.parentNode.before(t)})}setTimeout(function(){addCopyButtonToCodeBlocks()},100)</script><script defer src=/js/theme-switcher.js></script></footer></body></html>