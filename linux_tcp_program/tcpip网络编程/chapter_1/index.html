<!doctype html><html lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=cache-control content="max-age=0"><meta http-equiv=cache-control content="no-cache"><meta http-equiv=expires content="0"><meta http-equiv=expires content="Tue, 01 Jan 1980 1:00:00 GMT"><meta http-equiv=pragma content="no-cache"><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png }><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/site.webmanifest><meta name=theme-color media="(prefers-color-scheme: light)" content="#ffffff"><meta name=theme-color media="(prefers-color-scheme: dark)" content="#1b1b1b"><meta name=description content><script>(function(){const e=localStorage.getItem("theme")||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light");document.documentElement.setAttribute("data-theme",e)})()</script><title>| Rainboy's Blog</title><style>:root{--background:#ffffff}@media(prefers-color-scheme:dark){:root{--background:#1b1b1b}}html{background-color:var(--background)}body{background-color:var(--background)}</style><link rel=stylesheet type=text/css href=/style.min.ec0f719b913e581207983cf92193a08ecc267bcfa103b18138938c37c3af261a.css media=all><link rel=stylesheet href=/grid.css></head><body><nav><ul class=menu><li><a tabindex=-1 class=menu-link href=/><u>H</u>ome</a></li><li><a tabindex=-1 class=menu-link href=/tags><u>T</u>ags</a></li><li><span style=cursor:pointer id=theme-switcher class=menu-link type=button>ğŸŒ™</span></li></ul></nav><div id=single-header><h1></h1><div id=single-meta></div></div><main><h1 id=ç¬¬ä¸€ç« -ç†è§£ç½‘ç»œç¼–ç¨‹å’Œsocket>ç¬¬ä¸€ç«  ç†è§£ç½‘ç»œç¼–ç¨‹å’Œsocket</h1><blockquote><p>![INFO]
ç½‘ç»œç¼–ç¨‹å°±æ˜¯ç¼–å†™ç¨‹åºä½¿ç”¨ä¸¤å°è¿ç½‘çš„è®¡ç®—æœºç›¸äº’äº¤æ¢æ•°æ®.</p></blockquote><p>è¿™å°±æ˜¯æ•´ä¸ªç½‘ç»œç¼–ç¨‹çš„å…¨éƒ¨å†…å®¹.æˆ‘è§‰å¾—ä¸éœ€è¦å»è¯¦ç»†çš„ç†è§£TCP/IPçš„ç»†èŠ‚.</p><p>ä¸‹é¢æˆ‘æŒ‰æˆ‘çš„ç†è§£è¿™ä¸€ç« çš„å†…å®¹.</p><p>å¦‚æœæˆ‘ä»¬æƒ³åˆ°åœ¨ç”µè„‘ä¸Šåˆ›å»ºä¸€ä¸ªserverç«¯çš„è½¯ä»¶,ç”¨æ¥æ¥æ”¶å…¶å®ƒç”µè„‘ä¸Šå¦ä¸€ä¸ªç¨‹åºé€šè¿‡ç½‘ç»œå‘æ¥çš„ä¿¡æ¯,åº”è¯¥å¦‚ä½•åšå‘¢? åº”è¯¥æŒ‰ä¸‹é¢çš„æµç¨‹æ¥åš</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=ln>1</span><span class=cl>---
</span></span><span class=line><span class=ln>2</span><span class=cl>title: server socket åˆ›å»ºæµç¨‹
</span></span><span class=line><span class=ln>3</span><span class=cl>---
</span></span><span class=line><span class=ln>4</span><span class=cl>flowchart TD
</span></span><span class=line><span class=ln>5</span><span class=cl>    step_1[1.åˆ›å»ºsocket,API:socket]
</span></span><span class=line><span class=ln>6</span><span class=cl>    step_2[2.ç»‘å®šç«¯å£ä¸ip: bind]
</span></span><span class=line><span class=ln>7</span><span class=cl>    step_3[3.å¼€å¯ç›‘å¬ listen]
</span></span><span class=line><span class=ln>8</span><span class=cl>    step_4[4.æ¥å—äº§ç”Ÿçš„socket: accept ]
</span></span><span class=line><span class=ln>9</span><span class=cl>    step_1 --&gt; step_2 --&gt; step_3 --&gt; step_4;
</span></span></code></pre></div><h2 id=ç¬¬ä¸€æ­¥åˆ›å»º-socketæ’åº§>ç¬¬ä¸€æ­¥åˆ›å»º socket(æ’åº§)</h2><p><p class=imgp><img loading=lazy src=chapter_1/assets/image.png alt="alt text"></p></p><p>å¦‚æœæˆ‘ä»¬å®¶é‡Œéœ€è¦ç½‘ç»œé€šä¿¡,é¦–å…ˆè¦æœ‰ä¸€ä¸ªç½‘ç»œé¢æ¿(ç½‘ç»œæ’åº§)ç”¨æ¥è¿æ¥ç½‘ç»œ,ç„¶åæ‰èƒ½é€šä¿¡. åŒæ ·æˆ‘ä»¬ä¹Ÿéœ€è¦å…ˆåˆ›å»ºä¸€ä¸ªsocket,è¿™ä¸ªsocketçš„ä½œç”¨å°±æ˜¯ç”¨äºåé¢çš„ç½‘ç»œè¿æ¥.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=line><span class=ln>1</span><span class=cl><span class=kt>int</span> <span class=nf>socket</span><span class=p>(</span><span class=kt>int</span> <span class=n>domain</span><span class=p>,</span><span class=kt>int</span> <span class=n>type</span><span class=p>,</span><span class=kt>int</span> <span class=n>protocal</span><span class=p>)</span>
</span></span></code></pre></div><p>å…·ä½“å‚æ•°çš„å«ä¹‰ä¸ç†è§£è§ä¸€ä¸‹ç« èŠ‚</p><h2 id=ç¬¬äºŒæ­¥-bindå‡½æ•°>ç¬¬äºŒæ­¥ bindå‡½æ•°</h2><p>é€šè¿‡ç¬¬ä¸€æ­¥æˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªsocket(æ’åº§),é‚£ä¹ˆåº”è¯¥æŠŠå®ƒæ”¾åœ¨å“ªé‡Œå‘¢?
å…¶å®å°±æ˜¯æ ¹æ®å“ªäº›ä¿¡æ¯å¯ä»¥æ‰¾åˆ°è¿™ä¸ªsocket.</p><ol><li>ä¿¡æ¯é¦–å…ˆè¦èƒ½å‘é€ç»™ç”µè„‘,ä¹Ÿå°±æ˜¯éœ€è¦çŸ¥é“ç”µè„‘çš„IP,ä¸€ä¸ªç”µè„‘å¯ä»¥æœ‰å¤šä¸ªIP.</li></ol><p><p class=imgp><img loading=lazy src=chapter_1/assets/image-2.png alt=å¤šç½‘å£></p></p><p>æ¯”å¦‚è¿™ä¸ªç”µè„‘å°±æœ‰ä¸¤ä¸ªç½‘å£,(å•ç½‘å£ä¹Ÿå¯ä»¥æœ‰å¤šIP)</p><ol start=2><li>å¯ä»¥æƒ³åƒåˆ°ä¸€ä¸ªç”µè„‘ä¸Šèƒ½è¿›è¡Œç½‘ç»œé€šä¿¡çš„è½¯ä»¶æœ‰å¤šä¸ª,é‚£ä¹ˆå°±æœ‰å¾ˆå¤šä¸ªsocket.</li></ol><p><p class=imgp><img loading=lazy src=chapter_1/assets/image-3.png alt=2></p></p><p><p class=imgp><img loading=lazy src=chapter_1/assets/image-4.png alt=3></p></p><p><p class=imgp><img loading=lazy src=chapter_1/assets/image-5.png alt=4></p></p><p>ç”µè„‘ä¸ºäº†å’Œå¤–éƒ¨é€šä¿¡,åˆ›å»ºäº†ç«¯å£è¿™ä¸ªæ¦‚å¿µ.</p><p>ä½ å¯ä»¥æŠŠç«¯å£æƒ³åƒæˆç”µè„‘ä¸€ä¸ªä¸€ä¸ªå­”æ´,æ¯ä¸€ä¸ªæ•°æ®é€šè¿‡è¿™ä¸ªå­”æ´å‘æµå…¥è¿›ç”µè„‘,å¦‚ä½•ä½ çš„socket"å®‰è£…"åœ¨è¿™ä¸ªç«¯å£ä¸Š,é‚£ä¹ˆå°±å¯ä»¥æ¥æ”¶åˆ°è¿™ä¸ªæ•°æ®äº†.</p><p>ç„¶åè¿™ä¸ªsocketå’Œè¿˜éœ€è¦å’ŒæŸä¸€ç«¯å£ç»‘å®šåœ¨ä¸€èµ·.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=line><span class=ln>1</span><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;sys/socket.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=ln>2</span><span class=cl><span class=cp></span><span class=kt>int</span> <span class=nf>bind</span><span class=p>(</span><span class=kt>int</span> <span class=n>sockfd</span><span class=p>,</span><span class=k>struct</span> <span class=n>sockaddr_in</span> <span class=o>*</span> <span class=n>myaddr</span><span class=p>,</span><span class=kt>socklen_t</span> <span class=n>addrlen</span><span class=p>)</span>
</span></span></code></pre></div><h2 id=ç¬¬ä¸‰æ­¥-æ¿€æ´»ç›‘å¬listen>ç¬¬ä¸‰æ­¥: æ¿€æ´»ç›‘å¬,listen</h2><p>ç°åœ¨æˆ‘ä»¬æœ‰äº†ä¸€ä¸ªsocket,å¹¶æŠŠå®ƒæ”¾åˆ°äº†åˆé€‚çš„ä½ç½®(bind),æ¥ä¸‹å°±èƒ½é€šä¿¡äº†å—?
ä¸èƒ½,è¿˜éœ€è¦å¯ç”¨,æ¿€æ´»å®ƒ,å°±åƒå®¶é‡Œå¼„äº†ç½‘ç»œé¢æ¿,ç½‘çº¿,è¿˜éœ€è¦ç½‘ç»œå…¬å¸ç»™æˆ‘ä»¬å¼€é€šç½‘ç»œæƒé™.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=line><span class=ln>1</span><span class=cl><span class=kt>int</span> <span class=nf>listen</span><span class=p>(</span><span class=kt>int</span> <span class=n>sockfd</span><span class=p>,</span><span class=kt>int</span> <span class=n>backlog</span><span class=p>)</span>
</span></span></code></pre></div><p><code>listen</code>çš„å…¶å®æ˜¯åœ¨<code>socket</code>åˆ›å»ºä¸€ä¸ªç›‘å¬é˜Ÿåˆ—,é˜Ÿåˆ—å¤§å°ä¸º<code>backlog</code>,æ¯ä¸€ä¸ªclientè¯·æ±‚è¿æ¥å,å°±ä¼šåŠ å…¥åˆ°é˜Ÿåˆ—é‡Œ,ç­‰å¾…å¤„ç†</p><h2 id=ç¬¬å››æ­¥-acceptå¤„ç†è¿æ¥è¯·æ±‚>ç¬¬å››æ­¥: accept,å¤„ç†è¿æ¥è¯·æ±‚</h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=line><span class=ln>1</span><span class=cl><span class=kt>int</span> <span class=nf>accept</span><span class=p>(</span><span class=kt>int</span> <span class=n>sockfd</span><span class=p>,</span><span class=k>struct</span> <span class=n>sockaddr</span> <span class=o>*</span> <span class=n>addr</span> <span class=p>,</span><span class=kt>socklen_t</span> <span class=o>*</span> <span class=n>addrlen</span><span class=p>);</span>
</span></span></code></pre></div><p>ä¸Šä¸€æ­¥,å¯ä»¥æ¥æ”¶è¿æ¥,ç„¶ååŠ å…¥åˆ°é˜Ÿåˆ—é‡Œ,ä½†æ˜¯è¿˜éœ€è¦å¯¹è¿™äº›é˜Ÿåˆ—é‡Œçš„å†…å®¹è¿›è¡Œå¤„ç†.</p><p><code>accept</code>çš„ä½œç”¨,ä»é˜Ÿåˆ—å–å‡ºä¸€ä¸ªè¿æ¥æ•°æ®,ç„¶ååˆ›å»ºä¸€ä¸ª<code>socket</code>.ä½ å¯èƒ½ä¼šé—®,ä¸ºä»€ä¹ˆåˆåˆ›å»ºäº†ä¸€ä¸ªsocket,åŸæ¥ä¸æ˜¯æœ‰ä¸€ä¸ªå—?</p><p>é¦–å…ˆæˆ‘ä»¬è¦æ˜ç¡®çš„çŸ¥é“ä¸€ä¸ªæ¦‚å¿µ,ä¸¤ä¸ªsocketä¸€åœ¨ä¸€èµ·æ‰èƒ½è¿›è¡Œé€šä¿¡,æˆ–è€…è¯´é€šä¿¡çš„ä¸¤ä¸ªç”µè„‘ä¹‹é—´å„æœ‰ä¸€ä¸ªsocket,ä¸å…è®¸ä¸€socketå¯¹åº”å¤šä¸ªsocket.</p><p>ç¬¬ä¸€ä¸ªsocket,æˆ‘ä»¬çš„æˆä¸ºsocket,æˆ‘ä»¬ç§°ä¸º<code>server socket</code>,å®ƒåœ¨åŒä¸€æ—¶åˆ»ä¸ä¸€ä¸ªclient socketè¿›è¡Œè¿æ¥,ç„¶åæ¥æ”¶åˆ°å¿…è¦çš„ä¿¡æ¯ä¹‹å.æ ¹æ®è¿™äº›ä¿¡æ¯äº§ç”Ÿä¸€ä¸ªsocket A.è¿™ä¸ªæ–°çš„socket Aå·²ååªä¸è¿™ä¸ªclient socketè¿›è¡Œé€šä¿¡.</p><p>è¿™ä¸ªè¿‡ç¨‹æˆ‘ä»¬ç§°ä¸º<code>accept</code></p><h2 id=serverç«¯ä»£ç >serverç«¯ä»£ç </h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-cpp data-lang=cpp><span class=line><span class=ln>1</span><span class=cl><span class=p>{{</span><span class=err>#</span><span class=n>include</span> <span class=n>code</span><span class=o>/</span><span class=mi>1</span><span class=o>-</span><span class=n>hello_world_server</span><span class=p>.</span><span class=n>c</span><span class=p>}}</span>
</span></span></code></pre></div><p>ç¼–è¯‘</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=ln>1</span><span class=cl>gcc -g -o server 1-hello_world_server.c
</span></span></code></pre></div><p>æµ‹è¯•</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=ln>1</span><span class=cl>netcat -v 127.0.0.1 <span class=m>8989</span>
</span></span></code></pre></div><p>ç»“æœ</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=ln>1</span><span class=cl>â  netcat -v 127.0.0.1 8989                                                                                                                                  
</span></span><span class=line><span class=ln>2</span><span class=cl>localhost [127.0.0.1] 8989 (sunwebadmins) open
</span></span><span class=line><span class=ln>3</span><span class=cl>Hello World!%
</span></span></code></pre></div><h2 id=clientç«¯ä»£ç >clientç«¯ä»£ç </h2><p>clientå®ç°æ¯”è¾ƒç®€å•</p><ol><li>åˆ›å»ºsocket</li><li>è°ƒç”¨connect,ä¸server socketè¿›è¡Œè¿æ¥</li><li>å‘é€æ•°æ®</li><li>æ¥æ”¶è¿”å›çš„æ•°æ®</li><li>ç»“æŸclient socket</li></ol><div class=highlight><pre tabindex=0 class=chroma><code class=language-cpp data-lang=cpp><span class=line><span class=ln>1</span><span class=cl><span class=p>{{</span><span class=err>#</span><span class=n>include</span> <span class=n>code</span><span class=o>/</span><span class=mi>1</span><span class=o>-</span><span class=n>hello_world_client</span><span class=p>.</span><span class=n>c</span><span class=p>}}</span>
</span></span></code></pre></div><p>è¿è¡Œç»“æœ</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=ln>1</span><span class=cl>â  ./1-hello_world_client.out
</span></span><span class=line><span class=ln>2</span><span class=cl>Message from server: Hello World!
</span></span></code></pre></div><h2 id=inet_addr-å‡½æ•°>inet_addr å‡½æ•°</h2><p><code>inet_addr</code> æ˜¯ä¸€ä¸ªç”¨äºå°† IPv4 åœ°å€ä»ç‚¹åˆ†åè¿›åˆ¶å­—ç¬¦ä¸²è¡¨ç¤ºè½¬æ¢ä¸ºç½‘ç»œå­—èŠ‚åºçš„ 32 ä½äºŒè¿›åˆ¶å€¼çš„å‡½æ•°ã€‚å®ƒåœ¨ Linux å’Œå…¶ä»–ç±» Unix ç³»ç»Ÿçš„ç½‘ç»œç¼–ç¨‹ä¸­å¹¿æ³›ä½¿ç”¨ã€‚</p><p><code>man 3 inet_addr</code></p><p>å‡½æ•°åŸå‹ï¼š</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=line><span class=ln>1</span><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;arpa/inet.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=ln>2</span><span class=cl><span class=cp></span><span class=kt>in_addr_t</span> <span class=nf>inet_addr</span><span class=p>(</span><span class=k>const</span> <span class=kt>char</span> <span class=o>*</span><span class=n>cp</span><span class=p>);</span>
</span></span></code></pre></div><p>å‚æ•°ï¼š</p><ul><li><code>cp</code>ï¼šä»¥ç‚¹åˆ†åè¿›åˆ¶æ ¼å¼è¡¨ç¤ºçš„ IPv4 åœ°å€å­—ç¬¦ä¸²ï¼Œä¾‹å¦‚ &ldquo;192.168.0.1&rdquo;ã€‚</li></ul><p>è¿”å›å€¼ï¼š</p><ul><li>æˆåŠŸæ—¶ï¼Œè¿”å›è½¬æ¢åçš„ 32 ä½ç½‘ç»œå­—èŠ‚åºçš„ IPv4 åœ°å€ã€‚</li><li>å¤±è´¥æ—¶ï¼Œè¿”å› <code>INADDR_NONE</code>ï¼ˆé€šå¸¸ä¸º -1ï¼‰ã€‚</li></ul><p><code>inet_addr</code> å‡½æ•°å°†ç‚¹åˆ†åè¿›åˆ¶æ ¼å¼çš„ IPv4 åœ°å€å­—ç¬¦ä¸²è½¬æ¢ä¸ºç½‘ç»œå­—èŠ‚åºçš„ 32 ä½äºŒè¿›åˆ¶å€¼ã€‚å®ƒæ‰§è¡Œä»¥ä¸‹æ­¥éª¤ï¼š</p><ol><li>å°†ç‚¹åˆ†åè¿›åˆ¶çš„ IPv4 åœ°å€å­—ç¬¦ä¸²æŒ‰ç…§ç‚¹å·åˆ†éš”ç¬¦åˆ†å‰²ä¸ºå››ä¸ªéƒ¨åˆ†ï¼Œæ¯ä¸ªéƒ¨åˆ†è¡¨ç¤ºä¸€ä¸ªå­—èŠ‚ã€‚</li><li>å°†æ¯ä¸ªéƒ¨åˆ†è½¬æ¢ä¸ºå¯¹åº”çš„æ•´æ•°å€¼ï¼ˆ0-255ï¼‰ã€‚</li><li>å°†å››ä¸ªå­—èŠ‚ç»„åˆæˆä¸€ä¸ª 32 ä½çš„äºŒè¿›åˆ¶å€¼ï¼Œå¹¶æŒ‰ç…§ç½‘ç»œå­—èŠ‚åºæ’åˆ—ã€‚</li></ol><p>ä¾‹å¦‚ï¼Œå¯¹äº IP åœ°å€ &ldquo;192.168.0.1&rdquo;ï¼Œ<code>inet_addr</code> å‡½æ•°å°†è¿”å›ä¸€ä¸ª 32 ä½çš„æ•´æ•°å€¼ <code>0x0100A8C0</code>ï¼ˆç½‘ç»œå­—èŠ‚åºï¼‰ã€‚</p><p>ä½¿ç”¨ç¤ºä¾‹ï¼š</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=line><span class=ln> 1</span><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;stdio.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=ln> 2</span><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;arpa/inet.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=ln> 3</span><span class=cl><span class=cp></span>
</span></span><span class=line><span class=ln> 4</span><span class=cl><span class=kt>int</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=ln> 5</span><span class=cl>    <span class=k>const</span> <span class=kt>char</span> <span class=o>*</span><span class=n>ip_str</span> <span class=o>=</span> <span class=s>&#34;192.168.0.1&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=ln> 6</span><span class=cl>    <span class=kt>in_addr_t</span> <span class=n>ip_addr</span> <span class=o>=</span> <span class=nf>inet_addr</span><span class=p>(</span><span class=n>ip_str</span><span class=p>);</span>
</span></span><span class=line><span class=ln> 7</span><span class=cl>    
</span></span><span class=line><span class=ln> 8</span><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=n>ip_addr</span> <span class=o>==</span> <span class=n>INADDR_NONE</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=ln> 9</span><span class=cl>        <span class=nf>printf</span><span class=p>(</span><span class=s>&#34;æ— æ•ˆçš„ IP åœ°å€</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=ln>10</span><span class=cl>    <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=ln>11</span><span class=cl>        <span class=nf>printf</span><span class=p>(</span><span class=s>&#34;IP åœ°å€çš„ç½‘ç»œå­—èŠ‚åºè¡¨ç¤º: 0x%08X</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>,</span> <span class=n>ip_addr</span><span class=p>);</span>
</span></span><span class=line><span class=ln>12</span><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=ln>13</span><span class=cl>    
</span></span><span class=line><span class=ln>14</span><span class=cl>    <span class=k>return</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=ln>15</span><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>è¾“å‡ºï¼š</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=ln>1</span><span class=cl>IP åœ°å€çš„ç½‘ç»œå­—èŠ‚åºè¡¨ç¤º: 0x0100A8C0
</span></span></code></pre></div><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œ<code>inet_addr</code> å‡½æ•°åªæ”¯æŒ IPv4 åœ°å€çš„è½¬æ¢ï¼Œå¯¹äº IPv6 åœ°å€ï¼Œéœ€è¦ä½¿ç”¨ <code>inet_pton</code> å‡½æ•°è¿›è¡Œè½¬æ¢ã€‚</p><p>å¦å¤–ï¼Œç”±äº <code>inet_addr</code> å‡½æ•°ä¸èƒ½å¤„ç†æ ¼å¼é”™è¯¯çš„ IP åœ°å€å­—ç¬¦ä¸²ï¼Œå› æ­¤åœ¨å®é™…ä½¿ç”¨ä¸­ï¼Œé€šå¸¸æ¨èä½¿ç”¨æ›´åŠ å¥å£®å’Œé€šç”¨çš„ <code>inet_pton</code> å‡½æ•°æ¥è¿›è¡Œ IP åœ°å€çš„è½¬æ¢ã€‚</p><h2 id=linuxçš„æ–‡ä»¶æ“ä½œ>linuxçš„æ–‡ä»¶æ“ä½œ</h2><p>æ¯ä¸€ä¸ªç¨‹åºéƒ½æœ‰å¤šä¸ªæ–‡ä»¶æè¿°ç¬¦,ä» 0 åˆ° 1023ï¼Œè¿™äº›0,1,2æ–‡ä»¶æè¿°ç¬¦è¢«ç§°ä¸ºæ ‡å‡†è¾“å…¥ã€æ ‡å‡†è¾“å‡ºã€æ ‡å‡†é”™è¯¯ã€‚</p><p>è¿™ä¸ªæ–‡ä»¶æè¿°ç¬¦æ˜¯ç”±linuxç³»ç»Ÿç»´æŠ¤çš„.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=line><span class=ln>1</span><span class=cl><span class=kt>int</span> <span class=nf>open</span><span class=p>(</span><span class=k>const</span> <span class=kt>char</span> <span class=o>*</span><span class=n>pathname</span><span class=p>,</span> <span class=kt>int</span> <span class=n>flags</span><span class=p>);</span>
</span></span><span class=line><span class=ln>2</span><span class=cl><span class=kt>int</span> <span class=nf>close</span><span class=p>(</span><span class=kt>int</span> <span class=n>fd</span><span class=p>);</span>
</span></span><span class=line><span class=ln>3</span><span class=cl><span class=kt>ssize_t</span> <span class=nf>read</span><span class=p>(</span><span class=kt>int</span> <span class=n>fd</span><span class=p>,</span> <span class=kt>void</span> <span class=o>*</span><span class=n>buf</span><span class=p>,</span> <span class=kt>size_t</span> <span class=n>count</span><span class=p>);</span>
</span></span><span class=line><span class=ln>4</span><span class=cl><span class=kt>ssize_t</span> <span class=nf>write</span><span class=p>(</span><span class=kt>int</span> <span class=n>fd</span><span class=p>,</span> <span class=k>const</span> <span class=kt>void</span> <span class=o>*</span><span class=n>buf</span><span class=p>,</span> <span class=kt>size_t</span> <span class=n>count</span><span class=p>);</span>
</span></span></code></pre></div></main><br><footer><div class=footer-info><p>Copyright &copy; 2025 Rainboy. All rights reserved.
<span>| Last build: 2025-09-05 00:16:30</span></p></div><script defer>document.addEventListener("keydown",function(e){if(document.activeElement.isContentEditable)return!1;if(document.activeElement.tagName=="INPUT")return!1;if(e.altKey||e.ctrlKey||e.shiftKey)return!1;var t=e.key;if(t==="h")e.preventDefault(),e.stopPropagation(),window.location.href="/";else if(t==="t")e.preventDefault(),e.stopPropagation(),window.location.href=`https://${location.hostname}/tags`;else if(t==="i"){e.preventDefault(),e.stopPropagation();const t=document.querySelectorAll("input");for(let e=0;e<t.length;e++)if(t[e].offsetParent!==null){t[e].selectionStart=t[e].selectionEnd=t[e].value.length,t[e].focus();break}}return!1})</script><script defer>function throttle(e,t){var n=Date.now();return function(){var s=Date.now();n+t-s<0&&(e(),n=s)}}function scrollHandler(){const e=Array.from(document.querySelectorAll("body h2, body h3"));function t(){for(var n,s,o,i=window.pageYOffset||document.documentElement.scrollTop,t=0;t<e.length;t++)s=e[t].getAttribute("id"),n=document.querySelector('nav ul li a[href="#'+s+'"]'),n&&n.classList.remove("active-toc");for(t=e.length-1;t>=0;t--)if(o=e[t].offsetTop,i>o-75&&(s=e[t].getAttribute("id"),n=document.querySelector('nav ul li a[href="#'+s+'"]'),n)){n.classList.add("active-toc");break}}window.addEventListener("scroll",throttle(t,200))}setTimeout(scrollHandler,100)</script><script defer>function addCopyButtonToCodeBlocks(){const e=document.querySelectorAll('code[class^="language-"]:not(.output):not([class*="language-console"])');e.forEach(e=>{const t=document.createElement("button");t.classList.add("copy-code-button"),t.innerHTML="copy",t.addEventListener("click",()=>{const s=e.querySelectorAll(".cl");let n="";s.forEach(e=>{n+=e.innerText}),navigator.clipboard.writeText(n),t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},1500)}),e.parentNode.before(t)})}setTimeout(function(){addCopyButtonToCodeBlocks()},100)</script><script defer src=/js/theme-switcher.js></script></footer></body></html>